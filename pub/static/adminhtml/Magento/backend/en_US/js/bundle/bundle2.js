require.config({"config": {
        "jsbuild":{"jquery/fileUploader/jquery.fileupload.js":"/*\r\n * jQuery File Upload Plugin\r\n * https://github.com/blueimp/jQuery-File-Upload\r\n *\r\n * Copyright 2010, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n */\r\n\r\n/* global define, require */\r\n/* eslint-disable new-cap */\r\n\r\n(function (factory) {\r\n  'use strict';\r\n  if (typeof define === 'function' && define.amd) {\r\n    // Register as an anonymous AMD module:\r\n    define(['jquery', 'jquery/fileUploader/vendor/jquery.ui.widget'], factory);\r\n  } else if (typeof exports === 'object') {\r\n    // Node/CommonJS:\r\n    factory(require('jquery'), require('jquery/fileUploader/vendor/jquery.ui.widget'));\r\n  } else {\r\n    // Browser globals:\r\n    factory(window.jQuery);\r\n  }\r\n})(function ($) {\r\n  'use strict';\r\n\r\n  // Detect file input support, based on\r\n  // https://viljamis.com/2012/file-upload-support-on-mobile/\r\n  $.support.fileInput = !(\r\n    new RegExp(\r\n      // Handle devices which give false positives for the feature detection:\r\n      '(Android (1\\\\.[0156]|2\\\\.[01]))' +\r\n        '|(Windows Phone (OS 7|8\\\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)' +\r\n        '|(w(eb)?OSBrowser)|(webOS)' +\r\n        '|(Kindle/(1\\\\.0|2\\\\.[05]|3\\\\.0))'\r\n    ).test(window.navigator.userAgent) ||\r\n    // Feature detection for all other devices:\r\n    $('<input type=\"file\"/>').prop('disabled')\r\n  );\r\n\r\n  // The FileReader API is not actually used, but works as feature detection,\r\n  // as some Safari versions (5?) support XHR file uploads via the FormData API,\r\n  // but not non-multipart XHR file uploads.\r\n  // window.XMLHttpRequestUpload is not available on IE10, so we check for\r\n  // window.ProgressEvent instead to detect XHR2 file upload capability:\r\n  $.support.xhrFileUpload = !!(window.ProgressEvent && window.FileReader);\r\n  $.support.xhrFormDataFileUpload = !!window.FormData;\r\n\r\n  // Detect support for Blob slicing (required for chunked uploads):\r\n  $.support.blobSlice =\r\n    window.Blob &&\r\n    (Blob.prototype.slice ||\r\n      Blob.prototype.webkitSlice ||\r\n      Blob.prototype.mozSlice);\r\n\r\n  /**\r\n   * Helper function to create drag handlers for dragover/dragenter/dragleave\r\n   *\r\n   * @param {string} type Event type\r\n   * @returns {Function} Drag handler\r\n   */\r\n  function getDragHandler(type) {\r\n    var isDragOver = type === 'dragover';\r\n    return function (e) {\r\n      e.dataTransfer = e.originalEvent && e.originalEvent.dataTransfer;\r\n      var dataTransfer = e.dataTransfer;\r\n      if (\r\n        dataTransfer &&\r\n        $.inArray('Files', dataTransfer.types) !== -1 &&\r\n        this._trigger(type, $.Event(type, { delegatedEvent: e })) !== false\r\n      ) {\r\n        e.preventDefault();\r\n        if (isDragOver) {\r\n          dataTransfer.dropEffect = 'copy';\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  // The fileupload widget listens for change events on file input fields defined\r\n  // via fileInput setting and paste or drop events of the given dropZone.\r\n  // In addition to the default jQuery Widget methods, the fileupload widget\r\n  // exposes the \"add\" and \"send\" methods, to add or directly send files using\r\n  // the fileupload API.\r\n  // By default, files added via file input selection, paste, drag & drop or\r\n  // \"add\" method are uploaded immediately, but it is possible to override\r\n  // the \"add\" callback option to queue file uploads.\r\n  $.widget('blueimp.fileupload', {\r\n    options: {\r\n      // The drop target element(s), by the default the complete document.\r\n      // Set to null to disable drag & drop support:\r\n      dropZone: $(document),\r\n      // The paste target element(s), by the default undefined.\r\n      // Set to a DOM node or jQuery object to enable file pasting:\r\n      pasteZone: undefined,\r\n      // The file input field(s), that are listened to for change events.\r\n      // If undefined, it is set to the file input fields inside\r\n      // of the widget element on plugin initialization.\r\n      // Set to null to disable the change listener.\r\n      fileInput: undefined,\r\n      // By default, the file input field is replaced with a clone after\r\n      // each input field change event. This is required for iframe transport\r\n      // queues and allows change events to be fired for the same file\r\n      // selection, but can be disabled by setting the following option to false:\r\n      replaceFileInput: true,\r\n      // The parameter name for the file form data (the request argument name).\r\n      // If undefined or empty, the name property of the file input field is\r\n      // used, or \"files[]\" if the file input name property is also empty,\r\n      // can be a string or an array of strings:\r\n      paramName: undefined,\r\n      // By default, each file of a selection is uploaded using an individual\r\n      // request for XHR type uploads. Set to false to upload file\r\n      // selections in one request each:\r\n      singleFileUploads: true,\r\n      // To limit the number of files uploaded with one XHR request,\r\n      // set the following option to an integer greater than 0:\r\n      limitMultiFileUploads: undefined,\r\n      // The following option limits the number of files uploaded with one\r\n      // XHR request to keep the request size under or equal to the defined\r\n      // limit in bytes:\r\n      limitMultiFileUploadSize: undefined,\r\n      // Multipart file uploads add a number of bytes to each uploaded file,\r\n      // therefore the following option adds an overhead for each file used\r\n      // in the limitMultiFileUploadSize configuration:\r\n      limitMultiFileUploadSizeOverhead: 512,\r\n      // Set the following option to true to issue all file upload requests\r\n      // in a sequential order:\r\n      sequentialUploads: false,\r\n      // To limit the number of concurrent uploads,\r\n      // set the following option to an integer greater than 0:\r\n      limitConcurrentUploads: undefined,\r\n      // Set the following option to true to force iframe transport uploads:\r\n      forceIframeTransport: false,\r\n      // Set the following option to the location of a redirect url on the\r\n      // origin server, for cross-domain iframe transport uploads:\r\n      redirect: undefined,\r\n      // The parameter name for the redirect url, sent as part of the form\r\n      // data and set to 'redirect' if this option is empty:\r\n      redirectParamName: undefined,\r\n      // Set the following option to the location of a postMessage window,\r\n      // to enable postMessage transport uploads:\r\n      postMessage: undefined,\r\n      // By default, XHR file uploads are sent as multipart/form-data.\r\n      // The iframe transport is always using multipart/form-data.\r\n      // Set to false to enable non-multipart XHR uploads:\r\n      multipart: true,\r\n      // To upload large files in smaller chunks, set the following option\r\n      // to a preferred maximum chunk size. If set to 0, null or undefined,\r\n      // or the browser does not support the required Blob API, files will\r\n      // be uploaded as a whole.\r\n      maxChunkSize: undefined,\r\n      // When a non-multipart upload or a chunked multipart upload has been\r\n      // aborted, this option can be used to resume the upload by setting\r\n      // it to the size of the already uploaded bytes. This option is most\r\n      // useful when modifying the options object inside of the \"add\" or\r\n      // \"send\" callbacks, as the options are cloned for each file upload.\r\n      uploadedBytes: undefined,\r\n      // By default, failed (abort or error) file uploads are removed from the\r\n      // global progress calculation. Set the following option to false to\r\n      // prevent recalculating the global progress data:\r\n      recalculateProgress: true,\r\n      // Interval in milliseconds to calculate and trigger progress events:\r\n      progressInterval: 100,\r\n      // Interval in milliseconds to calculate progress bitrate:\r\n      bitrateInterval: 500,\r\n      // By default, uploads are started automatically when adding files:\r\n      autoUpload: true,\r\n      // By default, duplicate file names are expected to be handled on\r\n      // the server-side. If this is not possible (e.g. when uploading\r\n      // files directly to Amazon S3), the following option can be set to\r\n      // an empty object or an object mapping existing filenames, e.g.:\r\n      // { \"image.jpg\": true, \"image (1).jpg\": true }\r\n      // If it is set, all files will be uploaded with unique filenames,\r\n      // adding increasing number suffixes if necessary, e.g.:\r\n      // \"image (2).jpg\"\r\n      uniqueFilenames: undefined,\r\n\r\n      // Error and info messages:\r\n      messages: {\r\n        uploadedBytes: 'Uploaded bytes exceed file size'\r\n      },\r\n\r\n      // Translation function, gets the message key to be translated\r\n      // and an object with context specific data as arguments:\r\n      i18n: function (message, context) {\r\n        // eslint-disable-next-line no-param-reassign\r\n        message = this.messages[message] || message.toString();\r\n        if (context) {\r\n          $.each(context, function (key, value) {\r\n            // eslint-disable-next-line no-param-reassign\r\n            message = message.replace('{' + key + '}', value);\r\n          });\r\n        }\r\n        return message;\r\n      },\r\n\r\n      // Additional form data to be sent along with the file uploads can be set\r\n      // using this option, which accepts an array of objects with name and\r\n      // value properties, a function returning such an array, a FormData\r\n      // object (for XHR file uploads), or a simple object.\r\n      // The form of the first fileInput is given as parameter to the function:\r\n      formData: function (form) {\r\n        return form.serializeArray();\r\n      },\r\n\r\n      // The add callback is invoked as soon as files are added to the fileupload\r\n      // widget (via file input selection, drag & drop, paste or add API call).\r\n      // If the singleFileUploads option is enabled, this callback will be\r\n      // called once for each file in the selection for XHR file uploads, else\r\n      // once for each file selection.\r\n      //\r\n      // The upload starts when the submit method is invoked on the data parameter.\r\n      // The data object contains a files property holding the added files\r\n      // and allows you to override plugin options as well as define ajax settings.\r\n      //\r\n      // Listeners for this callback can also be bound the following way:\r\n      // .on('fileuploadadd', func);\r\n      //\r\n      // data.submit() returns a Promise object and allows to attach additional\r\n      // handlers using jQuery's Deferred callbacks:\r\n      // data.submit().done(func).fail(func).always(func);\r\n      add: function (e, data) {\r\n        if (e.isDefaultPrevented()) {\r\n          return false;\r\n        }\r\n        if (\r\n          data.autoUpload ||\r\n          (data.autoUpload !== false &&\r\n            $(this).fileupload('option', 'autoUpload'))\r\n        ) {\r\n          data.process().done(function () {\r\n            data.submit();\r\n          });\r\n        }\r\n      },\r\n\r\n      // Other callbacks:\r\n\r\n      // Callback for the submit event of each file upload:\r\n      // submit: function (e, data) {}, // .on('fileuploadsubmit', func);\r\n\r\n      // Callback for the start of each file upload request:\r\n      // send: function (e, data) {}, // .on('fileuploadsend', func);\r\n\r\n      // Callback for successful uploads:\r\n      // done: function (e, data) {}, // .on('fileuploaddone', func);\r\n\r\n      // Callback for failed (abort or error) uploads:\r\n      // fail: function (e, data) {}, // .on('fileuploadfail', func);\r\n\r\n      // Callback for completed (success, abort or error) requests:\r\n      // always: function (e, data) {}, // .on('fileuploadalways', func);\r\n\r\n      // Callback for upload progress events:\r\n      // progress: function (e, data) {}, // .on('fileuploadprogress', func);\r\n\r\n      // Callback for global upload progress events:\r\n      // progressall: function (e, data) {}, // .on('fileuploadprogressall', func);\r\n\r\n      // Callback for uploads start, equivalent to the global ajaxStart event:\r\n      // start: function (e) {}, // .on('fileuploadstart', func);\r\n\r\n      // Callback for uploads stop, equivalent to the global ajaxStop event:\r\n      // stop: function (e) {}, // .on('fileuploadstop', func);\r\n\r\n      // Callback for change events of the fileInput(s):\r\n      // change: function (e, data) {}, // .on('fileuploadchange', func);\r\n\r\n      // Callback for paste events to the pasteZone(s):\r\n      // paste: function (e, data) {}, // .on('fileuploadpaste', func);\r\n\r\n      // Callback for drop events of the dropZone(s):\r\n      // drop: function (e, data) {}, // .on('fileuploaddrop', func);\r\n\r\n      // Callback for dragover events of the dropZone(s):\r\n      // dragover: function (e) {}, // .on('fileuploaddragover', func);\r\n\r\n      // Callback before the start of each chunk upload request (before form data initialization):\r\n      // chunkbeforesend: function (e, data) {}, // .on('fileuploadchunkbeforesend', func);\r\n\r\n      // Callback for the start of each chunk upload request:\r\n      // chunksend: function (e, data) {}, // .on('fileuploadchunksend', func);\r\n\r\n      // Callback for successful chunk uploads:\r\n      // chunkdone: function (e, data) {}, // .on('fileuploadchunkdone', func);\r\n\r\n      // Callback for failed (abort or error) chunk uploads:\r\n      // chunkfail: function (e, data) {}, // .on('fileuploadchunkfail', func);\r\n\r\n      // Callback for completed (success, abort or error) chunk upload requests:\r\n      // chunkalways: function (e, data) {}, // .on('fileuploadchunkalways', func);\r\n\r\n      // The plugin options are used as settings object for the ajax calls.\r\n      // The following are jQuery ajax settings required for the file uploads:\r\n      processData: false,\r\n      contentType: false,\r\n      cache: false,\r\n      timeout: 0\r\n    },\r\n\r\n    // jQuery versions before 1.8 require promise.pipe if the return value is\r\n    // used, as promise.then in older versions has a different behavior, see:\r\n    // https://blog.jquery.com/2012/08/09/jquery-1-8-released/\r\n    // https://bugs.jquery.com/ticket/11010\r\n    // https://github.com/blueimp/jQuery-File-Upload/pull/3435\r\n    _promisePipe: (function () {\r\n      var parts = $.fn.jquery.split('.');\r\n      return Number(parts[0]) > 1 || Number(parts[1]) > 7 ? 'then' : 'pipe';\r\n    })(),\r\n\r\n    // A list of options that require reinitializing event listeners and/or\r\n    // special initialization code:\r\n    _specialOptions: [\r\n      'fileInput',\r\n      'dropZone',\r\n      'pasteZone',\r\n      'multipart',\r\n      'forceIframeTransport'\r\n    ],\r\n\r\n    _blobSlice:\r\n      $.support.blobSlice &&\r\n      function () {\r\n        var slice = this.slice || this.webkitSlice || this.mozSlice;\r\n        return slice.apply(this, arguments);\r\n      },\r\n\r\n    _BitrateTimer: function () {\r\n      this.timestamp = Date.now ? Date.now() : new Date().getTime();\r\n      this.loaded = 0;\r\n      this.bitrate = 0;\r\n      this.getBitrate = function (now, loaded, interval) {\r\n        var timeDiff = now - this.timestamp;\r\n        if (!this.bitrate || !interval || timeDiff > interval) {\r\n          this.bitrate = (loaded - this.loaded) * (1000 / timeDiff) * 8;\r\n          this.loaded = loaded;\r\n          this.timestamp = now;\r\n        }\r\n        return this.bitrate;\r\n      };\r\n    },\r\n\r\n    _isXHRUpload: function (options) {\r\n      return (\r\n        !options.forceIframeTransport &&\r\n        ((!options.multipart && $.support.xhrFileUpload) ||\r\n          $.support.xhrFormDataFileUpload)\r\n      );\r\n    },\r\n\r\n    _getFormData: function (options) {\r\n      var formData;\r\n      if ($.type(options.formData) === 'function') {\r\n        return options.formData(options.form);\r\n      }\r\n      if ($.isArray(options.formData)) {\r\n        return options.formData;\r\n      }\r\n      if ($.type(options.formData) === 'object') {\r\n        formData = [];\r\n        $.each(options.formData, function (name, value) {\r\n          formData.push({ name: name, value: value });\r\n        });\r\n        return formData;\r\n      }\r\n      return [];\r\n    },\r\n\r\n    _getTotal: function (files) {\r\n      var total = 0;\r\n      $.each(files, function (index, file) {\r\n        total += file.size || 1;\r\n      });\r\n      return total;\r\n    },\r\n\r\n    _initProgressObject: function (obj) {\r\n      var progress = {\r\n        loaded: 0,\r\n        total: 0,\r\n        bitrate: 0\r\n      };\r\n      if (obj._progress) {\r\n        $.extend(obj._progress, progress);\r\n      } else {\r\n        obj._progress = progress;\r\n      }\r\n    },\r\n\r\n    _initResponseObject: function (obj) {\r\n      var prop;\r\n      if (obj._response) {\r\n        for (prop in obj._response) {\r\n          if (Object.prototype.hasOwnProperty.call(obj._response, prop)) {\r\n            delete obj._response[prop];\r\n          }\r\n        }\r\n      } else {\r\n        obj._response = {};\r\n      }\r\n    },\r\n\r\n    _onProgress: function (e, data) {\r\n      if (e.lengthComputable) {\r\n        var now = Date.now ? Date.now() : new Date().getTime(),\r\n          loaded;\r\n        if (\r\n          data._time &&\r\n          data.progressInterval &&\r\n          now - data._time < data.progressInterval &&\r\n          e.loaded !== e.total\r\n        ) {\r\n          return;\r\n        }\r\n        data._time = now;\r\n        loaded =\r\n          Math.floor(\r\n            (e.loaded / e.total) * (data.chunkSize || data._progress.total)\r\n          ) + (data.uploadedBytes || 0);\r\n        // Add the difference from the previously loaded state\r\n        // to the global loaded counter:\r\n        this._progress.loaded += loaded - data._progress.loaded;\r\n        this._progress.bitrate = this._bitrateTimer.getBitrate(\r\n          now,\r\n          this._progress.loaded,\r\n          data.bitrateInterval\r\n        );\r\n        data._progress.loaded = data.loaded = loaded;\r\n        data._progress.bitrate = data.bitrate = data._bitrateTimer.getBitrate(\r\n          now,\r\n          loaded,\r\n          data.bitrateInterval\r\n        );\r\n        // Trigger a custom progress event with a total data property set\r\n        // to the file size(s) of the current upload and a loaded data\r\n        // property calculated accordingly:\r\n        this._trigger(\r\n          'progress',\r\n          $.Event('progress', { delegatedEvent: e }),\r\n          data\r\n        );\r\n        // Trigger a global progress event for all current file uploads,\r\n        // including ajax calls queued for sequential file uploads:\r\n        this._trigger(\r\n          'progressall',\r\n          $.Event('progressall', { delegatedEvent: e }),\r\n          this._progress\r\n        );\r\n      }\r\n    },\r\n\r\n    _initProgressListener: function (options) {\r\n      var that = this,\r\n        xhr = options.xhr ? options.xhr() : $.ajaxSettings.xhr();\r\n      // Accesss to the native XHR object is required to add event listeners\r\n      // for the upload progress event:\r\n      if (xhr.upload) {\r\n        $(xhr.upload).on('progress', function (e) {\r\n          var oe = e.originalEvent;\r\n          // Make sure the progress event properties get copied over:\r\n          e.lengthComputable = oe.lengthComputable;\r\n          e.loaded = oe.loaded;\r\n          e.total = oe.total;\r\n          that._onProgress(e, options);\r\n        });\r\n        options.xhr = function () {\r\n          return xhr;\r\n        };\r\n      }\r\n    },\r\n\r\n    _deinitProgressListener: function (options) {\r\n      var xhr = options.xhr ? options.xhr() : $.ajaxSettings.xhr();\r\n      if (xhr.upload) {\r\n        $(xhr.upload).off('progress');\r\n      }\r\n    },\r\n\r\n    _isInstanceOf: function (type, obj) {\r\n      // Cross-frame instanceof check\r\n      return Object.prototype.toString.call(obj) === '[object ' + type + ']';\r\n    },\r\n\r\n    _getUniqueFilename: function (name, map) {\r\n      // eslint-disable-next-line no-param-reassign\r\n      name = String(name);\r\n      if (map[name]) {\r\n        // eslint-disable-next-line no-param-reassign\r\n        name = name.replace(/(?: \\(([\\d]+)\\))?(\\.[^.]+)?$/, function (\r\n          _,\r\n          p1,\r\n          p2\r\n        ) {\r\n          var index = p1 ? Number(p1) + 1 : 1;\r\n          var ext = p2 || '';\r\n          return ' (' + index + ')' + ext;\r\n        });\r\n        return this._getUniqueFilename(name, map);\r\n      }\r\n      map[name] = true;\r\n      return name;\r\n    },\r\n\r\n    _initXHRData: function (options) {\r\n      var that = this,\r\n        formData,\r\n        file = options.files[0],\r\n        // Ignore non-multipart setting if not supported:\r\n        multipart = options.multipart || !$.support.xhrFileUpload,\r\n        paramName =\r\n          $.type(options.paramName) === 'array'\r\n            ? options.paramName[0]\r\n            : options.paramName;\r\n      options.headers = $.extend({}, options.headers);\r\n      if (options.contentRange) {\r\n        options.headers['Content-Range'] = options.contentRange;\r\n      }\r\n      if (!multipart || options.blob || !this._isInstanceOf('File', file)) {\r\n        options.headers['Content-Disposition'] =\r\n          'attachment; filename=\"' +\r\n          encodeURI(file.uploadName || file.name) +\r\n          '\"';\r\n      }\r\n      if (!multipart) {\r\n        options.contentType = file.type || 'application/octet-stream';\r\n        options.data = options.blob || file;\r\n      } else if ($.support.xhrFormDataFileUpload) {\r\n        if (options.postMessage) {\r\n          // window.postMessage does not allow sending FormData\r\n          // objects, so we just add the File/Blob objects to\r\n          // the formData array and let the postMessage window\r\n          // create the FormData object out of this array:\r\n          formData = this._getFormData(options);\r\n          if (options.blob) {\r\n            formData.push({\r\n              name: paramName,\r\n              value: options.blob\r\n            });\r\n          } else {\r\n            $.each(options.files, function (index, file) {\r\n              formData.push({\r\n                name:\r\n                  ($.type(options.paramName) === 'array' &&\r\n                    options.paramName[index]) ||\r\n                  paramName,\r\n                value: file\r\n              });\r\n            });\r\n          }\r\n        } else {\r\n          if (that._isInstanceOf('FormData', options.formData)) {\r\n            formData = options.formData;\r\n          } else {\r\n            formData = new FormData();\r\n            $.each(this._getFormData(options), function (index, field) {\r\n              formData.append(field.name, field.value);\r\n            });\r\n          }\r\n          if (options.blob) {\r\n            formData.append(\r\n              paramName,\r\n              options.blob,\r\n              file.uploadName || file.name\r\n            );\r\n          } else {\r\n            $.each(options.files, function (index, file) {\r\n              // This check allows the tests to run with\r\n              // dummy objects:\r\n              if (\r\n                that._isInstanceOf('File', file) ||\r\n                that._isInstanceOf('Blob', file)\r\n              ) {\r\n                var fileName = file.uploadName || file.name;\r\n                if (options.uniqueFilenames) {\r\n                  fileName = that._getUniqueFilename(\r\n                    fileName,\r\n                    options.uniqueFilenames\r\n                  );\r\n                }\r\n                formData.append(\r\n                  ($.type(options.paramName) === 'array' &&\r\n                    options.paramName[index]) ||\r\n                    paramName,\r\n                  file,\r\n                  fileName\r\n                );\r\n              }\r\n            });\r\n          }\r\n        }\r\n        options.data = formData;\r\n      }\r\n      // Blob reference is not needed anymore, free memory:\r\n      options.blob = null;\r\n    },\r\n\r\n    _initIframeSettings: function (options) {\r\n      var targetHost = $('<a></a>').prop('href', options.url).prop('host');\r\n      // Setting the dataType to iframe enables the iframe transport:\r\n      options.dataType = 'iframe ' + (options.dataType || '');\r\n      // The iframe transport accepts a serialized array as form data:\r\n      options.formData = this._getFormData(options);\r\n      // Add redirect url to form data on cross-domain uploads:\r\n      if (options.redirect && targetHost && targetHost !== location.host) {\r\n        options.formData.push({\r\n          name: options.redirectParamName || 'redirect',\r\n          value: options.redirect\r\n        });\r\n      }\r\n    },\r\n\r\n    _initDataSettings: function (options) {\r\n      if (this._isXHRUpload(options)) {\r\n        if (!this._chunkedUpload(options, true)) {\r\n          if (!options.data) {\r\n            this._initXHRData(options);\r\n          }\r\n          this._initProgressListener(options);\r\n        }\r\n        if (options.postMessage) {\r\n          // Setting the dataType to postmessage enables the\r\n          // postMessage transport:\r\n          options.dataType = 'postmessage ' + (options.dataType || '');\r\n        }\r\n      } else {\r\n        this._initIframeSettings(options);\r\n      }\r\n    },\r\n\r\n    _getParamName: function (options) {\r\n      var fileInput = $(options.fileInput),\r\n        paramName = options.paramName;\r\n      if (!paramName) {\r\n        paramName = [];\r\n        fileInput.each(function () {\r\n          var input = $(this),\r\n            name = input.prop('name') || 'files[]',\r\n            i = (input.prop('files') || [1]).length;\r\n          while (i) {\r\n            paramName.push(name);\r\n            i -= 1;\r\n          }\r\n        });\r\n        if (!paramName.length) {\r\n          paramName = [fileInput.prop('name') || 'files[]'];\r\n        }\r\n      } else if (!$.isArray(paramName)) {\r\n        paramName = [paramName];\r\n      }\r\n      return paramName;\r\n    },\r\n\r\n    _initFormSettings: function (options) {\r\n      // Retrieve missing options from the input field and the\r\n      // associated form, if available:\r\n      if (!options.form || !options.form.length) {\r\n        options.form = $(options.fileInput.prop('form'));\r\n        // If the given file input doesn't have an associated form,\r\n        // use the default widget file input's form:\r\n        if (!options.form.length) {\r\n          options.form = $(this.options.fileInput.prop('form'));\r\n        }\r\n      }\r\n      options.paramName = this._getParamName(options);\r\n      if (!options.url) {\r\n        options.url = options.form.prop('action') || location.href;\r\n      }\r\n      // The HTTP request method must be \"POST\" or \"PUT\":\r\n      options.type = (\r\n        options.type ||\r\n        ($.type(options.form.prop('method')) === 'string' &&\r\n          options.form.prop('method')) ||\r\n        ''\r\n      ).toUpperCase();\r\n      if (\r\n        options.type !== 'POST' &&\r\n        options.type !== 'PUT' &&\r\n        options.type !== 'PATCH'\r\n      ) {\r\n        options.type = 'POST';\r\n      }\r\n      if (!options.formAcceptCharset) {\r\n        options.formAcceptCharset = options.form.attr('accept-charset');\r\n      }\r\n    },\r\n\r\n    _getAJAXSettings: function (data) {\r\n      var options = $.extend({}, this.options, data);\r\n      this._initFormSettings(options);\r\n      this._initDataSettings(options);\r\n      return options;\r\n    },\r\n\r\n    // jQuery 1.6 doesn't provide .state(),\r\n    // while jQuery 1.8+ removed .isRejected() and .isResolved():\r\n    _getDeferredState: function (deferred) {\r\n      if (deferred.state) {\r\n        return deferred.state();\r\n      }\r\n      if (deferred.isResolved()) {\r\n        return 'resolved';\r\n      }\r\n      if (deferred.isRejected()) {\r\n        return 'rejected';\r\n      }\r\n      return 'pending';\r\n    },\r\n\r\n    // Maps jqXHR callbacks to the equivalent\r\n    // methods of the given Promise object:\r\n    _enhancePromise: function (promise) {\r\n      promise.success = promise.done;\r\n      promise.error = promise.fail;\r\n      promise.complete = promise.always;\r\n      return promise;\r\n    },\r\n\r\n    // Creates and returns a Promise object enhanced with\r\n    // the jqXHR methods abort, success, error and complete:\r\n    _getXHRPromise: function (resolveOrReject, context, args) {\r\n      var dfd = $.Deferred(),\r\n        promise = dfd.promise();\r\n      // eslint-disable-next-line no-param-reassign\r\n      context = context || this.options.context || promise;\r\n      if (resolveOrReject === true) {\r\n        dfd.resolveWith(context, args);\r\n      } else if (resolveOrReject === false) {\r\n        dfd.rejectWith(context, args);\r\n      }\r\n      promise.abort = dfd.promise;\r\n      return this._enhancePromise(promise);\r\n    },\r\n\r\n    // Adds convenience methods to the data callback argument:\r\n    _addConvenienceMethods: function (e, data) {\r\n      var that = this,\r\n        getPromise = function (args) {\r\n          return $.Deferred().resolveWith(that, args).promise();\r\n        };\r\n      data.process = function (resolveFunc, rejectFunc) {\r\n        if (resolveFunc || rejectFunc) {\r\n          data._processQueue = this._processQueue = (this._processQueue ||\r\n            getPromise([this]))\r\n            [that._promisePipe](function () {\r\n              if (data.errorThrown) {\r\n                return $.Deferred().rejectWith(that, [data]).promise();\r\n              }\r\n              return getPromise(arguments);\r\n            })\r\n            [that._promisePipe](resolveFunc, rejectFunc);\r\n        }\r\n        return this._processQueue || getPromise([this]);\r\n      };\r\n      data.submit = function () {\r\n        if (this.state() !== 'pending') {\r\n          data.jqXHR = this.jqXHR =\r\n            that._trigger(\r\n              'submit',\r\n              $.Event('submit', { delegatedEvent: e }),\r\n              this\r\n            ) !== false && that._onSend(e, this);\r\n        }\r\n        return this.jqXHR || that._getXHRPromise();\r\n      };\r\n      data.abort = function () {\r\n        if (this.jqXHR) {\r\n          return this.jqXHR.abort();\r\n        }\r\n        this.errorThrown = 'abort';\r\n        that._trigger('fail', null, this);\r\n        return that._getXHRPromise(false);\r\n      };\r\n      data.state = function () {\r\n        if (this.jqXHR) {\r\n          return that._getDeferredState(this.jqXHR);\r\n        }\r\n        if (this._processQueue) {\r\n          return that._getDeferredState(this._processQueue);\r\n        }\r\n      };\r\n      data.processing = function () {\r\n        return (\r\n          !this.jqXHR &&\r\n          this._processQueue &&\r\n          that._getDeferredState(this._processQueue) === 'pending'\r\n        );\r\n      };\r\n      data.progress = function () {\r\n        return this._progress;\r\n      };\r\n      data.response = function () {\r\n        return this._response;\r\n      };\r\n    },\r\n\r\n    // Parses the Range header from the server response\r\n    // and returns the uploaded bytes:\r\n    _getUploadedBytes: function (jqXHR) {\r\n      var range = jqXHR.getResponseHeader('Range'),\r\n        parts = range && range.split('-'),\r\n        upperBytesPos = parts && parts.length > 1 && parseInt(parts[1], 10);\r\n      return upperBytesPos && upperBytesPos + 1;\r\n    },\r\n\r\n    // Uploads a file in multiple, sequential requests\r\n    // by splitting the file up in multiple blob chunks.\r\n    // If the second parameter is true, only tests if the file\r\n    // should be uploaded in chunks, but does not invoke any\r\n    // upload requests:\r\n    _chunkedUpload: function (options, testOnly) {\r\n      options.uploadedBytes = options.uploadedBytes || 0;\r\n      var that = this,\r\n        file = options.files[0],\r\n        fs = file.size,\r\n        ub = options.uploadedBytes,\r\n        mcs = options.maxChunkSize || fs,\r\n        slice = this._blobSlice,\r\n        dfd = $.Deferred(),\r\n        promise = dfd.promise(),\r\n        jqXHR,\r\n        upload;\r\n      if (\r\n        !(\r\n          this._isXHRUpload(options) &&\r\n          slice &&\r\n          (ub || ($.type(mcs) === 'function' ? mcs(options) : mcs) < fs)\r\n        ) ||\r\n        options.data\r\n      ) {\r\n        return false;\r\n      }\r\n      if (testOnly) {\r\n        return true;\r\n      }\r\n      if (ub >= fs) {\r\n        file.error = options.i18n('uploadedBytes');\r\n        return this._getXHRPromise(false, options.context, [\r\n          null,\r\n          'error',\r\n          file.error\r\n        ]);\r\n      }\r\n      // The chunk upload method:\r\n      upload = function () {\r\n        // Clone the options object for each chunk upload:\r\n        var o = $.extend({}, options),\r\n          currentLoaded = o._progress.loaded;\r\n        o.blob = slice.call(\r\n          file,\r\n          ub,\r\n          ub + ($.type(mcs) === 'function' ? mcs(o) : mcs),\r\n          file.type\r\n        );\r\n        // Store the current chunk size, as the blob itself\r\n        // will be dereferenced after data processing:\r\n        o.chunkSize = o.blob.size;\r\n        // Expose the chunk bytes position range:\r\n        o.contentRange =\r\n          'bytes ' + ub + '-' + (ub + o.chunkSize - 1) + '/' + fs;\r\n        // Trigger chunkbeforesend to allow form data to be updated for this chunk\r\n        that._trigger('chunkbeforesend', null, o);\r\n        // Process the upload data (the blob and potential form data):\r\n        that._initXHRData(o);\r\n        // Add progress listeners for this chunk upload:\r\n        that._initProgressListener(o);\r\n        jqXHR = (\r\n          (that._trigger('chunksend', null, o) !== false && $.ajax(o)) ||\r\n          that._getXHRPromise(false, o.context)\r\n        )\r\n          .done(function (result, textStatus, jqXHR) {\r\n            ub = that._getUploadedBytes(jqXHR) || ub + o.chunkSize;\r\n            // Create a progress event if no final progress event\r\n            // with loaded equaling total has been triggered\r\n            // for this chunk:\r\n            if (currentLoaded + o.chunkSize - o._progress.loaded) {\r\n              that._onProgress(\r\n                $.Event('progress', {\r\n                  lengthComputable: true,\r\n                  loaded: ub - o.uploadedBytes,\r\n                  total: ub - o.uploadedBytes\r\n                }),\r\n                o\r\n              );\r\n            }\r\n            options.uploadedBytes = o.uploadedBytes = ub;\r\n            o.result = result;\r\n            o.textStatus = textStatus;\r\n            o.jqXHR = jqXHR;\r\n            that._trigger('chunkdone', null, o);\r\n            that._trigger('chunkalways', null, o);\r\n            if (ub < fs) {\r\n              // File upload not yet complete,\r\n              // continue with the next chunk:\r\n              upload();\r\n            } else {\r\n              dfd.resolveWith(o.context, [result, textStatus, jqXHR]);\r\n            }\r\n          })\r\n          .fail(function (jqXHR, textStatus, errorThrown) {\r\n            o.jqXHR = jqXHR;\r\n            o.textStatus = textStatus;\r\n            o.errorThrown = errorThrown;\r\n            that._trigger('chunkfail', null, o);\r\n            that._trigger('chunkalways', null, o);\r\n            dfd.rejectWith(o.context, [jqXHR, textStatus, errorThrown]);\r\n          })\r\n          .always(function () {\r\n            that._deinitProgressListener(o);\r\n          });\r\n      };\r\n      this._enhancePromise(promise);\r\n      promise.abort = function () {\r\n        return jqXHR.abort();\r\n      };\r\n      upload();\r\n      return promise;\r\n    },\r\n\r\n    _beforeSend: function (e, data) {\r\n      if (this._active === 0) {\r\n        // the start callback is triggered when an upload starts\r\n        // and no other uploads are currently running,\r\n        // equivalent to the global ajaxStart event:\r\n        this._trigger('start');\r\n        // Set timer for global bitrate progress calculation:\r\n        this._bitrateTimer = new this._BitrateTimer();\r\n        // Reset the global progress values:\r\n        this._progress.loaded = this._progress.total = 0;\r\n        this._progress.bitrate = 0;\r\n      }\r\n      // Make sure the container objects for the .response() and\r\n      // .progress() methods on the data object are available\r\n      // and reset to their initial state:\r\n      this._initResponseObject(data);\r\n      this._initProgressObject(data);\r\n      data._progress.loaded = data.loaded = data.uploadedBytes || 0;\r\n      data._progress.total = data.total = this._getTotal(data.files) || 1;\r\n      data._progress.bitrate = data.bitrate = 0;\r\n      this._active += 1;\r\n      // Initialize the global progress values:\r\n      this._progress.loaded += data.loaded;\r\n      this._progress.total += data.total;\r\n    },\r\n\r\n    _onDone: function (result, textStatus, jqXHR, options) {\r\n      var total = options._progress.total,\r\n        response = options._response;\r\n      if (options._progress.loaded < total) {\r\n        // Create a progress event if no final progress event\r\n        // with loaded equaling total has been triggered:\r\n        this._onProgress(\r\n          $.Event('progress', {\r\n            lengthComputable: true,\r\n            loaded: total,\r\n            total: total\r\n          }),\r\n          options\r\n        );\r\n      }\r\n      response.result = options.result = result;\r\n      response.textStatus = options.textStatus = textStatus;\r\n      response.jqXHR = options.jqXHR = jqXHR;\r\n      this._trigger('done', null, options);\r\n    },\r\n\r\n    _onFail: function (jqXHR, textStatus, errorThrown, options) {\r\n      var response = options._response;\r\n      if (options.recalculateProgress) {\r\n        // Remove the failed (error or abort) file upload from\r\n        // the global progress calculation:\r\n        this._progress.loaded -= options._progress.loaded;\r\n        this._progress.total -= options._progress.total;\r\n      }\r\n      response.jqXHR = options.jqXHR = jqXHR;\r\n      response.textStatus = options.textStatus = textStatus;\r\n      response.errorThrown = options.errorThrown = errorThrown;\r\n      this._trigger('fail', null, options);\r\n    },\r\n\r\n    _onAlways: function (jqXHRorResult, textStatus, jqXHRorError, options) {\r\n      // jqXHRorResult, textStatus and jqXHRorError are added to the\r\n      // options object via done and fail callbacks\r\n      this._trigger('always', null, options);\r\n    },\r\n\r\n    _onSend: function (e, data) {\r\n      if (!data.submit) {\r\n        this._addConvenienceMethods(e, data);\r\n      }\r\n      var that = this,\r\n        jqXHR,\r\n        aborted,\r\n        slot,\r\n        pipe,\r\n        options = that._getAJAXSettings(data),\r\n        send = function () {\r\n          that._sending += 1;\r\n          // Set timer for bitrate progress calculation:\r\n          options._bitrateTimer = new that._BitrateTimer();\r\n          jqXHR =\r\n            jqXHR ||\r\n            (\r\n              ((aborted ||\r\n                that._trigger(\r\n                  'send',\r\n                  $.Event('send', { delegatedEvent: e }),\r\n                  options\r\n                ) === false) &&\r\n                that._getXHRPromise(false, options.context, aborted)) ||\r\n              that._chunkedUpload(options) ||\r\n              $.ajax(options)\r\n            )\r\n              .done(function (result, textStatus, jqXHR) {\r\n                that._onDone(result, textStatus, jqXHR, options);\r\n              })\r\n              .fail(function (jqXHR, textStatus, errorThrown) {\r\n                that._onFail(jqXHR, textStatus, errorThrown, options);\r\n              })\r\n              .always(function (jqXHRorResult, textStatus, jqXHRorError) {\r\n                that._deinitProgressListener(options);\r\n                that._onAlways(\r\n                  jqXHRorResult,\r\n                  textStatus,\r\n                  jqXHRorError,\r\n                  options\r\n                );\r\n                that._sending -= 1;\r\n                that._active -= 1;\r\n                if (\r\n                  options.limitConcurrentUploads &&\r\n                  options.limitConcurrentUploads > that._sending\r\n                ) {\r\n                  // Start the next queued upload,\r\n                  // that has not been aborted:\r\n                  var nextSlot = that._slots.shift();\r\n                  while (nextSlot) {\r\n                    if (that._getDeferredState(nextSlot) === 'pending') {\r\n                      nextSlot.resolve();\r\n                      break;\r\n                    }\r\n                    nextSlot = that._slots.shift();\r\n                  }\r\n                }\r\n                if (that._active === 0) {\r\n                  // The stop callback is triggered when all uploads have\r\n                  // been completed, equivalent to the global ajaxStop event:\r\n                  that._trigger('stop');\r\n                }\r\n              });\r\n          return jqXHR;\r\n        };\r\n      this._beforeSend(e, options);\r\n      if (\r\n        this.options.sequentialUploads ||\r\n        (this.options.limitConcurrentUploads &&\r\n          this.options.limitConcurrentUploads <= this._sending)\r\n      ) {\r\n        if (this.options.limitConcurrentUploads > 1) {\r\n          slot = $.Deferred();\r\n          this._slots.push(slot);\r\n          pipe = slot[that._promisePipe](send);\r\n        } else {\r\n          this._sequence = this._sequence[that._promisePipe](send, send);\r\n          pipe = this._sequence;\r\n        }\r\n        // Return the piped Promise object, enhanced with an abort method,\r\n        // which is delegated to the jqXHR object of the current upload,\r\n        // and jqXHR callbacks mapped to the equivalent Promise methods:\r\n        pipe.abort = function () {\r\n          aborted = [undefined, 'abort', 'abort'];\r\n          if (!jqXHR) {\r\n            if (slot) {\r\n              slot.rejectWith(options.context, aborted);\r\n            }\r\n            return send();\r\n          }\r\n          return jqXHR.abort();\r\n        };\r\n        return this._enhancePromise(pipe);\r\n      }\r\n      return send();\r\n    },\r\n\r\n    _onAdd: function (e, data) {\r\n      var that = this,\r\n        result = true,\r\n        options = $.extend({}, this.options, data),\r\n        files = data.files,\r\n        filesLength = files.length,\r\n        limit = options.limitMultiFileUploads,\r\n        limitSize = options.limitMultiFileUploadSize,\r\n        overhead = options.limitMultiFileUploadSizeOverhead,\r\n        batchSize = 0,\r\n        paramName = this._getParamName(options),\r\n        paramNameSet,\r\n        paramNameSlice,\r\n        fileSet,\r\n        i,\r\n        j = 0;\r\n      if (!filesLength) {\r\n        return false;\r\n      }\r\n      if (limitSize && files[0].size === undefined) {\r\n        limitSize = undefined;\r\n      }\r\n      if (\r\n        !(options.singleFileUploads || limit || limitSize) ||\r\n        !this._isXHRUpload(options)\r\n      ) {\r\n        fileSet = [files];\r\n        paramNameSet = [paramName];\r\n      } else if (!(options.singleFileUploads || limitSize) && limit) {\r\n        fileSet = [];\r\n        paramNameSet = [];\r\n        for (i = 0; i < filesLength; i += limit) {\r\n          fileSet.push(files.slice(i, i + limit));\r\n          paramNameSlice = paramName.slice(i, i + limit);\r\n          if (!paramNameSlice.length) {\r\n            paramNameSlice = paramName;\r\n          }\r\n          paramNameSet.push(paramNameSlice);\r\n        }\r\n      } else if (!options.singleFileUploads && limitSize) {\r\n        fileSet = [];\r\n        paramNameSet = [];\r\n        for (i = 0; i < filesLength; i = i + 1) {\r\n          batchSize += files[i].size + overhead;\r\n          if (\r\n            i + 1 === filesLength ||\r\n            batchSize + files[i + 1].size + overhead > limitSize ||\r\n            (limit && i + 1 - j >= limit)\r\n          ) {\r\n            fileSet.push(files.slice(j, i + 1));\r\n            paramNameSlice = paramName.slice(j, i + 1);\r\n            if (!paramNameSlice.length) {\r\n              paramNameSlice = paramName;\r\n            }\r\n            paramNameSet.push(paramNameSlice);\r\n            j = i + 1;\r\n            batchSize = 0;\r\n          }\r\n        }\r\n      } else {\r\n        paramNameSet = paramName;\r\n      }\r\n      data.originalFiles = files;\r\n      $.each(fileSet || files, function (index, element) {\r\n        var newData = $.extend({}, data);\r\n        newData.files = fileSet ? element : [element];\r\n        newData.paramName = paramNameSet[index];\r\n        that._initResponseObject(newData);\r\n        that._initProgressObject(newData);\r\n        that._addConvenienceMethods(e, newData);\r\n        result = that._trigger(\r\n          'add',\r\n          $.Event('add', { delegatedEvent: e }),\r\n          newData\r\n        );\r\n        return result;\r\n      });\r\n      return result;\r\n    },\r\n\r\n    _replaceFileInput: function (data) {\r\n      var input = data.fileInput,\r\n        inputClone = input.clone(true),\r\n        restoreFocus = input.is(document.activeElement);\r\n      // Add a reference for the new cloned file input to the data argument:\r\n      data.fileInputClone = inputClone;\r\n      $('<form></form>').append(inputClone)[0].reset();\r\n      // Detaching allows to insert the fileInput on another form\r\n      // without loosing the file input value:\r\n      input.after(inputClone).detach();\r\n      // If the fileInput had focus before it was detached,\r\n      // restore focus to the inputClone.\r\n      if (restoreFocus) {\r\n        inputClone.trigger('focus');\r\n      }\r\n      // Avoid memory leaks with the detached file input:\r\n      $.cleanData(input.off('remove'));\r\n      // Replace the original file input element in the fileInput\r\n      // elements set with the clone, which has been copied including\r\n      // event handlers:\r\n      this.options.fileInput = this.options.fileInput.map(function (i, el) {\r\n        if (el === input[0]) {\r\n          return inputClone[0];\r\n        }\r\n        return el;\r\n      });\r\n      // If the widget has been initialized on the file input itself,\r\n      // override this.element with the file input clone:\r\n      if (input[0] === this.element[0]) {\r\n        this.element = inputClone;\r\n      }\r\n    },\r\n\r\n    _handleFileTreeEntry: function (entry, path) {\r\n      var that = this,\r\n        dfd = $.Deferred(),\r\n        entries = [],\r\n        dirReader,\r\n        errorHandler = function (e) {\r\n          if (e && !e.entry) {\r\n            e.entry = entry;\r\n          }\r\n          // Since $.when returns immediately if one\r\n          // Deferred is rejected, we use resolve instead.\r\n          // This allows valid files and invalid items\r\n          // to be returned together in one set:\r\n          dfd.resolve([e]);\r\n        },\r\n        successHandler = function (entries) {\r\n          that\r\n            ._handleFileTreeEntries(entries, path + entry.name + '/')\r\n            .done(function (files) {\r\n              dfd.resolve(files);\r\n            })\r\n            .fail(errorHandler);\r\n        },\r\n        readEntries = function () {\r\n          dirReader.readEntries(function (results) {\r\n            if (!results.length) {\r\n              successHandler(entries);\r\n            } else {\r\n              entries = entries.concat(results);\r\n              readEntries();\r\n            }\r\n          }, errorHandler);\r\n        };\r\n      // eslint-disable-next-line no-param-reassign\r\n      path = path || '';\r\n      if (entry.isFile) {\r\n        if (entry._file) {\r\n          // Workaround for Chrome bug #149735\r\n          entry._file.relativePath = path;\r\n          dfd.resolve(entry._file);\r\n        } else {\r\n          entry.file(function (file) {\r\n            file.relativePath = path;\r\n            dfd.resolve(file);\r\n          }, errorHandler);\r\n        }\r\n      } else if (entry.isDirectory) {\r\n        dirReader = entry.createReader();\r\n        readEntries();\r\n      } else {\r\n        // Return an empty list for file system items\r\n        // other than files or directories:\r\n        dfd.resolve([]);\r\n      }\r\n      return dfd.promise();\r\n    },\r\n\r\n    _handleFileTreeEntries: function (entries, path) {\r\n      var that = this;\r\n      return $.when\r\n        .apply(\r\n          $,\r\n          $.map(entries, function (entry) {\r\n            return that._handleFileTreeEntry(entry, path);\r\n          })\r\n        )\r\n        [this._promisePipe](function () {\r\n          return Array.prototype.concat.apply([], arguments);\r\n        });\r\n    },\r\n\r\n    _getDroppedFiles: function (dataTransfer) {\r\n      // eslint-disable-next-line no-param-reassign\r\n      dataTransfer = dataTransfer || {};\r\n      var items = dataTransfer.items;\r\n      if (\r\n        items &&\r\n        items.length &&\r\n        (items[0].webkitGetAsEntry || items[0].getAsEntry)\r\n      ) {\r\n        return this._handleFileTreeEntries(\r\n          $.map(items, function (item) {\r\n            var entry;\r\n            if (item.webkitGetAsEntry) {\r\n              entry = item.webkitGetAsEntry();\r\n              if (entry) {\r\n                // Workaround for Chrome bug #149735:\r\n                entry._file = item.getAsFile();\r\n              }\r\n              return entry;\r\n            }\r\n            return item.getAsEntry();\r\n          })\r\n        );\r\n      }\r\n      return $.Deferred().resolve($.makeArray(dataTransfer.files)).promise();\r\n    },\r\n\r\n    _getSingleFileInputFiles: function (fileInput) {\r\n      // eslint-disable-next-line no-param-reassign\r\n      fileInput = $(fileInput);\r\n      var entries =\r\n          fileInput.prop('webkitEntries') || fileInput.prop('entries'),\r\n        files,\r\n        value;\r\n      if (entries && entries.length) {\r\n        return this._handleFileTreeEntries(entries);\r\n      }\r\n      files = $.makeArray(fileInput.prop('files'));\r\n      if (!files.length) {\r\n        value = fileInput.prop('value');\r\n        if (!value) {\r\n          return $.Deferred().resolve([]).promise();\r\n        }\r\n        // If the files property is not available, the browser does not\r\n        // support the File API and we add a pseudo File object with\r\n        // the input value as name with path information removed:\r\n        files = [{ name: value.replace(/^.*\\\\/, '') }];\r\n      } else if (files[0].name === undefined && files[0].fileName) {\r\n        // File normalization for Safari 4 and Firefox 3:\r\n        $.each(files, function (index, file) {\r\n          file.name = file.fileName;\r\n          file.size = file.fileSize;\r\n        });\r\n      }\r\n      return $.Deferred().resolve(files).promise();\r\n    },\r\n\r\n    _getFileInputFiles: function (fileInput) {\r\n      if (!(fileInput instanceof $) || fileInput.length === 1) {\r\n        return this._getSingleFileInputFiles(fileInput);\r\n      }\r\n      return $.when\r\n        .apply($, $.map(fileInput, this._getSingleFileInputFiles))\r\n        [this._promisePipe](function () {\r\n          return Array.prototype.concat.apply([], arguments);\r\n        });\r\n    },\r\n\r\n    _onChange: function (e) {\r\n      var that = this,\r\n        data = {\r\n          fileInput: $(e.target),\r\n          form: $(e.target.form)\r\n        };\r\n      this._getFileInputFiles(data.fileInput).always(function (files) {\r\n        data.files = files;\r\n        if (that.options.replaceFileInput) {\r\n          that._replaceFileInput(data);\r\n        }\r\n        if (\r\n          that._trigger(\r\n            'change',\r\n            $.Event('change', { delegatedEvent: e }),\r\n            data\r\n          ) !== false\r\n        ) {\r\n          that._onAdd(e, data);\r\n        }\r\n      });\r\n    },\r\n\r\n    _onPaste: function (e) {\r\n      var items =\r\n          e.originalEvent &&\r\n          e.originalEvent.clipboardData &&\r\n          e.originalEvent.clipboardData.items,\r\n        data = { files: [] };\r\n      if (items && items.length) {\r\n        $.each(items, function (index, item) {\r\n          var file = item.getAsFile && item.getAsFile();\r\n          if (file) {\r\n            data.files.push(file);\r\n          }\r\n        });\r\n        if (\r\n          this._trigger(\r\n            'paste',\r\n            $.Event('paste', { delegatedEvent: e }),\r\n            data\r\n          ) !== false\r\n        ) {\r\n          this._onAdd(e, data);\r\n        }\r\n      }\r\n    },\r\n\r\n    _onDrop: function (e) {\r\n      e.dataTransfer = e.originalEvent && e.originalEvent.dataTransfer;\r\n      var that = this,\r\n        dataTransfer = e.dataTransfer,\r\n        data = {};\r\n      if (dataTransfer && dataTransfer.files && dataTransfer.files.length) {\r\n        e.preventDefault();\r\n        this._getDroppedFiles(dataTransfer).always(function (files) {\r\n          data.files = files;\r\n          if (\r\n            that._trigger(\r\n              'drop',\r\n              $.Event('drop', { delegatedEvent: e }),\r\n              data\r\n            ) !== false\r\n          ) {\r\n            that._onAdd(e, data);\r\n          }\r\n        });\r\n      }\r\n    },\r\n\r\n    _onDragOver: getDragHandler('dragover'),\r\n\r\n    _onDragEnter: getDragHandler('dragenter'),\r\n\r\n    _onDragLeave: getDragHandler('dragleave'),\r\n\r\n    _initEventHandlers: function () {\r\n      if (this._isXHRUpload(this.options)) {\r\n        this._on(this.options.dropZone, {\r\n          dragover: this._onDragOver,\r\n          drop: this._onDrop,\r\n          // event.preventDefault() on dragenter is required for IE10+:\r\n          dragenter: this._onDragEnter,\r\n          // dragleave is not required, but added for completeness:\r\n          dragleave: this._onDragLeave\r\n        });\r\n        this._on(this.options.pasteZone, {\r\n          paste: this._onPaste\r\n        });\r\n      }\r\n      if ($.support.fileInput) {\r\n        this._on(this.options.fileInput, {\r\n          change: this._onChange\r\n        });\r\n      }\r\n    },\r\n\r\n    _destroyEventHandlers: function () {\r\n      this._off(this.options.dropZone, 'dragenter dragleave dragover drop');\r\n      this._off(this.options.pasteZone, 'paste');\r\n      this._off(this.options.fileInput, 'change');\r\n    },\r\n\r\n    _destroy: function () {\r\n      this._destroyEventHandlers();\r\n    },\r\n\r\n    _setOption: function (key, value) {\r\n      var reinit = $.inArray(key, this._specialOptions) !== -1;\r\n      if (reinit) {\r\n        this._destroyEventHandlers();\r\n      }\r\n      this._super(key, value);\r\n      if (reinit) {\r\n        this._initSpecialOptions();\r\n        this._initEventHandlers();\r\n      }\r\n    },\r\n\r\n    _initSpecialOptions: function () {\r\n      var options = this.options;\r\n      if (options.fileInput === undefined) {\r\n        options.fileInput = this.element.is('input[type=\"file\"]')\r\n          ? this.element\r\n          : this.element.find('input[type=\"file\"]');\r\n      } else if (!(options.fileInput instanceof $)) {\r\n        options.fileInput = $(options.fileInput);\r\n      }\r\n      if (!(options.dropZone instanceof $)) {\r\n        options.dropZone = $(options.dropZone);\r\n      }\r\n      if (!(options.pasteZone instanceof $)) {\r\n        options.pasteZone = $(options.pasteZone);\r\n      }\r\n    },\r\n\r\n    _getRegExp: function (str) {\r\n      var parts = str.split('/'),\r\n        modifiers = parts.pop();\r\n      parts.shift();\r\n      return new RegExp(parts.join('/'), modifiers);\r\n    },\r\n\r\n    _isRegExpOption: function (key, value) {\r\n      return (\r\n        key !== 'url' &&\r\n        $.type(value) === 'string' &&\r\n        /^\\/.*\\/[igm]{0,3}$/.test(value)\r\n      );\r\n    },\r\n\r\n    _initDataAttributes: function () {\r\n      var that = this,\r\n        options = this.options,\r\n        data = this.element.data();\r\n      // Initialize options set via HTML5 data-attributes:\r\n      $.each(this.element[0].attributes, function (index, attr) {\r\n        var key = attr.name.toLowerCase(),\r\n          value;\r\n        if (/^data-/.test(key)) {\r\n          // Convert hyphen-ated key to camelCase:\r\n          key = key.slice(5).replace(/-[a-z]/g, function (str) {\r\n            return str.charAt(1).toUpperCase();\r\n          });\r\n          value = data[key];\r\n          if (that._isRegExpOption(key, value)) {\r\n            value = that._getRegExp(value);\r\n          }\r\n          options[key] = value;\r\n        }\r\n      });\r\n    },\r\n\r\n    _create: function () {\r\n      this._initDataAttributes();\r\n      this._initSpecialOptions();\r\n      this._slots = [];\r\n      this._sequence = this._getXHRPromise(true);\r\n      this._sending = this._active = 0;\r\n      this._initProgressObject(this);\r\n      this._initEventHandlers();\r\n    },\r\n\r\n    // This method is exposed to the widget API and allows to query\r\n    // the number of active uploads:\r\n    active: function () {\r\n      return this._active;\r\n    },\r\n\r\n    // This method is exposed to the widget API and allows to query\r\n    // the widget upload progress.\r\n    // It returns an object with loaded, total and bitrate properties\r\n    // for the running uploads:\r\n    progress: function () {\r\n      return this._progress;\r\n    },\r\n\r\n    // This method is exposed to the widget API and allows adding files\r\n    // using the fileupload API. The data parameter accepts an object which\r\n    // must have a files property and can contain additional options:\r\n    // .fileupload('add', {files: filesList});\r\n    add: function (data) {\r\n      var that = this;\r\n      if (!data || this.options.disabled) {\r\n        return;\r\n      }\r\n      if (data.fileInput && !data.files) {\r\n        this._getFileInputFiles(data.fileInput).always(function (files) {\r\n          data.files = files;\r\n          that._onAdd(null, data);\r\n        });\r\n      } else {\r\n        data.files = $.makeArray(data.files);\r\n        this._onAdd(null, data);\r\n      }\r\n    },\r\n\r\n    // This method is exposed to the widget API and allows sending files\r\n    // using the fileupload API. The data parameter accepts an object which\r\n    // must have a files or fileInput property and can contain additional options:\r\n    // .fileupload('send', {files: filesList});\r\n    // The method returns a Promise object for the file upload call.\r\n    send: function (data) {\r\n      if (data && !this.options.disabled) {\r\n        if (data.fileInput && !data.files) {\r\n          var that = this,\r\n            dfd = $.Deferred(),\r\n            promise = dfd.promise(),\r\n            jqXHR,\r\n            aborted;\r\n          promise.abort = function () {\r\n            aborted = true;\r\n            if (jqXHR) {\r\n              return jqXHR.abort();\r\n            }\r\n            dfd.reject(null, 'abort', 'abort');\r\n            return promise;\r\n          };\r\n          this._getFileInputFiles(data.fileInput).always(function (files) {\r\n            if (aborted) {\r\n              return;\r\n            }\r\n            if (!files.length) {\r\n              dfd.reject();\r\n              return;\r\n            }\r\n            data.files = files;\r\n            jqXHR = that._onSend(null, data);\r\n            jqXHR.then(\r\n              function (result, textStatus, jqXHR) {\r\n                dfd.resolve(result, textStatus, jqXHR);\r\n              },\r\n              function (jqXHR, textStatus, errorThrown) {\r\n                dfd.reject(jqXHR, textStatus, errorThrown);\r\n              }\r\n            );\r\n          });\r\n          return this._enhancePromise(promise);\r\n        }\r\n        data.files = $.makeArray(data.files);\r\n        if (data.files.length) {\r\n          return this._onSend(null, data);\r\n        }\r\n      }\r\n      return this._getXHRPromise(false, data && data.context);\r\n    }\r\n  });\r\n});\r\n","jquery/fileUploader/jquery.fileuploader.js":"/**\r\n * Custom Uploader\r\n * Copyright \u00a9 Magento, Inc. All rights reserved.\r\n * See COPYING.txt for license details.\r\n */\r\n\r\n/* global define, require */\r\n\r\n(function (factory) {\r\n  'use strict';\r\n  if (typeof define === 'function' && define.amd) {\r\n    // Register as an anonymous AMD module:\r\n    define([\r\n      'jquery',\r\n      'jquery/fileUploader/jquery.fileupload-image',\r\n      'jquery/fileUploader/jquery.fileupload-audio',\r\n      'jquery/fileUploader/jquery.fileupload-video',\r\n      'jquery/fileUploader/jquery.iframe-transport',\r\n    ], factory);\r\n  } else if (typeof exports === 'object') {\r\n    // Node/CommonJS:\r\n    factory(\r\n      require('jquery'),\r\n      require('jquery/fileUploader/jquery.fileupload-image'),\r\n      require('jquery/fileUploader/jquery.fileupload-audio'),\r\n      require('jquery/fileUploader/jquery.fileupload-video'),\r\n      require('jquery/fileUploader/jquery.iframe-transport')\r\n    );\r\n  } else {\r\n    // Browser globals:\r\n    factory(window.jQuery);\r\n  }\r\n})();\r\n","jquery/fileUploader/jquery.iframe-transport.js":"/*\r\n * jQuery Iframe Transport Plugin\r\n * https://github.com/blueimp/jQuery-File-Upload\r\n *\r\n * Copyright 2011, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n */\r\n\r\n/* global define, require */\r\n\r\n(function (factory) {\r\n  'use strict';\r\n  if (typeof define === 'function' && define.amd) {\r\n    // Register as an anonymous AMD module:\r\n    define(['jquery'], factory);\r\n  } else if (typeof exports === 'object') {\r\n    // Node/CommonJS:\r\n    factory(require('jquery'));\r\n  } else {\r\n    // Browser globals:\r\n    factory(window.jQuery);\r\n  }\r\n})(function ($) {\r\n  'use strict';\r\n\r\n  // Helper variable to create unique names for the transport iframes:\r\n  var counter = 0,\r\n    jsonAPI = $,\r\n    jsonParse = 'parseJSON';\r\n\r\n  if ('JSON' in window && 'parse' in JSON) {\r\n    jsonAPI = JSON;\r\n    jsonParse = 'parse';\r\n  }\r\n\r\n  // The iframe transport accepts four additional options:\r\n  // options.fileInput: a jQuery collection of file input fields\r\n  // options.paramName: the parameter name for the file form data,\r\n  //  overrides the name property of the file input field(s),\r\n  //  can be a string or an array of strings.\r\n  // options.formData: an array of objects with name and value properties,\r\n  //  equivalent to the return data of .serializeArray(), e.g.:\r\n  //  [{name: 'a', value: 1}, {name: 'b', value: 2}]\r\n  // options.initialIframeSrc: the URL of the initial iframe src,\r\n  //  by default set to \"javascript:false;\"\r\n  $.ajaxTransport('iframe', function (options) {\r\n    if (options.async) {\r\n      // javascript:false as initial iframe src\r\n      // prevents warning popups on HTTPS in IE6:\r\n      // eslint-disable-next-line no-script-url\r\n      var initialIframeSrc = options.initialIframeSrc || 'javascript:false;',\r\n        form,\r\n        iframe,\r\n        addParamChar;\r\n      return {\r\n        send: function (_, completeCallback) {\r\n          form = $('<form style=\"display:none;\"></form>');\r\n          form.attr('accept-charset', options.formAcceptCharset);\r\n          addParamChar = /\\?/.test(options.url) ? '&' : '?';\r\n          // XDomainRequest only supports GET and POST:\r\n          if (options.type === 'DELETE') {\r\n            options.url = options.url + addParamChar + '_method=DELETE';\r\n            options.type = 'POST';\r\n          } else if (options.type === 'PUT') {\r\n            options.url = options.url + addParamChar + '_method=PUT';\r\n            options.type = 'POST';\r\n          } else if (options.type === 'PATCH') {\r\n            options.url = options.url + addParamChar + '_method=PATCH';\r\n            options.type = 'POST';\r\n          }\r\n          // IE versions below IE8 cannot set the name property of\r\n          // elements that have already been added to the DOM,\r\n          // so we set the name along with the iframe HTML markup:\r\n          counter += 1;\r\n          iframe = $(\r\n            '<iframe src=\"' +\r\n              initialIframeSrc +\r\n              '\" name=\"iframe-transport-' +\r\n              counter +\r\n              '\"></iframe>'\r\n          ).on('load', function () {\r\n            var fileInputClones,\r\n              paramNames = $.isArray(options.paramName)\r\n                ? options.paramName\r\n                : [options.paramName];\r\n            iframe.off('load').on('load', function () {\r\n              var response;\r\n              // Wrap in a try/catch block to catch exceptions thrown\r\n              // when trying to access cross-domain iframe contents:\r\n              try {\r\n                response = iframe.contents();\r\n                // Google Chrome and Firefox do not throw an\r\n                // exception when calling iframe.contents() on\r\n                // cross-domain requests, so we unify the response:\r\n                if (!response.length || !response[0].firstChild) {\r\n                  throw new Error();\r\n                }\r\n              } catch (e) {\r\n                response = undefined;\r\n              }\r\n              // The complete callback returns the\r\n              // iframe content document as response object:\r\n              completeCallback(200, 'success', { iframe: response });\r\n              // Fix for IE endless progress bar activity bug\r\n              // (happens on form submits to iframe targets):\r\n              $('<iframe src=\"' + initialIframeSrc + '\"></iframe>').appendTo(\r\n                form\r\n              );\r\n              window.setTimeout(function () {\r\n                // Removing the form in a setTimeout call\r\n                // allows Chrome's developer tools to display\r\n                // the response result\r\n                form.remove();\r\n              }, 0);\r\n            });\r\n            form\r\n              .prop('target', iframe.prop('name'))\r\n              .prop('action', options.url)\r\n              .prop('method', options.type);\r\n            if (options.formData) {\r\n              $.each(options.formData, function (index, field) {\r\n                $('<input type=\"hidden\"/>')\r\n                  .prop('name', field.name)\r\n                  .val(field.value)\r\n                  .appendTo(form);\r\n              });\r\n            }\r\n            if (\r\n              options.fileInput &&\r\n              options.fileInput.length &&\r\n              options.type === 'POST'\r\n            ) {\r\n              fileInputClones = options.fileInput.clone();\r\n              // Insert a clone for each file input field:\r\n              options.fileInput.after(function (index) {\r\n                return fileInputClones[index];\r\n              });\r\n              if (options.paramName) {\r\n                options.fileInput.each(function (index) {\r\n                  $(this).prop('name', paramNames[index] || options.paramName);\r\n                });\r\n              }\r\n              // Appending the file input fields to the hidden form\r\n              // removes them from their original location:\r\n              form\r\n                .append(options.fileInput)\r\n                .prop('enctype', 'multipart/form-data')\r\n                // enctype must be set as encoding for IE:\r\n                .prop('encoding', 'multipart/form-data');\r\n              // Remove the HTML5 form attribute from the input(s):\r\n              options.fileInput.removeAttr('form');\r\n            }\r\n            window.setTimeout(function () {\r\n              // Submitting the form in a setTimeout call fixes an issue with\r\n              // Safari 13 not triggering the iframe load event after resetting\r\n              // the load event handler, see also:\r\n              // https://github.com/blueimp/jQuery-File-Upload/issues/3633\r\n              form.submit();\r\n              // Insert the file input fields at their original location\r\n              // by replacing the clones with the originals:\r\n              if (fileInputClones && fileInputClones.length) {\r\n                options.fileInput.each(function (index, input) {\r\n                  var clone = $(fileInputClones[index]);\r\n                  // Restore the original name and form properties:\r\n                  $(input)\r\n                    .prop('name', clone.prop('name'))\r\n                    .attr('form', clone.attr('form'));\r\n                  clone.replaceWith(input);\r\n                });\r\n              }\r\n            }, 0);\r\n          });\r\n          form.append(iframe).appendTo(document.body);\r\n        },\r\n        abort: function () {\r\n          if (iframe) {\r\n            // javascript:false as iframe src aborts the request\r\n            // and prevents warning popups on HTTPS in IE6.\r\n            iframe.off('load').prop('src', initialIframeSrc);\r\n          }\r\n          if (form) {\r\n            form.remove();\r\n          }\r\n        }\r\n      };\r\n    }\r\n  });\r\n\r\n  // The iframe transport returns the iframe content document as response.\r\n  // The following adds converters from iframe to text, json, html, xml\r\n  // and script.\r\n  // Please note that the Content-Type for JSON responses has to be text/plain\r\n  // or text/html, if the browser doesn't include application/json in the\r\n  // Accept header, else IE will show a download dialog.\r\n  // The Content-Type for XML responses on the other hand has to be always\r\n  // application/xml or text/xml, so IE properly parses the XML response.\r\n  // See also\r\n  // https://github.com/blueimp/jQuery-File-Upload/wiki/Setup#content-type-negotiation\r\n  $.ajaxSetup({\r\n    converters: {\r\n      'iframe text': function (iframe) {\r\n        return iframe && $(iframe[0].body).text();\r\n      },\r\n      'iframe json': function (iframe) {\r\n        return iframe && jsonAPI[jsonParse]($(iframe[0].body).text());\r\n      },\r\n      'iframe html': function (iframe) {\r\n        return iframe && $(iframe[0].body).html();\r\n      },\r\n      'iframe xml': function (iframe) {\r\n        var xmlDoc = iframe && iframe[0];\r\n        return xmlDoc && $.isXMLDoc(xmlDoc)\r\n          ? xmlDoc\r\n          : $.parseXML(\r\n              (xmlDoc.XMLDocument && xmlDoc.XMLDocument.xml) ||\r\n                $(xmlDoc.body).html()\r\n            );\r\n      },\r\n      'iframe script': function (iframe) {\r\n        return iframe && $.globalEval($(iframe[0].body).text());\r\n      }\r\n    }\r\n  });\r\n});\r\n","jquery/fileUploader/cors/jquery.postmessage-transport.js":"/*\r\n * jQuery postMessage Transport Plugin\r\n * https://github.com/blueimp/jQuery-File-Upload\r\n *\r\n * Copyright 2011, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n */\r\n\r\n/* global define, require */\r\n\r\n(function (factory) {\r\n  'use strict';\r\n  if (typeof define === 'function' && define.amd) {\r\n    // Register as an anonymous AMD module:\r\n    define(['jquery'], factory);\r\n  } else if (typeof exports === 'object') {\r\n    // Node/CommonJS:\r\n    factory(require('jquery'));\r\n  } else {\r\n    // Browser globals:\r\n    factory(window.jQuery);\r\n  }\r\n})(function ($) {\r\n  'use strict';\r\n\r\n  var counter = 0,\r\n    names = [\r\n      'accepts',\r\n      'cache',\r\n      'contents',\r\n      'contentType',\r\n      'crossDomain',\r\n      'data',\r\n      'dataType',\r\n      'headers',\r\n      'ifModified',\r\n      'mimeType',\r\n      'password',\r\n      'processData',\r\n      'timeout',\r\n      'traditional',\r\n      'type',\r\n      'url',\r\n      'username'\r\n    ],\r\n    convert = function (p) {\r\n      return p;\r\n    };\r\n\r\n  $.ajaxSetup({\r\n    converters: {\r\n      'postmessage text': convert,\r\n      'postmessage json': convert,\r\n      'postmessage html': convert\r\n    }\r\n  });\r\n\r\n  $.ajaxTransport('postmessage', function (options) {\r\n    if (options.postMessage && window.postMessage) {\r\n      var iframe,\r\n        loc = $('<a></a>').prop('href', options.postMessage)[0],\r\n        target = loc.protocol + '//' + loc.host,\r\n        xhrUpload = options.xhr().upload;\r\n      // IE always includes the port for the host property of a link\r\n      // element, but not in the location.host or origin property for the\r\n      // default http port 80 and https port 443, so we strip it:\r\n      if (/^(http:\\/\\/.+:80)|(https:\\/\\/.+:443)$/.test(target)) {\r\n        target = target.replace(/:(80|443)$/, '');\r\n      }\r\n      return {\r\n        send: function (_, completeCallback) {\r\n          counter += 1;\r\n          var message = {\r\n              id: 'postmessage-transport-' + counter\r\n            },\r\n            eventName = 'message.' + message.id;\r\n          iframe = $(\r\n            '<iframe style=\"display:none;\" src=\"' +\r\n              options.postMessage +\r\n              '\" name=\"' +\r\n              message.id +\r\n              '\"></iframe>'\r\n          )\r\n            .on('load', function () {\r\n              $.each(names, function (i, name) {\r\n                message[name] = options[name];\r\n              });\r\n              message.dataType = message.dataType.replace('postmessage ', '');\r\n              $(window).on(eventName, function (event) {\r\n                var e = event.originalEvent;\r\n                var data = e.data;\r\n                var ev;\r\n                if (e.origin === target && data.id === message.id) {\r\n                  if (data.type === 'progress') {\r\n                    ev = document.createEvent('Event');\r\n                    ev.initEvent(data.type, false, true);\r\n                    $.extend(ev, data);\r\n                    xhrUpload.dispatchEvent(ev);\r\n                  } else {\r\n                    completeCallback(\r\n                      data.status,\r\n                      data.statusText,\r\n                      { postmessage: data.result },\r\n                      data.headers\r\n                    );\r\n                    iframe.remove();\r\n                    $(window).off(eventName);\r\n                  }\r\n                }\r\n              });\r\n              iframe[0].contentWindow.postMessage(message, target);\r\n            })\r\n            .appendTo(document.body);\r\n        },\r\n        abort: function () {\r\n          if (iframe) {\r\n            iframe.remove();\r\n          }\r\n        }\r\n      };\r\n    }\r\n  });\r\n});\r\n","jquery/fileUploader/cors/jquery.xdr-transport.js":"/*\r\n * jQuery XDomainRequest Transport Plugin\r\n * https://github.com/blueimp/jQuery-File-Upload\r\n *\r\n * Copyright 2011, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n *\r\n * Based on Julian Aubourg's ajaxHooks xdr.js:\r\n * https://github.com/jaubourg/ajaxHooks/\r\n */\r\n\r\n/* global define, require, XDomainRequest */\r\n\r\n(function (factory) {\r\n  'use strict';\r\n  if (typeof define === 'function' && define.amd) {\r\n    // Register as an anonymous AMD module:\r\n    define(['jquery'], factory);\r\n  } else if (typeof exports === 'object') {\r\n    // Node/CommonJS:\r\n    factory(require('jquery'));\r\n  } else {\r\n    // Browser globals:\r\n    factory(window.jQuery);\r\n  }\r\n})(function ($) {\r\n  'use strict';\r\n  if (window.XDomainRequest && !$.support.cors) {\r\n    $.ajaxTransport(function (s) {\r\n      if (s.crossDomain && s.async) {\r\n        if (s.timeout) {\r\n          s.xdrTimeout = s.timeout;\r\n          delete s.timeout;\r\n        }\r\n        var xdr;\r\n        return {\r\n          send: function (headers, completeCallback) {\r\n            var addParamChar = /\\?/.test(s.url) ? '&' : '?';\r\n            /**\r\n             * Callback wrapper function\r\n             *\r\n             * @param {number} status HTTP status code\r\n             * @param {string} statusText HTTP status text\r\n             * @param {object} [responses] Content-type specific responses\r\n             * @param {string} [responseHeaders] Response headers string\r\n             */\r\n            function callback(status, statusText, responses, responseHeaders) {\r\n              xdr.onload = xdr.onerror = xdr.ontimeout = $.noop;\r\n              xdr = null;\r\n              completeCallback(status, statusText, responses, responseHeaders);\r\n            }\r\n            xdr = new XDomainRequest();\r\n            // XDomainRequest only supports GET and POST:\r\n            if (s.type === 'DELETE') {\r\n              s.url = s.url + addParamChar + '_method=DELETE';\r\n              s.type = 'POST';\r\n            } else if (s.type === 'PUT') {\r\n              s.url = s.url + addParamChar + '_method=PUT';\r\n              s.type = 'POST';\r\n            } else if (s.type === 'PATCH') {\r\n              s.url = s.url + addParamChar + '_method=PATCH';\r\n              s.type = 'POST';\r\n            }\r\n            xdr.open(s.type, s.url);\r\n            xdr.onload = function () {\r\n              callback(\r\n                200,\r\n                'OK',\r\n                { text: xdr.responseText },\r\n                'Content-Type: ' + xdr.contentType\r\n              );\r\n            };\r\n            xdr.onerror = function () {\r\n              callback(404, 'Not Found');\r\n            };\r\n            if (s.xdrTimeout) {\r\n              xdr.ontimeout = function () {\r\n                callback(0, 'timeout');\r\n              };\r\n              xdr.timeout = s.xdrTimeout;\r\n            }\r\n            xdr.send((s.hasContent && s.data) || null);\r\n          },\r\n          abort: function () {\r\n            if (xdr) {\r\n              xdr.onerror = $.noop();\r\n              xdr.abort();\r\n            }\r\n          }\r\n        };\r\n      }\r\n    });\r\n  }\r\n});\r\n","jquery/fileUploader/vendor/jquery.ui.widget.js":"/*! jQuery UI - v1.12.1+0b7246b6eeadfa9e2696e22f3230f6452f8129dc - 2020-02-20\r\n * http://jqueryui.com\r\n * Includes: widget.js\r\n * Copyright jQuery Foundation and other contributors; Licensed MIT */\r\n\r\n/* global define, require */\r\n/* eslint-disable no-param-reassign, new-cap, jsdoc/require-jsdoc */\r\n\r\n(function (factory) {\r\n  'use strict';\r\n  if (typeof define === 'function' && define.amd) {\r\n    // AMD. Register as an anonymous module.\r\n    define(['jquery'], factory);\r\n  } else if (typeof exports === 'object') {\r\n    // Node/CommonJS\r\n    factory(require('jquery'));\r\n  } else {\r\n    // Browser globals\r\n    factory(window.jQuery);\r\n  }\r\n})(function ($) {\r\n  ('use strict');\r\n\r\n  $.ui = $.ui || {};\r\n\r\n  $.ui.version = '1.12.1';\r\n\r\n  /*!\r\n   * jQuery UI Widget 1.12.1\r\n   * http://jqueryui.com\r\n   *\r\n   * Copyright jQuery Foundation and other contributors\r\n   * Released under the MIT license.\r\n   * http://jquery.org/license\r\n   */\r\n\r\n  //>>label: Widget\r\n  //>>group: Core\r\n  //>>description: Provides a factory for creating stateful widgets with a common API.\r\n  //>>docs: http://api.jqueryui.com/jQuery.widget/\r\n  //>>demos: http://jqueryui.com/widget/\r\n\r\n  // Support: jQuery 1.9.x or older\r\n  // $.expr[ \":\" ] is deprecated.\r\n  if (!$.expr.pseudos) {\r\n    $.expr.pseudos = $.expr[':'];\r\n  }\r\n\r\n  // Support: jQuery 1.11.x or older\r\n  // $.unique has been renamed to $.uniqueSort\r\n  if (!$.uniqueSort) {\r\n    $.uniqueSort = $.unique;\r\n  }\r\n\r\n  var widgetUuid = 0;\r\n  var widgetHasOwnProperty = Array.prototype.hasOwnProperty;\r\n  var widgetSlice = Array.prototype.slice;\r\n\r\n  $.cleanData = (function (orig) {\r\n    return function (elems) {\r\n      var events, elem, i;\r\n      // eslint-disable-next-line eqeqeq\r\n      for (i = 0; (elem = elems[i]) != null; i++) {\r\n        // Only trigger remove when necessary to save time\r\n        events = $._data(elem, 'events');\r\n        if (events && events.remove) {\r\n          $(elem).triggerHandler('remove');\r\n        }\r\n      }\r\n      orig(elems);\r\n    };\r\n  })($.cleanData);\r\n\r\n  $.widget = function (name, base, prototype) {\r\n    var existingConstructor, constructor, basePrototype;\r\n\r\n    // ProxiedPrototype allows the provided prototype to remain unmodified\r\n    // so that it can be used as a mixin for multiple widgets (#8876)\r\n    var proxiedPrototype = {};\r\n\r\n    var namespace = name.split('.')[0];\r\n    name = name.split('.')[1];\r\n    var fullName = namespace + '-' + name;\r\n\r\n    if (!prototype) {\r\n      prototype = base;\r\n      base = $.Widget;\r\n    }\r\n\r\n    if ($.isArray(prototype)) {\r\n      prototype = $.extend.apply(null, [{}].concat(prototype));\r\n    }\r\n\r\n    // Create selector for plugin\r\n    $.expr.pseudos[fullName.toLowerCase()] = function (elem) {\r\n      return !!$.data(elem, fullName);\r\n    };\r\n\r\n    $[namespace] = $[namespace] || {};\r\n    existingConstructor = $[namespace][name];\r\n    constructor = $[namespace][name] = function (options, element) {\r\n      // Allow instantiation without \"new\" keyword\r\n      if (!this._createWidget) {\r\n        return new constructor(options, element);\r\n      }\r\n\r\n      // Allow instantiation without initializing for simple inheritance\r\n      // must use \"new\" keyword (the code above always passes args)\r\n      if (arguments.length) {\r\n        this._createWidget(options, element);\r\n      }\r\n    };\r\n\r\n    // Extend with the existing constructor to carry over any static properties\r\n    $.extend(constructor, existingConstructor, {\r\n      version: prototype.version,\r\n\r\n      // Copy the object used to create the prototype in case we need to\r\n      // redefine the widget later\r\n      _proto: $.extend({}, prototype),\r\n\r\n      // Track widgets that inherit from this widget in case this widget is\r\n      // redefined after a widget inherits from it\r\n      _childConstructors: []\r\n    });\r\n\r\n    basePrototype = new base();\r\n\r\n    // We need to make the options hash a property directly on the new instance\r\n    // otherwise we'll modify the options hash on the prototype that we're\r\n    // inheriting from\r\n    basePrototype.options = $.widget.extend({}, basePrototype.options);\r\n    $.each(prototype, function (prop, value) {\r\n      if (!$.isFunction(value)) {\r\n        proxiedPrototype[prop] = value;\r\n        return;\r\n      }\r\n      proxiedPrototype[prop] = (function () {\r\n        function _super() {\r\n          return base.prototype[prop].apply(this, arguments);\r\n        }\r\n\r\n        function _superApply(args) {\r\n          return base.prototype[prop].apply(this, args);\r\n        }\r\n\r\n        return function () {\r\n          var __super = this._super;\r\n          var __superApply = this._superApply;\r\n          var returnValue;\r\n\r\n          this._super = _super;\r\n          this._superApply = _superApply;\r\n\r\n          returnValue = value.apply(this, arguments);\r\n\r\n          this._super = __super;\r\n          this._superApply = __superApply;\r\n\r\n          return returnValue;\r\n        };\r\n      })();\r\n    });\r\n    constructor.prototype = $.widget.extend(\r\n      basePrototype,\r\n      {\r\n        // TODO: remove support for widgetEventPrefix\r\n        // always use the name + a colon as the prefix, e.g., draggable:start\r\n        // don't prefix for widgets that aren't DOM-based\r\n        widgetEventPrefix: existingConstructor\r\n          ? basePrototype.widgetEventPrefix || name\r\n          : name\r\n      },\r\n      proxiedPrototype,\r\n      {\r\n        constructor: constructor,\r\n        namespace: namespace,\r\n        widgetName: name,\r\n        widgetFullName: fullName\r\n      }\r\n    );\r\n\r\n    // If this widget is being redefined then we need to find all widgets that\r\n    // are inheriting from it and redefine all of them so that they inherit from\r\n    // the new version of this widget. We're essentially trying to replace one\r\n    // level in the prototype chain.\r\n    if (existingConstructor) {\r\n      $.each(existingConstructor._childConstructors, function (i, child) {\r\n        var childPrototype = child.prototype;\r\n\r\n        // Redefine the child widget using the same prototype that was\r\n        // originally used, but inherit from the new version of the base\r\n        $.widget(\r\n          childPrototype.namespace + '.' + childPrototype.widgetName,\r\n          constructor,\r\n          child._proto\r\n        );\r\n      });\r\n\r\n      // Remove the list of existing child constructors from the old constructor\r\n      // so the old child constructors can be garbage collected\r\n      delete existingConstructor._childConstructors;\r\n    } else {\r\n      base._childConstructors.push(constructor);\r\n    }\r\n\r\n    $.widget.bridge(name, constructor);\r\n\r\n    return constructor;\r\n  };\r\n\r\n  $.widget.extend = function (target) {\r\n    var input = widgetSlice.call(arguments, 1);\r\n    var inputIndex = 0;\r\n    var inputLength = input.length;\r\n    var key;\r\n    var value;\r\n\r\n    for (; inputIndex < inputLength; inputIndex++) {\r\n      for (key in input[inputIndex]) {\r\n        value = input[inputIndex][key];\r\n        if (\r\n          widgetHasOwnProperty.call(input[inputIndex], key) &&\r\n          value !== undefined\r\n        ) {\r\n          // Clone objects\r\n          if ($.isPlainObject(value)) {\r\n            target[key] = $.isPlainObject(target[key])\r\n              ? $.widget.extend({}, target[key], value)\r\n              : // Don't extend strings, arrays, etc. with objects\r\n                $.widget.extend({}, value);\r\n\r\n            // Copy everything else by reference\r\n          } else {\r\n            target[key] = value;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return target;\r\n  };\r\n\r\n  $.widget.bridge = function (name, object) {\r\n    var fullName = object.prototype.widgetFullName || name;\r\n    $.fn[name] = function (options) {\r\n      var isMethodCall = typeof options === 'string';\r\n      var args = widgetSlice.call(arguments, 1);\r\n      var returnValue = this;\r\n\r\n      if (isMethodCall) {\r\n        // If this is an empty collection, we need to have the instance method\r\n        // return undefined instead of the jQuery instance\r\n        if (!this.length && options === 'instance') {\r\n          returnValue = undefined;\r\n        } else {\r\n          this.each(function () {\r\n            var methodValue;\r\n            var instance = $.data(this, fullName);\r\n\r\n            if (options === 'instance') {\r\n              returnValue = instance;\r\n              return false;\r\n            }\r\n\r\n            if (!instance) {\r\n              return $.error(\r\n                'cannot call methods on ' +\r\n                  name +\r\n                  ' prior to initialization; ' +\r\n                  \"attempted to call method '\" +\r\n                  options +\r\n                  \"'\"\r\n              );\r\n            }\r\n\r\n            if (!$.isFunction(instance[options]) || options.charAt(0) === '_') {\r\n              return $.error(\r\n                \"no such method '\" +\r\n                  options +\r\n                  \"' for \" +\r\n                  name +\r\n                  ' widget instance'\r\n              );\r\n            }\r\n\r\n            methodValue = instance[options].apply(instance, args);\r\n\r\n            if (methodValue !== instance && methodValue !== undefined) {\r\n              returnValue =\r\n                methodValue && methodValue.jquery\r\n                  ? returnValue.pushStack(methodValue.get())\r\n                  : methodValue;\r\n              return false;\r\n            }\r\n          });\r\n        }\r\n      } else {\r\n        // Allow multiple hashes to be passed on init\r\n        if (args.length) {\r\n          options = $.widget.extend.apply(null, [options].concat(args));\r\n        }\r\n\r\n        this.each(function () {\r\n          var instance = $.data(this, fullName);\r\n          if (instance) {\r\n            instance.option(options || {});\r\n            if (instance._init) {\r\n              instance._init();\r\n            }\r\n          } else {\r\n            $.data(this, fullName, new object(options, this));\r\n          }\r\n        });\r\n      }\r\n\r\n      return returnValue;\r\n    };\r\n  };\r\n\r\n  $.Widget = function (/* options, element */) {};\r\n  $.Widget._childConstructors = [];\r\n\r\n  $.Widget.prototype = {\r\n    widgetName: 'widget',\r\n    widgetEventPrefix: '',\r\n    defaultElement: '<div>',\r\n\r\n    options: {\r\n      classes: {},\r\n      disabled: false,\r\n\r\n      // Callbacks\r\n      create: null\r\n    },\r\n\r\n    _createWidget: function (options, element) {\r\n      element = $(element || this.defaultElement || this)[0];\r\n      this.element = $(element);\r\n      this.uuid = widgetUuid++;\r\n      this.eventNamespace = '.' + this.widgetName + this.uuid;\r\n\r\n      this.bindings = $();\r\n      this.hoverable = $();\r\n      this.focusable = $();\r\n      this.classesElementLookup = {};\r\n\r\n      if (element !== this) {\r\n        $.data(element, this.widgetFullName, this);\r\n        this._on(true, this.element, {\r\n          remove: function (event) {\r\n            if (event.target === element) {\r\n              this.destroy();\r\n            }\r\n          }\r\n        });\r\n        this.document = $(\r\n          element.style\r\n            ? // Element within the document\r\n              element.ownerDocument\r\n            : // Element is window or document\r\n              element.document || element\r\n        );\r\n        this.window = $(\r\n          this.document[0].defaultView || this.document[0].parentWindow\r\n        );\r\n      }\r\n\r\n      this.options = $.widget.extend(\r\n        {},\r\n        this.options,\r\n        this._getCreateOptions(),\r\n        options\r\n      );\r\n\r\n      this._create();\r\n\r\n      if (this.options.disabled) {\r\n        this._setOptionDisabled(this.options.disabled);\r\n      }\r\n\r\n      this._trigger('create', null, this._getCreateEventData());\r\n      this._init();\r\n    },\r\n\r\n    _getCreateOptions: function () {\r\n      return {};\r\n    },\r\n\r\n    _getCreateEventData: $.noop,\r\n\r\n    _create: $.noop,\r\n\r\n    _init: $.noop,\r\n\r\n    destroy: function () {\r\n      var that = this;\r\n\r\n      this._destroy();\r\n      $.each(this.classesElementLookup, function (key, value) {\r\n        that._removeClass(value, key);\r\n      });\r\n\r\n      // We can probably remove the unbind calls in 2.0\r\n      // all event bindings should go through this._on()\r\n      this.element.off(this.eventNamespace).removeData(this.widgetFullName);\r\n      this.widget().off(this.eventNamespace).removeAttr('aria-disabled');\r\n\r\n      // Clean up events and states\r\n      this.bindings.off(this.eventNamespace);\r\n    },\r\n\r\n    _destroy: $.noop,\r\n\r\n    widget: function () {\r\n      return this.element;\r\n    },\r\n\r\n    option: function (key, value) {\r\n      var options = key;\r\n      var parts;\r\n      var curOption;\r\n      var i;\r\n\r\n      if (arguments.length === 0) {\r\n        // Don't return a reference to the internal hash\r\n        return $.widget.extend({}, this.options);\r\n      }\r\n\r\n      if (typeof key === 'string') {\r\n        // Handle nested keys, e.g., \"foo.bar\" => { foo: { bar: ___ } }\r\n        options = {};\r\n        parts = key.split('.');\r\n        key = parts.shift();\r\n        if (parts.length) {\r\n          curOption = options[key] = $.widget.extend({}, this.options[key]);\r\n          for (i = 0; i < parts.length - 1; i++) {\r\n            curOption[parts[i]] = curOption[parts[i]] || {};\r\n            curOption = curOption[parts[i]];\r\n          }\r\n          key = parts.pop();\r\n          if (arguments.length === 1) {\r\n            return curOption[key] === undefined ? null : curOption[key];\r\n          }\r\n          curOption[key] = value;\r\n        } else {\r\n          if (arguments.length === 1) {\r\n            return this.options[key] === undefined ? null : this.options[key];\r\n          }\r\n          options[key] = value;\r\n        }\r\n      }\r\n\r\n      this._setOptions(options);\r\n\r\n      return this;\r\n    },\r\n\r\n    _setOptions: function (options) {\r\n      var key;\r\n\r\n      for (key in options) {\r\n        this._setOption(key, options[key]);\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    _setOption: function (key, value) {\r\n      if (key === 'classes') {\r\n        this._setOptionClasses(value);\r\n      }\r\n\r\n      this.options[key] = value;\r\n\r\n      if (key === 'disabled') {\r\n        this._setOptionDisabled(value);\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    _setOptionClasses: function (value) {\r\n      var classKey, elements, currentElements;\r\n\r\n      for (classKey in value) {\r\n        currentElements = this.classesElementLookup[classKey];\r\n        if (\r\n          value[classKey] === this.options.classes[classKey] ||\r\n          !currentElements ||\r\n          !currentElements.length\r\n        ) {\r\n          continue;\r\n        }\r\n\r\n        // We are doing this to create a new jQuery object because the _removeClass() call\r\n        // on the next line is going to destroy the reference to the current elements being\r\n        // tracked. We need to save a copy of this collection so that we can add the new classes\r\n        // below.\r\n        elements = $(currentElements.get());\r\n        this._removeClass(currentElements, classKey);\r\n\r\n        // We don't use _addClass() here, because that uses this.options.classes\r\n        // for generating the string of classes. We want to use the value passed in from\r\n        // _setOption(), this is the new value of the classes option which was passed to\r\n        // _setOption(). We pass this value directly to _classes().\r\n        elements.addClass(\r\n          this._classes({\r\n            element: elements,\r\n            keys: classKey,\r\n            classes: value,\r\n            add: true\r\n          })\r\n        );\r\n      }\r\n    },\r\n\r\n    _setOptionDisabled: function (value) {\r\n      this._toggleClass(\r\n        this.widget(),\r\n        this.widgetFullName + '-disabled',\r\n        null,\r\n        !!value\r\n      );\r\n\r\n      // If the widget is becoming disabled, then nothing is interactive\r\n      if (value) {\r\n        this._removeClass(this.hoverable, null, 'ui-state-hover');\r\n        this._removeClass(this.focusable, null, 'ui-state-focus');\r\n      }\r\n    },\r\n\r\n    enable: function () {\r\n      return this._setOptions({ disabled: false });\r\n    },\r\n\r\n    disable: function () {\r\n      return this._setOptions({ disabled: true });\r\n    },\r\n\r\n    _classes: function (options) {\r\n      var full = [];\r\n      var that = this;\r\n\r\n      options = $.extend(\r\n        {\r\n          element: this.element,\r\n          classes: this.options.classes || {}\r\n        },\r\n        options\r\n      );\r\n\r\n      function bindRemoveEvent() {\r\n        options.element.each(function (_, element) {\r\n          var isTracked = $.map(that.classesElementLookup, function (elements) {\r\n            return elements;\r\n          }).some(function (elements) {\r\n            return elements.is(element);\r\n          });\r\n\r\n          if (!isTracked) {\r\n            that._on($(element), {\r\n              remove: '_untrackClassesElement'\r\n            });\r\n          }\r\n        });\r\n      }\r\n\r\n      function processClassString(classes, checkOption) {\r\n        var current, i;\r\n        for (i = 0; i < classes.length; i++) {\r\n          current = that.classesElementLookup[classes[i]] || $();\r\n          if (options.add) {\r\n            bindRemoveEvent();\r\n            current = $(\r\n              $.uniqueSort(current.get().concat(options.element.get()))\r\n            );\r\n          } else {\r\n            current = $(current.not(options.element).get());\r\n          }\r\n          that.classesElementLookup[classes[i]] = current;\r\n          full.push(classes[i]);\r\n          if (checkOption && options.classes[classes[i]]) {\r\n            full.push(options.classes[classes[i]]);\r\n          }\r\n        }\r\n      }\r\n\r\n      if (options.keys) {\r\n        processClassString(options.keys.match(/\\S+/g) || [], true);\r\n      }\r\n      if (options.extra) {\r\n        processClassString(options.extra.match(/\\S+/g) || []);\r\n      }\r\n\r\n      return full.join(' ');\r\n    },\r\n\r\n    _untrackClassesElement: function (event) {\r\n      var that = this;\r\n      $.each(that.classesElementLookup, function (key, value) {\r\n        if ($.inArray(event.target, value) !== -1) {\r\n          that.classesElementLookup[key] = $(value.not(event.target).get());\r\n        }\r\n      });\r\n\r\n      this._off($(event.target));\r\n    },\r\n\r\n    _removeClass: function (element, keys, extra) {\r\n      return this._toggleClass(element, keys, extra, false);\r\n    },\r\n\r\n    _addClass: function (element, keys, extra) {\r\n      return this._toggleClass(element, keys, extra, true);\r\n    },\r\n\r\n    _toggleClass: function (element, keys, extra, add) {\r\n      add = typeof add === 'boolean' ? add : extra;\r\n      var shift = typeof element === 'string' || element === null,\r\n        options = {\r\n          extra: shift ? keys : extra,\r\n          keys: shift ? element : keys,\r\n          element: shift ? this.element : element,\r\n          add: add\r\n        };\r\n      options.element.toggleClass(this._classes(options), add);\r\n      return this;\r\n    },\r\n\r\n    _on: function (suppressDisabledCheck, element, handlers) {\r\n      var delegateElement;\r\n      var instance = this;\r\n\r\n      // No suppressDisabledCheck flag, shuffle arguments\r\n      if (typeof suppressDisabledCheck !== 'boolean') {\r\n        handlers = element;\r\n        element = suppressDisabledCheck;\r\n        suppressDisabledCheck = false;\r\n      }\r\n\r\n      // No element argument, shuffle and use this.element\r\n      if (!handlers) {\r\n        handlers = element;\r\n        element = this.element;\r\n        delegateElement = this.widget();\r\n      } else {\r\n        element = delegateElement = $(element);\r\n        this.bindings = this.bindings.add(element);\r\n      }\r\n\r\n      $.each(handlers, function (event, handler) {\r\n        function handlerProxy() {\r\n          // Allow widgets to customize the disabled handling\r\n          // - disabled as an array instead of boolean\r\n          // - disabled class as method for disabling individual parts\r\n          if (\r\n            !suppressDisabledCheck &&\r\n            (instance.options.disabled === true ||\r\n              $(this).hasClass('ui-state-disabled'))\r\n          ) {\r\n            return;\r\n          }\r\n          return (typeof handler === 'string'\r\n            ? instance[handler]\r\n            : handler\r\n          ).apply(instance, arguments);\r\n        }\r\n\r\n        // Copy the guid so direct unbinding works\r\n        if (typeof handler !== 'string') {\r\n          handlerProxy.guid = handler.guid =\r\n            handler.guid || handlerProxy.guid || $.guid++;\r\n        }\r\n\r\n        var match = event.match(/^([\\w:-]*)\\s*(.*)$/);\r\n        var eventName = match[1] + instance.eventNamespace;\r\n        var selector = match[2];\r\n\r\n        if (selector) {\r\n          delegateElement.on(eventName, selector, handlerProxy);\r\n        } else {\r\n          element.on(eventName, handlerProxy);\r\n        }\r\n      });\r\n    },\r\n\r\n    _off: function (element, eventName) {\r\n      eventName =\r\n        (eventName || '').split(' ').join(this.eventNamespace + ' ') +\r\n        this.eventNamespace;\r\n      element.off(eventName);\r\n\r\n      // Clear the stack to avoid memory leaks (#10056)\r\n      this.bindings = $(this.bindings.not(element).get());\r\n      this.focusable = $(this.focusable.not(element).get());\r\n      this.hoverable = $(this.hoverable.not(element).get());\r\n    },\r\n\r\n    _delay: function (handler, delay) {\r\n      var instance = this;\r\n      function handlerProxy() {\r\n        return (typeof handler === 'string'\r\n          ? instance[handler]\r\n          : handler\r\n        ).apply(instance, arguments);\r\n      }\r\n      return setTimeout(handlerProxy, delay || 0);\r\n    },\r\n\r\n    _hoverable: function (element) {\r\n      this.hoverable = this.hoverable.add(element);\r\n      this._on(element, {\r\n        mouseenter: function (event) {\r\n          this._addClass($(event.currentTarget), null, 'ui-state-hover');\r\n        },\r\n        mouseleave: function (event) {\r\n          this._removeClass($(event.currentTarget), null, 'ui-state-hover');\r\n        }\r\n      });\r\n    },\r\n\r\n    _focusable: function (element) {\r\n      this.focusable = this.focusable.add(element);\r\n      this._on(element, {\r\n        focusin: function (event) {\r\n          this._addClass($(event.currentTarget), null, 'ui-state-focus');\r\n        },\r\n        focusout: function (event) {\r\n          this._removeClass($(event.currentTarget), null, 'ui-state-focus');\r\n        }\r\n      });\r\n    },\r\n\r\n    _trigger: function (type, event, data) {\r\n      var prop, orig;\r\n      var callback = this.options[type];\r\n\r\n      data = data || {};\r\n      event = $.Event(event);\r\n      event.type = (type === this.widgetEventPrefix\r\n        ? type\r\n        : this.widgetEventPrefix + type\r\n      ).toLowerCase();\r\n\r\n      // The original event may come from any element\r\n      // so we need to reset the target on the new event\r\n      event.target = this.element[0];\r\n\r\n      // Copy original event properties over to the new event\r\n      orig = event.originalEvent;\r\n      if (orig) {\r\n        for (prop in orig) {\r\n          if (!(prop in event)) {\r\n            event[prop] = orig[prop];\r\n          }\r\n        }\r\n      }\r\n\r\n      this.element.trigger(event, data);\r\n      return !(\r\n        ($.isFunction(callback) &&\r\n          callback.apply(this.element[0], [event].concat(data)) === false) ||\r\n        event.isDefaultPrevented()\r\n      );\r\n    }\r\n  };\r\n\r\n  $.each({ show: 'fadeIn', hide: 'fadeOut' }, function (method, defaultEffect) {\r\n    $.Widget.prototype['_' + method] = function (element, options, callback) {\r\n      if (typeof options === 'string') {\r\n        options = { effect: options };\r\n      }\r\n\r\n      var hasOptions;\r\n      var effectName = !options\r\n        ? method\r\n        : options === true || typeof options === 'number'\r\n        ? defaultEffect\r\n        : options.effect || defaultEffect;\r\n\r\n      options = options || {};\r\n      if (typeof options === 'number') {\r\n        options = { duration: options };\r\n      }\r\n\r\n      hasOptions = !$.isEmptyObject(options);\r\n      options.complete = callback;\r\n\r\n      if (options.delay) {\r\n        element.delay(options.delay);\r\n      }\r\n\r\n      if (hasOptions && $.effects && $.effects.effect[effectName]) {\r\n        element[method](options);\r\n      } else if (effectName !== method && element[effectName]) {\r\n        element[effectName](options.duration, options.easing, callback);\r\n      } else {\r\n        element.queue(function (next) {\r\n          $(this)[method]();\r\n          if (callback) {\r\n            callback.call(element[0]);\r\n          }\r\n          next();\r\n        });\r\n      }\r\n    };\r\n  });\r\n});\r\n","jquery/fileUploader/vendor/blueimp-canvas-to-blob/js/canvas-to-blob.js":"/*\r\n * JavaScript Canvas to Blob\r\n * https://github.com/blueimp/JavaScript-Canvas-to-Blob\r\n *\r\n * Copyright 2012, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n *\r\n * Based on stackoverflow user Stoive's code snippet:\r\n * http://stackoverflow.com/q/4998908\r\n */\r\n\r\n/* global define, Uint8Array, ArrayBuffer, module */\r\n\r\n;(function (window) {\r\n  'use strict'\r\n\r\n  var CanvasPrototype =\r\n    window.HTMLCanvasElement && window.HTMLCanvasElement.prototype\r\n  var hasBlobConstructor =\r\n    window.Blob &&\r\n    (function () {\r\n      try {\r\n        return Boolean(new Blob())\r\n      } catch (e) {\r\n        return false\r\n      }\r\n    })()\r\n  var hasArrayBufferViewSupport =\r\n    hasBlobConstructor &&\r\n    window.Uint8Array &&\r\n    (function () {\r\n      try {\r\n        return new Blob([new Uint8Array(100)]).size === 100\r\n      } catch (e) {\r\n        return false\r\n      }\r\n    })()\r\n  var BlobBuilder =\r\n    window.BlobBuilder ||\r\n    window.WebKitBlobBuilder ||\r\n    window.MozBlobBuilder ||\r\n    window.MSBlobBuilder\r\n  var dataURIPattern = /^data:((.*?)(;charset=.*?)?)(;base64)?,/\r\n  var dataURLtoBlob =\r\n    (hasBlobConstructor || BlobBuilder) &&\r\n    window.atob &&\r\n    window.ArrayBuffer &&\r\n    window.Uint8Array &&\r\n    function (dataURI) {\r\n      var matches,\r\n        mediaType,\r\n        isBase64,\r\n        dataString,\r\n        byteString,\r\n        arrayBuffer,\r\n        intArray,\r\n        i,\r\n        bb\r\n      // Parse the dataURI components as per RFC 2397\r\n      matches = dataURI.match(dataURIPattern)\r\n      if (!matches) {\r\n        throw new Error('invalid data URI')\r\n      }\r\n      // Default to text/plain;charset=US-ASCII\r\n      mediaType = matches[2]\r\n        ? matches[1]\r\n        : 'text/plain' + (matches[3] || ';charset=US-ASCII')\r\n      isBase64 = !!matches[4]\r\n      dataString = dataURI.slice(matches[0].length)\r\n      if (isBase64) {\r\n        // Convert base64 to raw binary data held in a string:\r\n        byteString = atob(dataString)\r\n      } else {\r\n        // Convert base64/URLEncoded data component to raw binary:\r\n        byteString = decodeURIComponent(dataString)\r\n      }\r\n      // Write the bytes of the string to an ArrayBuffer:\r\n      arrayBuffer = new ArrayBuffer(byteString.length)\r\n      intArray = new Uint8Array(arrayBuffer)\r\n      for (i = 0; i < byteString.length; i += 1) {\r\n        intArray[i] = byteString.charCodeAt(i)\r\n      }\r\n      // Write the ArrayBuffer (or ArrayBufferView) to a blob:\r\n      if (hasBlobConstructor) {\r\n        return new Blob([hasArrayBufferViewSupport ? intArray : arrayBuffer], {\r\n          type: mediaType\r\n        })\r\n      }\r\n      bb = new BlobBuilder()\r\n      bb.append(arrayBuffer)\r\n      return bb.getBlob(mediaType)\r\n    }\r\n  if (window.HTMLCanvasElement && !CanvasPrototype.toBlob) {\r\n    if (CanvasPrototype.mozGetAsFile) {\r\n      CanvasPrototype.toBlob = function (callback, type, quality) {\r\n        var self = this\r\n        setTimeout(function () {\r\n          if (quality && CanvasPrototype.toDataURL && dataURLtoBlob) {\r\n            callback(dataURLtoBlob(self.toDataURL(type, quality)))\r\n          } else {\r\n            callback(self.mozGetAsFile('blob', type))\r\n          }\r\n        })\r\n      }\r\n    } else if (CanvasPrototype.toDataURL && dataURLtoBlob) {\r\n      if (CanvasPrototype.msToBlob) {\r\n        CanvasPrototype.toBlob = function (callback, type, quality) {\r\n          var self = this\r\n          setTimeout(function () {\r\n            if (\r\n              ((type && type !== 'image/png') || quality) &&\r\n              CanvasPrototype.toDataURL &&\r\n              dataURLtoBlob\r\n            ) {\r\n              callback(dataURLtoBlob(self.toDataURL(type, quality)))\r\n            } else {\r\n              callback(self.msToBlob(type))\r\n            }\r\n          })\r\n        }\r\n      } else {\r\n        CanvasPrototype.toBlob = function (callback, type, quality) {\r\n          var self = this\r\n          setTimeout(function () {\r\n            callback(dataURLtoBlob(self.toDataURL(type, quality)))\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n  if (typeof define === 'function' && define.amd) {\r\n    define(function () {\r\n      return dataURLtoBlob\r\n    })\r\n  } else if (typeof module === 'object' && module.exports) {\r\n    module.exports = dataURLtoBlob\r\n  } else {\r\n    window.dataURLtoBlob = dataURLtoBlob\r\n  }\r\n})(window)\r\n","jquery/fileUploader/vendor/blueimp-load-image/js/index.js":"/* global module, require */\r\n\r\nmodule.exports = require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image')\r\n\r\nrequire('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-scale')\r\nrequire('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-meta')\r\nrequire('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-fetch')\r\nrequire('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-exif')\r\nrequire('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-exif-map')\r\nrequire('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-iptc')\r\nrequire('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-iptc-map')\r\nrequire('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-orientation')\r\n","jquery/fileUploader/vendor/blueimp-load-image/js/load-image-exif-map.js":"/*\r\n * JavaScript Load Image Exif Map\r\n * https://github.com/blueimp/JavaScript-Load-Image\r\n *\r\n * Copyright 2013, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Exif tags mapping based on\r\n * https://github.com/jseidelin/exif-js\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n */\r\n\r\n/* global define, module, require */\r\n\r\n;(function (factory) {\r\n  'use strict'\r\n  if (typeof define === 'function' && define.amd) {\r\n    // Register as an anonymous AMD module:\r\n    define(['jquery/fileUploader/vendor/blueimp-load-image/js/load-image', 'jquery/fileUploader/vendor/blueimp-load-image/js/load-image-exif'], factory)\r\n  } else if (typeof module === 'object' && module.exports) {\r\n    factory(require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image'), require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-exif'))\r\n  } else {\r\n    // Browser globals:\r\n    factory(window.loadImage)\r\n  }\r\n})(function (loadImage) {\r\n  'use strict'\r\n\r\n  var ExifMapProto = loadImage.ExifMap.prototype\r\n\r\n  ExifMapProto.tags = {\r\n    // =================\r\n    // TIFF tags (IFD0):\r\n    // =================\r\n    0x0100: 'ImageWidth',\r\n    0x0101: 'ImageHeight',\r\n    0x0102: 'BitsPerSample',\r\n    0x0103: 'Compression',\r\n    0x0106: 'PhotometricInterpretation',\r\n    0x0112: 'Orientation',\r\n    0x0115: 'SamplesPerPixel',\r\n    0x011c: 'PlanarConfiguration',\r\n    0x0212: 'YCbCrSubSampling',\r\n    0x0213: 'YCbCrPositioning',\r\n    0x011a: 'XResolution',\r\n    0x011b: 'YResolution',\r\n    0x0128: 'ResolutionUnit',\r\n    0x0111: 'StripOffsets',\r\n    0x0116: 'RowsPerStrip',\r\n    0x0117: 'StripByteCounts',\r\n    0x0201: 'JPEGInterchangeFormat',\r\n    0x0202: 'JPEGInterchangeFormatLength',\r\n    0x012d: 'TransferFunction',\r\n    0x013e: 'WhitePoint',\r\n    0x013f: 'PrimaryChromaticities',\r\n    0x0211: 'YCbCrCoefficients',\r\n    0x0214: 'ReferenceBlackWhite',\r\n    0x0132: 'DateTime',\r\n    0x010e: 'ImageDescription',\r\n    0x010f: 'Make',\r\n    0x0110: 'Model',\r\n    0x0131: 'Software',\r\n    0x013b: 'Artist',\r\n    0x8298: 'Copyright',\r\n    0x8769: {\r\n      // ExifIFDPointer\r\n      0x9000: 'ExifVersion', // EXIF version\r\n      0xa000: 'FlashpixVersion', // Flashpix format version\r\n      0xa001: 'ColorSpace', // Color space information tag\r\n      0xa002: 'PixelXDimension', // Valid width of meaningful image\r\n      0xa003: 'PixelYDimension', // Valid height of meaningful image\r\n      0xa500: 'Gamma',\r\n      0x9101: 'ComponentsConfiguration', // Information about channels\r\n      0x9102: 'CompressedBitsPerPixel', // Compressed bits per pixel\r\n      0x927c: 'MakerNote', // Any desired information written by the manufacturer\r\n      0x9286: 'UserComment', // Comments by user\r\n      0xa004: 'RelatedSoundFile', // Name of related sound file\r\n      0x9003: 'DateTimeOriginal', // Date and time when the original image was generated\r\n      0x9004: 'DateTimeDigitized', // Date and time when the image was stored digitally\r\n      0x9010: 'OffsetTime', // Time zone when the image file was last changed\r\n      0x9011: 'OffsetTimeOriginal', // Time zone when the image was stored digitally\r\n      0x9012: 'OffsetTimeDigitized', // Time zone when the image was stored digitally\r\n      0x9290: 'SubSecTime', // Fractions of seconds for DateTime\r\n      0x9291: 'SubSecTimeOriginal', // Fractions of seconds for DateTimeOriginal\r\n      0x9292: 'SubSecTimeDigitized', // Fractions of seconds for DateTimeDigitized\r\n      0x829a: 'ExposureTime', // Exposure time (in seconds)\r\n      0x829d: 'FNumber',\r\n      0x8822: 'ExposureProgram', // Exposure program\r\n      0x8824: 'SpectralSensitivity', // Spectral sensitivity\r\n      0x8827: 'PhotographicSensitivity', // EXIF 2.3, ISOSpeedRatings in EXIF 2.2\r\n      0x8828: 'OECF', // Optoelectric conversion factor\r\n      0x8830: 'SensitivityType',\r\n      0x8831: 'StandardOutputSensitivity',\r\n      0x8832: 'RecommendedExposureIndex',\r\n      0x8833: 'ISOSpeed',\r\n      0x8834: 'ISOSpeedLatitudeyyy',\r\n      0x8835: 'ISOSpeedLatitudezzz',\r\n      0x9201: 'ShutterSpeedValue', // Shutter speed\r\n      0x9202: 'ApertureValue', // Lens aperture\r\n      0x9203: 'BrightnessValue', // Value of brightness\r\n      0x9204: 'ExposureBias', // Exposure bias\r\n      0x9205: 'MaxApertureValue', // Smallest F number of lens\r\n      0x9206: 'SubjectDistance', // Distance to subject in meters\r\n      0x9207: 'MeteringMode', // Metering mode\r\n      0x9208: 'LightSource', // Kind of light source\r\n      0x9209: 'Flash', // Flash status\r\n      0x9214: 'SubjectArea', // Location and area of main subject\r\n      0x920a: 'FocalLength', // Focal length of the lens in mm\r\n      0xa20b: 'FlashEnergy', // Strobe energy in BCPS\r\n      0xa20c: 'SpatialFrequencyResponse',\r\n      0xa20e: 'FocalPlaneXResolution', // Number of pixels in width direction per FPRUnit\r\n      0xa20f: 'FocalPlaneYResolution', // Number of pixels in height direction per FPRUnit\r\n      0xa210: 'FocalPlaneResolutionUnit', // Unit for measuring the focal plane resolution\r\n      0xa214: 'SubjectLocation', // Location of subject in image\r\n      0xa215: 'ExposureIndex', // Exposure index selected on camera\r\n      0xa217: 'SensingMethod', // Image sensor type\r\n      0xa300: 'FileSource', // Image source (3 == DSC)\r\n      0xa301: 'SceneType', // Scene type (1 == directly photographed)\r\n      0xa302: 'CFAPattern', // Color filter array geometric pattern\r\n      0xa401: 'CustomRendered', // Special processing\r\n      0xa402: 'ExposureMode', // Exposure mode\r\n      0xa403: 'WhiteBalance', // 1 = auto white balance, 2 = manual\r\n      0xa404: 'DigitalZoomRatio', // Digital zoom ratio\r\n      0xa405: 'FocalLengthIn35mmFilm',\r\n      0xa406: 'SceneCaptureType', // Type of scene\r\n      0xa407: 'GainControl', // Degree of overall image gain adjustment\r\n      0xa408: 'Contrast', // Direction of contrast processing applied by camera\r\n      0xa409: 'Saturation', // Direction of saturation processing applied by camera\r\n      0xa40a: 'Sharpness', // Direction of sharpness processing applied by camera\r\n      0xa40b: 'DeviceSettingDescription',\r\n      0xa40c: 'SubjectDistanceRange', // Distance to subject\r\n      0xa420: 'ImageUniqueID', // Identifier assigned uniquely to each image\r\n      0xa430: 'CameraOwnerName',\r\n      0xa431: 'BodySerialNumber',\r\n      0xa432: 'LensSpecification',\r\n      0xa433: 'LensMake',\r\n      0xa434: 'LensModel',\r\n      0xa435: 'LensSerialNumber'\r\n    },\r\n    0x8825: {\r\n      // GPSInfoIFDPointer\r\n      0x0000: 'GPSVersionID',\r\n      0x0001: 'GPSLatitudeRef',\r\n      0x0002: 'GPSLatitude',\r\n      0x0003: 'GPSLongitudeRef',\r\n      0x0004: 'GPSLongitude',\r\n      0x0005: 'GPSAltitudeRef',\r\n      0x0006: 'GPSAltitude',\r\n      0x0007: 'GPSTimeStamp',\r\n      0x0008: 'GPSSatellites',\r\n      0x0009: 'GPSStatus',\r\n      0x000a: 'GPSMeasureMode',\r\n      0x000b: 'GPSDOP',\r\n      0x000c: 'GPSSpeedRef',\r\n      0x000d: 'GPSSpeed',\r\n      0x000e: 'GPSTrackRef',\r\n      0x000f: 'GPSTrack',\r\n      0x0010: 'GPSImgDirectionRef',\r\n      0x0011: 'GPSImgDirection',\r\n      0x0012: 'GPSMapDatum',\r\n      0x0013: 'GPSDestLatitudeRef',\r\n      0x0014: 'GPSDestLatitude',\r\n      0x0015: 'GPSDestLongitudeRef',\r\n      0x0016: 'GPSDestLongitude',\r\n      0x0017: 'GPSDestBearingRef',\r\n      0x0018: 'GPSDestBearing',\r\n      0x0019: 'GPSDestDistanceRef',\r\n      0x001a: 'GPSDestDistance',\r\n      0x001b: 'GPSProcessingMethod',\r\n      0x001c: 'GPSAreaInformation',\r\n      0x001d: 'GPSDateStamp',\r\n      0x001e: 'GPSDifferential',\r\n      0x001f: 'GPSHPositioningError'\r\n    },\r\n    0xa005: {\r\n      // InteroperabilityIFDPointer\r\n      0x0001: 'InteroperabilityIndex'\r\n    }\r\n  }\r\n\r\n  // IFD1 directory can contain any IFD0 tags:\r\n  ExifMapProto.tags.ifd1 = ExifMapProto.tags\r\n\r\n  ExifMapProto.stringValues = {\r\n    ExposureProgram: {\r\n      0: 'Undefined',\r\n      1: 'Manual',\r\n      2: 'Normal program',\r\n      3: 'Aperture priority',\r\n      4: 'Shutter priority',\r\n      5: 'Creative program',\r\n      6: 'Action program',\r\n      7: 'Portrait mode',\r\n      8: 'Landscape mode'\r\n    },\r\n    MeteringMode: {\r\n      0: 'Unknown',\r\n      1: 'Average',\r\n      2: 'CenterWeightedAverage',\r\n      3: 'Spot',\r\n      4: 'MultiSpot',\r\n      5: 'Pattern',\r\n      6: 'Partial',\r\n      255: 'Other'\r\n    },\r\n    LightSource: {\r\n      0: 'Unknown',\r\n      1: 'Daylight',\r\n      2: 'Fluorescent',\r\n      3: 'Tungsten (incandescent light)',\r\n      4: 'Flash',\r\n      9: 'Fine weather',\r\n      10: 'Cloudy weather',\r\n      11: 'Shade',\r\n      12: 'Daylight fluorescent (D 5700 - 7100K)',\r\n      13: 'Day white fluorescent (N 4600 - 5400K)',\r\n      14: 'Cool white fluorescent (W 3900 - 4500K)',\r\n      15: 'White fluorescent (WW 3200 - 3700K)',\r\n      17: 'Standard light A',\r\n      18: 'Standard light B',\r\n      19: 'Standard light C',\r\n      20: 'D55',\r\n      21: 'D65',\r\n      22: 'D75',\r\n      23: 'D50',\r\n      24: 'ISO studio tungsten',\r\n      255: 'Other'\r\n    },\r\n    Flash: {\r\n      0x0000: 'Flash did not fire',\r\n      0x0001: 'Flash fired',\r\n      0x0005: 'Strobe return light not detected',\r\n      0x0007: 'Strobe return light detected',\r\n      0x0009: 'Flash fired, compulsory flash mode',\r\n      0x000d: 'Flash fired, compulsory flash mode, return light not detected',\r\n      0x000f: 'Flash fired, compulsory flash mode, return light detected',\r\n      0x0010: 'Flash did not fire, compulsory flash mode',\r\n      0x0018: 'Flash did not fire, auto mode',\r\n      0x0019: 'Flash fired, auto mode',\r\n      0x001d: 'Flash fired, auto mode, return light not detected',\r\n      0x001f: 'Flash fired, auto mode, return light detected',\r\n      0x0020: 'No flash function',\r\n      0x0041: 'Flash fired, red-eye reduction mode',\r\n      0x0045: 'Flash fired, red-eye reduction mode, return light not detected',\r\n      0x0047: 'Flash fired, red-eye reduction mode, return light detected',\r\n      0x0049: 'Flash fired, compulsory flash mode, red-eye reduction mode',\r\n      0x004d: 'Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected',\r\n      0x004f: 'Flash fired, compulsory flash mode, red-eye reduction mode, return light detected',\r\n      0x0059: 'Flash fired, auto mode, red-eye reduction mode',\r\n      0x005d: 'Flash fired, auto mode, return light not detected, red-eye reduction mode',\r\n      0x005f: 'Flash fired, auto mode, return light detected, red-eye reduction mode'\r\n    },\r\n    SensingMethod: {\r\n      1: 'Undefined',\r\n      2: 'One-chip color area sensor',\r\n      3: 'Two-chip color area sensor',\r\n      4: 'Three-chip color area sensor',\r\n      5: 'Color sequential area sensor',\r\n      7: 'Trilinear sensor',\r\n      8: 'Color sequential linear sensor'\r\n    },\r\n    SceneCaptureType: {\r\n      0: 'Standard',\r\n      1: 'Landscape',\r\n      2: 'Portrait',\r\n      3: 'Night scene'\r\n    },\r\n    SceneType: {\r\n      1: 'Directly photographed'\r\n    },\r\n    CustomRendered: {\r\n      0: 'Normal process',\r\n      1: 'Custom process'\r\n    },\r\n    WhiteBalance: {\r\n      0: 'Auto white balance',\r\n      1: 'Manual white balance'\r\n    },\r\n    GainControl: {\r\n      0: 'None',\r\n      1: 'Low gain up',\r\n      2: 'High gain up',\r\n      3: 'Low gain down',\r\n      4: 'High gain down'\r\n    },\r\n    Contrast: {\r\n      0: 'Normal',\r\n      1: 'Soft',\r\n      2: 'Hard'\r\n    },\r\n    Saturation: {\r\n      0: 'Normal',\r\n      1: 'Low saturation',\r\n      2: 'High saturation'\r\n    },\r\n    Sharpness: {\r\n      0: 'Normal',\r\n      1: 'Soft',\r\n      2: 'Hard'\r\n    },\r\n    SubjectDistanceRange: {\r\n      0: 'Unknown',\r\n      1: 'Macro',\r\n      2: 'Close view',\r\n      3: 'Distant view'\r\n    },\r\n    FileSource: {\r\n      3: 'DSC'\r\n    },\r\n    ComponentsConfiguration: {\r\n      0: '',\r\n      1: 'Y',\r\n      2: 'Cb',\r\n      3: 'Cr',\r\n      4: 'R',\r\n      5: 'G',\r\n      6: 'B'\r\n    },\r\n    Orientation: {\r\n      1: 'Original',\r\n      2: 'Horizontal flip',\r\n      3: 'Rotate 180\u00b0 CCW',\r\n      4: 'Vertical flip',\r\n      5: 'Vertical flip + Rotate 90\u00b0 CW',\r\n      6: 'Rotate 90\u00b0 CW',\r\n      7: 'Horizontal flip + Rotate 90\u00b0 CW',\r\n      8: 'Rotate 90\u00b0 CCW'\r\n    }\r\n  }\r\n\r\n  ExifMapProto.getText = function (name) {\r\n    var value = this.get(name)\r\n    switch (name) {\r\n      case 'LightSource':\r\n      case 'Flash':\r\n      case 'MeteringMode':\r\n      case 'ExposureProgram':\r\n      case 'SensingMethod':\r\n      case 'SceneCaptureType':\r\n      case 'SceneType':\r\n      case 'CustomRendered':\r\n      case 'WhiteBalance':\r\n      case 'GainControl':\r\n      case 'Contrast':\r\n      case 'Saturation':\r\n      case 'Sharpness':\r\n      case 'SubjectDistanceRange':\r\n      case 'FileSource':\r\n      case 'Orientation':\r\n        return this.stringValues[name][value]\r\n      case 'ExifVersion':\r\n      case 'FlashpixVersion':\r\n        if (!value) return\r\n        return String.fromCharCode(value[0], value[1], value[2], value[3])\r\n      case 'ComponentsConfiguration':\r\n        if (!value) return\r\n        return (\r\n          this.stringValues[name][value[0]] +\r\n          this.stringValues[name][value[1]] +\r\n          this.stringValues[name][value[2]] +\r\n          this.stringValues[name][value[3]]\r\n        )\r\n      case 'GPSVersionID':\r\n        if (!value) return\r\n        return value[0] + '.' + value[1] + '.' + value[2] + '.' + value[3]\r\n    }\r\n    return String(value)\r\n  }\r\n\r\n  ExifMapProto.getAll = function () {\r\n    var map = {}\r\n    var prop\r\n    var obj\r\n    var name\r\n    for (prop in this) {\r\n      if (Object.prototype.hasOwnProperty.call(this, prop)) {\r\n        obj = this[prop]\r\n        if (obj && obj.getAll) {\r\n          map[this.ifds[prop].name] = obj.getAll()\r\n        } else {\r\n          name = this.tags[prop]\r\n          if (name) map[name] = this.getText(name)\r\n        }\r\n      }\r\n    }\r\n    return map\r\n  }\r\n\r\n  ExifMapProto.getName = function (tagCode) {\r\n    var name = this.tags[tagCode]\r\n    if (typeof name === 'object') return this.ifds[tagCode].name\r\n    return name\r\n  }\r\n\r\n  // Extend the map of tag names to tag codes:\r\n  ;(function () {\r\n    var tags = ExifMapProto.tags\r\n    var prop\r\n    var ifd\r\n    var subTags\r\n    // Map the tag names to tags:\r\n    for (prop in tags) {\r\n      if (Object.prototype.hasOwnProperty.call(tags, prop)) {\r\n        ifd = ExifMapProto.ifds[prop]\r\n        if (ifd) {\r\n          subTags = tags[prop]\r\n          for (prop in subTags) {\r\n            if (Object.prototype.hasOwnProperty.call(subTags, prop)) {\r\n              ifd.map[subTags[prop]] = Number(prop)\r\n            }\r\n          }\r\n        } else {\r\n          ExifMapProto.map[tags[prop]] = Number(prop)\r\n        }\r\n      }\r\n    }\r\n  })()\r\n})\r\n","jquery/fileUploader/vendor/blueimp-load-image/js/load-image-exif.js":"/*\r\n * JavaScript Load Image Exif Parser\r\n * https://github.com/blueimp/JavaScript-Load-Image\r\n *\r\n * Copyright 2013, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n */\r\n\r\n/* global define, module, require, DataView */\r\n\r\n/* eslint-disable no-console */\r\n\r\n;(function (factory) {\r\n  'use strict'\r\n  if (typeof define === 'function' && define.amd) {\r\n    // Register as an anonymous AMD module:\r\n    define(['jquery/fileUploader/vendor/blueimp-load-image/js/load-image', 'jquery/fileUploader/vendor/blueimp-load-image/js/load-image-meta'], factory)\r\n  } else if (typeof module === 'object' && module.exports) {\r\n    factory(require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image'), require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-meta'))\r\n  } else {\r\n    // Browser globals:\r\n    factory(window.loadImage)\r\n  }\r\n})(function (loadImage) {\r\n  'use strict'\r\n\r\n  /**\r\n   * Exif tag map\r\n   *\r\n   * @name ExifMap\r\n   * @class\r\n   * @param {number|string} tagCode IFD tag code\r\n   */\r\n  function ExifMap(tagCode) {\r\n    if (tagCode) {\r\n      Object.defineProperty(this, 'map', {\r\n        value: this.ifds[tagCode].map\r\n      })\r\n      Object.defineProperty(this, 'tags', {\r\n        value: (this.tags && this.tags[tagCode]) || {}\r\n      })\r\n    }\r\n  }\r\n\r\n  ExifMap.prototype.map = {\r\n    Orientation: 0x0112,\r\n    Thumbnail: 'ifd1',\r\n    Blob: 0x0201, // Alias for JPEGInterchangeFormat\r\n    Exif: 0x8769,\r\n    GPSInfo: 0x8825,\r\n    Interoperability: 0xa005\r\n  }\r\n\r\n  ExifMap.prototype.ifds = {\r\n    ifd1: { name: 'Thumbnail', map: ExifMap.prototype.map },\r\n    0x8769: { name: 'Exif', map: {} },\r\n    0x8825: { name: 'GPSInfo', map: {} },\r\n    0xa005: { name: 'Interoperability', map: {} }\r\n  }\r\n\r\n  /**\r\n   * Retrieves exif tag value\r\n   *\r\n   * @param {number|string} id Exif tag code or name\r\n   * @returns {object} Exif tag value\r\n   */\r\n  ExifMap.prototype.get = function (id) {\r\n    return this[id] || this[this.map[id]]\r\n  }\r\n\r\n  /**\r\n   * Returns the Exif Thumbnail data as Blob.\r\n   *\r\n   * @param {DataView} dataView Data view interface\r\n   * @param {number} offset Thumbnail data offset\r\n   * @param {number} length Thumbnail data length\r\n   * @returns {undefined|Blob} Returns the Thumbnail Blob or undefined\r\n   */\r\n  function getExifThumbnail(dataView, offset, length) {\r\n    if (!length) return\r\n    if (offset + length > dataView.byteLength) {\r\n      console.log('Invalid Exif data: Invalid thumbnail data.')\r\n      return\r\n    }\r\n    return new Blob(\r\n      [loadImage.bufferSlice.call(dataView.buffer, offset, offset + length)],\r\n      {\r\n        type: 'image/jpeg'\r\n      }\r\n    )\r\n  }\r\n\r\n  var ExifTagTypes = {\r\n    // byte, 8-bit unsigned int:\r\n    1: {\r\n      getValue: function (dataView, dataOffset) {\r\n        return dataView.getUint8(dataOffset)\r\n      },\r\n      size: 1\r\n    },\r\n    // ascii, 8-bit byte:\r\n    2: {\r\n      getValue: function (dataView, dataOffset) {\r\n        return String.fromCharCode(dataView.getUint8(dataOffset))\r\n      },\r\n      size: 1,\r\n      ascii: true\r\n    },\r\n    // short, 16 bit int:\r\n    3: {\r\n      getValue: function (dataView, dataOffset, littleEndian) {\r\n        return dataView.getUint16(dataOffset, littleEndian)\r\n      },\r\n      size: 2\r\n    },\r\n    // long, 32 bit int:\r\n    4: {\r\n      getValue: function (dataView, dataOffset, littleEndian) {\r\n        return dataView.getUint32(dataOffset, littleEndian)\r\n      },\r\n      size: 4\r\n    },\r\n    // rational = two long values, first is numerator, second is denominator:\r\n    5: {\r\n      getValue: function (dataView, dataOffset, littleEndian) {\r\n        return (\r\n          dataView.getUint32(dataOffset, littleEndian) /\r\n          dataView.getUint32(dataOffset + 4, littleEndian)\r\n        )\r\n      },\r\n      size: 8\r\n    },\r\n    // slong, 32 bit signed int:\r\n    9: {\r\n      getValue: function (dataView, dataOffset, littleEndian) {\r\n        return dataView.getInt32(dataOffset, littleEndian)\r\n      },\r\n      size: 4\r\n    },\r\n    // srational, two slongs, first is numerator, second is denominator:\r\n    10: {\r\n      getValue: function (dataView, dataOffset, littleEndian) {\r\n        return (\r\n          dataView.getInt32(dataOffset, littleEndian) /\r\n          dataView.getInt32(dataOffset + 4, littleEndian)\r\n        )\r\n      },\r\n      size: 8\r\n    }\r\n  }\r\n  // undefined, 8-bit byte, value depending on field:\r\n  ExifTagTypes[7] = ExifTagTypes[1]\r\n\r\n  /**\r\n   * Returns Exif tag value.\r\n   *\r\n   * @param {DataView} dataView Data view interface\r\n   * @param {number} tiffOffset TIFF offset\r\n   * @param {number} offset Tag offset\r\n   * @param {number} type Tag type\r\n   * @param {number} length Tag length\r\n   * @param {boolean} littleEndian Little endian encoding\r\n   * @returns {object} Tag value\r\n   */\r\n  function getExifValue(\r\n    dataView,\r\n    tiffOffset,\r\n    offset,\r\n    type,\r\n    length,\r\n    littleEndian\r\n  ) {\r\n    var tagType = ExifTagTypes[type]\r\n    var tagSize\r\n    var dataOffset\r\n    var values\r\n    var i\r\n    var str\r\n    var c\r\n    if (!tagType) {\r\n      console.log('Invalid Exif data: Invalid tag type.')\r\n      return\r\n    }\r\n    tagSize = tagType.size * length\r\n    // Determine if the value is contained in the dataOffset bytes,\r\n    // or if the value at the dataOffset is a pointer to the actual data:\r\n    dataOffset =\r\n      tagSize > 4\r\n        ? tiffOffset + dataView.getUint32(offset + 8, littleEndian)\r\n        : offset + 8\r\n    if (dataOffset + tagSize > dataView.byteLength) {\r\n      console.log('Invalid Exif data: Invalid data offset.')\r\n      return\r\n    }\r\n    if (length === 1) {\r\n      return tagType.getValue(dataView, dataOffset, littleEndian)\r\n    }\r\n    values = []\r\n    for (i = 0; i < length; i += 1) {\r\n      values[i] = tagType.getValue(\r\n        dataView,\r\n        dataOffset + i * tagType.size,\r\n        littleEndian\r\n      )\r\n    }\r\n    if (tagType.ascii) {\r\n      str = ''\r\n      // Concatenate the chars:\r\n      for (i = 0; i < values.length; i += 1) {\r\n        c = values[i]\r\n        // Ignore the terminating NULL byte(s):\r\n        if (c === '\\u0000') {\r\n          break\r\n        }\r\n        str += c\r\n      }\r\n      return str\r\n    }\r\n    return values\r\n  }\r\n\r\n  /**\r\n   * Determines if the given tag should be included.\r\n   *\r\n   * @param {object} includeTags Map of tags to include\r\n   * @param {object} excludeTags Map of tags to exclude\r\n   * @param {number|string} tagCode Tag code to check\r\n   * @returns {boolean} True if the tag should be included\r\n   */\r\n  function shouldIncludeTag(includeTags, excludeTags, tagCode) {\r\n    return (\r\n      (!includeTags || includeTags[tagCode]) &&\r\n      (!excludeTags || excludeTags[tagCode] !== true)\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Parses Exif tags.\r\n   *\r\n   * @param {DataView} dataView Data view interface\r\n   * @param {number} tiffOffset TIFF offset\r\n   * @param {number} dirOffset Directory offset\r\n   * @param {boolean} littleEndian Little endian encoding\r\n   * @param {ExifMap} tags Map to store parsed exif tags\r\n   * @param {ExifMap} tagOffsets Map to store parsed exif tag offsets\r\n   * @param {object} includeTags Map of tags to include\r\n   * @param {object} excludeTags Map of tags to exclude\r\n   * @returns {number} Next directory offset\r\n   */\r\n  function parseExifTags(\r\n    dataView,\r\n    tiffOffset,\r\n    dirOffset,\r\n    littleEndian,\r\n    tags,\r\n    tagOffsets,\r\n    includeTags,\r\n    excludeTags\r\n  ) {\r\n    var tagsNumber, dirEndOffset, i, tagOffset, tagNumber, tagValue\r\n    if (dirOffset + 6 > dataView.byteLength) {\r\n      console.log('Invalid Exif data: Invalid directory offset.')\r\n      return\r\n    }\r\n    tagsNumber = dataView.getUint16(dirOffset, littleEndian)\r\n    dirEndOffset = dirOffset + 2 + 12 * tagsNumber\r\n    if (dirEndOffset + 4 > dataView.byteLength) {\r\n      console.log('Invalid Exif data: Invalid directory size.')\r\n      return\r\n    }\r\n    for (i = 0; i < tagsNumber; i += 1) {\r\n      tagOffset = dirOffset + 2 + 12 * i\r\n      tagNumber = dataView.getUint16(tagOffset, littleEndian)\r\n      if (!shouldIncludeTag(includeTags, excludeTags, tagNumber)) continue\r\n      tagValue = getExifValue(\r\n        dataView,\r\n        tiffOffset,\r\n        tagOffset,\r\n        dataView.getUint16(tagOffset + 2, littleEndian), // tag type\r\n        dataView.getUint32(tagOffset + 4, littleEndian), // tag length\r\n        littleEndian\r\n      )\r\n      tags[tagNumber] = tagValue\r\n      if (tagOffsets) {\r\n        tagOffsets[tagNumber] = tagOffset\r\n      }\r\n    }\r\n    // Return the offset to the next directory:\r\n    return dataView.getUint32(dirEndOffset, littleEndian)\r\n  }\r\n\r\n  /**\r\n   * Parses tags in a given IFD (Image File Directory).\r\n   *\r\n   * @param {object} data Data object to store exif tags and offsets\r\n   * @param {number|string} tagCode IFD tag code\r\n   * @param {DataView} dataView Data view interface\r\n   * @param {number} tiffOffset TIFF offset\r\n   * @param {boolean} littleEndian Little endian encoding\r\n   * @param {object} includeTags Map of tags to include\r\n   * @param {object} excludeTags Map of tags to exclude\r\n   */\r\n  function parseExifIFD(\r\n    data,\r\n    tagCode,\r\n    dataView,\r\n    tiffOffset,\r\n    littleEndian,\r\n    includeTags,\r\n    excludeTags\r\n  ) {\r\n    var dirOffset = data.exif[tagCode]\r\n    if (dirOffset) {\r\n      data.exif[tagCode] = new ExifMap(tagCode)\r\n      if (data.exifOffsets) {\r\n        data.exifOffsets[tagCode] = new ExifMap(tagCode)\r\n      }\r\n      parseExifTags(\r\n        dataView,\r\n        tiffOffset,\r\n        tiffOffset + dirOffset,\r\n        littleEndian,\r\n        data.exif[tagCode],\r\n        data.exifOffsets && data.exifOffsets[tagCode],\r\n        includeTags && includeTags[tagCode],\r\n        excludeTags && excludeTags[tagCode]\r\n      )\r\n    }\r\n  }\r\n\r\n  loadImage.parseExifData = function (dataView, offset, length, data, options) {\r\n    if (options.disableExif) {\r\n      return\r\n    }\r\n    var includeTags = options.includeExifTags\r\n    var excludeTags = options.excludeExifTags || {\r\n      0x8769: {\r\n        // ExifIFDPointer\r\n        0x927c: true // MakerNote\r\n      }\r\n    }\r\n    var tiffOffset = offset + 10\r\n    var littleEndian\r\n    var dirOffset\r\n    var thumbnailIFD\r\n    // Check for the ASCII code for \"Exif\" (0x45786966):\r\n    if (dataView.getUint32(offset + 4) !== 0x45786966) {\r\n      // No Exif data, might be XMP data instead\r\n      return\r\n    }\r\n    if (tiffOffset + 8 > dataView.byteLength) {\r\n      console.log('Invalid Exif data: Invalid segment size.')\r\n      return\r\n    }\r\n    // Check for the two null bytes:\r\n    if (dataView.getUint16(offset + 8) !== 0x0000) {\r\n      console.log('Invalid Exif data: Missing byte alignment offset.')\r\n      return\r\n    }\r\n    // Check the byte alignment:\r\n    switch (dataView.getUint16(tiffOffset)) {\r\n      case 0x4949:\r\n        littleEndian = true\r\n        break\r\n      case 0x4d4d:\r\n        littleEndian = false\r\n        break\r\n      default:\r\n        console.log('Invalid Exif data: Invalid byte alignment marker.')\r\n        return\r\n    }\r\n    // Check for the TIFF tag marker (0x002A):\r\n    if (dataView.getUint16(tiffOffset + 2, littleEndian) !== 0x002a) {\r\n      console.log('Invalid Exif data: Missing TIFF marker.')\r\n      return\r\n    }\r\n    // Retrieve the directory offset bytes, usually 0x00000008 or 8 decimal:\r\n    dirOffset = dataView.getUint32(tiffOffset + 4, littleEndian)\r\n    // Create the exif object to store the tags:\r\n    data.exif = new ExifMap()\r\n    if (!options.disableExifOffsets) {\r\n      data.exifOffsets = new ExifMap()\r\n      data.exifTiffOffset = tiffOffset\r\n      data.exifLittleEndian = littleEndian\r\n    }\r\n    // Parse the tags of the main image directory (IFD0) and retrieve the\r\n    // offset to the next directory (IFD1), usually the thumbnail directory:\r\n    dirOffset = parseExifTags(\r\n      dataView,\r\n      tiffOffset,\r\n      tiffOffset + dirOffset,\r\n      littleEndian,\r\n      data.exif,\r\n      data.exifOffsets,\r\n      includeTags,\r\n      excludeTags\r\n    )\r\n    if (dirOffset && shouldIncludeTag(includeTags, excludeTags, 'ifd1')) {\r\n      data.exif.ifd1 = dirOffset\r\n      if (data.exifOffsets) {\r\n        data.exifOffsets.ifd1 = tiffOffset + dirOffset\r\n      }\r\n    }\r\n    Object.keys(data.exif.ifds).forEach(function (tagCode) {\r\n      parseExifIFD(\r\n        data,\r\n        tagCode,\r\n        dataView,\r\n        tiffOffset,\r\n        littleEndian,\r\n        includeTags,\r\n        excludeTags\r\n      )\r\n    })\r\n    thumbnailIFD = data.exif.ifd1\r\n    // Check for JPEG Thumbnail offset and data length:\r\n    if (thumbnailIFD && thumbnailIFD[0x0201]) {\r\n      thumbnailIFD[0x0201] = getExifThumbnail(\r\n        dataView,\r\n        tiffOffset + thumbnailIFD[0x0201],\r\n        thumbnailIFD[0x0202] // Thumbnail data length\r\n      )\r\n    }\r\n  }\r\n\r\n  // Registers the Exif parser for the APP1 JPEG metadata segment:\r\n  loadImage.metaDataParsers.jpeg[0xffe1].push(loadImage.parseExifData)\r\n\r\n  loadImage.exifWriters = {\r\n    // Orientation writer:\r\n    0x0112: function (buffer, data, value) {\r\n      var orientationOffset = data.exifOffsets[0x0112]\r\n      if (!orientationOffset) return buffer\r\n      var view = new DataView(buffer, orientationOffset + 8, 2)\r\n      view.setUint16(0, value, data.exifLittleEndian)\r\n      return buffer\r\n    }\r\n  }\r\n\r\n  loadImage.writeExifData = function (buffer, data, id, value) {\r\n    loadImage.exifWriters[data.exif.map[id]](buffer, data, value)\r\n  }\r\n\r\n  loadImage.ExifMap = ExifMap\r\n\r\n  // Adds the following properties to the parseMetaData callback data:\r\n  // - exif: The parsed Exif tags\r\n  // - exifOffsets: The parsed Exif tag offsets\r\n  // - exifTiffOffset: TIFF header offset (used for offset pointers)\r\n  // - exifLittleEndian: little endian order if true, big endian if false\r\n\r\n  // Adds the following options to the parseMetaData method:\r\n  // - disableExif: Disables Exif parsing when true.\r\n  // - disableExifOffsets: Disables storing Exif tag offsets when true.\r\n  // - includeExifTags: A map of Exif tags to include for parsing.\r\n  // - excludeExifTags: A map of Exif tags to exclude from parsing.\r\n})\r\n","jquery/fileUploader/vendor/blueimp-load-image/js/load-image-fetch.js":"/*\r\n * JavaScript Load Image Fetch\r\n * https://github.com/blueimp/JavaScript-Load-Image\r\n *\r\n * Copyright 2017, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n */\r\n\r\n/* global define, module, require, Promise */\r\n\r\n;(function (factory) {\r\n  'use strict'\r\n  if (typeof define === 'function' && define.amd) {\r\n    // Register as an anonymous AMD module:\r\n    define(['jquery/fileUploader/vendor/blueimp-load-image/js/load-image'], factory)\r\n  } else if (typeof module === 'object' && module.exports) {\r\n    factory(require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image'))\r\n  } else {\r\n    // Browser globals:\r\n    factory(window.loadImage)\r\n  }\r\n})(function (loadImage) {\r\n  'use strict'\r\n\r\n  var global = loadImage.global\r\n\r\n  if (\r\n    global.fetch &&\r\n    global.Request &&\r\n    global.Response &&\r\n    global.Response.prototype.blob\r\n  ) {\r\n    loadImage.fetchBlob = function (url, callback, options) {\r\n      /**\r\n       * Fetch response handler.\r\n       *\r\n       * @param {Response} response Fetch response\r\n       * @returns {Blob} Fetched Blob.\r\n       */\r\n      function responseHandler(response) {\r\n        return response.blob()\r\n      }\r\n      if (global.Promise && typeof callback !== 'function') {\r\n        return fetch(new Request(url, callback)).then(responseHandler)\r\n      }\r\n      fetch(new Request(url, options))\r\n        .then(responseHandler)\r\n        .then(callback)\r\n        [\r\n          // Avoid parsing error in IE<9, where catch is a reserved word.\r\n          // eslint-disable-next-line dot-notation\r\n          'catch'\r\n        ](function (err) {\r\n          callback(null, err)\r\n        })\r\n    }\r\n  } else if (\r\n    global.XMLHttpRequest &&\r\n    // https://xhr.spec.whatwg.org/#the-responsetype-attribute\r\n    new XMLHttpRequest().responseType === ''\r\n  ) {\r\n    loadImage.fetchBlob = function (url, callback, options) {\r\n      /**\r\n       * Promise executor\r\n       *\r\n       * @param {Function} resolve Resolution function\r\n       * @param {Function} reject Rejection function\r\n       */\r\n      function executor(resolve, reject) {\r\n        options = options || {} // eslint-disable-line no-param-reassign\r\n        var req = new XMLHttpRequest()\r\n        req.open(options.method || 'GET', url)\r\n        if (options.headers) {\r\n          Object.keys(options.headers).forEach(function (key) {\r\n            req.setRequestHeader(key, options.headers[key])\r\n          })\r\n        }\r\n        req.withCredentials = options.credentials === 'include'\r\n        req.responseType = 'blob'\r\n        req.onload = function () {\r\n          resolve(req.response)\r\n        }\r\n        req.onerror = req.onabort = req.ontimeout = function (err) {\r\n          if (resolve === reject) {\r\n            // Not using Promises\r\n            reject(null, err)\r\n          } else {\r\n            reject(err)\r\n          }\r\n        }\r\n        req.send(options.body)\r\n      }\r\n      if (global.Promise && typeof callback !== 'function') {\r\n        options = callback // eslint-disable-line no-param-reassign\r\n        return new Promise(executor)\r\n      }\r\n      return executor(callback, callback)\r\n    }\r\n  }\r\n})\r\n","jquery/fileUploader/vendor/blueimp-load-image/js/load-image-iptc-map.js":"/*\r\n * JavaScript Load Image IPTC Map\r\n * https://github.com/blueimp/JavaScript-Load-Image\r\n *\r\n * Copyright 2013, Sebastian Tschan\r\n * Copyright 2018, Dave Bevan\r\n *\r\n * IPTC tags mapping based on\r\n * https://iptc.org/standards/photo-metadata\r\n * https://exiftool.org/TagNames/IPTC.html\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n */\r\n\r\n/* global define, module, require */\r\n\r\n;(function (factory) {\r\n  'use strict'\r\n  if (typeof define === 'function' && define.amd) {\r\n    // Register as an anonymous AMD module:\r\n    define(['jquery/fileUploader/vendor/blueimp-load-image/js/load-image', 'jquery/fileUploader/vendor/blueimp-load-image/js/load-image-iptc'], factory)\r\n  } else if (typeof module === 'object' && module.exports) {\r\n    factory(require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image'), require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-iptc'))\r\n  } else {\r\n    // Browser globals:\r\n    factory(window.loadImage)\r\n  }\r\n})(function (loadImage) {\r\n  'use strict'\r\n\r\n  var IptcMapProto = loadImage.IptcMap.prototype\r\n\r\n  IptcMapProto.tags = {\r\n    0: 'ApplicationRecordVersion',\r\n    3: 'ObjectTypeReference',\r\n    4: 'ObjectAttributeReference',\r\n    5: 'ObjectName',\r\n    7: 'EditStatus',\r\n    8: 'EditorialUpdate',\r\n    10: 'Urgency',\r\n    12: 'SubjectReference',\r\n    15: 'Category',\r\n    20: 'SupplementalCategories',\r\n    22: 'FixtureIdentifier',\r\n    25: 'Keywords',\r\n    26: 'ContentLocationCode',\r\n    27: 'ContentLocationName',\r\n    30: 'ReleaseDate',\r\n    35: 'ReleaseTime',\r\n    37: 'ExpirationDate',\r\n    38: 'ExpirationTime',\r\n    40: 'SpecialInstructions',\r\n    42: 'ActionAdvised',\r\n    45: 'ReferenceService',\r\n    47: 'ReferenceDate',\r\n    50: 'ReferenceNumber',\r\n    55: 'DateCreated',\r\n    60: 'TimeCreated',\r\n    62: 'DigitalCreationDate',\r\n    63: 'DigitalCreationTime',\r\n    65: 'OriginatingProgram',\r\n    70: 'ProgramVersion',\r\n    75: 'ObjectCycle',\r\n    80: 'Byline',\r\n    85: 'BylineTitle',\r\n    90: 'City',\r\n    92: 'Sublocation',\r\n    95: 'State',\r\n    100: 'CountryCode',\r\n    101: 'Country',\r\n    103: 'OriginalTransmissionReference',\r\n    105: 'Headline',\r\n    110: 'Credit',\r\n    115: 'Source',\r\n    116: 'CopyrightNotice',\r\n    118: 'Contact',\r\n    120: 'Caption',\r\n    121: 'LocalCaption',\r\n    122: 'Writer',\r\n    125: 'RasterizedCaption',\r\n    130: 'ImageType',\r\n    131: 'ImageOrientation',\r\n    135: 'LanguageIdentifier',\r\n    150: 'AudioType',\r\n    151: 'AudioSamplingRate',\r\n    152: 'AudioSamplingResolution',\r\n    153: 'AudioDuration',\r\n    154: 'AudioOutcue',\r\n    184: 'JobID',\r\n    185: 'MasterDocumentID',\r\n    186: 'ShortDocumentID',\r\n    187: 'UniqueDocumentID',\r\n    188: 'OwnerID',\r\n    200: 'ObjectPreviewFileFormat',\r\n    201: 'ObjectPreviewFileVersion',\r\n    202: 'ObjectPreviewData',\r\n    221: 'Prefs',\r\n    225: 'ClassifyState',\r\n    228: 'SimilarityIndex',\r\n    230: 'DocumentNotes',\r\n    231: 'DocumentHistory',\r\n    232: 'ExifCameraInfo',\r\n    255: 'CatalogSets'\r\n  }\r\n\r\n  IptcMapProto.stringValues = {\r\n    10: {\r\n      0: '0 (reserved)',\r\n      1: '1 (most urgent)',\r\n      2: '2',\r\n      3: '3',\r\n      4: '4',\r\n      5: '5 (normal urgency)',\r\n      6: '6',\r\n      7: '7',\r\n      8: '8 (least urgent)',\r\n      9: '9 (user-defined priority)'\r\n    },\r\n    75: {\r\n      a: 'Morning',\r\n      b: 'Both Morning and Evening',\r\n      p: 'Evening'\r\n    },\r\n    131: {\r\n      L: 'Landscape',\r\n      P: 'Portrait',\r\n      S: 'Square'\r\n    }\r\n  }\r\n\r\n  IptcMapProto.getText = function (id) {\r\n    var value = this.get(id)\r\n    var tagCode = this.map[id]\r\n    var stringValue = this.stringValues[tagCode]\r\n    if (stringValue) return stringValue[value]\r\n    return String(value)\r\n  }\r\n\r\n  IptcMapProto.getAll = function () {\r\n    var map = {}\r\n    var prop\r\n    var name\r\n    for (prop in this) {\r\n      if (Object.prototype.hasOwnProperty.call(this, prop)) {\r\n        name = this.tags[prop]\r\n        if (name) map[name] = this.getText(name)\r\n      }\r\n    }\r\n    return map\r\n  }\r\n\r\n  IptcMapProto.getName = function (tagCode) {\r\n    return this.tags[tagCode]\r\n  }\r\n\r\n  // Extend the map of tag names to tag codes:\r\n  ;(function () {\r\n    var tags = IptcMapProto.tags\r\n    var map = IptcMapProto.map || {}\r\n    var prop\r\n    // Map the tag names to tags:\r\n    for (prop in tags) {\r\n      if (Object.prototype.hasOwnProperty.call(tags, prop)) {\r\n        map[tags[prop]] = Number(prop)\r\n      }\r\n    }\r\n  })()\r\n})\r\n","jquery/fileUploader/vendor/blueimp-load-image/js/load-image-iptc.js":"/*\r\n * JavaScript Load Image IPTC Parser\r\n * https://github.com/blueimp/JavaScript-Load-Image\r\n *\r\n * Copyright 2013, Sebastian Tschan\r\n * Copyright 2018, Dave Bevan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n */\r\n\r\n/* global define, module, require, DataView */\r\n\r\n;(function (factory) {\r\n  'use strict'\r\n  if (typeof define === 'function' && define.amd) {\r\n    // Register as an anonymous AMD module:\r\n    define(['jquery/fileUploader/vendor/blueimp-load-image/js/load-image', 'jquery/fileUploader/vendor/blueimp-load-image/js/load-image-meta'], factory)\r\n  } else if (typeof module === 'object' && module.exports) {\r\n    factory(require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image'), require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-meta'))\r\n  } else {\r\n    // Browser globals:\r\n    factory(window.loadImage)\r\n  }\r\n})(function (loadImage) {\r\n  'use strict'\r\n\r\n  /**\r\n   * IPTC tag map\r\n   *\r\n   * @name IptcMap\r\n   * @class\r\n   */\r\n  function IptcMap() {}\r\n\r\n  IptcMap.prototype.map = {\r\n    ObjectName: 5\r\n  }\r\n\r\n  IptcMap.prototype.types = {\r\n    0: 'Uint16', // ApplicationRecordVersion\r\n    200: 'Uint16', // ObjectPreviewFileFormat\r\n    201: 'Uint16', // ObjectPreviewFileVersion\r\n    202: 'binary' // ObjectPreviewData\r\n  }\r\n\r\n  /**\r\n   * Retrieves IPTC tag value\r\n   *\r\n   * @param {number|string} id IPTC tag code or name\r\n   * @returns {object} IPTC tag value\r\n   */\r\n  IptcMap.prototype.get = function (id) {\r\n    return this[id] || this[this.map[id]]\r\n  }\r\n\r\n  /**\r\n   * Retrieves string for the given DataView and range\r\n   *\r\n   * @param {DataView} dataView Data view interface\r\n   * @param {number} offset Offset start\r\n   * @param {number} length Offset length\r\n   * @returns {string} String value\r\n   */\r\n  function getStringValue(dataView, offset, length) {\r\n    var outstr = ''\r\n    var end = offset + length\r\n    for (var n = offset; n < end; n += 1) {\r\n      outstr += String.fromCharCode(dataView.getUint8(n))\r\n    }\r\n    return outstr\r\n  }\r\n\r\n  /**\r\n   * Retrieves tag value for the given DataView and range\r\n   *\r\n   * @param {number} tagCode tag code\r\n   * @param {IptcMap} map IPTC tag map\r\n   * @param {DataView} dataView Data view interface\r\n   * @param {number} offset Range start\r\n   * @param {number} length Range length\r\n   * @returns {object} Tag value\r\n   */\r\n  function getTagValue(tagCode, map, dataView, offset, length) {\r\n    if (map.types[tagCode] === 'binary') {\r\n      return new Blob([dataView.buffer.slice(offset, offset + length)])\r\n    }\r\n    if (map.types[tagCode] === 'Uint16') {\r\n      return dataView.getUint16(offset)\r\n    }\r\n    return getStringValue(dataView, offset, length)\r\n  }\r\n\r\n  /**\r\n   * Combines IPTC value with existing ones.\r\n   *\r\n   * @param {object} value Existing IPTC field value\r\n   * @param {object} newValue New IPTC field value\r\n   * @returns {object} Resulting IPTC field value\r\n   */\r\n  function combineTagValues(value, newValue) {\r\n    if (value === undefined) return newValue\r\n    if (value instanceof Array) {\r\n      value.push(newValue)\r\n      return value\r\n    }\r\n    return [value, newValue]\r\n  }\r\n\r\n  /**\r\n   * Parses IPTC tags.\r\n   *\r\n   * @param {DataView} dataView Data view interface\r\n   * @param {number} segmentOffset Segment offset\r\n   * @param {number} segmentLength Segment length\r\n   * @param {object} data Data export object\r\n   * @param {object} includeTags Map of tags to include\r\n   * @param {object} excludeTags Map of tags to exclude\r\n   */\r\n  function parseIptcTags(\r\n    dataView,\r\n    segmentOffset,\r\n    segmentLength,\r\n    data,\r\n    includeTags,\r\n    excludeTags\r\n  ) {\r\n    var value, tagSize, tagCode\r\n    var segmentEnd = segmentOffset + segmentLength\r\n    var offset = segmentOffset\r\n    while (offset < segmentEnd) {\r\n      if (\r\n        dataView.getUint8(offset) === 0x1c && // tag marker\r\n        dataView.getUint8(offset + 1) === 0x02 // record number, only handles v2\r\n      ) {\r\n        tagCode = dataView.getUint8(offset + 2)\r\n        if (\r\n          (!includeTags || includeTags[tagCode]) &&\r\n          (!excludeTags || !excludeTags[tagCode])\r\n        ) {\r\n          tagSize = dataView.getInt16(offset + 3)\r\n          value = getTagValue(tagCode, data.iptc, dataView, offset + 5, tagSize)\r\n          data.iptc[tagCode] = combineTagValues(data.iptc[tagCode], value)\r\n          if (data.iptcOffsets) {\r\n            data.iptcOffsets[tagCode] = offset\r\n          }\r\n        }\r\n      }\r\n      offset += 1\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Tests if field segment starts at offset.\r\n   *\r\n   * @param {DataView} dataView Data view interface\r\n   * @param {number} offset Segment offset\r\n   * @returns {boolean} True if '8BIM<EOT><EOT>' exists at offset\r\n   */\r\n  function isSegmentStart(dataView, offset) {\r\n    return (\r\n      dataView.getUint32(offset) === 0x3842494d && // Photoshop segment start\r\n      dataView.getUint16(offset + 4) === 0x0404 // IPTC segment start\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Returns header length.\r\n   *\r\n   * @param {DataView} dataView Data view interface\r\n   * @param {number} offset Segment offset\r\n   * @returns {number} Header length\r\n   */\r\n  function getHeaderLength(dataView, offset) {\r\n    var length = dataView.getUint8(offset + 7)\r\n    if (length % 2 !== 0) length += 1\r\n    // Check for pre photoshop 6 format\r\n    if (length === 0) {\r\n      // Always 4\r\n      length = 4\r\n    }\r\n    return length\r\n  }\r\n\r\n  loadImage.parseIptcData = function (dataView, offset, length, data, options) {\r\n    if (options.disableIptc) {\r\n      return\r\n    }\r\n    var markerLength = offset + length\r\n    while (offset + 8 < markerLength) {\r\n      if (isSegmentStart(dataView, offset)) {\r\n        var headerLength = getHeaderLength(dataView, offset)\r\n        var segmentOffset = offset + 8 + headerLength\r\n        if (segmentOffset > markerLength) {\r\n          // eslint-disable-next-line no-console\r\n          console.log('Invalid IPTC data: Invalid segment offset.')\r\n          break\r\n        }\r\n        var segmentLength = dataView.getUint16(offset + 6 + headerLength)\r\n        if (offset + segmentLength > markerLength) {\r\n          // eslint-disable-next-line no-console\r\n          console.log('Invalid IPTC data: Invalid segment size.')\r\n          break\r\n        }\r\n        // Create the iptc object to store the tags:\r\n        data.iptc = new IptcMap()\r\n        if (!options.disableIptcOffsets) {\r\n          data.iptcOffsets = new IptcMap()\r\n        }\r\n        parseIptcTags(\r\n          dataView,\r\n          segmentOffset,\r\n          segmentLength,\r\n          data,\r\n          options.includeIptcTags,\r\n          options.excludeIptcTags || { 202: true } // ObjectPreviewData\r\n        )\r\n        return\r\n      }\r\n      // eslint-disable-next-line no-param-reassign\r\n      offset += 1\r\n    }\r\n  }\r\n\r\n  // Registers this IPTC parser for the APP13 JPEG metadata segment:\r\n  loadImage.metaDataParsers.jpeg[0xffed].push(loadImage.parseIptcData)\r\n\r\n  loadImage.IptcMap = IptcMap\r\n\r\n  // Adds the following properties to the parseMetaData callback data:\r\n  // - iptc: The iptc tags, parsed by the parseIptcData method\r\n\r\n  // Adds the following options to the parseMetaData method:\r\n  // - disableIptc: Disables IPTC parsing when true.\r\n  // - disableIptcOffsets: Disables storing IPTC tag offsets when true.\r\n  // - includeIptcTags: A map of IPTC tags to include for parsing.\r\n  // - excludeIptcTags: A map of IPTC tags to exclude from parsing.\r\n})\r\n","jquery/fileUploader/vendor/blueimp-load-image/js/load-image-meta.js":"/*\r\n * JavaScript Load Image Meta\r\n * https://github.com/blueimp/JavaScript-Load-Image\r\n *\r\n * Copyright 2013, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Image metadata handling implementation\r\n * based on the help and contribution of\r\n * Achim St\u00f6hr.\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n */\r\n\r\n/* global define, module, require, Promise, DataView, Uint8Array, ArrayBuffer */\r\n\r\n;(function (factory) {\r\n  'use strict'\r\n  if (typeof define === 'function' && define.amd) {\r\n    // Register as an anonymous AMD module:\r\n    define(['jquery/fileUploader/vendor/blueimp-load-image/js/load-image'], factory)\r\n  } else if (typeof module === 'object' && module.exports) {\r\n    factory(require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image'))\r\n  } else {\r\n    // Browser globals:\r\n    factory(window.loadImage)\r\n  }\r\n})(function (loadImage) {\r\n  'use strict'\r\n\r\n  var global = loadImage.global\r\n  var originalTransform = loadImage.transform\r\n\r\n  var blobSlice =\r\n    global.Blob &&\r\n    (Blob.prototype.slice ||\r\n      Blob.prototype.webkitSlice ||\r\n      Blob.prototype.mozSlice)\r\n\r\n  var bufferSlice =\r\n    (global.ArrayBuffer && ArrayBuffer.prototype.slice) ||\r\n    function (begin, end) {\r\n      // Polyfill for IE10, which does not support ArrayBuffer.slice\r\n      // eslint-disable-next-line no-param-reassign\r\n      end = end || this.byteLength - begin\r\n      var arr1 = new Uint8Array(this, begin, end)\r\n      var arr2 = new Uint8Array(end)\r\n      arr2.set(arr1)\r\n      return arr2.buffer\r\n    }\r\n\r\n  var metaDataParsers = {\r\n    jpeg: {\r\n      0xffe1: [], // APP1 marker\r\n      0xffed: [] // APP13 marker\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Parses image metadata and calls the callback with an object argument\r\n   * with the following property:\r\n   * - imageHead: The complete image head as ArrayBuffer\r\n   * The options argument accepts an object and supports the following\r\n   * properties:\r\n   * - maxMetaDataSize: Defines the maximum number of bytes to parse.\r\n   * - disableImageHead: Disables creating the imageHead property.\r\n   *\r\n   * @param {Blob} file Blob object\r\n   * @param {Function} [callback] Callback function\r\n   * @param {object} [options] Parsing options\r\n   * @param {object} [data] Result data object\r\n   * @returns {Promise<object>|undefined} Returns Promise if no callback given.\r\n   */\r\n  function parseMetaData(file, callback, options, data) {\r\n    var that = this\r\n    /**\r\n     * Promise executor\r\n     *\r\n     * @param {Function} resolve Resolution function\r\n     * @param {Function} reject Rejection function\r\n     * @returns {undefined} Undefined\r\n     */\r\n    function executor(resolve, reject) {\r\n      if (\r\n        !(\r\n          global.DataView &&\r\n          blobSlice &&\r\n          file &&\r\n          file.size >= 12 &&\r\n          file.type === 'image/jpeg'\r\n        )\r\n      ) {\r\n        // Nothing to parse\r\n        return resolve(data)\r\n      }\r\n      // 256 KiB should contain all EXIF/ICC/IPTC segments:\r\n      var maxMetaDataSize = options.maxMetaDataSize || 262144\r\n      if (\r\n        !loadImage.readFile(\r\n          blobSlice.call(file, 0, maxMetaDataSize),\r\n          function (buffer) {\r\n            // Note on endianness:\r\n            // Since the marker and length bytes in JPEG files are always\r\n            // stored in big endian order, we can leave the endian parameter\r\n            // of the DataView methods undefined, defaulting to big endian.\r\n            var dataView = new DataView(buffer)\r\n            // Check for the JPEG marker (0xffd8):\r\n            if (dataView.getUint16(0) !== 0xffd8) {\r\n              return reject(\r\n                new Error('Invalid JPEG file: Missing JPEG marker.')\r\n              )\r\n            }\r\n            var offset = 2\r\n            var maxOffset = dataView.byteLength - 4\r\n            var headLength = offset\r\n            var markerBytes\r\n            var markerLength\r\n            var parsers\r\n            var i\r\n            while (offset < maxOffset) {\r\n              markerBytes = dataView.getUint16(offset)\r\n              // Search for APPn (0xffeN) and COM (0xfffe) markers,\r\n              // which contain application-specific metadata like\r\n              // Exif, ICC and IPTC data and text comments:\r\n              if (\r\n                (markerBytes >= 0xffe0 && markerBytes <= 0xffef) ||\r\n                markerBytes === 0xfffe\r\n              ) {\r\n                // The marker bytes (2) are always followed by\r\n                // the length bytes (2), indicating the length of the\r\n                // marker segment, which includes the length bytes,\r\n                // but not the marker bytes, so we add 2:\r\n                markerLength = dataView.getUint16(offset + 2) + 2\r\n                if (offset + markerLength > dataView.byteLength) {\r\n                  // eslint-disable-next-line no-console\r\n                  console.log('Invalid JPEG metadata: Invalid segment size.')\r\n                  break\r\n                }\r\n                parsers = metaDataParsers.jpeg[markerBytes]\r\n                if (parsers && !options.disableMetaDataParsers) {\r\n                  for (i = 0; i < parsers.length; i += 1) {\r\n                    parsers[i].call(\r\n                      that,\r\n                      dataView,\r\n                      offset,\r\n                      markerLength,\r\n                      data,\r\n                      options\r\n                    )\r\n                  }\r\n                }\r\n                offset += markerLength\r\n                headLength = offset\r\n              } else {\r\n                // Not an APPn or COM marker, probably safe to\r\n                // assume that this is the end of the metadata\r\n                break\r\n              }\r\n            }\r\n            // Meta length must be longer than JPEG marker (2)\r\n            // plus APPn marker (2), followed by length bytes (2):\r\n            if (!options.disableImageHead && headLength > 6) {\r\n              data.imageHead = bufferSlice.call(buffer, 0, headLength)\r\n            }\r\n            resolve(data)\r\n          },\r\n          reject,\r\n          'readAsArrayBuffer'\r\n        )\r\n      ) {\r\n        // No support for the FileReader interface, nothing to parse\r\n        resolve(data)\r\n      }\r\n    }\r\n    options = options || {} // eslint-disable-line no-param-reassign\r\n    if (global.Promise && typeof callback !== 'function') {\r\n      options = callback || {} // eslint-disable-line no-param-reassign\r\n      data = options // eslint-disable-line no-param-reassign\r\n      return new Promise(executor)\r\n    }\r\n    data = data || {} // eslint-disable-line no-param-reassign\r\n    return executor(callback, callback)\r\n  }\r\n\r\n  /**\r\n   * Replaces the head of a JPEG Blob\r\n   *\r\n   * @param {Blob} blob Blob object\r\n   * @param {ArrayBuffer} oldHead Old JPEG head\r\n   * @param {ArrayBuffer} newHead New JPEG head\r\n   * @returns {Blob} Combined Blob\r\n   */\r\n  function replaceJPEGHead(blob, oldHead, newHead) {\r\n    if (!blob || !oldHead || !newHead) return null\r\n    return new Blob([newHead, blobSlice.call(blob, oldHead.byteLength)], {\r\n      type: 'image/jpeg'\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Replaces the image head of a JPEG blob with the given one.\r\n   * Returns a Promise or calls the callback with the new Blob.\r\n   *\r\n   * @param {Blob} blob Blob object\r\n   * @param {ArrayBuffer} head New JPEG head\r\n   * @param {Function} [callback] Callback function\r\n   * @returns {Promise<Blob|null>|undefined} Combined Blob\r\n   */\r\n  function replaceHead(blob, head, callback) {\r\n    var options = { maxMetaDataSize: 256, disableMetaDataParsers: true }\r\n    if (!callback && global.Promise) {\r\n      return parseMetaData(blob, options).then(function (data) {\r\n        return replaceJPEGHead(blob, data.imageHead, head)\r\n      })\r\n    }\r\n    parseMetaData(\r\n      blob,\r\n      function (data) {\r\n        callback(replaceJPEGHead(blob, data.imageHead, head))\r\n      },\r\n      options\r\n    )\r\n  }\r\n\r\n  loadImage.transform = function (img, options, callback, file, data) {\r\n    if (loadImage.requiresMetaData(options)) {\r\n      data = data || {} // eslint-disable-line no-param-reassign\r\n      parseMetaData(\r\n        file,\r\n        function (result) {\r\n          if (result !== data) {\r\n            // eslint-disable-next-line no-console\r\n            if (global.console) console.log(result)\r\n            result = data // eslint-disable-line no-param-reassign\r\n          }\r\n          originalTransform.call(\r\n            loadImage,\r\n            img,\r\n            options,\r\n            callback,\r\n            file,\r\n            result\r\n          )\r\n        },\r\n        options,\r\n        data\r\n      )\r\n    } else {\r\n      originalTransform.apply(loadImage, arguments)\r\n    }\r\n  }\r\n\r\n  loadImage.blobSlice = blobSlice\r\n  loadImage.bufferSlice = bufferSlice\r\n  loadImage.replaceHead = replaceHead\r\n  loadImage.parseMetaData = parseMetaData\r\n  loadImage.metaDataParsers = metaDataParsers\r\n})\r\n","jquery/fileUploader/vendor/blueimp-load-image/js/load-image-orientation.js":"/*\r\n * JavaScript Load Image Orientation\r\n * https://github.com/blueimp/JavaScript-Load-Image\r\n *\r\n * Copyright 2013, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n */\r\n\r\n/*\r\nExif orientation values to correctly display the letter F:\r\n\r\n    1             2\r\n  \u2588\u2588\u2588\u2588\u2588\u2588        \u2588\u2588\u2588\u2588\u2588\u2588\r\n  \u2588\u2588                \u2588\u2588\r\n  \u2588\u2588\u2588\u2588            \u2588\u2588\u2588\u2588\r\n  \u2588\u2588                \u2588\u2588\r\n  \u2588\u2588                \u2588\u2588\r\n\r\n    3             4\r\n      \u2588\u2588        \u2588\u2588\r\n      \u2588\u2588        \u2588\u2588\r\n    \u2588\u2588\u2588\u2588        \u2588\u2588\u2588\u2588\r\n      \u2588\u2588        \u2588\u2588\r\n  \u2588\u2588\u2588\u2588\u2588\u2588        \u2588\u2588\u2588\u2588\u2588\u2588\r\n\r\n    5             6\r\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588    \u2588\u2588\r\n\u2588\u2588  \u2588\u2588        \u2588\u2588  \u2588\u2588\r\n\u2588\u2588            \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\r\n\r\n    7             8\r\n        \u2588\u2588    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\r\n    \u2588\u2588  \u2588\u2588        \u2588\u2588  \u2588\u2588\r\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588            \u2588\u2588\r\n\r\n*/\r\n\r\n/* global define, module, require */\r\n\r\n;(function (factory) {\r\n  'use strict'\r\n  if (typeof define === 'function' && define.amd) {\r\n    // Register as an anonymous AMD module:\r\n    define(['jquery/fileUploader/vendor/blueimp-load-image/js/load-image', 'jquery/fileUploader/vendor/blueimp-load-image/js/load-image-scale', 'jquery/fileUploader/vendor/blueimp-load-image/js/load-image-meta'], factory)\r\n  } else if (typeof module === 'object' && module.exports) {\r\n    factory(\r\n      require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image'),\r\n      require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-scale'),\r\n      require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-meta')\r\n    )\r\n  } else {\r\n    // Browser globals:\r\n    factory(window.loadImage)\r\n  }\r\n})(function (loadImage) {\r\n  'use strict'\r\n\r\n  var originalTransform = loadImage.transform\r\n  var originalRequiresCanvas = loadImage.requiresCanvas\r\n  var originalRequiresMetaData = loadImage.requiresMetaData\r\n  var originalTransformCoordinates = loadImage.transformCoordinates\r\n  var originalGetTransformedOptions = loadImage.getTransformedOptions\r\n\r\n  ;(function ($) {\r\n    // Guard for non-browser environments (e.g. server-side rendering):\r\n    if (!$.global.document) return\r\n    // black+white 3x2 JPEG, with the following meta information set:\r\n    // - EXIF Orientation: 6 (Rotated 90\u00b0 CCW)\r\n    // Image data layout (B=black, F=white):\r\n    // BFF\r\n    // BBB\r\n    var testImageURL =\r\n      'data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAA' +\r\n      'AAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBA' +\r\n      'QEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQE' +\r\n      'BAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAIAAwMBEQACEQEDEQH/x' +\r\n      'ABRAAEAAAAAAAAAAAAAAAAAAAAKEAEBAQADAQEAAAAAAAAAAAAGBQQDCAkCBwEBAAAAAAA' +\r\n      'AAAAAAAAAAAAAABEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8AG8T9NfSMEVMhQ' +\r\n      'voP3fFiRZ+MTHDifa/95OFSZU5OzRzxkyejv8ciEfhSceSXGjS8eSdLnZc2HDm4M3BxcXw' +\r\n      'H/9k='\r\n    var img = document.createElement('img')\r\n    img.onload = function () {\r\n      // Check if the browser supports automatic image orientation:\r\n      $.orientation = img.width === 2 && img.height === 3\r\n      if ($.orientation) {\r\n        var canvas = $.createCanvas(1, 1, true)\r\n        var ctx = canvas.getContext('2d')\r\n        ctx.drawImage(img, 1, 1, 1, 1, 0, 0, 1, 1)\r\n        // Check if the source image coordinates (sX, sY, sWidth, sHeight) are\r\n        // correctly applied to the auto-orientated image, which should result\r\n        // in a white opaque pixel (e.g. in Safari).\r\n        // Browsers that show a transparent pixel (e.g. Chromium) fail to crop\r\n        // auto-oriented images correctly and require a workaround, e.g.\r\n        // drawing the complete source image to an intermediate canvas first.\r\n        // See https://bugs.chromium.org/p/chromium/issues/detail?id=1074354\r\n        $.orientationCropBug =\r\n          ctx.getImageData(0, 0, 1, 1).data.toString() !== '255,255,255,255'\r\n      }\r\n    }\r\n    img.src = testImageURL\r\n  })(loadImage)\r\n\r\n  /**\r\n   * Determines if the orientation requires a canvas element.\r\n   *\r\n   * @param {object} [options] Options object\r\n   * @param {boolean} [withMetaData] Is metadata required for orientation\r\n   * @returns {boolean} Returns true if orientation requires canvas/meta\r\n   */\r\n  function requiresCanvasOrientation(options, withMetaData) {\r\n    var orientation = options && options.orientation\r\n    return (\r\n      // Exif orientation for browsers without automatic image orientation:\r\n      (orientation === true && !loadImage.orientation) ||\r\n      // Orientation reset for browsers with automatic image orientation:\r\n      (orientation === 1 && loadImage.orientation) ||\r\n      // Orientation to defined value, requires meta for orientation reset only:\r\n      ((!withMetaData || loadImage.orientation) &&\r\n        orientation > 1 &&\r\n        orientation < 9)\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Determines if the image requires an orientation change.\r\n   *\r\n   * @param {number} [orientation] Defined orientation value\r\n   * @param {number} [autoOrientation] Auto-orientation based on Exif data\r\n   * @returns {boolean} Returns true if an orientation change is required\r\n   */\r\n  function requiresOrientationChange(orientation, autoOrientation) {\r\n    return (\r\n      orientation !== autoOrientation &&\r\n      ((orientation === 1 && autoOrientation > 1 && autoOrientation < 9) ||\r\n        (orientation > 1 && orientation < 9))\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Determines orientation combinations that require a rotation by 180\u00b0.\r\n   *\r\n   * The following is a list of combinations that return true:\r\n   *\r\n   * 2 (flip) => 5 (rot90,flip), 7 (rot90,flip), 6 (rot90), 8 (rot90)\r\n   * 4 (flip) => 5 (rot90,flip), 7 (rot90,flip), 6 (rot90), 8 (rot90)\r\n   *\r\n   * 5 (rot90,flip) => 2 (flip), 4 (flip), 6 (rot90), 8 (rot90)\r\n   * 7 (rot90,flip) => 2 (flip), 4 (flip), 6 (rot90), 8 (rot90)\r\n   *\r\n   * 6 (rot90) => 2 (flip), 4 (flip), 5 (rot90,flip), 7 (rot90,flip)\r\n   * 8 (rot90) => 2 (flip), 4 (flip), 5 (rot90,flip), 7 (rot90,flip)\r\n   *\r\n   * @param {number} [orientation] Defined orientation value\r\n   * @param {number} [autoOrientation] Auto-orientation based on Exif data\r\n   * @returns {boolean} Returns true if rotation by 180\u00b0 is required\r\n   */\r\n  function requiresRot180(orientation, autoOrientation) {\r\n    if (autoOrientation > 1 && autoOrientation < 9) {\r\n      switch (orientation) {\r\n        case 2:\r\n        case 4:\r\n          return autoOrientation > 4\r\n        case 5:\r\n        case 7:\r\n          return autoOrientation % 2 === 0\r\n        case 6:\r\n        case 8:\r\n          return (\r\n            autoOrientation === 2 ||\r\n            autoOrientation === 4 ||\r\n            autoOrientation === 5 ||\r\n            autoOrientation === 7\r\n          )\r\n      }\r\n    }\r\n    return false\r\n  }\r\n\r\n  // Determines if the target image should be a canvas element:\r\n  loadImage.requiresCanvas = function (options) {\r\n    return (\r\n      requiresCanvasOrientation(options) ||\r\n      originalRequiresCanvas.call(loadImage, options)\r\n    )\r\n  }\r\n\r\n  // Determines if metadata should be loaded automatically:\r\n  loadImage.requiresMetaData = function (options) {\r\n    return (\r\n      requiresCanvasOrientation(options, true) ||\r\n      originalRequiresMetaData.call(loadImage, options)\r\n    )\r\n  }\r\n\r\n  loadImage.transform = function (img, options, callback, file, data) {\r\n    originalTransform.call(\r\n      loadImage,\r\n      img,\r\n      options,\r\n      function (img, data) {\r\n        if (data) {\r\n          var autoOrientation =\r\n            loadImage.orientation && data.exif && data.exif.get('Orientation')\r\n          if (autoOrientation > 4 && autoOrientation < 9) {\r\n            // Automatic image orientation switched image dimensions\r\n            var originalWidth = data.originalWidth\r\n            var originalHeight = data.originalHeight\r\n            data.originalWidth = originalHeight\r\n            data.originalHeight = originalWidth\r\n          }\r\n        }\r\n        callback(img, data)\r\n      },\r\n      file,\r\n      data\r\n    )\r\n  }\r\n\r\n  // Transforms coordinate and dimension options\r\n  // based on the given orientation option:\r\n  loadImage.getTransformedOptions = function (img, opts, data) {\r\n    var options = originalGetTransformedOptions.call(loadImage, img, opts)\r\n    var exifOrientation = data.exif && data.exif.get('Orientation')\r\n    var orientation = options.orientation\r\n    var autoOrientation = loadImage.orientation && exifOrientation\r\n    if (orientation === true) orientation = exifOrientation\r\n    if (!requiresOrientationChange(orientation, autoOrientation)) {\r\n      return options\r\n    }\r\n    var top = options.top\r\n    var right = options.right\r\n    var bottom = options.bottom\r\n    var left = options.left\r\n    var newOptions = {}\r\n    for (var i in options) {\r\n      if (Object.prototype.hasOwnProperty.call(options, i)) {\r\n        newOptions[i] = options[i]\r\n      }\r\n    }\r\n    newOptions.orientation = orientation\r\n    if (\r\n      (orientation > 4 && !(autoOrientation > 4)) ||\r\n      (orientation < 5 && autoOrientation > 4)\r\n    ) {\r\n      // Image dimensions and target dimensions are switched\r\n      newOptions.maxWidth = options.maxHeight\r\n      newOptions.maxHeight = options.maxWidth\r\n      newOptions.minWidth = options.minHeight\r\n      newOptions.minHeight = options.minWidth\r\n      newOptions.sourceWidth = options.sourceHeight\r\n      newOptions.sourceHeight = options.sourceWidth\r\n    }\r\n    if (autoOrientation > 1) {\r\n      // Browsers which correctly apply source image coordinates to\r\n      // auto-oriented images\r\n      switch (autoOrientation) {\r\n        case 2:\r\n          // Horizontal flip\r\n          right = options.left\r\n          left = options.right\r\n          break\r\n        case 3:\r\n          // 180\u00b0 Rotate CCW\r\n          top = options.bottom\r\n          right = options.left\r\n          bottom = options.top\r\n          left = options.right\r\n          break\r\n        case 4:\r\n          // Vertical flip\r\n          top = options.bottom\r\n          bottom = options.top\r\n          break\r\n        case 5:\r\n          // Horizontal flip + 90\u00b0 Rotate CCW\r\n          top = options.left\r\n          right = options.bottom\r\n          bottom = options.right\r\n          left = options.top\r\n          break\r\n        case 6:\r\n          // 90\u00b0 Rotate CCW\r\n          top = options.left\r\n          right = options.top\r\n          bottom = options.right\r\n          left = options.bottom\r\n          break\r\n        case 7:\r\n          // Vertical flip + 90\u00b0 Rotate CCW\r\n          top = options.right\r\n          right = options.top\r\n          bottom = options.left\r\n          left = options.bottom\r\n          break\r\n        case 8:\r\n          // 90\u00b0 Rotate CW\r\n          top = options.right\r\n          right = options.bottom\r\n          bottom = options.left\r\n          left = options.top\r\n          break\r\n      }\r\n      // Some orientation combinations require additional rotation by 180\u00b0:\r\n      if (requiresRot180(orientation, autoOrientation)) {\r\n        var tmpTop = top\r\n        var tmpRight = right\r\n        top = bottom\r\n        right = left\r\n        bottom = tmpTop\r\n        left = tmpRight\r\n      }\r\n    }\r\n    newOptions.top = top\r\n    newOptions.right = right\r\n    newOptions.bottom = bottom\r\n    newOptions.left = left\r\n    // Account for defined browser orientation:\r\n    switch (orientation) {\r\n      case 2:\r\n        // Horizontal flip\r\n        newOptions.right = left\r\n        newOptions.left = right\r\n        break\r\n      case 3:\r\n        // 180\u00b0 Rotate CCW\r\n        newOptions.top = bottom\r\n        newOptions.right = left\r\n        newOptions.bottom = top\r\n        newOptions.left = right\r\n        break\r\n      case 4:\r\n        // Vertical flip\r\n        newOptions.top = bottom\r\n        newOptions.bottom = top\r\n        break\r\n      case 5:\r\n        // Vertical flip + 90\u00b0 Rotate CW\r\n        newOptions.top = left\r\n        newOptions.right = bottom\r\n        newOptions.bottom = right\r\n        newOptions.left = top\r\n        break\r\n      case 6:\r\n        // 90\u00b0 Rotate CW\r\n        newOptions.top = right\r\n        newOptions.right = bottom\r\n        newOptions.bottom = left\r\n        newOptions.left = top\r\n        break\r\n      case 7:\r\n        // Horizontal flip + 90\u00b0 Rotate CW\r\n        newOptions.top = right\r\n        newOptions.right = top\r\n        newOptions.bottom = left\r\n        newOptions.left = bottom\r\n        break\r\n      case 8:\r\n        // 90\u00b0 Rotate CCW\r\n        newOptions.top = left\r\n        newOptions.right = top\r\n        newOptions.bottom = right\r\n        newOptions.left = bottom\r\n        break\r\n    }\r\n    return newOptions\r\n  }\r\n\r\n  // Transform image orientation based on the given EXIF orientation option:\r\n  loadImage.transformCoordinates = function (canvas, options, data) {\r\n    originalTransformCoordinates.call(loadImage, canvas, options, data)\r\n    var orientation = options.orientation\r\n    var autoOrientation =\r\n      loadImage.orientation && data.exif && data.exif.get('Orientation')\r\n    if (!requiresOrientationChange(orientation, autoOrientation)) {\r\n      return\r\n    }\r\n    var ctx = canvas.getContext('2d')\r\n    var width = canvas.width\r\n    var height = canvas.height\r\n    var sourceWidth = width\r\n    var sourceHeight = height\r\n    if (\r\n      (orientation > 4 && !(autoOrientation > 4)) ||\r\n      (orientation < 5 && autoOrientation > 4)\r\n    ) {\r\n      // Image dimensions and target dimensions are switched\r\n      canvas.width = height\r\n      canvas.height = width\r\n    }\r\n    if (orientation > 4) {\r\n      // Destination and source dimensions are switched\r\n      sourceWidth = height\r\n      sourceHeight = width\r\n    }\r\n    // Reset automatic browser orientation:\r\n    switch (autoOrientation) {\r\n      case 2:\r\n        // Horizontal flip\r\n        ctx.translate(sourceWidth, 0)\r\n        ctx.scale(-1, 1)\r\n        break\r\n      case 3:\r\n        // 180\u00b0 Rotate CCW\r\n        ctx.translate(sourceWidth, sourceHeight)\r\n        ctx.rotate(Math.PI)\r\n        break\r\n      case 4:\r\n        // Vertical flip\r\n        ctx.translate(0, sourceHeight)\r\n        ctx.scale(1, -1)\r\n        break\r\n      case 5:\r\n        // Horizontal flip + 90\u00b0 Rotate CCW\r\n        ctx.rotate(-0.5 * Math.PI)\r\n        ctx.scale(-1, 1)\r\n        break\r\n      case 6:\r\n        // 90\u00b0 Rotate CCW\r\n        ctx.rotate(-0.5 * Math.PI)\r\n        ctx.translate(-sourceWidth, 0)\r\n        break\r\n      case 7:\r\n        // Vertical flip + 90\u00b0 Rotate CCW\r\n        ctx.rotate(-0.5 * Math.PI)\r\n        ctx.translate(-sourceWidth, sourceHeight)\r\n        ctx.scale(1, -1)\r\n        break\r\n      case 8:\r\n        // 90\u00b0 Rotate CW\r\n        ctx.rotate(0.5 * Math.PI)\r\n        ctx.translate(0, -sourceHeight)\r\n        break\r\n    }\r\n    // Some orientation combinations require additional rotation by 180\u00b0:\r\n    if (requiresRot180(orientation, autoOrientation)) {\r\n      ctx.translate(sourceWidth, sourceHeight)\r\n      ctx.rotate(Math.PI)\r\n    }\r\n    switch (orientation) {\r\n      case 2:\r\n        // Horizontal flip\r\n        ctx.translate(width, 0)\r\n        ctx.scale(-1, 1)\r\n        break\r\n      case 3:\r\n        // 180\u00b0 Rotate CCW\r\n        ctx.translate(width, height)\r\n        ctx.rotate(Math.PI)\r\n        break\r\n      case 4:\r\n        // Vertical flip\r\n        ctx.translate(0, height)\r\n        ctx.scale(1, -1)\r\n        break\r\n      case 5:\r\n        // Vertical flip + 90\u00b0 Rotate CW\r\n        ctx.rotate(0.5 * Math.PI)\r\n        ctx.scale(1, -1)\r\n        break\r\n      case 6:\r\n        // 90\u00b0 Rotate CW\r\n        ctx.rotate(0.5 * Math.PI)\r\n        ctx.translate(0, -height)\r\n        break\r\n      case 7:\r\n        // Horizontal flip + 90\u00b0 Rotate CW\r\n        ctx.rotate(0.5 * Math.PI)\r\n        ctx.translate(width, -height)\r\n        ctx.scale(-1, 1)\r\n        break\r\n      case 8:\r\n        // 90\u00b0 Rotate CCW\r\n        ctx.rotate(-0.5 * Math.PI)\r\n        ctx.translate(-width, 0)\r\n        break\r\n    }\r\n  }\r\n})\r\n","jquery/fileUploader/vendor/blueimp-load-image/js/load-image-scale.js":"/*\r\n * JavaScript Load Image Scaling\r\n * https://github.com/blueimp/JavaScript-Load-Image\r\n *\r\n * Copyright 2011, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n */\r\n\r\n/* global define, module, require */\r\n\r\n;(function (factory) {\r\n  'use strict'\r\n  if (typeof define === 'function' && define.amd) {\r\n    // Register as an anonymous AMD module:\r\n    define(['jquery/fileUploader/vendor/blueimp-load-image/js/load-image'], factory)\r\n  } else if (typeof module === 'object' && module.exports) {\r\n    factory(require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image'))\r\n  } else {\r\n    // Browser globals:\r\n    factory(window.loadImage)\r\n  }\r\n})(function (loadImage) {\r\n  'use strict'\r\n\r\n  var originalTransform = loadImage.transform\r\n\r\n  loadImage.createCanvas = function (width, height, offscreen) {\r\n    if (offscreen && loadImage.global.OffscreenCanvas) {\r\n      return new OffscreenCanvas(width, height)\r\n    }\r\n    var canvas = document.createElement('canvas')\r\n    canvas.width = width\r\n    canvas.height = height\r\n    return canvas\r\n  }\r\n\r\n  loadImage.transform = function (img, options, callback, file, data) {\r\n    originalTransform.call(\r\n      loadImage,\r\n      loadImage.scale(img, options, data),\r\n      options,\r\n      callback,\r\n      file,\r\n      data\r\n    )\r\n  }\r\n\r\n  // Transform image coordinates, allows to override e.g.\r\n  // the canvas orientation based on the orientation option,\r\n  // gets canvas, options and data passed as arguments:\r\n  loadImage.transformCoordinates = function () {}\r\n\r\n  // Returns transformed options, allows to override e.g.\r\n  // maxWidth, maxHeight and crop options based on the aspectRatio.\r\n  // gets img, options, data passed as arguments:\r\n  loadImage.getTransformedOptions = function (img, options) {\r\n    var aspectRatio = options.aspectRatio\r\n    var newOptions\r\n    var i\r\n    var width\r\n    var height\r\n    if (!aspectRatio) {\r\n      return options\r\n    }\r\n    newOptions = {}\r\n    for (i in options) {\r\n      if (Object.prototype.hasOwnProperty.call(options, i)) {\r\n        newOptions[i] = options[i]\r\n      }\r\n    }\r\n    newOptions.crop = true\r\n    width = img.naturalWidth || img.width\r\n    height = img.naturalHeight || img.height\r\n    if (width / height > aspectRatio) {\r\n      newOptions.maxWidth = height * aspectRatio\r\n      newOptions.maxHeight = height\r\n    } else {\r\n      newOptions.maxWidth = width\r\n      newOptions.maxHeight = width / aspectRatio\r\n    }\r\n    return newOptions\r\n  }\r\n\r\n  // Canvas render method, allows to implement a different rendering algorithm:\r\n  loadImage.drawImage = function (\r\n    img,\r\n    canvas,\r\n    sourceX,\r\n    sourceY,\r\n    sourceWidth,\r\n    sourceHeight,\r\n    destWidth,\r\n    destHeight,\r\n    options\r\n  ) {\r\n    var ctx = canvas.getContext('2d')\r\n    if (options.imageSmoothingEnabled === false) {\r\n      ctx.msImageSmoothingEnabled = false\r\n      ctx.imageSmoothingEnabled = false\r\n    } else if (options.imageSmoothingQuality) {\r\n      ctx.imageSmoothingQuality = options.imageSmoothingQuality\r\n    }\r\n    ctx.drawImage(\r\n      img,\r\n      sourceX,\r\n      sourceY,\r\n      sourceWidth,\r\n      sourceHeight,\r\n      0,\r\n      0,\r\n      destWidth,\r\n      destHeight\r\n    )\r\n    return ctx\r\n  }\r\n\r\n  // Determines if the target image should be a canvas element:\r\n  loadImage.requiresCanvas = function (options) {\r\n    return options.canvas || options.crop || !!options.aspectRatio\r\n  }\r\n\r\n  // Scales and/or crops the given image (img or canvas HTML element)\r\n  // using the given options:\r\n  loadImage.scale = function (img, options, data) {\r\n    // eslint-disable-next-line no-param-reassign\r\n    options = options || {}\r\n    // eslint-disable-next-line no-param-reassign\r\n    data = data || {}\r\n    var useCanvas =\r\n      img.getContext ||\r\n      (loadImage.requiresCanvas(options) &&\r\n        !!loadImage.global.HTMLCanvasElement)\r\n    var width = img.naturalWidth || img.width\r\n    var height = img.naturalHeight || img.height\r\n    var destWidth = width\r\n    var destHeight = height\r\n    var maxWidth\r\n    var maxHeight\r\n    var minWidth\r\n    var minHeight\r\n    var sourceWidth\r\n    var sourceHeight\r\n    var sourceX\r\n    var sourceY\r\n    var pixelRatio\r\n    var downsamplingRatio\r\n    var tmp\r\n    var canvas\r\n    /**\r\n     * Scales up image dimensions\r\n     */\r\n    function scaleUp() {\r\n      var scale = Math.max(\r\n        (minWidth || destWidth) / destWidth,\r\n        (minHeight || destHeight) / destHeight\r\n      )\r\n      if (scale > 1) {\r\n        destWidth *= scale\r\n        destHeight *= scale\r\n      }\r\n    }\r\n    /**\r\n     * Scales down image dimensions\r\n     */\r\n    function scaleDown() {\r\n      var scale = Math.min(\r\n        (maxWidth || destWidth) / destWidth,\r\n        (maxHeight || destHeight) / destHeight\r\n      )\r\n      if (scale < 1) {\r\n        destWidth *= scale\r\n        destHeight *= scale\r\n      }\r\n    }\r\n    if (useCanvas) {\r\n      // eslint-disable-next-line no-param-reassign\r\n      options = loadImage.getTransformedOptions(img, options, data)\r\n      sourceX = options.left || 0\r\n      sourceY = options.top || 0\r\n      if (options.sourceWidth) {\r\n        sourceWidth = options.sourceWidth\r\n        if (options.right !== undefined && options.left === undefined) {\r\n          sourceX = width - sourceWidth - options.right\r\n        }\r\n      } else {\r\n        sourceWidth = width - sourceX - (options.right || 0)\r\n      }\r\n      if (options.sourceHeight) {\r\n        sourceHeight = options.sourceHeight\r\n        if (options.bottom !== undefined && options.top === undefined) {\r\n          sourceY = height - sourceHeight - options.bottom\r\n        }\r\n      } else {\r\n        sourceHeight = height - sourceY - (options.bottom || 0)\r\n      }\r\n      destWidth = sourceWidth\r\n      destHeight = sourceHeight\r\n    }\r\n    maxWidth = options.maxWidth\r\n    maxHeight = options.maxHeight\r\n    minWidth = options.minWidth\r\n    minHeight = options.minHeight\r\n    if (useCanvas && maxWidth && maxHeight && options.crop) {\r\n      destWidth = maxWidth\r\n      destHeight = maxHeight\r\n      tmp = sourceWidth / sourceHeight - maxWidth / maxHeight\r\n      if (tmp < 0) {\r\n        sourceHeight = (maxHeight * sourceWidth) / maxWidth\r\n        if (options.top === undefined && options.bottom === undefined) {\r\n          sourceY = (height - sourceHeight) / 2\r\n        }\r\n      } else if (tmp > 0) {\r\n        sourceWidth = (maxWidth * sourceHeight) / maxHeight\r\n        if (options.left === undefined && options.right === undefined) {\r\n          sourceX = (width - sourceWidth) / 2\r\n        }\r\n      }\r\n    } else {\r\n      if (options.contain || options.cover) {\r\n        minWidth = maxWidth = maxWidth || minWidth\r\n        minHeight = maxHeight = maxHeight || minHeight\r\n      }\r\n      if (options.cover) {\r\n        scaleDown()\r\n        scaleUp()\r\n      } else {\r\n        scaleUp()\r\n        scaleDown()\r\n      }\r\n    }\r\n    if (useCanvas) {\r\n      pixelRatio = options.pixelRatio\r\n      if (\r\n        pixelRatio > 1 &&\r\n        // Check if the image has not yet had the device pixel ratio applied:\r\n        !(\r\n          img.style.width &&\r\n          Math.floor(parseFloat(img.style.width, 10)) ===\r\n            Math.floor(width / pixelRatio)\r\n        )\r\n      ) {\r\n        destWidth *= pixelRatio\r\n        destHeight *= pixelRatio\r\n      }\r\n      // Check if workaround for Chromium orientation crop bug is required:\r\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=1074354\r\n      if (\r\n        loadImage.orientationCropBug &&\r\n        !img.getContext &&\r\n        (sourceX || sourceY || sourceWidth !== width || sourceHeight !== height)\r\n      ) {\r\n        // Write the complete source image to an intermediate canvas first:\r\n        tmp = img\r\n        // eslint-disable-next-line no-param-reassign\r\n        img = loadImage.createCanvas(width, height, true)\r\n        loadImage.drawImage(\r\n          tmp,\r\n          img,\r\n          0,\r\n          0,\r\n          width,\r\n          height,\r\n          width,\r\n          height,\r\n          options\r\n        )\r\n      }\r\n      downsamplingRatio = options.downsamplingRatio\r\n      if (\r\n        downsamplingRatio > 0 &&\r\n        downsamplingRatio < 1 &&\r\n        destWidth < sourceWidth &&\r\n        destHeight < sourceHeight\r\n      ) {\r\n        while (sourceWidth * downsamplingRatio > destWidth) {\r\n          canvas = loadImage.createCanvas(\r\n            sourceWidth * downsamplingRatio,\r\n            sourceHeight * downsamplingRatio,\r\n            true\r\n          )\r\n          loadImage.drawImage(\r\n            img,\r\n            canvas,\r\n            sourceX,\r\n            sourceY,\r\n            sourceWidth,\r\n            sourceHeight,\r\n            canvas.width,\r\n            canvas.height,\r\n            options\r\n          )\r\n          sourceX = 0\r\n          sourceY = 0\r\n          sourceWidth = canvas.width\r\n          sourceHeight = canvas.height\r\n          // eslint-disable-next-line no-param-reassign\r\n          img = canvas\r\n        }\r\n      }\r\n      canvas = loadImage.createCanvas(destWidth, destHeight)\r\n      loadImage.transformCoordinates(canvas, options, data)\r\n      if (pixelRatio > 1) {\r\n        canvas.style.width = canvas.width / pixelRatio + 'px'\r\n      }\r\n      loadImage\r\n        .drawImage(\r\n          img,\r\n          canvas,\r\n          sourceX,\r\n          sourceY,\r\n          sourceWidth,\r\n          sourceHeight,\r\n          destWidth,\r\n          destHeight,\r\n          options\r\n        )\r\n        .setTransform(1, 0, 0, 1, 0, 0) // reset to the identity matrix\r\n      return canvas\r\n    }\r\n    img.width = destWidth\r\n    img.height = destHeight\r\n    return img\r\n  }\r\n})\r\n","jquery/fileUploader/vendor/blueimp-load-image/js/load-image.js":"/*\r\n * JavaScript Load Image\r\n * https://github.com/blueimp/JavaScript-Load-Image\r\n *\r\n * Copyright 2011, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n */\r\n\r\n/* global define, module, Promise */\r\n\r\n;(function ($) {\r\n  'use strict'\r\n\r\n  var urlAPI = $.URL || $.webkitURL\r\n\r\n  /**\r\n   * Creates an object URL for a given File object.\r\n   *\r\n   * @param {Blob} blob Blob object\r\n   * @returns {string|boolean} Returns object URL if API exists, else false.\r\n   */\r\n  function createObjectURL(blob) {\r\n    return urlAPI ? urlAPI.createObjectURL(blob) : false\r\n  }\r\n\r\n  /**\r\n   * Revokes a given object URL.\r\n   *\r\n   * @param {string} url Blob object URL\r\n   * @returns {undefined|boolean} Returns undefined if API exists, else false.\r\n   */\r\n  function revokeObjectURL(url) {\r\n    return urlAPI ? urlAPI.revokeObjectURL(url) : false\r\n  }\r\n\r\n  /**\r\n   * Helper function to revoke an object URL\r\n   *\r\n   * @param {string} url Blob Object URL\r\n   * @param {object} [options] Options object\r\n   */\r\n  function revokeHelper(url, options) {\r\n    if (url && url.slice(0, 5) === 'blob:' && !(options && options.noRevoke)) {\r\n      revokeObjectURL(url)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Loads a given File object via FileReader interface.\r\n   *\r\n   * @param {Blob} file Blob object\r\n   * @param {Function} onload Load event callback\r\n   * @param {Function} [onerror] Error/Abort event callback\r\n   * @param {string} [method=readAsDataURL] FileReader method\r\n   * @returns {FileReader|boolean} Returns FileReader if API exists, else false.\r\n   */\r\n  function readFile(file, onload, onerror, method) {\r\n    if (!$.FileReader) return false\r\n    var reader = new FileReader()\r\n    reader.onload = function () {\r\n      onload.call(reader, this.result)\r\n    }\r\n    if (onerror) {\r\n      reader.onabort = reader.onerror = function () {\r\n        onerror.call(reader, this.error)\r\n      }\r\n    }\r\n    var readerMethod = reader[method || 'readAsDataURL']\r\n    if (readerMethod) {\r\n      readerMethod.call(reader, file)\r\n      return reader\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Cross-frame instanceof check.\r\n   *\r\n   * @param {string} type Instance type\r\n   * @param {object} obj Object instance\r\n   * @returns {boolean} Returns true if the object is of the given instance.\r\n   */\r\n  function isInstanceOf(type, obj) {\r\n    // Cross-frame instanceof check\r\n    return Object.prototype.toString.call(obj) === '[object ' + type + ']'\r\n  }\r\n\r\n  /**\r\n   * @typedef { HTMLImageElement|HTMLCanvasElement } Result\r\n   */\r\n\r\n  /**\r\n   * Loads an image for a given File object.\r\n   *\r\n   * @param {Blob|string} file Blob object or image URL\r\n   * @param {Function|object} [callback] Image load event callback or options\r\n   * @param {object} [options] Options object\r\n   * @returns {HTMLImageElement|FileReader|Promise<Result>} Object\r\n   */\r\n  function loadImage(file, callback, options) {\r\n    /**\r\n     * Promise executor\r\n     *\r\n     * @param {Function} resolve Resolution function\r\n     * @param {Function} reject Rejection function\r\n     * @returns {HTMLImageElement|FileReader} Object\r\n     */\r\n    function executor(resolve, reject) {\r\n      var img = document.createElement('img')\r\n      var url\r\n      /**\r\n       * Callback for the fetchBlob call.\r\n       *\r\n       * @param {HTMLImageElement|HTMLCanvasElement} img Error object\r\n       * @param {object} data Data object\r\n       * @returns {undefined} Undefined\r\n       */\r\n      function resolveWrapper(img, data) {\r\n        if (resolve === reject) {\r\n          // Not using Promises\r\n          if (resolve) resolve(img, data)\r\n          return\r\n        } else if (img instanceof Error) {\r\n          reject(img)\r\n          return\r\n        }\r\n        data = data || {} // eslint-disable-line no-param-reassign\r\n        data.image = img\r\n        resolve(data)\r\n      }\r\n      /**\r\n       * Callback for the fetchBlob call.\r\n       *\r\n       * @param {Blob} blob Blob object\r\n       * @param {Error} err Error object\r\n       */\r\n      function fetchBlobCallback(blob, err) {\r\n        if (err && $.console) console.log(err) // eslint-disable-line no-console\r\n        if (blob && isInstanceOf('Blob', blob)) {\r\n          file = blob // eslint-disable-line no-param-reassign\r\n          url = createObjectURL(file)\r\n        } else {\r\n          url = file\r\n          if (options && options.crossOrigin) {\r\n            img.crossOrigin = options.crossOrigin\r\n          }\r\n        }\r\n        img.src = url\r\n      }\r\n      img.onerror = function (event) {\r\n        revokeHelper(url, options)\r\n        if (reject) reject.call(img, event)\r\n      }\r\n      img.onload = function () {\r\n        revokeHelper(url, options)\r\n        var data = {\r\n          originalWidth: img.naturalWidth || img.width,\r\n          originalHeight: img.naturalHeight || img.height\r\n        }\r\n        try {\r\n          loadImage.transform(img, options, resolveWrapper, file, data)\r\n        } catch (error) {\r\n          if (reject) reject(error)\r\n        }\r\n      }\r\n      if (typeof file === 'string') {\r\n        if (loadImage.requiresMetaData(options)) {\r\n          loadImage.fetchBlob(file, fetchBlobCallback, options)\r\n        } else {\r\n          fetchBlobCallback()\r\n        }\r\n        return img\r\n      } else if (isInstanceOf('Blob', file) || isInstanceOf('File', file)) {\r\n        url = createObjectURL(file)\r\n        if (url) {\r\n          img.src = url\r\n          return img\r\n        }\r\n        return readFile(\r\n          file,\r\n          function (url) {\r\n            img.src = url\r\n          },\r\n          reject\r\n        )\r\n      }\r\n    }\r\n    if ($.Promise && typeof callback !== 'function') {\r\n      options = callback // eslint-disable-line no-param-reassign\r\n      return new Promise(executor)\r\n    }\r\n    return executor(callback, callback)\r\n  }\r\n\r\n  // Determines if metadata should be loaded automatically.\r\n  // Requires the load image meta extension to load metadata.\r\n  loadImage.requiresMetaData = function (options) {\r\n    return options && options.meta\r\n  }\r\n\r\n  // If the callback given to this function returns a blob, it is used as image\r\n  // source instead of the original url and overrides the file argument used in\r\n  // the onload and onerror event callbacks:\r\n  loadImage.fetchBlob = function (url, callback) {\r\n    callback()\r\n  }\r\n\r\n  loadImage.transform = function (img, options, callback, file, data) {\r\n    callback(img, data)\r\n  }\r\n\r\n  loadImage.global = $\r\n  loadImage.readFile = readFile\r\n  loadImage.isInstanceOf = isInstanceOf\r\n  loadImage.createObjectURL = createObjectURL\r\n  loadImage.revokeObjectURL = revokeObjectURL\r\n\r\n  if (typeof define === 'function' && define.amd) {\r\n    define(function () {\r\n      return loadImage\r\n    })\r\n  } else if (typeof module === 'object' && module.exports) {\r\n    module.exports = loadImage\r\n  } else {\r\n    $.loadImage = loadImage\r\n  }\r\n})((typeof window !== 'undefined' && window) || this)\r\n","jquery/fileUploader/vendor/blueimp-tmpl/js/compile.js":"#!/usr/bin/env node\r\n/*\r\n * JavaScript Templates Compiler\r\n * https://github.com/blueimp/JavaScript-Templates\r\n *\r\n * Copyright 2011, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n */\r\n\r\n/* eslint-disable strict */\r\n/* eslint-disable no-console */\r\n\r\n;(function () {\r\n  'use strict'\r\n  var path = require('path')\r\n  var tmpl = require(path.join(__dirname, 'tmpl.js'))\r\n  var fs = require('fs')\r\n  // Retrieve the content of the minimal runtime:\r\n  var runtime = fs.readFileSync(path.join(__dirname, 'runtime.js'), 'utf8')\r\n  // A regular expression to parse templates from script tags in a HTML page:\r\n  var regexp = /<script( id=\"([\\w-]+)\")? type=\"text\\/x-tmpl\"( id=\"([\\w-]+)\")?>([\\s\\S]+?)<\\/script>/gi\r\n  // A regular expression to match the helper function names:\r\n  var helperRegexp = new RegExp(\r\n    tmpl.helper.match(/\\w+(?=\\s*=\\s*function\\s*\\()/g).join('\\\\s*\\\\(|') +\r\n      '\\\\s*\\\\('\r\n  )\r\n  // A list to store the function bodies:\r\n  var list = []\r\n  var code\r\n  // Extend the Templating engine with a print method for the generated functions:\r\n  tmpl.print = function (str) {\r\n    // Only add helper functions if they are used inside of the template:\r\n    var helper = helperRegexp.test(str) ? tmpl.helper : ''\r\n    var body = str.replace(tmpl.regexp, tmpl.func)\r\n    if (helper || /_e\\s*\\(/.test(body)) {\r\n      helper = '_e=tmpl.encode' + helper + ','\r\n    }\r\n    return (\r\n      'function(' +\r\n      tmpl.arg +\r\n      ',tmpl){' +\r\n      ('var ' + helper + \"_s='\" + body + \"';return _s;\")\r\n        .split(\"_s+='';\")\r\n        .join('') +\r\n      '}'\r\n    )\r\n  }\r\n  // Loop through the command line arguments:\r\n  process.argv.forEach(function (file, index) {\r\n    var listLength = list.length\r\n    var stats\r\n    var content\r\n    var result\r\n    var id\r\n    // Skip the first two arguments, which are \"node\" and the script:\r\n    if (index > 1) {\r\n      stats = fs.statSync(file)\r\n      if (!stats.isFile()) {\r\n        console.error(file + ' is not a file.')\r\n        return\r\n      }\r\n      content = fs.readFileSync(file, 'utf8')\r\n      // eslint-disable-next-line no-constant-condition\r\n      while (true) {\r\n        // Find templates in script tags:\r\n        result = regexp.exec(content)\r\n        if (!result) {\r\n          break\r\n        }\r\n        id = result[2] || result[4]\r\n        list.push(\"'\" + id + \"':\" + tmpl.print(result[5]))\r\n      }\r\n      if (listLength === list.length) {\r\n        // No template script tags found, use the complete content:\r\n        id = path.basename(file, path.extname(file))\r\n        list.push(\"'\" + id + \"':\" + tmpl.print(content))\r\n      }\r\n    }\r\n  })\r\n  if (!list.length) {\r\n    console.error('Missing input file.')\r\n    return\r\n  }\r\n  // Combine the generated functions as cache of the minimal runtime:\r\n  code = runtime.replace('{}', '{' + list.join(',') + '}')\r\n  // Print the resulting code to the console output:\r\n  console.log(code)\r\n})()\r\n","jquery/fileUploader/vendor/blueimp-tmpl/js/runtime.js":"/*\r\n * JavaScript Templates Runtime\r\n * https://github.com/blueimp/JavaScript-Templates\r\n *\r\n * Copyright 2011, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n */\r\n\r\n/* global define */\r\n\r\n/* eslint-disable strict */\r\n\r\n;(function ($) {\r\n  'use strict'\r\n  var tmpl = function (id, data) {\r\n    var f = tmpl.cache[id]\r\n    return data\r\n      ? f(data, tmpl)\r\n      : function (data) {\r\n          return f(data, tmpl)\r\n        }\r\n  }\r\n  tmpl.cache = {}\r\n  tmpl.encReg = /[<>&\"'\\x00]/g // eslint-disable-line no-control-regex\r\n  tmpl.encMap = {\r\n    '<': '&lt;',\r\n    '>': '&gt;',\r\n    '&': '&amp;',\r\n    '\"': '&quot;',\r\n    \"'\": '&#39;'\r\n  }\r\n  tmpl.encode = function (s) {\r\n    // eslint-disable-next-line eqeqeq\r\n    return (s == null ? '' : '' + s).replace(tmpl.encReg, function (c) {\r\n      return tmpl.encMap[c] || ''\r\n    })\r\n  }\r\n  if (typeof define === 'function' && define.amd) {\r\n    define(function () {\r\n      return tmpl\r\n    })\r\n  } else if (typeof module === 'object' && module.exports) {\r\n    module.exports = tmpl\r\n  } else {\r\n    $.tmpl = tmpl\r\n  }\r\n})(this)\r\n","jquery/fileUploader/vendor/blueimp-tmpl/js/tmpl.js":"/*\r\n * JavaScript Templates\r\n * https://github.com/blueimp/JavaScript-Templates\r\n *\r\n * Copyright 2011, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * https://opensource.org/licenses/MIT\r\n *\r\n * Inspired by John Resig's JavaScript Micro-Templating:\r\n * http://ejohn.org/blog/javascript-micro-templating/\r\n */\r\n\r\n/* global define */\r\n\r\n/* eslint-disable strict */\r\n\r\n;(function ($) {\r\n  'use strict'\r\n  var tmpl = function (str, data) {\r\n    var f = !/[^\\w\\-.:]/.test(str)\r\n      ? (tmpl.cache[str] = tmpl.cache[str] || tmpl(tmpl.load(str)))\r\n      : new Function( // eslint-disable-line no-new-func\r\n          tmpl.arg + ',tmpl',\r\n          'var _e=tmpl.encode' +\r\n            tmpl.helper +\r\n            \",_s='\" +\r\n            str.replace(tmpl.regexp, tmpl.func) +\r\n            \"';return _s;\"\r\n        )\r\n    return data\r\n      ? f(data, tmpl)\r\n      : function (data) {\r\n          return f(data, tmpl)\r\n        }\r\n  }\r\n  tmpl.cache = {}\r\n  tmpl.load = function (id) {\r\n    return document.getElementById(id).innerHTML\r\n  }\r\n  tmpl.regexp = /([\\s'\\\\])(?!(?:[^{]|\\{(?!%))*%\\})|(?:\\{%(=|#)([\\s\\S]+?)%\\})|(\\{%)|(%\\})/g\r\n  tmpl.func = function (s, p1, p2, p3, p4, p5) {\r\n    if (p1) {\r\n      // whitespace, quote and backspace in HTML context\r\n      return (\r\n        {\r\n          '\\n': '\\\\n',\r\n          '\\r': '\\\\r',\r\n          '\\t': '\\\\t',\r\n          ' ': ' '\r\n        }[p1] || '\\\\' + p1\r\n      )\r\n    }\r\n    if (p2) {\r\n      // interpolation: {%=prop%}, or unescaped: {%#prop%}\r\n      if (p2 === '=') {\r\n        return \"'+_e(\" + p3 + \")+'\"\r\n      }\r\n      return \"'+(\" + p3 + \"==null?'':\" + p3 + \")+'\"\r\n    }\r\n    if (p4) {\r\n      // evaluation start tag: {%\r\n      return \"';\"\r\n    }\r\n    if (p5) {\r\n      // evaluation end tag: %}\r\n      return \"_s+='\"\r\n    }\r\n  }\r\n  tmpl.encReg = /[<>&\"'\\x00]/g // eslint-disable-line no-control-regex\r\n  tmpl.encMap = {\r\n    '<': '&lt;',\r\n    '>': '&gt;',\r\n    '&': '&amp;',\r\n    '\"': '&quot;',\r\n    \"'\": '&#39;'\r\n  }\r\n  tmpl.encode = function (s) {\r\n    // eslint-disable-next-line eqeqeq\r\n    return (s == null ? '' : '' + s).replace(tmpl.encReg, function (c) {\r\n      return tmpl.encMap[c] || ''\r\n    })\r\n  }\r\n  tmpl.arg = 'o'\r\n  tmpl.helper =\r\n    \",print=function(s,e){_s+=e?(s==null?'':s):_e(s);}\" +\r\n    ',include=function(s,d){_s+=tmpl(s,d);}'\r\n  if (typeof define === 'function' && define.amd) {\r\n    define(function () {\r\n      return tmpl\r\n    })\r\n  } else if (typeof module === 'object' && module.exports) {\r\n    module.exports = tmpl\r\n  } else {\r\n    $.tmpl = tmpl\r\n  }\r\n})(this)\r\n","jquery/jstree/jquery.hotkeys.js":"/*\r\n * jQuery Hotkeys Plugin\r\n * Copyright 2010, John Resig\r\n * Dual licensed under the MIT or GPL Version 2 licenses.\r\n *\r\n * Based upon the plugin by Tzury Bar Yochay:\r\n * http://github.com/tzuryby/hotkeys\r\n *\r\n * Original idea by:\r\n * Binny V A, http://www.openjs.com/scripts/events/keyboard_shortcuts/\r\n*/\r\n(function (factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define([\"jquery\"], factory);\r\n    } else {\r\n        factory(jQuery);\r\n    }\r\n}(function (jQuery) {\r\n\r\n\tjQuery.hotkeys = {\r\n\t\tversion: \"0.8\",\r\n\r\n\t\tspecialKeys: {\r\n\t\t\t8: \"backspace\", 9: \"tab\", 13: \"return\", 16: \"shift\", 17: \"ctrl\", 18: \"alt\", 19: \"pause\",\r\n\t\t\t20: \"capslock\", 27: \"esc\", 32: \"space\", 33: \"pageup\", 34: \"pagedown\", 35: \"end\", 36: \"home\",\r\n\t\t\t37: \"left\", 38: \"up\", 39: \"right\", 40: \"down\", 45: \"insert\", 46: \"del\", \r\n\t\t\t96: \"0\", 97: \"1\", 98: \"2\", 99: \"3\", 100: \"4\", 101: \"5\", 102: \"6\", 103: \"7\",\r\n\t\t\t104: \"8\", 105: \"9\", 106: \"*\", 107: \"+\", 109: \"-\", 110: \".\", 111 : \"/\", \r\n\t\t\t112: \"f1\", 113: \"f2\", 114: \"f3\", 115: \"f4\", 116: \"f5\", 117: \"f6\", 118: \"f7\", 119: \"f8\", \r\n\t\t\t120: \"f9\", 121: \"f10\", 122: \"f11\", 123: \"f12\", 144: \"numlock\", 145: \"scroll\", 191: \"/\", 224: \"meta\"\r\n\t\t},\r\n\t\r\n\t\tshiftNums: {\r\n\t\t\t\"`\": \"~\", \"1\": \"!\", \"2\": \"@\", \"3\": \"#\", \"4\": \"$\", \"5\": \"%\", \"6\": \"^\", \"7\": \"&\", \r\n\t\t\t\"8\": \"*\", \"9\": \"(\", \"0\": \")\", \"-\": \"_\", \"=\": \"+\", \";\": \": \", \"'\": \"\\\"\", \",\": \"<\", \r\n\t\t\t\".\": \">\",  \"/\": \"?\",  \"\\\\\": \"|\"\r\n\t\t}\r\n\t};\r\n\r\n\tfunction keyHandler( handleObj ) {\r\n\t\t// Only care when a possible input has been specified\r\n\t\tif ( typeof handleObj.data !== \"string\" ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tvar origHandler = handleObj.handler,\r\n\t\t\tkeys = handleObj.data.toLowerCase().split(\" \");\r\n\t\r\n\t\thandleObj.handler = function( event ) {\r\n\t\t\t// Don't fire in text-accepting inputs that we didn't directly bind to\r\n            /**\r\n             * Modified by Magento to ensure it doesn't fire on any content editable areas. This library is no\r\n             * longer maintained by its author however we require content editable to behave as expected.\r\n             */\r\n\t\t\tif ( this !== event.target && (/textarea|select/i.test( event.target.nodeName ) ||\r\n                event.target.type === \"text\" || event.target.type === \"number\" ||\r\n                jQuery(event.target).attr('contenteditable')) ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Keypress represents characters, not special keys\r\n\t\t\tvar special = event.type !== \"keypress\" && jQuery.hotkeys.specialKeys[ event.which ],\r\n\t\t\t\tcharacter = String.fromCharCode( event.which ).toLowerCase(),\r\n\t\t\t\tkey, modif = \"\", possible = {};\r\n\r\n\t\t\t// check combinations (alt|ctrl|shift+anything)\r\n\t\t\tif ( event.altKey && special !== \"alt\" ) {\r\n\t\t\t\tmodif += \"alt+\";\r\n\t\t\t}\r\n\r\n\t\t\tif ( event.ctrlKey && special !== \"ctrl\" ) {\r\n\t\t\t\tmodif += \"ctrl+\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// TODO: Need to make sure this works consistently across platforms\r\n\t\t\tif ( event.metaKey && !event.ctrlKey && special !== \"meta\" ) {\r\n\t\t\t\tmodif += \"meta+\";\r\n\t\t\t}\r\n\r\n\t\t\tif ( event.shiftKey && special !== \"shift\" ) {\r\n\t\t\t\tmodif += \"shift+\";\r\n\t\t\t}\r\n\r\n\t\t\tif ( special ) {\r\n\t\t\t\tpossible[ modif + special ] = true;\r\n\r\n\t\t\t} else {\r\n\t\t\t\tpossible[ modif + character ] = true;\r\n\t\t\t\tpossible[ modif + jQuery.hotkeys.shiftNums[ character ] ] = true;\r\n\r\n\t\t\t\t// \"$\" can be triggered as \"Shift+4\" or \"Shift+$\" or just \"$\"\r\n\t\t\t\tif ( modif === \"shift+\" ) {\r\n\t\t\t\t\tpossible[ jQuery.hotkeys.shiftNums[ character ] ] = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0, l = keys.length; i < l; i++ ) {\r\n\t\t\t\tif ( possible[ keys[i] ] ) {\r\n\t\t\t\t\treturn origHandler.apply( this, arguments );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tjQuery.each([ \"keydown\", \"keyup\", \"keypress\" ], function() {\r\n\t\tjQuery.event.special[ this ] = { add: keyHandler };\r\n\t});\r\n\r\n}));","jquery/jstree/jquery.jstree.js":"/*\r\n * jsTree 1.0-rc3\r\n * http://jstree.com/\r\n *\r\n * Copyright (c) 2010 Ivan Bozhanov (vakata.com)\r\n *\r\n * Licensed same as jquery - under the terms of either the MIT License or the GPL Version 2 License\r\n *   http://www.opensource.org/licenses/mit-license.php\r\n *   http://www.gnu.org/licenses/gpl.html\r\n *\r\n * $Date: 2011-02-09 01:17:14 +0200 (\u0441\u0440, 09 \u0444\u0435\u0432\u0440 2011) $\r\n * $Revision: 236 $\r\n */\r\n\r\n/*jslint browser: true, onevar: true, undef: true, bitwise: true, strict: true */\r\n/*global window : false, clearInterval: false, clearTimeout: false, document: false, setInterval: false, setTimeout: false, jQuery: false, navigator: false, XSLTProcessor: false, DOMParser: false, XMLSerializer: false*/\r\n(function (factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define([\r\n            \"jquery\",\r\n            \"jquery/jquery.cookie\",\r\n            \"jquery/jstree/jquery.hotkeys\"\r\n        ], factory);\r\n    } else {\r\n        factory(jQuery);\r\n    }\r\n}(function ($) {\r\n\"use strict\";\r\n\r\n// top wrapper to prevent multiple inclusion (is this OK?)\r\n(function () {\r\n\tvar is_ie6 = false, is_ie7 = false, is_ff2 = false;\r\n\r\n/*\r\n * jsTree core\r\n */\r\n(function ($) {\r\n\t// Common functions not related to jsTree\r\n\t// decided to move them to a `vakata` \"namespace\"\r\n\t$.vakata = {};\r\n\t// CSS related functions\r\n\t$.vakata.css = {\r\n\t\tget_css : function(rule_name, delete_flag, sheet) {\r\n\t\t\trule_name = rule_name.toLowerCase();\r\n\t\t\tvar css_rules = sheet.cssRules || sheet.rules,\r\n\t\t\t\tj = 0;\r\n\t\t\tdo {\r\n\t\t\t\tif(css_rules.length && j > css_rules.length + 5) { return false; }\r\n\t\t\t\tif(css_rules[j].selectorText && css_rules[j].selectorText.toLowerCase() == rule_name) {\r\n\t\t\t\t\tif(delete_flag === true) {\r\n\t\t\t\t\t\tif(sheet.removeRule) { sheet.removeRule(j); }\r\n\t\t\t\t\t\tif(sheet.deleteRule) { sheet.deleteRule(j); }\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse { return css_rules[j]; }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\twhile (css_rules[++j]);\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tadd_css : function(rule_name, sheet) {\r\n\t\t\tif($.jstree.css.get_css(rule_name, false, sheet)) { return false; }\r\n\t\t\tif(sheet.insertRule) { sheet.insertRule(rule_name + ' { }', 0); } else { sheet.addRule(rule_name, null, 0); }\r\n\t\t\treturn $.vakata.css.get_css(rule_name);\r\n\t\t},\r\n\t\tremove_css : function(rule_name, sheet) {\r\n\t\t\treturn $.vakata.css.get_css(rule_name, true, sheet);\r\n\t\t},\r\n\t\tadd_sheet : function(opts) {\r\n\t\t\tvar tmp = false, is_new = true;\r\n\t\t\tif(opts.str) {\r\n\t\t\t\tif(opts.title) { tmp = $(\"style[id='\" + opts.title + \"-stylesheet']\")[0]; }\r\n\t\t\t\tif(tmp) { is_new = false; }\r\n\t\t\t\telse {\r\n\t\t\t\t\ttmp = document.createElement(\"style\");\r\n\t\t\t\t\ttmp.setAttribute('type',\"text/css\");\r\n\t\t\t\t\tif(opts.title) { tmp.setAttribute(\"id\", opts.title + \"-stylesheet\"); }\r\n\t\t\t\t}\r\n\t\t\t\tif(tmp.styleSheet) {\r\n\t\t\t\t\tif(is_new) {\r\n\t\t\t\t\t\tdocument.getElementsByTagName(\"head\")[0].appendChild(tmp);\r\n\t\t\t\t\t\ttmp.styleSheet.cssText = opts.str;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\ttmp.styleSheet.cssText = tmp.styleSheet.cssText + \" \" + opts.str;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\ttmp.appendChild(document.createTextNode(opts.str));\r\n\t\t\t\t\tdocument.getElementsByTagName(\"head\")[0].appendChild(tmp);\r\n\t\t\t\t}\r\n\t\t\t\treturn tmp.sheet || tmp.styleSheet;\r\n\t\t\t}\r\n\t\t\tif(opts.url) {\r\n\t\t\t\tif(document.createStyleSheet) {\r\n\t\t\t\t\ttry { tmp = document.createStyleSheet(opts.url); } catch (e) { }\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\ttmp\t\t\t= document.createElement('link');\r\n\t\t\t\t\ttmp.rel\t\t= 'stylesheet';\r\n\t\t\t\t\ttmp.type\t= 'text/css';\r\n\t\t\t\t\ttmp.media\t= \"all\";\r\n\t\t\t\t\ttmp.href\t= opts.url;\r\n\t\t\t\t\tdocument.getElementsByTagName(\"head\")[0].appendChild(tmp);\r\n\t\t\t\t\treturn tmp.styleSheet;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// private variables\r\n\tvar instances = [],\t\t\t// instance array (used by $.jstree.reference/create/focused)\r\n\t\tfocused_instance = -1,\t// the index in the instance array of the currently focused instance\r\n\t\tplugins = {},\t\t\t// list of included plugins\r\n\t\tprepared_move = {};\t\t// for the move_node function\r\n\r\n\t// jQuery plugin wrapper (thanks to jquery UI widget function)\r\n\t$.fn.jstree = function (settings) {\r\n\t\tvar isMethodCall = (typeof settings == 'string'), // is this a method call like $().jstree(\"open_node\")\r\n\t\t\targs = Array.prototype.slice.call(arguments, 1),\r\n\t\t\treturnValue = this;\r\n\r\n\t\t// if a method call execute the method on all selected instances\r\n\t\tif(isMethodCall) {\r\n\t\t\tif(settings.substring(0, 1) == '_') { return returnValue; }\r\n\t\t\tthis.each(function() {\r\n\t\t\t\tvar instance = instances[$.data(this, \"jstree_instance_id\")],\r\n\t\t\t\t\tmethodValue = (instance && $.isFunction(instance[settings])) ? instance[settings].apply(instance, args) : instance;\r\n\t\t\t\t\tif(typeof methodValue !== \"undefined\" && (settings.indexOf(\"is_\") === 0 || (methodValue !== true && methodValue !== false))) { returnValue = methodValue; return false; }\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.each(function() {\r\n\t\t\t\t// extend settings and allow for multiple hashes and $.data\r\n\t\t\t\tvar instance_id = $.data(this, \"jstree_instance_id\"),\r\n\t\t\t\t\ta = [],\r\n\t\t\t\t\tb = settings ? $.extend({}, true, settings) : {},\r\n\t\t\t\t\tc = $(this),\r\n\t\t\t\t\ts = false,\r\n\t\t\t\t\tt = [];\r\n\t\t\t\ta = a.concat(args);\r\n\t\t\t\tif(c.data(\"jstree\")) { a.push(c.data(\"jstree\")); }\r\n\t\t\t\tb = a.length ? $.extend.apply(null, [true, b].concat(a)) : b;\r\n\r\n\t\t\t\t// if an instance already exists, destroy it first\r\n\t\t\t\tif(typeof instance_id !== \"undefined\" && instances[instance_id]) { instances[instance_id].destroy(); }\r\n\t\t\t\t// push a new empty object to the instances array\r\n\t\t\t\tinstance_id = parseInt(instances.push({}),10) - 1;\r\n\t\t\t\t// store the jstree instance id to the container element\r\n\t\t\t\t$.data(this, \"jstree_instance_id\", instance_id);\r\n\t\t\t\t// clean up all plugins\r\n\t\t\t\tb.plugins = $.isArray(b.plugins) ? b.plugins : $.jstree.defaults.plugins.slice();\r\n\t\t\t\tb.plugins.unshift(\"core\");\r\n\t\t\t\t// only unique plugins\r\n\t\t\t\tb.plugins = b.plugins.sort().join(\",,\").replace(/(,|^)([^,]+)(,,\\2)+(,|$)/g,\"$1$2$4\").replace(/,,+/g,\",\").replace(/,$/,\"\").split(\",\");\r\n\r\n\t\t\t\t// extend defaults with passed data\r\n\t\t\t\ts = $.extend(true, {}, $.jstree.defaults, b);\r\n\t\t\t\ts.plugins = b.plugins;\r\n\t\t\t\t$.each(plugins, function (i, val) {\r\n\t\t\t\t\tif($.inArray(i, s.plugins) === -1) { s[i] = null; delete s[i]; }\r\n\t\t\t\t\telse { t.push(i); }\r\n\t\t\t\t});\r\n\t\t\t\ts.plugins = t;\r\n\r\n\t\t\t\t// push the new object to the instances array (at the same time set the default classes to the container) and init\r\n\t\t\t\tinstances[instance_id] = new $.jstree._instance(instance_id, $(this).addClass(\"jstree jstree-\" + instance_id), s);\r\n\t\t\t\t// init all activated plugins for this instance\r\n\t\t\t\t$.each(instances[instance_id]._get_settings().plugins, function (i, val) { instances[instance_id].data[val] = {}; });\r\n\t\t\t\t$.each(instances[instance_id]._get_settings().plugins, function (i, val) { if(plugins[val]) { plugins[val].__init.apply(instances[instance_id]); } });\r\n\t\t\t\t// initialize the instance\r\n\t\t\t\tsetTimeout(function() { if(instances[instance_id]) { instances[instance_id].init(); } }, 0);\r\n\t\t\t});\r\n\t\t}\r\n\t\t// return the jquery selection (or if it was a method call that returned a value - the returned value)\r\n\t\treturn returnValue;\r\n\t};\r\n\t// object to store exposed functions and objects\r\n\t$.jstree = {\r\n\t\tdefaults : {\r\n\t\t\tplugins : []\r\n\t\t},\r\n\t\t_focused : function () { return instances[focused_instance] || null; },\r\n\t\t_reference : function (needle) {\r\n\t\t\t// get by instance id\r\n\t\t\tif(instances[needle]) { return instances[needle]; }\r\n\t\t\t// get by DOM (if still no luck - return null\r\n\t\t\tvar o = $(needle);\r\n\t\t\tif(!o.length && typeof needle === \"string\") { o = $(\"#\" + needle); }\r\n\t\t\tif(!o.length) { return null; }\r\n\t\t\treturn instances[o.closest(\".jstree\").data(\"jstree_instance_id\")] || null;\r\n\t\t},\r\n\t\t_instance : function (index, container, settings) {\r\n\t\t\t// for plugins to store data in\r\n\t\t\tthis.data = { core : {} };\r\n\t\t\tthis.get_settings\t= function () { return $.extend(true, {}, settings); };\r\n\t\t\tthis._get_settings\t= function () { return settings; };\r\n\t\t\tthis.get_index\t\t= function () { return index; };\r\n\t\t\tthis.get_container\t= function () { return container; };\r\n\t\t\tthis.get_container_ul = function () { return container.children(\"ul:eq(0)\"); };\r\n\t\t\tthis._set_settings\t= function (s) {\r\n\t\t\t\tsettings = $.extend(true, {}, settings, s);\r\n\t\t\t};\r\n\t\t},\r\n\t\t_fn : { },\r\n\t\tplugin : function (pname, pdata) {\r\n\t\t\tpdata = $.extend({}, {\r\n\t\t\t\t__init\t\t: $.noop,\r\n\t\t\t\t__destroy\t: $.noop,\r\n\t\t\t\t_fn\t\t\t: {},\r\n\t\t\t\tdefaults\t: false\r\n\t\t\t}, pdata);\r\n\t\t\tplugins[pname] = pdata;\r\n\r\n\t\t\t$.jstree.defaults[pname] = pdata.defaults;\r\n\t\t\t$.each(pdata._fn, function (i, val) {\r\n\t\t\t\tval.plugin\t\t= pname;\r\n\t\t\t\tval.old\t\t\t= $.jstree._fn[i];\r\n\t\t\t\t$.jstree._fn[i] = function () {\r\n\t\t\t\t\tvar rslt,\r\n\t\t\t\t\t\tfunc = val,\r\n\t\t\t\t\t\targs = Array.prototype.slice.call(arguments),\r\n\t\t\t\t\t\tevnt = new $.Event(\"before.jstree\"),\r\n\t\t\t\t\t\trlbk = false;\r\n\r\n\t\t\t\t\tif(this.data.core.locked === true && i !== \"unlock\" && i !== \"is_locked\") { return; }\r\n\r\n\t\t\t\t\t// Check if function belongs to the included plugins of this instance\r\n\t\t\t\t\tdo {\r\n\t\t\t\t\t\tif(func && func.plugin && $.inArray(func.plugin, this._get_settings().plugins) !== -1) { break; }\r\n\t\t\t\t\t\tfunc = func.old;\r\n\t\t\t\t\t} while(func);\r\n\t\t\t\t\tif(!func) { return; }\r\n\r\n\t\t\t\t\t// context and function to trigger events, then finally call the function\r\n\t\t\t\t\tif(i.indexOf(\"_\") === 0) {\r\n\t\t\t\t\t\trslt = func.apply(this, args);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\trslt = this.get_container().triggerHandler(evnt, { \"func\" : i, \"inst\" : this, \"args\" : args, \"plugin\" : func.plugin });\r\n\t\t\t\t\t\tif(rslt === false) { return; }\r\n\t\t\t\t\t\tif(typeof rslt !== \"undefined\") { args = rslt; }\r\n\r\n\t\t\t\t\t\trslt = func.apply(\r\n\t\t\t\t\t\t\t$.extend({}, this, {\r\n\t\t\t\t\t\t\t\t__callback : function (data) {\r\n\t\t\t\t\t\t\t\t\tthis.get_container().triggerHandler( i + '.jstree', { \"inst\" : this, \"args\" : args, \"rslt\" : data, \"rlbk\" : rlbk });\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t__rollback : function () {\r\n\t\t\t\t\t\t\t\t\trlbk = this.get_rollback();\r\n\t\t\t\t\t\t\t\t\treturn rlbk;\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t__call_old : function (replace_arguments) {\r\n\t\t\t\t\t\t\t\t\treturn func.old.apply(this, (replace_arguments ? Array.prototype.slice.call(arguments, 1) : args ) );\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}), args);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// return the result\r\n\t\t\t\t\treturn rslt;\r\n\t\t\t\t};\r\n\t\t\t\t$.jstree._fn[i].old = val.old;\r\n\t\t\t\t$.jstree._fn[i].plugin = pname;\r\n\t\t\t});\r\n\t\t},\r\n\t\trollback : function (rb) {\r\n\t\t\tif(rb) {\r\n\t\t\t\tif(!$.isArray(rb)) { rb = [ rb ]; }\r\n\t\t\t\t$.each(rb, function (i, val) {\r\n\t\t\t\t\tinstances[val.i].set_rollback(val.h, val.d);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t// set the prototype for all instances\r\n\t$.jstree._fn = $.jstree._instance.prototype = {};\r\n\r\n\t// load the css when DOM is ready\r\n\t$(function() {\r\n\t\t// code is copied from jQuery ($.browser is deprecated + there is a bug in IE)\r\n\t\tvar u = navigator.userAgent.toLowerCase(),\r\n\t\t\tv = (u.match( /.+?(?:rv|it|ra|ie)[\\/: ]([\\d.]+)/ ) || [0,'0'])[1],\r\n\t\t\tcss_string = '' +\r\n\t\t\t\t'.jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } ' +\r\n\t\t\t\t'.jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } ' +\r\n\t\t\t\t'.jstree-rtl li { margin-left:0; margin-right:18px; } ' +\r\n\t\t\t\t'.jstree > ul > li { margin-left:0px; } ' +\r\n\t\t\t\t'.jstree-rtl > ul > li { margin-right:0px; } ' +\r\n\t\t\t\t'.jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } ' +\r\n\t\t\t\t'.jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } ' +\r\n\t\t\t\t'.jstree a:focus { outline: none; } ' +\r\n\t\t\t\t'.jstree a > ins { height:16px; width:16px; } ' +\r\n\t\t\t\t'.jstree a > .jstree-icon { margin-right:3px; } ' +\r\n\t\t\t\t'.jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } ' +\r\n\t\t\t\t'li.jstree-open > ul { display:block; } ' +\r\n\t\t\t\t'li.jstree-closed > ul { display:none; } ';\r\n\t\t// Correct IE 6 (does not support the > CSS selector)\r\n\t\tif(/msie/.test(u) && parseInt(v, 10) == 6) {\r\n\t\t\tis_ie6 = true;\r\n\r\n\t\t\t// fix image flicker and lack of caching\r\n\t\t\ttry {\r\n\t\t\t\tdocument.execCommand(\"BackgroundImageCache\", false, true);\r\n\t\t\t} catch (err) { }\r\n\r\n\t\t\tcss_string += '' +\r\n\t\t\t\t'.jstree li { height:18px; margin-left:0; margin-right:0; } ' +\r\n\t\t\t\t'.jstree li li { margin-left:18px; } ' +\r\n\t\t\t\t'.jstree-rtl li li { margin-left:0px; margin-right:18px; } ' +\r\n\t\t\t\t'li.jstree-open ul { display:block; } ' +\r\n\t\t\t\t'li.jstree-closed ul { display:none !important; } ' +\r\n\t\t\t\t'.jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } ' +\r\n\t\t\t\t'.jstree li a ins { height:16px; width:16px; margin-right:3px; } ' +\r\n\t\t\t\t'.jstree-rtl li a ins { margin-right:0px; margin-left:3px; } ';\r\n\t\t}\r\n\t\t// Correct IE 7 (shifts anchor nodes onhover)\r\n\t\tif(/msie/.test(u) && parseInt(v, 10) == 7) {\r\n\t\t\tis_ie7 = true;\r\n\t\t\tcss_string += '.jstree li a { border-width:0 !important; padding:0px 2px !important; } ';\r\n\t\t}\r\n\t\t// correct ff2 lack of display:inline-block\r\n\t\tif(!/compatible/.test(u) && /mozilla/.test(u) && parseFloat(v, 10) < 1.9) {\r\n\t\t\tis_ff2 = true;\r\n\t\t\tcss_string += '' +\r\n\t\t\t\t'.jstree ins { display:-moz-inline-box; } ' +\r\n\t\t\t\t'.jstree li { line-height:12px; } ' + // WHY??\r\n\t\t\t\t'.jstree a { display:-moz-inline-box; } ' +\r\n\t\t\t\t'.jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } ';\r\n\t\t\t\t/* this shouldn't be here as it is theme specific */\r\n\t\t}\r\n\t\t// the default stylesheet\r\n\t\t$.vakata.css.add_sheet({ str : css_string, title : \"jstree\" });\r\n\t});\r\n\r\n\t// core functions (open, close, create, update, delete)\r\n\t$.jstree.plugin(\"core\", {\r\n\t\t__init : function () {\r\n\t\t\tthis.data.core.locked = false;\r\n\t\t\tthis.data.core.to_open = this.get_settings().core.initially_open;\r\n\t\t\tthis.data.core.to_load = this.get_settings().core.initially_load;\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\thtml_titles\t: false,\r\n\t\t\tanimation\t: 500,\r\n\t\t\tinitially_open : [],\r\n\t\t\tinitially_load : [],\r\n\t\t\topen_parents : true,\r\n\t\t\tnotify_plugins : true,\r\n\t\t\trtl\t\t\t: false,\r\n\t\t\tload_open\t: false,\r\n\t\t\tstrings\t\t: {\r\n\t\t\t\tloading\t\t: \"Loading ...\",\r\n\t\t\t\tnew_node\t: \"New node\",\r\n\t\t\t\tmultiple_selection : \"Multiple selection\"\r\n\t\t\t}\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\tinit\t: function () {\r\n\t\t\t\tthis.set_focus();\r\n\t\t\t\tif(this._get_settings().core.rtl) {\r\n\t\t\t\t\tthis.get_container().addClass(\"jstree-rtl\").css(\"direction\", \"rtl\");\r\n\t\t\t\t}\r\n\t\t\t\tthis.get_container().html(\"<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>\" + this._get_string(\"loading\") + \"</a></li></ul>\");\r\n\t\t\t\tthis.data.core.li_height = this.get_container_ul().find(\"li.jstree-closed, li.jstree-leaf\").eq(0).height() || 18;\r\n\r\n\t\t\t\tthis.get_container()\r\n\t\t\t\t\t.delegate(\"li > ins\", \"click.jstree\", $.proxy(function (event) {\r\n\t\t\t\t\t\t\tvar trgt = $(event.target);\r\n\t\t\t\t\t\t\t// if(trgt.is(\"ins\") && event.pageY - trgt.offset().top < this.data.core.li_height) { this.toggle_node(trgt); }\r\n\t\t\t\t\t\t\tthis.toggle_node(trgt);\r\n\t\t\t\t\t\t}, this))\r\n\t\t\t\t\t.bind(\"mousedown.jstree\", $.proxy(function () {\r\n\t\t\t\t\t\t\tthis.set_focus(); // This used to be setTimeout(set_focus,0) - why?\r\n\t\t\t\t\t\t}, this))\r\n\t\t\t\t\t.bind(\"dblclick.jstree\", function (event) {\r\n\t\t\t\t\t\tvar sel;\r\n\t\t\t\t\t\tif(document.selection && document.selection.empty) { document.selection.empty(); }\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif(window.getSelection) {\r\n\t\t\t\t\t\t\t\tsel = window.getSelection();\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\tsel.removeAllRanges();\r\n\t\t\t\t\t\t\t\t\tsel.collapse();\r\n\t\t\t\t\t\t\t\t} catch (err) { }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\tif(this._get_settings().core.notify_plugins) {\r\n\t\t\t\t\tthis.get_container()\r\n\t\t\t\t\t\t.bind(\"load_node.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\t\t\tvar o = this._get_node(data.rslt.obj),\r\n\t\t\t\t\t\t\t\t\tt = this;\r\n\t\t\t\t\t\t\t\tif(o === -1) { o = this.get_container_ul(); }\r\n\t\t\t\t\t\t\t\tif(!o.length) { return; }\r\n\t\t\t\t\t\t\t\to.find(\"li\").each(function () {\r\n\t\t\t\t\t\t\t\t\tvar th = $(this);\r\n\t\t\t\t\t\t\t\t\tif(th.data(\"jstree\")) {\r\n\t\t\t\t\t\t\t\t\t\t$.each(th.data(\"jstree\"), function (plugin, values) {\r\n\t\t\t\t\t\t\t\t\t\t\tif(t.data[plugin] && $.isFunction(t[\"_\" + plugin + \"_notify\"])) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tt[\"_\" + plugin + \"_notify\"].call(t, th, values);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}, this));\r\n\t\t\t\t}\r\n\t\t\t\tif(this._get_settings().core.load_open) {\r\n\t\t\t\t\tthis.get_container()\r\n\t\t\t\t\t\t.bind(\"load_node.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\t\t\tvar o = this._get_node(data.rslt.obj),\r\n\t\t\t\t\t\t\t\t\tt = this;\r\n\t\t\t\t\t\t\t\tif(o === -1) { o = this.get_container_ul(); }\r\n\t\t\t\t\t\t\t\tif(!o.length) { return; }\r\n\t\t\t\t\t\t\t\to.find(\"li.jstree-open:not(:has(ul))\").each(function () {\r\n\t\t\t\t\t\t\t\t\tt.load_node(this, $.noop, $.noop);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}, this));\r\n\t\t\t\t}\r\n\t\t\t\tthis.__callback();\r\n\t\t\t\tthis.load_node(-1, function () { this.loaded(); this.reload_nodes(); });\r\n\t\t\t},\r\n\t\t\tdestroy\t: function () {\r\n\t\t\t\tvar i,\r\n\t\t\t\t\tn = this.get_index(),\r\n\t\t\t\t\ts = this._get_settings(),\r\n\t\t\t\t\t_this = this;\r\n\r\n\t\t\t\t$.each(s.plugins, function (i, val) {\r\n\t\t\t\t\ttry { plugins[val].__destroy.apply(_this); } catch(err) { }\r\n\t\t\t\t});\r\n\t\t\t\tthis.__callback();\r\n\t\t\t\t// set focus to another instance if this one is focused\r\n\t\t\t\tif(this.is_focused()) {\r\n\t\t\t\t\tfor(i in instances) {\r\n\t\t\t\t\t\tif(instances.hasOwnProperty(i) && i != n) {\r\n\t\t\t\t\t\t\tinstances[i].set_focus();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// if no other instance found\r\n\t\t\t\tif(n === focused_instance) { focused_instance = -1; }\r\n\t\t\t\t// remove all traces of jstree in the DOM (only the ones set using jstree*) and cleans all events\r\n\t\t\t\tthis.get_container()\r\n\t\t\t\t\t.unbind(\".jstree\")\r\n\t\t\t\t\t.undelegate(\".jstree\")\r\n\t\t\t\t\t.removeData(\"jstree_instance_id\")\r\n\t\t\t\t\t.find(\"[class^='jstree']\")\r\n\t\t\t\t\t\t.addBack()\r\n\t\t\t\t\t\t.attr(\"class\", function () { return this.className.replace(/jstree[^ ]*|$/ig,''); });\r\n\t\t\t\t$(document)\r\n\t\t\t\t\t.unbind(\".jstree-\" + n)\r\n\t\t\t\t\t.undelegate(\".jstree-\" + n);\r\n\t\t\t\t// remove the actual data\r\n\t\t\t\tinstances[n] = null;\r\n\t\t\t\tdelete instances[n];\r\n\t\t\t},\r\n\r\n\t\t\t_core_notify : function (n, data) {\r\n\t\t\t\tif(data.opened) {\r\n\t\t\t\t\tthis.open_node(n, false, true);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tlock : function () {\r\n\t\t\t\tthis.data.core.locked = true;\r\n\t\t\t\tthis.get_container().children(\"ul\").addClass(\"jstree-locked\").css(\"opacity\",\"0.7\");\r\n\t\t\t\tthis.__callback({});\r\n\t\t\t},\r\n\t\t\tunlock : function () {\r\n\t\t\t\tthis.data.core.locked = false;\r\n\t\t\t\tthis.get_container().children(\"ul\").removeClass(\"jstree-locked\").css(\"opacity\",\"1\");\r\n\t\t\t\tthis.__callback({});\r\n\t\t\t},\r\n\t\t\tis_locked : function () { return this.data.core.locked; },\r\n\t\t\tsave_opened : function () {\r\n\t\t\t\tvar _this = this;\r\n\t\t\t\tthis.data.core.to_open = [];\r\n\t\t\t\tthis.get_container_ul().find(\"li.jstree-open\").each(function () {\r\n\t\t\t\t\tif(this.id) { _this.data.core.to_open.push(\"#\" + this.id.toString().replace(/^#/,\"\").replace(/\\\\\\//g,\"/\").replace(/\\//g,\"\\\\\\/\").replace(/\\\\\\./g,\".\").replace(/\\./g,\"\\\\.\").replace(/\\:/g,\"\\\\:\")); }\r\n\t\t\t\t});\r\n\t\t\t\tthis.__callback(_this.data.core.to_open);\r\n\t\t\t},\r\n\t\t\tsave_loaded : function () { },\r\n\t\t\treload_nodes : function (is_callback) {\r\n\t\t\t\tvar _this = this,\r\n\t\t\t\t\tdone = true,\r\n\t\t\t\t\tcurrent = [],\r\n\t\t\t\t\tremaining = [];\r\n\t\t\t\tif(!is_callback) {\r\n\t\t\t\t\tthis.data.core.reopen = false;\r\n\t\t\t\t\tthis.data.core.refreshing = true;\r\n\t\t\t\t\tthis.data.core.to_open = $.map($.makeArray(this.data.core.to_open), function (n) { return \"#\" + n.toString().replace(/^#/,\"\").replace(/\\\\\\//g,\"/\").replace(/\\//g,\"\\\\\\/\").replace(/\\\\\\./g,\".\").replace(/\\./g,\"\\\\.\").replace(/\\:/g,\"\\\\:\"); });\r\n\t\t\t\t\tthis.data.core.to_load = $.map($.makeArray(this.data.core.to_load), function (n) { return \"#\" + n.toString().replace(/^#/,\"\").replace(/\\\\\\//g,\"/\").replace(/\\//g,\"\\\\\\/\").replace(/\\\\\\./g,\".\").replace(/\\./g,\"\\\\.\").replace(/\\:/g,\"\\\\:\"); });\r\n\t\t\t\t\tif(this.data.core.to_open.length) {\r\n\t\t\t\t\t\tthis.data.core.to_load = this.data.core.to_load.concat(this.data.core.to_open);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(this.data.core.to_load.length) {\r\n\t\t\t\t\t$.each(this.data.core.to_load, function (i, val) {\r\n\t\t\t\t\t\tif(val == \"#\") { return true; }\r\n\t\t\t\t\t\tif($(val).length) { current.push(val); }\r\n\t\t\t\t\t\telse { remaining.push(val); }\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(current.length) {\r\n\t\t\t\t\t\tthis.data.core.to_load = remaining;\r\n\t\t\t\t\t\t$.each(current, function (i, val) {\r\n\t\t\t\t\t\t\tif(!_this._is_loaded(val)) {\r\n\t\t\t\t\t\t\t\t_this.load_node(val, function () { _this.reload_nodes(true); }, function () { _this.reload_nodes(true); });\r\n\t\t\t\t\t\t\t\tdone = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(this.data.core.to_open.length) {\r\n\t\t\t\t\t$.each(this.data.core.to_open, function (i, val) {\r\n\t\t\t\t\t\t_this.open_node(val, false, true);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tif(done) {\r\n\t\t\t\t\t// TODO: find a more elegant approach to syncronizing returning requests\r\n\t\t\t\t\tif(this.data.core.reopen) { clearTimeout(this.data.core.reopen); }\r\n\t\t\t\t\tthis.data.core.reopen = setTimeout(function () { _this.__callback({}, _this); }, 50);\r\n\t\t\t\t\tthis.data.core.refreshing = false;\r\n\t\t\t\t\tthis.reopen();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\treopen : function () {\r\n\t\t\t\tvar _this = this;\r\n\t\t\t\tif(this.data.core.to_open.length) {\r\n\t\t\t\t\t$.each(this.data.core.to_open, function (i, val) {\r\n\t\t\t\t\t\t_this.open_node(val, false, true);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tthis.__callback({});\r\n\t\t\t},\r\n\t\t\trefresh : function (obj) {\r\n\t\t\t\tvar _this = this;\r\n\t\t\t\tthis.save_opened();\r\n\t\t\t\tif(!obj) { obj = -1; }\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(!obj) { obj = -1; }\r\n\t\t\t\tif(obj !== -1) { obj.children(\"UL\").remove(); }\r\n\t\t\t\telse { this.get_container_ul().empty(); }\r\n\t\t\t\tthis.load_node(obj, function () { _this.__callback({ \"obj\" : obj}); _this.reload_nodes(); });\r\n\t\t\t},\r\n\t\t\t// Dummy function to fire after the first load (so that there is a jstree.loaded event)\r\n\t\t\tloaded\t: function () {\r\n\t\t\t\tthis.__callback();\r\n\t\t\t},\r\n\t\t\t// deal with focus\r\n\t\t\tset_focus\t: function () {\r\n\t\t\t\tif(this.is_focused()) { return; }\r\n\t\t\t\tvar f = $.jstree._focused();\r\n\t\t\t\tif(f) { f.unset_focus(); }\r\n\r\n\t\t\t\tthis.get_container().addClass(\"jstree-focused\");\r\n\t\t\t\tfocused_instance = this.get_index();\r\n\t\t\t\tthis.__callback();\r\n\t\t\t},\r\n\t\t\tis_focused\t: function () {\r\n\t\t\t\treturn focused_instance == this.get_index();\r\n\t\t\t},\r\n\t\t\tunset_focus\t: function () {\r\n\t\t\t\tif(this.is_focused()) {\r\n\t\t\t\t\tthis.get_container().removeClass(\"jstree-focused\");\r\n\t\t\t\t\tfocused_instance = -1;\r\n\t\t\t\t}\r\n\t\t\t\tthis.__callback();\r\n\t\t\t},\r\n\r\n\t\t\t// traverse\r\n\t\t\t_get_node\t\t: function (obj) {\r\n\t\t\t\tvar $obj = $(obj, this.get_container());\r\n\t\t\t\tif($obj.is(\".jstree\") || obj == -1) { return -1; }\r\n\t\t\t\t$obj = $obj.closest(\"li\", this.get_container());\r\n\t\t\t\treturn $obj.length ? $obj : false;\r\n\t\t\t},\r\n\t\t\t_get_next\t\t: function (obj, strict) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(obj === -1) { return this.get_container().find(\"> ul > li:first-child\"); }\r\n\t\t\t\tif(!obj.length) { return false; }\r\n\t\t\t\tif(strict) { return (obj.nextAll(\"li\").size() > 0) ? obj.nextAll(\"li:eq(0)\") : false; }\r\n\r\n\t\t\t\tif(obj.hasClass(\"jstree-open\")) { return obj.find(\"li:eq(0)\"); }\r\n\t\t\t\telse if(obj.nextAll(\"li\").size() > 0) { return obj.nextAll(\"li:eq(0)\"); }\r\n\t\t\t\telse { return obj.parentsUntil(\".jstree\",\"li\").next(\"li\").eq(0); }\r\n\t\t\t},\r\n\t\t\t_get_prev\t\t: function (obj, strict) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(obj === -1) { return this.get_container().find(\"> ul > li:last-child\"); }\r\n\t\t\t\tif(!obj.length) { return false; }\r\n\t\t\t\tif(strict) { return (obj.prevAll(\"li\").length > 0) ? obj.prevAll(\"li:eq(0)\") : false; }\r\n\r\n\t\t\t\tif(obj.prev(\"li\").length) {\r\n\t\t\t\t\tobj = obj.prev(\"li\").eq(0);\r\n\t\t\t\t\twhile(obj.hasClass(\"jstree-open\")) { obj = obj.children(\"ul:eq(0)\").children(\"li:last\"); }\r\n\t\t\t\t\treturn obj;\r\n\t\t\t\t}\r\n\t\t\t\telse { var o = obj.parentsUntil(\".jstree\",\"li:eq(0)\"); return o.length ? o : false; }\r\n\t\t\t},\r\n\t\t\t_get_parent\t\t: function (obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(obj == -1 || !obj.length) { return false; }\r\n\t\t\t\tvar o = obj.parentsUntil(\".jstree\", \"li:eq(0)\");\r\n\t\t\t\treturn o.length ? o : -1;\r\n\t\t\t},\r\n\t\t\t_get_children\t: function (obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(obj === -1) { return this.get_container().children(\"ul:eq(0)\").children(\"li\"); }\r\n\t\t\t\tif(!obj.length) { return false; }\r\n\t\t\t\treturn obj.children(\"ul:eq(0)\").children(\"li\");\r\n\t\t\t},\r\n\t\t\tget_path\t\t: function (obj, id_mode) {\r\n\t\t\t\tvar p = [],\r\n\t\t\t\t\t_this = this;\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(obj === -1 || !obj || !obj.length) { return false; }\r\n\t\t\t\tobj.parentsUntil(\".jstree\", \"li\").each(function () {\r\n\t\t\t\t\tp.push( id_mode ? this.id : _this.get_text(this) );\r\n\t\t\t\t});\r\n\t\t\t\tp.reverse();\r\n\t\t\t\tp.push( id_mode ? obj.attr(\"id\") : this.get_text(obj) );\r\n\t\t\t\treturn p;\r\n\t\t\t},\r\n\r\n\t\t\t// string functions\r\n\t\t\t_get_string : function (key) {\r\n\t\t\t\treturn this._get_settings().core.strings[key] || key;\r\n\t\t\t},\r\n\r\n\t\t\tis_open\t\t: function (obj) { obj = this._get_node(obj); return obj && obj !== -1 && obj.hasClass(\"jstree-open\"); },\r\n\t\t\tis_closed\t: function (obj) { obj = this._get_node(obj); return obj && obj !== -1 && obj.hasClass(\"jstree-closed\"); },\r\n\t\t\tis_leaf\t\t: function (obj) { obj = this._get_node(obj); return obj && obj !== -1 && obj.hasClass(\"jstree-leaf\"); },\r\n\t\t\tcorrect_state\t: function (obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(!obj || obj === -1) { return false; }\r\n\t\t\t\tobj.removeClass(\"jstree-closed jstree-open\").addClass(\"jstree-leaf\").children(\"ul\").remove();\r\n\t\t\t\tthis.__callback({ \"obj\" : obj });\r\n\t\t\t},\r\n\t\t\t// open/close\r\n\t\t\topen_node\t: function (obj, callback, skip_animation) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(!obj.length) { return false; }\r\n\t\t\t\tif(!obj.hasClass(\"jstree-closed\")) { if(callback) { callback.call(); } return false; }\r\n\t\t\t\tvar s = skip_animation || is_ie6 ? 0 : this._get_settings().core.animation,\r\n\t\t\t\t\tt = this;\r\n\t\t\t\tif(!this._is_loaded(obj)) {\r\n\t\t\t\t\tobj.children(\"a\").addClass(\"jstree-loading\");\r\n\t\t\t\t\tthis.load_node(obj, function () { t.open_node(obj, callback, skip_animation); }, callback);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(this._get_settings().core.open_parents) {\r\n\t\t\t\t\t\tobj.parentsUntil(\".jstree\",\".jstree-closed\").each(function () {\r\n\t\t\t\t\t\t\tt.open_node(this, false, true);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(s) { obj.children(\"ul\").css(\"display\",\"none\"); }\r\n\t\t\t\t\tobj.removeClass(\"jstree-closed\").addClass(\"jstree-open\").children(\"a\").removeClass(\"jstree-loading\");\r\n\t\t\t\t\tif(s) { obj.children(\"ul\").stop(true, true).slideDown(s, function () { this.style.display = \"\"; t.after_open(obj); }); }\r\n\t\t\t\t\telse { t.after_open(obj); }\r\n\t\t\t\t\tthis.__callback({ \"obj\" : obj });\r\n\t\t\t\t\tif(callback) { callback.call(); }\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tafter_open\t: function (obj) { this.__callback({ \"obj\" : obj }); },\r\n\t\t\tclose_node\t: function (obj, skip_animation) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tvar s = skip_animation || is_ie6 ? 0 : this._get_settings().core.animation,\r\n\t\t\t\t\tt = this;\r\n\t\t\t\tif(!obj.length || !obj.hasClass(\"jstree-open\")) { return false; }\r\n\t\t\t\tif(s) { obj.children(\"ul\").attr(\"style\",\"display:block !important\"); }\r\n\t\t\t\tobj.removeClass(\"jstree-open\").addClass(\"jstree-closed\");\r\n\t\t\t\tif(s) { obj.children(\"ul\").stop(true, true).slideUp(s, function () { this.style.display = \"\"; t.after_close(obj); }); }\r\n\t\t\t\telse { t.after_close(obj); }\r\n\t\t\t\tthis.__callback({ \"obj\" : obj });\r\n\t\t\t},\r\n\t\t\tafter_close\t: function (obj) { this.__callback({ \"obj\" : obj }); },\r\n\t\t\ttoggle_node\t: function (obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(obj.hasClass(\"jstree-closed\")) { return this.open_node(obj); }\r\n\t\t\t\tif(obj.hasClass(\"jstree-open\")) { return this.close_node(obj); }\r\n\t\t\t},\r\n\t\t\topen_all\t: function (obj, do_animation, original_obj) {\r\n\t\t\t\tobj = obj ? this._get_node(obj) : -1;\r\n\t\t\t\tif(!obj || obj === -1) { obj = this.get_container_ul(); }\r\n\t\t\t\tif(original_obj) {\r\n\t\t\t\t\tobj = obj.find(\"li.jstree-closed\");\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\toriginal_obj = obj;\r\n\t\t\t\t\tif(obj.is(\".jstree-closed\")) { obj = obj.find(\"li.jstree-closed\").addBack(); }\r\n\t\t\t\t\telse { obj = obj.find(\"li.jstree-closed\"); }\r\n\t\t\t\t}\r\n\t\t\t\tvar _this = this;\r\n\t\t\t\tobj.each(function () {\r\n\t\t\t\t\tvar __this = this;\r\n\t\t\t\t\tif(!_this._is_loaded(this)) { _this.open_node(this, function() { _this.open_all(__this, do_animation, original_obj); }, !do_animation); }\r\n\t\t\t\t\telse { _this.open_node(this, false, !do_animation); }\r\n\t\t\t\t});\r\n\t\t\t\t// so that callback is fired AFTER all nodes are open\r\n\t\t\t\tif(original_obj.find('li.jstree-closed').length === 0) { this.__callback({ \"obj\" : original_obj }); }\r\n\t\t\t},\r\n\t\t\tclose_all\t: function (obj, do_animation) {\r\n\t\t\t\tvar _this = this;\r\n\t\t\t\tobj = obj ? this._get_node(obj) : this.get_container();\r\n\t\t\t\tif(!obj || obj === -1) { obj = this.get_container_ul(); }\r\n\t\t\t\tobj.find(\"li.jstree-open\").addBack().each(function () { _this.close_node(this, !do_animation); });\r\n\t\t\t\tthis.__callback({ \"obj\" : obj });\r\n\t\t\t},\r\n\t\t\tclean_node\t: function (obj) {\r\n\t\t\t\tobj = obj && obj != -1 ? $(obj) : this.get_container_ul();\r\n\t\t\t\tobj = obj.is(\"li\") ? obj.find(\"li\").addBack() : obj.find(\"li\");\r\n\t\t\t\tobj.removeClass(\"jstree-last\")\r\n\t\t\t\t\t.filter(\"li:last-child\").addClass(\"jstree-last\").end()\r\n\t\t\t\t\t.filter(\":has(li)\")\r\n\t\t\t\t\t\t.not(\".jstree-open\").removeClass(\"jstree-leaf\").addClass(\"jstree-closed\");\r\n\t\t\t\tobj.not(\".jstree-open, .jstree-closed\").addClass(\"jstree-leaf\").children(\"ul\").remove();\r\n\t\t\t\tthis.__callback({ \"obj\" : obj });\r\n\t\t\t},\r\n\t\t\t// rollback\r\n\t\t\tget_rollback : function () {\r\n\t\t\t\tthis.__callback();\r\n\t\t\t\treturn { i : this.get_index(), h : this.get_container().children(\"ul\").clone(true), d : this.data };\r\n\t\t\t},\r\n\t\t\tset_rollback : function (html, data) {\r\n\t\t\t\tthis.get_container().empty().append(html);\r\n\t\t\t\tthis.data = data;\r\n\t\t\t\tthis.__callback();\r\n\t\t\t},\r\n\t\t\t// Dummy functions to be overwritten by any datastore plugin included\r\n\t\t\tload_node\t: function (obj, s_call, e_call) { this.__callback({ \"obj\" : obj }); },\r\n\t\t\t_is_loaded\t: function (obj) { return true; },\r\n\r\n\t\t\t// Basic operations: create\r\n\t\t\tcreate_node\t: function (obj, position, js, callback, is_loaded) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tposition = typeof position === \"undefined\" ? \"last\" : position;\r\n\t\t\t\tvar d = $(\"<li />\"),\r\n\t\t\t\t\ts = this._get_settings().core,\r\n\t\t\t\t\ttmp;\r\n\r\n\t\t\t\tif(obj !== -1 && !obj.length) { return false; }\r\n\t\t\t\tif(!is_loaded && !this._is_loaded(obj)) { this.load_node(obj, function () { this.create_node(obj, position, js, callback, true); }); return false; }\r\n\r\n\t\t\t\tthis.__rollback();\r\n\r\n\t\t\t\tif(typeof js === \"string\") { js = { \"data\" : js }; }\r\n\t\t\t\tif(!js) { js = {}; }\r\n\t\t\t\tif(js.attr) { d.attr(js.attr); }\r\n\t\t\t\tif(js.metadata) { d.data(js.metadata); }\r\n\t\t\t\tif(js.state) { d.addClass(\"jstree-\" + js.state); }\r\n\t\t\t\tif(!js.data) { js.data = this._get_string(\"new_node\"); }\r\n\t\t\t\tif(!$.isArray(js.data)) { tmp = js.data; js.data = []; js.data.push(tmp); }\r\n\t\t\t\t$.each(js.data, function (i, m) {\r\n\t\t\t\t\ttmp = $(\"<a />\");\r\n\t\t\t\t\tif($.isFunction(m)) { m = m.call(this, js); }\r\n\t\t\t\t\tif(typeof m == \"string\") { tmp.attr('href','#')[ s.html_titles ? \"html\" : \"text\" ](m); }\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif(!m.attr) { m.attr = {}; }\r\n\t\t\t\t\t\tif(!m.attr.href) { m.attr.href = '#'; }\r\n\t\t\t\t\t\ttmp.attr(m.attr)[ s.html_titles ? \"html\" : \"text\" ](m.title);\r\n\t\t\t\t\t\tif(m.language) { tmp.addClass(m.language); }\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttmp.prepend(\"<ins class='jstree-icon'>&#160;</ins>\");\r\n\t\t\t\t\tif(!m.icon && js.icon) { m.icon = js.icon; }\r\n\t\t\t\t\tif(m.icon) {\r\n\t\t\t\t\t\tif(m.icon.indexOf(\"/\") === -1) { tmp.children(\"ins\").addClass(m.icon); }\r\n\t\t\t\t\t\telse { tmp.children(\"ins\").css(\"background\",\"url('\" + m.icon + \"') center center no-repeat\"); }\r\n\t\t\t\t\t}\r\n\t\t\t\t\td.append(tmp);\r\n\t\t\t\t});\r\n\t\t\t\td.prepend(\"<ins class='jstree-icon'>&#160;</ins>\");\r\n\t\t\t\tif(obj === -1) {\r\n\t\t\t\t\tobj = this.get_container();\r\n\t\t\t\t\tif(position === \"before\") { position = \"first\"; }\r\n\t\t\t\t\tif(position === \"after\") { position = \"last\"; }\r\n\t\t\t\t}\r\n\t\t\t\tswitch(position) {\r\n\t\t\t\t\tcase \"before\": obj.before(d); tmp = this._get_parent(obj); break;\r\n\t\t\t\t\tcase \"after\" : obj.after(d);  tmp = this._get_parent(obj); break;\r\n\t\t\t\t\tcase \"inside\":\r\n\t\t\t\t\tcase \"first\" :\r\n\t\t\t\t\t\tif(!obj.children(\"ul\").length) { obj.append(\"<ul />\"); }\r\n\t\t\t\t\t\tobj.children(\"ul\").prepend(d);\r\n\t\t\t\t\t\ttmp = obj;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"last\":\r\n\t\t\t\t\t\tif(!obj.children(\"ul\").length) { obj.append(\"<ul />\"); }\r\n\t\t\t\t\t\tobj.children(\"ul\").append(d);\r\n\t\t\t\t\t\ttmp = obj;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tif(!obj.children(\"ul\").length) { obj.append(\"<ul />\"); }\r\n\t\t\t\t\t\tif(!position) { position = 0; }\r\n\t\t\t\t\t\ttmp = obj.children(\"ul\").children(\"li\").eq(position);\r\n\t\t\t\t\t\tif(tmp.length) { tmp.before(d); }\r\n\t\t\t\t\t\telse { obj.children(\"ul\").append(d); }\r\n\t\t\t\t\t\ttmp = obj;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif(tmp === -1 || tmp.get(0) === this.get_container().get(0)) { tmp = -1; }\r\n\t\t\t\tthis.clean_node(tmp);\r\n\t\t\t\tthis.__callback({ \"obj\" : d, \"parent\" : tmp });\r\n\t\t\t\tif(callback) { callback.call(this, d); }\r\n\t\t\t\treturn d;\r\n\t\t\t},\r\n\t\t\t// Basic operations: rename (deal with text)\r\n\t\t\tget_text\t: function (obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(!obj.length) { return false; }\r\n\t\t\t\tvar s = this._get_settings().core.html_titles;\r\n\t\t\t\tobj = obj.children(\"a:eq(0)\");\r\n\t\t\t\tif(s) {\r\n\t\t\t\t\tobj = obj.clone();\r\n\t\t\t\t\tobj.children(\"INS\").remove();\r\n\t\t\t\t\treturn obj.html();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tobj = obj.contents().filter(function() { return this.nodeType == 3; })[0];\r\n\t\t\t\t\treturn obj.nodeValue;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tset_text\t: function (obj, val) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(!obj.length) { return false; }\r\n\t\t\t\tobj = obj.children(\"a:eq(0)\");\r\n\t\t\t\tif(this._get_settings().core.html_titles) {\r\n\t\t\t\t\tvar tmp = obj.children(\"INS\").clone();\r\n\t\t\t\t\tobj.html(val).prepend(tmp);\r\n\t\t\t\t\tthis.__callback({ \"obj\" : obj, \"name\" : val });\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tobj = obj.contents().filter(function() { return this.nodeType == 3; })[0];\r\n\t\t\t\t\tthis.__callback({ \"obj\" : obj, \"name\" : val });\r\n\t\t\t\t\treturn (obj.nodeValue = val);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\trename_node : function (obj, val) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tthis.__rollback();\r\n\t\t\t\tif(obj && obj.length && this.set_text.apply(this, Array.prototype.slice.call(arguments))) { this.__callback({ \"obj\" : obj, \"name\" : val }); }\r\n\t\t\t},\r\n\t\t\t// Basic operations: deleting nodes\r\n\t\t\tdelete_node : function (obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(!obj.length) { return false; }\r\n\t\t\t\tthis.__rollback();\r\n\t\t\t\tvar p = this._get_parent(obj), prev = $([]), t = this;\r\n\t\t\t\tobj.each(function () {\r\n\t\t\t\t\tprev = prev.add(t._get_prev(this));\r\n\t\t\t\t});\r\n\t\t\t\tobj = obj.detach();\r\n\t\t\t\tif(p !== -1 && p.find(\"> ul > li\").length === 0) {\r\n\t\t\t\t\tp.removeClass(\"jstree-open jstree-closed\").addClass(\"jstree-leaf\");\r\n\t\t\t\t}\r\n\t\t\t\tthis.clean_node(p);\r\n\t\t\t\tthis.__callback({ \"obj\" : obj, \"prev\" : prev, \"parent\" : p });\r\n\t\t\t\treturn obj;\r\n\t\t\t},\r\n\t\t\tprepare_move : function (o, r, pos, cb, is_cb) {\r\n\t\t\t\tvar p = {};\r\n\r\n\t\t\t\tp.ot = $.jstree._reference(o) || this;\r\n\t\t\t\tp.o = p.ot._get_node(o);\r\n\t\t\t\tp.r = r === - 1 ? -1 : this._get_node(r);\r\n\t\t\t\tp.p = (typeof pos === \"undefined\" || pos === false) ? \"last\" : pos; // TODO: move to a setting\r\n\t\t\t\tif(!is_cb && prepared_move.o && prepared_move.o[0] === p.o[0] && prepared_move.r[0] === p.r[0] && prepared_move.p === p.p) {\r\n\t\t\t\t\tthis.__callback(prepared_move);\r\n\t\t\t\t\tif(cb) { cb.call(this, prepared_move); }\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tp.ot = $.jstree._reference(p.o) || this;\r\n\t\t\t\tp.rt = $.jstree._reference(p.r) || this; // r === -1 ? p.ot : $.jstree._reference(p.r) || this\r\n\t\t\t\tif(p.r === -1 || !p.r) {\r\n\t\t\t\t\tp.cr = -1;\r\n\t\t\t\t\tswitch(p.p) {\r\n\t\t\t\t\t\tcase \"first\":\r\n\t\t\t\t\t\tcase \"before\":\r\n\t\t\t\t\t\tcase \"inside\":\r\n\t\t\t\t\t\t\tp.cp = 0;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"after\":\r\n\t\t\t\t\t\tcase \"last\":\r\n\t\t\t\t\t\t\tp.cp = p.rt.get_container().find(\" > ul > li\").length;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tp.cp = p.p;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(!/^(before|after)$/.test(p.p) && !this._is_loaded(p.r)) {\r\n\t\t\t\t\t\treturn this.load_node(p.r, function () { this.prepare_move(o, r, pos, cb, true); });\r\n\t\t\t\t\t}\r\n\t\t\t\t\tswitch(p.p) {\r\n\t\t\t\t\t\tcase \"before\":\r\n\t\t\t\t\t\t\tp.cp = p.r.index();\r\n\t\t\t\t\t\t\tp.cr = p.rt._get_parent(p.r);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"after\":\r\n\t\t\t\t\t\t\tp.cp = p.r.index() + 1;\r\n\t\t\t\t\t\t\tp.cr = p.rt._get_parent(p.r);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"inside\":\r\n\t\t\t\t\t\tcase \"first\":\r\n\t\t\t\t\t\t\tp.cp = 0;\r\n\t\t\t\t\t\t\tp.cr = p.r;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"last\":\r\n\t\t\t\t\t\t\tp.cp = p.r.find(\" > ul > li\").length;\r\n\t\t\t\t\t\t\tp.cr = p.r;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tp.cp = p.p;\r\n\t\t\t\t\t\t\tp.cr = p.r;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tp.np = p.cr == -1 ? p.rt.get_container() : p.cr;\r\n\t\t\t\tp.op = p.ot._get_parent(p.o);\r\n\t\t\t\tp.cop = p.o.index();\r\n\t\t\t\tif(p.op === -1) { p.op = p.ot ? p.ot.get_container() : this.get_container(); }\r\n\t\t\t\tif(!/^(before|after)$/.test(p.p) && p.op && p.np && p.op[0] === p.np[0] && p.o.index() < p.cp) { p.cp++; }\r\n\t\t\t\t//if(p.p === \"before\" && p.op && p.np && p.op[0] === p.np[0] && p.o.index() < p.cp) { p.cp--; }\r\n\t\t\t\tp.or = p.np.find(\" > ul > li:nth-child(\" + (p.cp + 1) + \")\");\r\n\t\t\t\tprepared_move = p;\r\n\t\t\t\tthis.__callback(prepared_move);\r\n\t\t\t\tif(cb) { cb.call(this, prepared_move); }\r\n\t\t\t},\r\n\t\t\tcheck_move : function () {\r\n\t\t\t\tvar obj = prepared_move, ret = true, r = obj.r === -1 ? this.get_container() : obj.r;\r\n\t\t\t\tif(!obj || !obj.o || obj.or[0] === obj.o[0]) { return false; }\r\n\t\t\t\tif(obj.op && obj.np && obj.op[0] === obj.np[0] && obj.cp - 1 === obj.o.index()) { return false; }\r\n\t\t\t\tobj.o.each(function () {\r\n\t\t\t\t\tif(r.parentsUntil(\".jstree\", \"li\").addBack().index(this) !== -1) { ret = false; return false; }\r\n\t\t\t\t});\r\n\t\t\t\treturn ret;\r\n\t\t\t},\r\n\t\t\tmove_node : function (obj, ref, position, is_copy, is_prepared, skip_check) {\r\n\t\t\t\tif(!is_prepared) {\r\n\t\t\t\t\treturn this.prepare_move(obj, ref, position, function (p) {\r\n\t\t\t\t\t\tthis.move_node(p, false, false, is_copy, true, skip_check);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tif(is_copy) {\r\n\t\t\t\t\tprepared_move.cy = true;\r\n\t\t\t\t}\r\n\t\t\t\tif(!skip_check && !this.check_move()) { return false; }\r\n\r\n\t\t\t\tthis.__rollback();\r\n\t\t\t\tvar o = false;\r\n\t\t\t\tif(is_copy) {\r\n\t\t\t\t\to = obj.o.clone(true);\r\n\t\t\t\t\to.find(\"*[id]\").addBack().each(function () {\r\n\t\t\t\t\t\tif(this.id) { this.id = \"copy_\" + this.id; }\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\telse { o = obj.o; }\r\n\r\n\t\t\t\tif(obj.or.length) { obj.or.before(o); }\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(!obj.np.children(\"ul\").length) { $(\"<ul />\").appendTo(obj.np); }\r\n\t\t\t\t\tobj.np.children(\"ul:eq(0)\").append(o);\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tobj.ot.clean_node(obj.op);\r\n\t\t\t\t\tobj.rt.clean_node(obj.np);\r\n\t\t\t\t\tif(!obj.op.find(\"> ul > li\").length) {\r\n\t\t\t\t\t\tobj.op.removeClass(\"jstree-open jstree-closed\").addClass(\"jstree-leaf\").children(\"ul\").remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) { }\r\n\r\n\t\t\t\tif(is_copy) {\r\n\t\t\t\t\tprepared_move.cy = true;\r\n\t\t\t\t\tprepared_move.oc = o;\r\n\t\t\t\t}\r\n\t\t\t\tthis.__callback(prepared_move);\r\n\t\t\t\treturn prepared_move;\r\n\t\t\t},\r\n\t\t\t_get_move : function () { return prepared_move; }\r\n\t\t}\r\n\t});\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree ui plugin\r\n * This plugins handles selecting/deselecting/hovering/dehovering nodes\r\n */\r\n(function ($) {\r\n\tvar scrollbar_width, e1, e2;\r\n\t$(function() {\r\n\t\tif (/msie/.test(navigator.userAgent.toLowerCase())) {\r\n\t\t\te1 = $('<textarea cols=\"10\" rows=\"2\"></textarea>').css({ position: 'absolute', top: -1000, left: 0 }).appendTo('body');\r\n\t\t\te2 = $('<textarea cols=\"10\" rows=\"2\" style=\"overflow: hidden;\"></textarea>').css({ position: 'absolute', top: -1000, left: 0 }).appendTo('body');\r\n\t\t\tscrollbar_width = e1.width() - e2.width();\r\n\t\t\te1.add(e2).remove();\r\n\t\t}\r\n\t\telse {\r\n\t\t\te1 = $('<div />').css({ width: 100, height: 100, overflow: 'auto', position: 'absolute', top: -1000, left: 0 })\r\n\t\t\t\t\t.prependTo('body').append('<div />').find('div').css({ width: '100%', height: 200 });\r\n\t\t\tscrollbar_width = 100 - e1.width();\r\n\t\t\te1.parent().remove();\r\n\t\t}\r\n\t});\r\n\t$.jstree.plugin(\"ui\", {\r\n\t\t__init : function () {\r\n\t\t\tthis.data.ui.selected = $();\r\n\t\t\tthis.data.ui.last_selected = false;\r\n\t\t\tthis.data.ui.hovered = null;\r\n\t\t\tthis.data.ui.to_select = this.get_settings().ui.initially_select;\r\n\r\n\t\t\tthis.get_container()\r\n\t\t\t\t.delegate(\"a\", \"click.jstree\", $.proxy(function (event) {\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tevent.currentTarget.blur();\r\n\t\t\t\t\t\tif(!$(event.currentTarget).hasClass(\"jstree-loading\")) {\r\n\t\t\t\t\t\t\tthis.select_node(event.currentTarget, true, event);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.delegate(\"a\", \"mouseenter.jstree\", $.proxy(function (event) {\r\n\t\t\t\t\t\tif(!$(event.currentTarget).hasClass(\"jstree-loading\")) {\r\n\t\t\t\t\t\t\tthis.hover_node(event.target);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.delegate(\"a\", \"mouseleave.jstree\", $.proxy(function (event) {\r\n\t\t\t\t\t\tif(!$(event.currentTarget).hasClass(\"jstree-loading\")) {\r\n\t\t\t\t\t\t\tthis.dehover_node(event.target);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"reopen.jstree\", $.proxy(function () {\r\n\t\t\t\t\t\tthis.reselect();\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"get_rollback.jstree\", $.proxy(function () {\r\n\t\t\t\t\t\tthis.dehover_node();\r\n\t\t\t\t\t\tthis.save_selected();\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"set_rollback.jstree\", $.proxy(function () {\r\n\t\t\t\t\t\tthis.reselect();\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"close_node.jstree\", $.proxy(function (event, data) {\r\n\t\t\t\t\t\tvar s = this._get_settings().ui,\r\n\t\t\t\t\t\t\tobj = this._get_node(data.rslt.obj),\r\n\t\t\t\t\t\t\tclk = (obj && obj.length) ? obj.children(\"ul\").find(\"a.jstree-clicked\") : $(),\r\n\t\t\t\t\t\t\t_this = this;\r\n\t\t\t\t\t\tif(s.selected_parent_close === false || !clk.length) { return; }\r\n\t\t\t\t\t\tclk.each(function () {\r\n\t\t\t\t\t\t\t_this.deselect_node(this);\r\n\t\t\t\t\t\t\tif(s.selected_parent_close === \"select_parent\") { _this.select_node(obj); }\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"delete_node.jstree\", $.proxy(function (event, data) {\r\n\t\t\t\t\t\tvar s = this._get_settings().ui.select_prev_on_delete,\r\n\t\t\t\t\t\t\tobj = this._get_node(data.rslt.obj),\r\n\t\t\t\t\t\t\tclk = (obj && obj.length) ? obj.find(\"a.jstree-clicked\") : [],\r\n\t\t\t\t\t\t\t_this = this;\r\n\t\t\t\t\t\tclk.each(function () { _this.deselect_node(this); });\r\n\t\t\t\t\t\tif(s && clk.length) {\r\n\t\t\t\t\t\t\tdata.rslt.prev.each(function () {\r\n\t\t\t\t\t\t\t\tif(this.parentNode) { _this.select_node(this); return false; /* if return false is removed all prev nodes will be selected */}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"move_node.jstree\", $.proxy(function (event, data) {\r\n\t\t\t\t\t\tif(data.rslt.cy) {\r\n\t\t\t\t\t\t\tdata.rslt.oc.find(\"a.jstree-clicked\").removeClass(\"jstree-clicked\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this));\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\tselect_limit : -1, // 0, 1, 2 ... or -1 for unlimited\r\n\t\t\tselect_multiple_modifier : \"ctrl\", // on, or ctrl, shift, alt\r\n\t\t\tselect_range_modifier : \"shift\",\r\n\t\t\tselected_parent_close : \"select_parent\", // false, \"deselect\", \"select_parent\"\r\n\t\t\tselected_parent_open : true,\r\n\t\t\tselect_prev_on_delete : true,\r\n\t\t\tdisable_selecting_children : false,\r\n\t\t\tinitially_select : []\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\t_get_node : function (obj, allow_multiple) {\r\n\t\t\t\tif(typeof obj === \"undefined\" || obj === null) { return allow_multiple ? this.data.ui.selected : this.data.ui.last_selected; }\r\n\t\t\t\tvar $obj = $(obj, this.get_container());\r\n\t\t\t\tif($obj.is(\".jstree\") || obj == -1) { return -1; }\r\n\t\t\t\t$obj = $obj.closest(\"li\", this.get_container());\r\n\t\t\t\treturn $obj.length ? $obj : false;\r\n\t\t\t},\r\n\t\t\t_ui_notify : function (n, data) {\r\n\t\t\t\tif(data.selected) {\r\n\t\t\t\t\tthis.select_node(n, false);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsave_selected : function () {\r\n\t\t\t\tvar _this = this;\r\n\t\t\t\tthis.data.ui.to_select = [];\r\n\t\t\t\tthis.data.ui.selected.each(function () { if(this.id) { _this.data.ui.to_select.push(\"#\" + this.id.toString().replace(/^#/,\"\").replace(/\\\\\\//g,\"/\").replace(/\\//g,\"\\\\\\/\").replace(/\\\\\\./g,\".\").replace(/\\./g,\"\\\\.\").replace(/\\:/g,\"\\\\:\")); } });\r\n\t\t\t\tthis.__callback(this.data.ui.to_select);\r\n\t\t\t},\r\n\t\t\treselect : function () {\r\n\t\t\t\tvar _this = this,\r\n\t\t\t\t\ts = this.data.ui.to_select;\r\n\t\t\t\ts = $.map($.makeArray(s), function (n) { return \"#\" + n.toString().replace(/^#/,\"\").replace(/\\\\\\//g,\"/\").replace(/\\//g,\"\\\\\\/\").replace(/\\\\\\./g,\".\").replace(/\\./g,\"\\\\.\").replace(/\\:/g,\"\\\\:\"); });\r\n\t\t\t\t// this.deselect_all(); WHY deselect, breaks plugin state notifier?\r\n\t\t\t\t$.each(s, function (i, val) { if(val && val !== \"#\") { _this.select_node(val); } });\r\n\t\t\t\tthis.data.ui.selected = this.data.ui.selected.filter(function () { return this.parentNode; });\r\n\t\t\t\tthis.__callback();\r\n\t\t\t},\r\n\t\t\trefresh : function (obj) {\r\n\t\t\t\tthis.save_selected();\r\n\t\t\t\treturn this.__call_old();\r\n\t\t\t},\r\n\t\t\thover_node : function (obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(!obj.length) { return false; }\r\n\t\t\t\t//if(this.data.ui.hovered && obj.get(0) === this.data.ui.hovered.get(0)) { return; }\r\n\t\t\t\tif(!obj.hasClass(\"jstree-hovered\")) { this.dehover_node(); }\r\n\t\t\t\tthis.data.ui.hovered = obj.children(\"a\").addClass(\"jstree-hovered\").parent();\r\n\t\t\t\tthis._fix_scroll(obj);\r\n\t\t\t\tthis.__callback({ \"obj\" : obj });\r\n\t\t\t},\r\n\t\t\tdehover_node : function () {\r\n\t\t\t\tvar obj = this.data.ui.hovered, p;\r\n\t\t\t\tif(!obj || !obj.length) { return false; }\r\n\t\t\t\tp = obj.children(\"a\").removeClass(\"jstree-hovered\").parent();\r\n\t\t\t\tif(this.data.ui.hovered[0] === p[0]) { this.data.ui.hovered = null; }\r\n\t\t\t\tthis.__callback({ \"obj\" : obj });\r\n\t\t\t},\r\n\t\t\tselect_node : function (obj, check, e) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(obj == -1 || !obj || !obj.length) { return false; }\r\n\t\t\t\tvar s = this._get_settings().ui,\r\n\t\t\t\t\tis_multiple = (s.select_multiple_modifier == \"on\" || (s.select_multiple_modifier !== false && e && e[s.select_multiple_modifier + \"Key\"])),\r\n\t\t\t\t\tis_range = (s.select_range_modifier !== false && e && e[s.select_range_modifier + \"Key\"] && this.data.ui.last_selected && this.data.ui.last_selected[0] !== obj[0] && this.data.ui.last_selected.parent()[0] === obj.parent()[0]),\r\n\t\t\t\t\tis_selected = this.is_selected(obj),\r\n\t\t\t\t\tproceed = true,\r\n\t\t\t\t\tt = this;\r\n\t\t\t\tif(check) {\r\n\t\t\t\t\tif(s.disable_selecting_children && is_multiple &&\r\n\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t(obj.parentsUntil(\".jstree\",\"li\").children(\"a.jstree-clicked\").length) ||\r\n\t\t\t\t\t\t\t(obj.children(\"ul\").find(\"a.jstree-clicked:eq(0)\").length)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tproceed = false;\r\n\t\t\t\t\tswitch(!0) {\r\n\t\t\t\t\t\tcase (is_range):\r\n\t\t\t\t\t\t\tthis.data.ui.last_selected.addClass(\"jstree-last-selected\");\r\n\t\t\t\t\t\t\tobj = obj[ obj.index() < this.data.ui.last_selected.index() ? \"nextUntil\" : \"prevUntil\" ](\".jstree-last-selected\").addBack();\r\n\t\t\t\t\t\t\tif(s.select_limit == -1 || obj.length < s.select_limit) {\r\n\t\t\t\t\t\t\t\tthis.data.ui.last_selected.removeClass(\"jstree-last-selected\");\r\n\t\t\t\t\t\t\t\tthis.data.ui.selected.each(function () {\r\n\t\t\t\t\t\t\t\t\tif(this !== t.data.ui.last_selected[0]) { t.deselect_node(this); }\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tis_selected = false;\r\n\t\t\t\t\t\t\t\tproceed = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tproceed = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase (is_selected && !is_multiple):\r\n\t\t\t\t\t\t\tthis.deselect_all();\r\n\t\t\t\t\t\t\tis_selected = false;\r\n\t\t\t\t\t\t\tproceed = true;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase (!is_selected && !is_multiple):\r\n\t\t\t\t\t\t\tif(s.select_limit == -1 || s.select_limit > 0) {\r\n\t\t\t\t\t\t\t\tthis.deselect_all();\r\n\t\t\t\t\t\t\t\tproceed = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase (is_selected && is_multiple):\r\n\t\t\t\t\t\t\tthis.deselect_node(obj);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase (!is_selected && is_multiple):\r\n\t\t\t\t\t\t\tif(s.select_limit == -1 || this.data.ui.selected.length + 1 <= s.select_limit) {\r\n\t\t\t\t\t\t\t\tproceed = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(proceed && !is_selected) {\r\n\t\t\t\t\tif(!is_range) { this.data.ui.last_selected = obj; }\r\n\t\t\t\t\tobj.children(\"a\").addClass(\"jstree-clicked\");\r\n\t\t\t\t\tif(s.selected_parent_open) {\r\n\t\t\t\t\t\tobj.parents(\".jstree-closed\").each(function () { t.open_node(this, false, true); });\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.data.ui.selected = this.data.ui.selected.add(obj);\r\n\t\t\t\t\tthis._fix_scroll(obj.eq(0));\r\n\t\t\t\t\tthis.__callback({ \"obj\" : obj, \"e\" : e });\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t_fix_scroll : function (obj) {\r\n\t\t\t\tvar c = this.get_container()[0], t;\r\n\t\t\t\tif(c.scrollHeight > c.offsetHeight) {\r\n\t\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\t\tif(!obj || obj === -1 || !obj.length || !obj.is(\":visible\")) { return; }\r\n\t\t\t\t\tt = obj.offset().top - this.get_container().offset().top;\r\n\t\t\t\t\tif(t < 0) {\r\n\t\t\t\t\t\tc.scrollTop = c.scrollTop + t - 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(t + this.data.core.li_height + (c.scrollWidth > c.offsetWidth ? scrollbar_width : 0) > c.offsetHeight) {\r\n\t\t\t\t\t\tc.scrollTop = c.scrollTop + (t - c.offsetHeight + this.data.core.li_height + 1 + (c.scrollWidth > c.offsetWidth ? scrollbar_width : 0));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdeselect_node : function (obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(!obj.length) { return false; }\r\n\t\t\t\tif(this.is_selected(obj)) {\r\n\t\t\t\t\tobj.children(\"a\").removeClass(\"jstree-clicked\");\r\n\t\t\t\t\tthis.data.ui.selected = this.data.ui.selected.not(obj);\r\n\t\t\t\t\tif(this.data.ui.last_selected.get(0) === obj.get(0)) { this.data.ui.last_selected = this.data.ui.selected.eq(0); }\r\n\t\t\t\t\tthis.__callback({ \"obj\" : obj });\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttoggle_select : function (obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(!obj.length) { return false; }\r\n\t\t\t\tif(this.is_selected(obj)) { this.deselect_node(obj); }\r\n\t\t\t\telse { this.select_node(obj); }\r\n\t\t\t},\r\n\t\t\tis_selected : function (obj) { return this.data.ui.selected.index(this._get_node(obj)) >= 0; },\r\n\t\t\tget_selected : function (context) {\r\n\t\t\t\treturn context ? $(context).find(\"a.jstree-clicked\").parent() : this.data.ui.selected;\r\n\t\t\t},\r\n\t\t\tdeselect_all : function (context) {\r\n\t\t\t\tvar ret = context ? $(context).find(\"a.jstree-clicked\").parent() : this.get_container().find(\"a.jstree-clicked\").parent();\r\n\t\t\t\tret.children(\"a.jstree-clicked\").removeClass(\"jstree-clicked\");\r\n\t\t\t\tthis.data.ui.selected = $([]);\r\n\t\t\t\tthis.data.ui.last_selected = false;\r\n\t\t\t\tthis.__callback({ \"obj\" : ret });\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\t// include the selection plugin by default\r\n\t$.jstree.defaults.plugins.push(\"ui\");\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree CRRM plugin\r\n * Handles creating/renaming/removing/moving nodes by user interaction.\r\n */\r\n(function ($) {\r\n\t$.jstree.plugin(\"crrm\", {\r\n\t\t__init : function () {\r\n\t\t\tthis.get_container()\r\n\t\t\t\t.bind(\"move_node.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\tif(this._get_settings().crrm.move.open_onmove) {\r\n\t\t\t\t\t\tvar t = this;\r\n\t\t\t\t\t\tdata.rslt.np.parentsUntil(\".jstree\").addBack().filter(\".jstree-closed\").each(function () {\r\n\t\t\t\t\t\t\tt.open_node(this, false, true);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}, this));\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\tinput_width_limit : 200,\r\n\t\t\tmove : {\r\n\t\t\t\talways_copy\t\t\t: false, // false, true or \"multitree\"\r\n\t\t\t\topen_onmove\t\t\t: true,\r\n\t\t\t\tdefault_position\t: \"last\",\r\n\t\t\t\tcheck_move\t\t\t: function (m) { return true; }\r\n\t\t\t}\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\t_show_input : function (obj, callback) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tvar rtl = this._get_settings().core.rtl,\r\n\t\t\t\t\tw = this._get_settings().crrm.input_width_limit,\r\n\t\t\t\t\tw1 = obj.children(\"ins\").width(),\r\n\t\t\t\t\tw2 = obj.find(\"> a:visible > ins\").width() * obj.find(\"> a:visible > ins\").length,\r\n\t\t\t\t\tt = this.get_text(obj),\r\n\t\t\t\t\th1 = $(\"<div />\", { css : { \"position\" : \"absolute\", \"top\" : \"-200px\", \"left\" : (rtl ? \"0px\" : \"-1000px\"), \"visibility\" : \"hidden\" } }).appendTo(\"body\"),\r\n\t\t\t\t\th2 = obj.css(\"position\",\"relative\").append(\r\n\t\t\t\t\t$(\"<input />\", {\r\n\t\t\t\t\t\t\"value\" : t,\r\n\t\t\t\t\t\t\"class\" : \"jstree-rename-input\",\r\n\t\t\t\t\t\t// \"size\" : t.length,\r\n\t\t\t\t\t\t\"css\" : {\r\n\t\t\t\t\t\t\t\"padding\" : \"0\",\r\n\t\t\t\t\t\t\t\"border\" : \"1px solid silver\",\r\n\t\t\t\t\t\t\t\"position\" : \"absolute\",\r\n\t\t\t\t\t\t\t\"left\"  : (rtl ? \"auto\" : (w1 + w2 + 4) + \"px\"),\r\n\t\t\t\t\t\t\t\"right\" : (rtl ? (w1 + w2 + 4) + \"px\" : \"auto\"),\r\n\t\t\t\t\t\t\t\"top\" : \"0px\",\r\n\t\t\t\t\t\t\t\"height\" : (this.data.core.li_height - 2) + \"px\",\r\n\t\t\t\t\t\t\t\"lineHeight\" : (this.data.core.li_height - 2) + \"px\",\r\n\t\t\t\t\t\t\t\"width\" : \"150px\" // will be set a bit further down\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\"blur\" : $.proxy(function () {\r\n\t\t\t\t\t\t\tvar i = obj.children(\".jstree-rename-input\"),\r\n\t\t\t\t\t\t\t\tv = i.val();\r\n\t\t\t\t\t\t\tif(v === \"\") { v = t; }\r\n\t\t\t\t\t\t\th1.remove();\r\n\t\t\t\t\t\t\ti.remove(); // rollback purposes\r\n\t\t\t\t\t\t\tthis.set_text(obj,t); // rollback purposes\r\n\t\t\t\t\t\t\tthis.rename_node(obj, v);\r\n\t\t\t\t\t\t\tcallback.call(this, obj, v, t);\r\n\t\t\t\t\t\t\tobj.css(\"position\",\"\");\r\n\t\t\t\t\t\t}, this),\r\n\t\t\t\t\t\t\"keyup\" : function (event) {\r\n\t\t\t\t\t\t\tvar key = event.keyCode || event.which;\r\n\t\t\t\t\t\t\tif(key == 27) { this.value = t; this.blur(); return; }\r\n\t\t\t\t\t\t\telse if(key == 13) { this.blur(); return; }\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\th2.width(Math.min(h1.text(\"pW\" + this.value).width(),w));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\"keypress\" : function(event) {\r\n\t\t\t\t\t\t\tvar key = event.keyCode || event.which;\r\n\t\t\t\t\t\t\tif(key == 13) { return false; }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t).children(\".jstree-rename-input\");\r\n\t\t\t\tthis.set_text(obj, \"\");\r\n\t\t\t\th1.css({\r\n\t\t\t\t\t\tfontFamily\t\t: h2.css('fontFamily')\t\t|| '',\r\n\t\t\t\t\t\tfontSize\t\t: h2.css('fontSize')\t\t|| '',\r\n\t\t\t\t\t\tfontWeight\t\t: h2.css('fontWeight')\t\t|| '',\r\n\t\t\t\t\t\tfontStyle\t\t: h2.css('fontStyle')\t\t|| '',\r\n\t\t\t\t\t\tfontStretch\t\t: h2.css('fontStretch')\t\t|| '',\r\n\t\t\t\t\t\tfontVariant\t\t: h2.css('fontVariant')\t\t|| '',\r\n\t\t\t\t\t\tletterSpacing\t: h2.css('letterSpacing')\t|| '',\r\n\t\t\t\t\t\twordSpacing\t\t: h2.css('wordSpacing')\t\t|| ''\r\n\t\t\t\t});\r\n\t\t\t\th2.width(Math.min(h1.text(\"pW\" + h2[0].value).width(),w))[0].select();\r\n\t\t\t},\r\n\t\t\trename : function (obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tthis.__rollback();\r\n\t\t\t\tvar f = this.__callback;\r\n\t\t\t\tthis._show_input(obj, function (obj, new_name, old_name) {\r\n\t\t\t\t\tf.call(this, { \"obj\" : obj, \"new_name\" : new_name, \"old_name\" : old_name });\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcreate : function (obj, position, js, callback, skip_rename) {\r\n\t\t\t\tvar t, _this = this;\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(!obj) { obj = -1; }\r\n\t\t\t\tthis.__rollback();\r\n\t\t\t\tt = this.create_node(obj, position, js, function (t) {\r\n\t\t\t\t\tvar p = this._get_parent(t),\r\n\t\t\t\t\t\tpos = $(t).index();\r\n\t\t\t\t\tif(callback) { callback.call(this, t); }\r\n\t\t\t\t\tif(p.length && p.hasClass(\"jstree-closed\")) { this.open_node(p, false, true); }\r\n\t\t\t\t\tif(!skip_rename) {\r\n\t\t\t\t\t\tthis._show_input(t, function (obj, new_name, old_name) {\r\n\t\t\t\t\t\t\t_this.__callback({ \"obj\" : obj, \"name\" : new_name, \"parent\" : p, \"position\" : pos });\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse { _this.__callback({ \"obj\" : t, \"name\" : this.get_text(t), \"parent\" : p, \"position\" : pos }); }\r\n\t\t\t\t});\r\n\t\t\t\treturn t;\r\n\t\t\t},\r\n\t\t\tremove : function (obj) {\r\n\t\t\t\tobj = this._get_node(obj, true);\r\n\t\t\t\tvar p = this._get_parent(obj), prev = this._get_prev(obj);\r\n\t\t\t\tthis.__rollback();\r\n\t\t\t\tobj = this.delete_node(obj);\r\n\t\t\t\tif(obj !== false) { this.__callback({ \"obj\" : obj, \"prev\" : prev, \"parent\" : p }); }\r\n\t\t\t},\r\n\t\t\tcheck_move : function () {\r\n\t\t\t\tif(!this.__call_old()) { return false; }\r\n\t\t\t\tvar s = this._get_settings().crrm.move;\r\n\t\t\t\tif(!s.check_move.call(this, this._get_move())) { return false; }\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\t\t\tmove_node : function (obj, ref, position, is_copy, is_prepared, skip_check) {\r\n\t\t\t\tvar s = this._get_settings().crrm.move;\r\n\t\t\t\tif(!is_prepared) {\r\n\t\t\t\t\tif(typeof position === \"undefined\") { position = s.default_position; }\r\n\t\t\t\t\tif(position === \"inside\" && !s.default_position.match(/^(before|after)$/)) { position = s.default_position; }\r\n\t\t\t\t\treturn this.__call_old(true, obj, ref, position, is_copy, false, skip_check);\r\n\t\t\t\t}\r\n\t\t\t\t// if the move is already prepared\r\n\t\t\t\tif(s.always_copy === true || (s.always_copy === \"multitree\" && obj.rt.get_index() !== obj.ot.get_index() )) {\r\n\t\t\t\t\tis_copy = true;\r\n\t\t\t\t}\r\n\t\t\t\tthis.__call_old(true, obj, ref, position, is_copy, true, skip_check);\r\n\t\t\t},\r\n\r\n\t\t\tcut : function (obj) {\r\n\t\t\t\tobj = this._get_node(obj, true);\r\n\t\t\t\tif(!obj || !obj.length) { return false; }\r\n\t\t\t\tthis.data.crrm.cp_nodes = false;\r\n\t\t\t\tthis.data.crrm.ct_nodes = obj;\r\n\t\t\t\tthis.__callback({ \"obj\" : obj });\r\n\t\t\t},\r\n\t\t\tcopy : function (obj) {\r\n\t\t\t\tobj = this._get_node(obj, true);\r\n\t\t\t\tif(!obj || !obj.length) { return false; }\r\n\t\t\t\tthis.data.crrm.ct_nodes = false;\r\n\t\t\t\tthis.data.crrm.cp_nodes = obj;\r\n\t\t\t\tthis.__callback({ \"obj\" : obj });\r\n\t\t\t},\r\n\t\t\tpaste : function (obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(!obj || !obj.length) { return false; }\r\n\t\t\t\tvar nodes = this.data.crrm.ct_nodes ? this.data.crrm.ct_nodes : this.data.crrm.cp_nodes;\r\n\t\t\t\tif(!this.data.crrm.ct_nodes && !this.data.crrm.cp_nodes) { return false; }\r\n\t\t\t\tif(this.data.crrm.ct_nodes) { this.move_node(this.data.crrm.ct_nodes, obj); this.data.crrm.ct_nodes = false; }\r\n\t\t\t\tif(this.data.crrm.cp_nodes) { this.move_node(this.data.crrm.cp_nodes, obj, false, true); }\r\n\t\t\t\tthis.__callback({ \"obj\" : obj, \"nodes\" : nodes });\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\t// include the crr plugin by default\r\n\t// $.jstree.defaults.plugins.push(\"crrm\");\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree themes plugin\r\n * Handles loading and setting themes, as well as detecting path to themes, etc.\r\n */\r\n(function ($) {\r\n\tvar themes_loaded = [];\r\n\t// this variable stores the path to the themes folder - if left as false - it will be autodetected\r\n\t$.jstree._themes = false;\r\n\t$.jstree.plugin(\"themes\", {\r\n\t\t__init : function () {\r\n\t\t\tthis.get_container()\r\n\t\t\t\t.bind(\"init.jstree\", $.proxy(function () {\r\n\t\t\t\t\t\tvar s = this._get_settings().themes;\r\n\t\t\t\t\t\tthis.data.themes.dots = s.dots;\r\n\t\t\t\t\t\tthis.data.themes.icons = s.icons;\r\n\t\t\t\t\t\tthis.set_theme(s.theme, s.url);\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"loaded.jstree\", $.proxy(function () {\r\n\t\t\t\t\t\t// bound here too, as simple HTML tree's won't honor dots & icons otherwise\r\n\t\t\t\t\t\tif(!this.data.themes.dots) { this.hide_dots(); }\r\n\t\t\t\t\t\telse { this.show_dots(); }\r\n\t\t\t\t\t\tif(!this.data.themes.icons) { this.hide_icons(); }\r\n\t\t\t\t\t\telse { this.show_icons(); }\r\n\t\t\t\t\t}, this));\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\ttheme : \"default\",\r\n\t\t\turl : false,\r\n\t\t\tdots : false,\r\n\t\t\ticons : true\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\tset_theme : function (theme_name, theme_url) {\r\n\t\t\t\tif(!theme_name) { return false; }\r\n\t\t\t\tif(!theme_url) { theme_url = $.jstree._themes + theme_name + '/style.css'; }\r\n\t\t\t\tif($.inArray(theme_url, themes_loaded) == -1) {\r\n\t\t\t\t\t// $.vakata.css.add_sheet({ \"url\" : theme_url });\r\n\t\t\t\t\tthemes_loaded.push(theme_url);\r\n\t\t\t\t}\r\n\t\t\t\tif(this.data.themes.theme != theme_name) {\r\n\t\t\t\t\tthis.get_container().removeClass('jstree-' + this.data.themes.theme);\r\n\t\t\t\t\tthis.data.themes.theme = theme_name;\r\n\t\t\t\t}\r\n\t\t\t\tthis.get_container().addClass('jstree-' + theme_name);\r\n\t\t\t\tif(!this.data.themes.dots) { this.hide_dots(); }\r\n\t\t\t\telse { this.show_dots(); }\r\n\t\t\t\tif(!this.data.themes.icons) { this.hide_icons(); }\r\n\t\t\t\telse { this.show_icons(); }\r\n\t\t\t\tthis.__callback();\r\n\t\t\t},\r\n\t\t\tget_theme\t: function () { return this.data.themes.theme; },\r\n\r\n\t\t\tshow_dots\t: function () { this.data.themes.dots = true; this.get_container().children(\"ul\").removeClass(\"jstree-no-dots\"); },\r\n\t\t\thide_dots\t: function () { this.data.themes.dots = false; this.get_container().children(\"ul\").addClass(\"jstree-no-dots\"); },\r\n\t\t\ttoggle_dots\t: function () { if(this.data.themes.dots) { this.hide_dots(); } else { this.show_dots(); } },\r\n\r\n\t\t\tshow_icons\t: function () { this.data.themes.icons = true; this.get_container().children(\"ul\").removeClass(\"jstree-no-icons\"); },\r\n\t\t\thide_icons\t: function () { this.data.themes.icons = false; this.get_container().children(\"ul\").addClass(\"jstree-no-icons\"); },\r\n\t\t\ttoggle_icons: function () { if(this.data.themes.icons) { this.hide_icons(); } else { this.show_icons(); } }\r\n\t\t}\r\n\t});\r\n\t// autodetect themes path\r\n\t$(function () {\r\n\t\tif($.jstree._themes === false) {\r\n\t\t\t$(\"script\").each(function () {\r\n\t\t\t\tif(this.src.toString().match(/jquery\\.jstree[^\\/]*?\\.js(\\?.*)?$/)) {\r\n\t\t\t\t\t$.jstree._themes = this.src.toString().replace(/jquery\\.jstree[^\\/]*?\\.js(\\?.*)?$/, \"\") + 'themes/';\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tif($.jstree._themes === false) { $.jstree._themes = \"themes/\"; }\r\n\t});\r\n\t// include the themes plugin by default\r\n\t$.jstree.defaults.plugins.push(\"themes\");\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree hotkeys plugin\r\n * Enables keyboard navigation for all tree instances\r\n * Depends on the jstree ui & jquery hotkeys plugins\r\n */\r\n(function ($) {\r\n\tvar bound = [];\r\n\tfunction exec(i, event) {\r\n\t\tvar f = $.jstree._focused(), tmp;\r\n\t\tif(f && f.data && f.data.hotkeys && f.data.hotkeys.enabled) {\r\n\t\t\ttmp = f._get_settings().hotkeys[i];\r\n\t\t\tif(tmp) { return tmp.call(f, event); }\r\n\t\t}\r\n\t}\r\n\t$.jstree.plugin(\"hotkeys\", {\r\n\t\t__init : function () {\r\n\t\t\tif(typeof $.hotkeys === \"undefined\") { throw \"jsTree hotkeys: jQuery hotkeys plugin not included.\"; }\r\n\t\t\tif(!this.data.ui) { throw \"jsTree hotkeys: jsTree UI plugin not included.\"; }\r\n\t\t\t$.each(this._get_settings().hotkeys, function (i, v) {\r\n\t\t\t\tif(v !== false && $.inArray(i, bound) == -1) {\r\n\t\t\t\t\t$(document).bind(\"keydown\", i, function (event) { return exec(i, event); });\r\n\t\t\t\t\tbound.push(i);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.get_container()\r\n\t\t\t\t.bind(\"lock.jstree\", $.proxy(function () {\r\n\t\t\t\t\t\tif(this.data.hotkeys.enabled) { this.data.hotkeys.enabled = false; this.data.hotkeys.revert = true; }\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"unlock.jstree\", $.proxy(function () {\r\n\t\t\t\t\t\tif(this.data.hotkeys.revert) { this.data.hotkeys.enabled = true; }\r\n\t\t\t\t\t}, this));\r\n\t\t\tthis.enable_hotkeys();\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\t\"up\" : function () {\r\n\t\t\t\tvar o = this.data.ui.hovered || this.data.ui.last_selected || -1;\r\n\t\t\t\tthis.hover_node(this._get_prev(o));\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\"ctrl+up\" : function () {\r\n\t\t\t\tvar o = this.data.ui.hovered || this.data.ui.last_selected || -1;\r\n\t\t\t\tthis.hover_node(this._get_prev(o));\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\"shift+up\" : function () {\r\n\t\t\t\tvar o = this.data.ui.hovered || this.data.ui.last_selected || -1;\r\n\t\t\t\tthis.hover_node(this._get_prev(o));\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\"down\" : function () {\r\n\t\t\t\tvar o = this.data.ui.hovered || this.data.ui.last_selected || -1;\r\n\t\t\t\tthis.hover_node(this._get_next(o));\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\"ctrl+down\" : function () {\r\n\t\t\t\tvar o = this.data.ui.hovered || this.data.ui.last_selected || -1;\r\n\t\t\t\tthis.hover_node(this._get_next(o));\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\"shift+down\" : function () {\r\n\t\t\t\tvar o = this.data.ui.hovered || this.data.ui.last_selected || -1;\r\n\t\t\t\tthis.hover_node(this._get_next(o));\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\"left\" : function () {\r\n\t\t\t\tvar o = this.data.ui.hovered || this.data.ui.last_selected;\r\n\t\t\t\tif(o) {\r\n\t\t\t\t\tif(o.hasClass(\"jstree-open\")) { this.close_node(o); }\r\n\t\t\t\t\telse { this.hover_node(this._get_prev(o)); }\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\"ctrl+left\" : function () {\r\n\t\t\t\tvar o = this.data.ui.hovered || this.data.ui.last_selected;\r\n\t\t\t\tif(o) {\r\n\t\t\t\t\tif(o.hasClass(\"jstree-open\")) { this.close_node(o); }\r\n\t\t\t\t\telse { this.hover_node(this._get_prev(o)); }\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\"shift+left\" : function () {\r\n\t\t\t\tvar o = this.data.ui.hovered || this.data.ui.last_selected;\r\n\t\t\t\tif(o) {\r\n\t\t\t\t\tif(o.hasClass(\"jstree-open\")) { this.close_node(o); }\r\n\t\t\t\t\telse { this.hover_node(this._get_prev(o)); }\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\"right\" : function () {\r\n\t\t\t\tvar o = this.data.ui.hovered || this.data.ui.last_selected;\r\n\t\t\t\tif(o && o.length) {\r\n\t\t\t\t\tif(o.hasClass(\"jstree-closed\")) { this.open_node(o); }\r\n\t\t\t\t\telse { this.hover_node(this._get_next(o)); }\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\"ctrl+right\" : function () {\r\n\t\t\t\tvar o = this.data.ui.hovered || this.data.ui.last_selected;\r\n\t\t\t\tif(o && o.length) {\r\n\t\t\t\t\tif(o.hasClass(\"jstree-closed\")) { this.open_node(o); }\r\n\t\t\t\t\telse { this.hover_node(this._get_next(o)); }\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\"shift+right\" : function () {\r\n\t\t\t\tvar o = this.data.ui.hovered || this.data.ui.last_selected;\r\n\t\t\t\tif(o && o.length) {\r\n\t\t\t\t\tif(o.hasClass(\"jstree-closed\")) { this.open_node(o); }\r\n\t\t\t\t\telse { this.hover_node(this._get_next(o)); }\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\"space\" : function () {\r\n\t\t\t\tif(this.data.ui.hovered) { this.data.ui.hovered.children(\"a:eq(0)\").click(); }\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\"ctrl+space\" : function (event) {\r\n\t\t\t\tevent.type = \"click\";\r\n\t\t\t\tif(this.data.ui.hovered) { this.data.ui.hovered.children(\"a:eq(0)\").trigger(event); }\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\"shift+space\" : function (event) {\r\n\t\t\t\tevent.type = \"click\";\r\n\t\t\t\tif(this.data.ui.hovered) { this.data.ui.hovered.children(\"a:eq(0)\").trigger(event); }\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\"f2\" : function () { this.rename(this.data.ui.hovered || this.data.ui.last_selected); },\r\n\t\t\t\"del\" : function () { this.remove(this.data.ui.hovered || this._get_node(null)); }\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\tenable_hotkeys : function () {\r\n\t\t\t\tthis.data.hotkeys.enabled = true;\r\n\t\t\t},\r\n\t\t\tdisable_hotkeys : function () {\r\n\t\t\t\tthis.data.hotkeys.enabled = false;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree JSON plugin\r\n * The JSON data store. Datastores are build by overriding the `load_node` and `_is_loaded` functions.\r\n */\r\n(function ($) {\r\n\t$.jstree.plugin(\"json_data\", {\r\n\t\t__init : function() {\r\n\t\t\tvar s = this._get_settings().json_data;\r\n\t\t\tif(s.progressive_unload) {\r\n\t\t\t\tthis.get_container().bind(\"after_close.jstree\", function (e, data) {\r\n\t\t\t\t\tdata.rslt.obj.children(\"ul\").remove();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\t// `data` can be a function:\r\n\t\t\t//  * accepts two arguments - node being loaded and a callback to pass the result to\r\n\t\t\t//  * will be executed in the current tree's scope & ajax won't be supported\r\n\t\t\tdata : false,\r\n\t\t\tajax : false,\r\n\t\t\tcorrect_state : true,\r\n\t\t\tprogressive_render : false,\r\n\t\t\tprogressive_unload : false\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\tload_node : function (obj, s_call, e_call) { var _this = this; this.load_node_json(obj, function () { _this.__callback({ \"obj\" : _this._get_node(obj) }); s_call.call(this); }, e_call); },\r\n\t\t\t_is_loaded : function (obj) {\r\n\t\t\t\tvar s = this._get_settings().json_data;\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\treturn obj == -1 || !obj || (!s.ajax && !s.progressive_render && !$.isFunction(s.data)) || obj.is(\".jstree-open, .jstree-leaf\") || obj.children(\"ul\").children(\"li\").length > 0;\r\n\t\t\t},\r\n\t\t\trefresh : function (obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tvar s = this._get_settings().json_data;\r\n\t\t\t\tif(obj && obj !== -1 && s.progressive_unload && ($.isFunction(s.data) || !!s.ajax)) {\r\n\t\t\t\t\tobj.removeData(\"jstree_children\");\r\n\t\t\t\t}\r\n\t\t\t\treturn this.__call_old();\r\n\t\t\t},\r\n\t\t\tload_node_json : function (obj, s_call, e_call) {\r\n\t\t\t\tvar s = this.get_settings().json_data, d,\r\n\t\t\t\t\terror_func = function () {},\r\n\t\t\t\t\tsuccess_func = function () {};\r\n\t\t\t\tobj = this._get_node(obj);\r\n\r\n\t\t\t\tif(obj && obj !== -1 && (s.progressive_render || s.progressive_unload) && !obj.is(\".jstree-open, .jstree-leaf\") && obj.children(\"ul\").children(\"li\").length === 0 && obj.data(\"jstree_children\")) {\r\n\t\t\t\t\td = this._parse_json(obj.data(\"jstree_children\"), obj);\r\n\t\t\t\t\tif(d) {\r\n\t\t\t\t\t\tobj.append(d);\r\n\t\t\t\t\t\tif(!s.progressive_unload) { obj.removeData(\"jstree_children\"); }\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.clean_node(obj);\r\n\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(obj && obj !== -1) {\r\n\t\t\t\t\tif(obj.data(\"jstree_is_loading\")) { return; }\r\n\t\t\t\t\telse { obj.data(\"jstree_is_loading\",true); }\r\n\t\t\t\t}\r\n\t\t\t\tswitch(!0) {\r\n\t\t\t\t\tcase (!s.data && !s.ajax): throw \"Neither data nor ajax settings supplied.\";\r\n\t\t\t\t\t// function option added here for easier model integration (also supporting async - see callback)\r\n\t\t\t\t\tcase ($.isFunction(s.data)):\r\n\t\t\t\t\t\ts.data.call(this, obj, $.proxy(function (d) {\r\n\t\t\t\t\t\t\td = this._parse_json(d, obj);\r\n\t\t\t\t\t\t\tif(!d) {\r\n\t\t\t\t\t\t\t\tif(obj === -1 || !obj) {\r\n\t\t\t\t\t\t\t\t\tif(s.correct_state) { this.get_container().children(\"ul\").empty(); }\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tobj.children(\"a.jstree-loading\").removeClass(\"jstree-loading\");\r\n\t\t\t\t\t\t\t\t\tobj.removeData(\"jstree_is_loading\");\r\n\t\t\t\t\t\t\t\t\tif(s.correct_state) { this.correct_state(obj); }\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(e_call) { e_call.call(this); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif(obj === -1 || !obj) { this.get_container().children(\"ul\").empty().append(d.children()); }\r\n\t\t\t\t\t\t\t\telse { obj.append(d).children(\"a.jstree-loading\").removeClass(\"jstree-loading\"); obj.removeData(\"jstree_is_loading\"); }\r\n\t\t\t\t\t\t\t\tthis.clean_node(obj);\r\n\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, this));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase (!!s.data && !s.ajax) || (!!s.data && !!s.ajax && (!obj || obj === -1)):\r\n\t\t\t\t\t\tif(!obj || obj == -1) {\r\n\t\t\t\t\t\t\td = this._parse_json(s.data, obj);\r\n\t\t\t\t\t\t\tif(d) {\r\n\t\t\t\t\t\t\t\tthis.get_container().children(\"ul\").empty().append(d.children());\r\n\t\t\t\t\t\t\t\tthis.clean_node();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif(s.correct_state) { this.get_container().children(\"ul\").empty(); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase (!s.data && !!s.ajax) || (!!s.data && !!s.ajax && obj && obj !== -1):\r\n\t\t\t\t\t\terror_func = function (x, t, e) {\r\n\t\t\t\t\t\t\tvar ef = this.get_settings().json_data.ajax.error;\r\n\t\t\t\t\t\t\tif(ef) { ef.call(this, x, t, e); }\r\n\t\t\t\t\t\t\tif(obj != -1 && obj.length) {\r\n\t\t\t\t\t\t\t\tobj.children(\"a.jstree-loading\").removeClass(\"jstree-loading\");\r\n\t\t\t\t\t\t\t\tobj.removeData(\"jstree_is_loading\");\r\n\t\t\t\t\t\t\t\tif(t === \"success\" && s.correct_state) { this.correct_state(obj); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif(t === \"success\" && s.correct_state) { this.get_container().children(\"ul\").empty(); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(e_call) { e_call.call(this); }\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tsuccess_func = function (d, t, x) {\r\n\t\t\t\t\t\t\tvar sf = this.get_settings().json_data.ajax.success;\r\n\t\t\t\t\t\t\tif(sf) { d = sf.call(this,d,t,x) || d; }\r\n\t\t\t\t\t\t\tif(d === \"\" || (d && d.toString && d.toString().replace(/^[\\s\\n]+$/,\"\") === \"\") || (!$.isArray(d) && !$.isPlainObject(d))) {\r\n\t\t\t\t\t\t\t\treturn error_func.call(this, x, t, \"\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\td = this._parse_json(d, obj);\r\n\t\t\t\t\t\t\tif(d) {\r\n\t\t\t\t\t\t\t\tif(obj === -1 || !obj) { this.get_container().children(\"ul\").empty().append(d.children()); }\r\n\t\t\t\t\t\t\t\telse { obj.append(d).children(\"a.jstree-loading\").removeClass(\"jstree-loading\"); obj.removeData(\"jstree_is_loading\"); }\r\n\t\t\t\t\t\t\t\tthis.clean_node(obj);\r\n\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif(obj === -1 || !obj) {\r\n\t\t\t\t\t\t\t\t\tif(s.correct_state) {\r\n\t\t\t\t\t\t\t\t\t\tthis.get_container().children(\"ul\").empty();\r\n\t\t\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tobj.children(\"a.jstree-loading\").removeClass(\"jstree-loading\");\r\n\t\t\t\t\t\t\t\t\tobj.removeData(\"jstree_is_loading\");\r\n\t\t\t\t\t\t\t\t\tif(s.correct_state) {\r\n\t\t\t\t\t\t\t\t\t\tthis.correct_state(obj);\r\n\t\t\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\ts.ajax.context = this;\r\n\t\t\t\t\t\ts.ajax.error = error_func;\r\n\t\t\t\t\t\ts.ajax.success = success_func;\r\n\t\t\t\t\t\tif(!s.ajax.dataType) { s.ajax.dataType = \"json\"; }\r\n\t\t\t\t\t\tif($.isFunction(s.ajax.url)) { s.ajax.url = s.ajax.url.call(this, obj); }\r\n\t\t\t\t\t\tif($.isFunction(s.ajax.data)) { s.ajax.data = s.ajax.data.call(this, obj); }\r\n\t\t\t\t\t\t$.ajax(s.ajax);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t_parse_json : function (js, obj, is_callback) {\r\n\t\t\t\tvar d = false,\r\n\t\t\t\t\tp = this._get_settings(),\r\n\t\t\t\t\ts = p.json_data,\r\n\t\t\t\t\tt = p.core.html_titles,\r\n\t\t\t\t\ttmp, i, j, ul1, ul2;\r\n\r\n\t\t\t\tif(!js) { return d; }\r\n\t\t\t\tif(s.progressive_unload && obj && obj !== -1) {\r\n\t\t\t\t\tobj.data(\"jstree_children\", d);\r\n\t\t\t\t}\r\n\t\t\t\tif($.isArray(js)) {\r\n\t\t\t\t\td = $();\r\n\t\t\t\t\tif(!js.length) { return false; }\r\n\t\t\t\t\tfor(i = 0, j = js.length; i < j; i++) {\r\n\t\t\t\t\t\ttmp = this._parse_json(js[i], obj, true);\r\n\t\t\t\t\t\tif(tmp.length) { d = d.add(tmp); }\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(typeof js == \"string\") { js = { data : js }; }\r\n\t\t\t\t\tif(!js.data && js.data !== \"\") { return d; }\r\n\t\t\t\t\td = $(\"<li />\");\r\n\t\t\t\t\tif(js.attr) { d.attr(js.attr); }\r\n\t\t\t\t\tif(js.metadata) { d.data(js.metadata); }\r\n\t\t\t\t\tif(js.state) { d.addClass(\"jstree-\" + js.state); }\r\n\t\t\t\t\tif(!$.isArray(js.data)) { tmp = js.data; js.data = []; js.data.push(tmp); }\r\n\t\t\t\t\t$.each(js.data, function (i, m) {\r\n\t\t\t\t\t\ttmp = $(\"<a />\");\r\n\t\t\t\t\t\tif($.isFunction(m)) { m = m.call(this, js); }\r\n\t\t\t\t\t\tif(typeof m == \"string\") { tmp.attr('href','#')[ t ? \"html\" : \"text\" ](m); }\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif(!m.attr) { m.attr = {}; }\r\n\t\t\t\t\t\t\tif(!m.attr.href) { m.attr.href = '#'; }\r\n\t\t\t\t\t\t\ttmp.attr(m.attr)[ t ? \"html\" : \"text\" ](m.title);\r\n\t\t\t\t\t\t\tif(m.language) { tmp.addClass(m.language); }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttmp.prepend(\"<ins class='jstree-icon'>&#160;</ins>\");\r\n\t\t\t\t\t\tif(!m.icon && js.icon) { m.icon = js.icon; }\r\n\t\t\t\t\t\tif(m.icon) {\r\n\t\t\t\t\t\t\tif(m.icon.indexOf(\"/\") === -1) { tmp.children(\"ins\").addClass(m.icon); }\r\n\t\t\t\t\t\t\telse { tmp.children(\"ins\").css(\"background\",\"url('\" + m.icon + \"') center center no-repeat\"); }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\td.append(tmp);\r\n\t\t\t\t\t});\r\n\t\t\t\t\td.prepend(\"<ins class='jstree-icon'>&#160;</ins>\");\r\n\t\t\t\t\tif(js.children) {\r\n\t\t\t\t\t\tif(s.progressive_render && js.state !== \"open\") {\r\n\t\t\t\t\t\t\td.addClass(\"jstree-closed\").data(\"jstree_children\", js.children);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif(s.progressive_unload) { d.data(\"jstree_children\", js.children); }\r\n\t\t\t\t\t\t\tif($.isArray(js.children) && js.children.length) {\r\n\t\t\t\t\t\t\t\ttmp = this._parse_json(js.children, obj, true);\r\n\t\t\t\t\t\t\t\tif(tmp.length) {\r\n\t\t\t\t\t\t\t\t\tul2 = $(\"<ul />\");\r\n\t\t\t\t\t\t\t\t\tul2.append(tmp);\r\n\t\t\t\t\t\t\t\t\td.append(ul2);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(!is_callback) {\r\n\t\t\t\t\tul1 = $(\"<ul />\");\r\n\t\t\t\t\tul1.append(d);\r\n\t\t\t\t\td = ul1;\r\n\t\t\t\t}\r\n\t\t\t\treturn d;\r\n\t\t\t},\r\n\t\t\tget_json : function (obj, li_attr, a_attr, is_callback) {\r\n\t\t\t\tvar result = [],\r\n\t\t\t\t\ts = this._get_settings(),\r\n\t\t\t\t\t_this = this,\r\n\t\t\t\t\ttmp1, tmp2, li, a, t, lang;\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(!obj || obj === -1) { obj = this.get_container().find(\"> ul > li\"); }\r\n\t\t\t\tli_attr = $.isArray(li_attr) ? li_attr : [ \"id\", \"class\" ];\r\n\t\t\t\tif(!is_callback && this.data.types) { li_attr.push(s.types.type_attr); }\r\n\t\t\t\ta_attr = $.isArray(a_attr) ? a_attr : [ ];\r\n\r\n\t\t\t\tobj.each(function () {\r\n\t\t\t\t\tli = $(this);\r\n\t\t\t\t\ttmp1 = { data : [] };\r\n\t\t\t\t\tif(li_attr.length) { tmp1.attr = { }; }\r\n\t\t\t\t\t$.each(li_attr, function (i, v) {\r\n\t\t\t\t\t\ttmp2 = li.attr(v);\r\n\t\t\t\t\t\tif(tmp2 && tmp2.length && tmp2.replace(/jstree[^ ]*/ig,'').length) {\r\n\t\t\t\t\t\t\ttmp1.attr[v] = (\" \" + tmp2).replace(/ jstree[^ ]*/ig,'').replace(/\\s+$/ig,\" \").replace(/^ /,\"\").replace(/ $/,\"\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(li.hasClass(\"jstree-open\")) { tmp1.state = \"open\"; }\r\n\t\t\t\t\tif(li.hasClass(\"jstree-closed\")) { tmp1.state = \"closed\"; }\r\n\t\t\t\t\tif(li.data()) { tmp1.metadata = li.data(); }\r\n\t\t\t\t\ta = li.children(\"a\");\r\n\t\t\t\t\ta.each(function () {\r\n\t\t\t\t\t\tt = $(this);\r\n\t\t\t\t\t\tif(\r\n\t\t\t\t\t\t\ta_attr.length ||\r\n\t\t\t\t\t\t\t$.inArray(\"languages\", s.plugins) !== -1 ||\r\n\t\t\t\t\t\t\tt.children(\"ins\").get(0).style.backgroundImage.length ||\r\n\t\t\t\t\t\t\t(t.children(\"ins\").get(0).className && t.children(\"ins\").get(0).className.replace(/jstree[^ ]*|$/ig,'').length)\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tlang = false;\r\n\t\t\t\t\t\t\tif($.inArray(\"languages\", s.plugins) !== -1 && $.isArray(s.languages) && s.languages.length) {\r\n\t\t\t\t\t\t\t\t$.each(s.languages, function (l, lv) {\r\n\t\t\t\t\t\t\t\t\tif(t.hasClass(lv)) {\r\n\t\t\t\t\t\t\t\t\t\tlang = lv;\r\n\t\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttmp2 = { attr : { }, title : _this.get_text(t, lang) };\r\n\t\t\t\t\t\t\t$.each(a_attr, function (k, z) {\r\n\t\t\t\t\t\t\t\ttmp2.attr[z] = (\" \" + (t.attr(z) || \"\")).replace(/ jstree[^ ]*/ig,'').replace(/\\s+$/ig,\" \").replace(/^ /,\"\").replace(/ $/,\"\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif($.inArray(\"languages\", s.plugins) !== -1 && $.isArray(s.languages) && s.languages.length) {\r\n\t\t\t\t\t\t\t\t$.each(s.languages, function (k, z) {\r\n\t\t\t\t\t\t\t\t\tif(t.hasClass(z)) { tmp2.language = z; return true; }\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(t.children(\"ins\").get(0).className.replace(/jstree[^ ]*|$/ig,'').replace(/^\\s+$/ig,\"\").length) {\r\n\t\t\t\t\t\t\t\ttmp2.icon = t.children(\"ins\").get(0).className.replace(/jstree[^ ]*|$/ig,'').replace(/\\s+$/ig,\" \").replace(/^ /,\"\").replace(/ $/,\"\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(t.children(\"ins\").get(0).style.backgroundImage.length) {\r\n\t\t\t\t\t\t\t\ttmp2.icon = t.children(\"ins\").get(0).style.backgroundImage.replace(\"url(\",\"\").replace(\")\",\"\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\ttmp2 = _this.get_text(t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(a.length > 1) { tmp1.data.push(tmp2); }\r\n\t\t\t\t\t\telse { tmp1.data = tmp2; }\r\n\t\t\t\t\t});\r\n\t\t\t\t\tli = li.find(\"> ul > li\");\r\n\t\t\t\t\tif(li.length) { tmp1.children = _this.get_json(li, li_attr, a_attr, true); }\r\n\t\t\t\t\tresult.push(tmp1);\r\n\t\t\t\t});\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree languages plugin\r\n * Adds support for multiple language versions in one tree\r\n * This basically allows for many titles coexisting in one node, but only one of them being visible at any given time\r\n * This is useful for maintaining the same structure in many languages (hence the name of the plugin)\r\n */\r\n(function ($) {\r\n\t$.jstree.plugin(\"languages\", {\r\n\t\t__init : function () { this._load_css();  },\r\n\t\tdefaults : [],\r\n\t\t_fn : {\r\n\t\t\tset_lang : function (i) {\r\n\t\t\t\tvar langs = this._get_settings().languages,\r\n\t\t\t\t\tst = false,\r\n\t\t\t\t\tselector = \".jstree-\" + this.get_index() + ' a';\r\n\t\t\t\tif(!$.isArray(langs) || langs.length === 0) { return false; }\r\n\t\t\t\tif($.inArray(i,langs) == -1) {\r\n\t\t\t\t\tif(!!langs[i]) { i = langs[i]; }\r\n\t\t\t\t\telse { return false; }\r\n\t\t\t\t}\r\n\t\t\t\tif(i == this.data.languages.current_language) { return true; }\r\n\t\t\t\tst = $.vakata.css.get_css(selector + \".\" + this.data.languages.current_language, false, this.data.languages.language_css);\r\n\t\t\t\tif(st !== false) { st.style.display = \"none\"; }\r\n\t\t\t\tst = $.vakata.css.get_css(selector + \".\" + i, false, this.data.languages.language_css);\r\n\t\t\t\tif(st !== false) { st.style.display = \"\"; }\r\n\t\t\t\tthis.data.languages.current_language = i;\r\n\t\t\t\tthis.__callback(i);\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\t\t\tget_lang : function () {\r\n\t\t\t\treturn this.data.languages.current_language;\r\n\t\t\t},\r\n\t\t\t_get_string : function (key, lang) {\r\n\t\t\t\tvar langs = this._get_settings().languages,\r\n\t\t\t\t\ts = this._get_settings().core.strings;\r\n\t\t\t\tif($.isArray(langs) && langs.length) {\r\n\t\t\t\t\tlang = (lang && $.inArray(lang,langs) != -1) ? lang : this.data.languages.current_language;\r\n\t\t\t\t}\r\n\t\t\t\tif(s[lang] && s[lang][key]) { return s[lang][key]; }\r\n\t\t\t\tif(s[key]) { return s[key]; }\r\n\t\t\t\treturn key;\r\n\t\t\t},\r\n\t\t\tget_text : function (obj, lang) {\r\n\t\t\t\tobj = this._get_node(obj) || this.data.ui.last_selected;\r\n\t\t\t\tif(!obj.size()) { return false; }\r\n\t\t\t\tvar langs = this._get_settings().languages,\r\n\t\t\t\t\ts = this._get_settings().core.html_titles;\r\n\t\t\t\tif($.isArray(langs) && langs.length) {\r\n\t\t\t\t\tlang = (lang && $.inArray(lang,langs) != -1) ? lang : this.data.languages.current_language;\r\n\t\t\t\t\tobj = obj.children(\"a.\" + lang);\r\n\t\t\t\t}\r\n\t\t\t\telse { obj = obj.children(\"a:eq(0)\"); }\r\n\t\t\t\tif(s) {\r\n\t\t\t\t\tobj = obj.clone();\r\n\t\t\t\t\tobj.children(\"INS\").remove();\r\n\t\t\t\t\treturn obj.html();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tobj = obj.contents().filter(function() { return this.nodeType == 3; })[0];\r\n\t\t\t\t\treturn obj.nodeValue;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tset_text : function (obj, val, lang) {\r\n\t\t\t\tobj = this._get_node(obj) || this.data.ui.last_selected;\r\n\t\t\t\tif(!obj.size()) { return false; }\r\n\t\t\t\tvar langs = this._get_settings().languages,\r\n\t\t\t\t\ts = this._get_settings().core.html_titles,\r\n\t\t\t\t\ttmp;\r\n\t\t\t\tif($.isArray(langs) && langs.length) {\r\n\t\t\t\t\tlang = (lang && $.inArray(lang,langs) != -1) ? lang : this.data.languages.current_language;\r\n\t\t\t\t\tobj = obj.children(\"a.\" + lang);\r\n\t\t\t\t}\r\n\t\t\t\telse { obj = obj.children(\"a:eq(0)\"); }\r\n\t\t\t\tif(s) {\r\n\t\t\t\t\ttmp = obj.children(\"INS\").clone();\r\n\t\t\t\t\tobj.html(val).prepend(tmp);\r\n\t\t\t\t\tthis.__callback({ \"obj\" : obj, \"name\" : val, \"lang\" : lang });\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tobj = obj.contents().filter(function() { return this.nodeType == 3; })[0];\r\n\t\t\t\t\tthis.__callback({ \"obj\" : obj, \"name\" : val, \"lang\" : lang });\r\n\t\t\t\t\treturn (obj.nodeValue = val);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t_load_css : function () {\r\n\t\t\t\tvar langs = this._get_settings().languages,\r\n\t\t\t\t\tstr = \"/* languages css */\",\r\n\t\t\t\t\tselector = \".jstree-\" + this.get_index() + ' a',\r\n\t\t\t\t\tln;\r\n\t\t\t\tif($.isArray(langs) && langs.length) {\r\n\t\t\t\t\tthis.data.languages.current_language = langs[0];\r\n\t\t\t\t\tfor(ln = 0; ln < langs.length; ln++) {\r\n\t\t\t\t\t\tstr += selector + \".\" + langs[ln] + \" {\";\r\n\t\t\t\t\t\tif(langs[ln] != this.data.languages.current_language) { str += \" display:none; \"; }\r\n\t\t\t\t\t\tstr += \" } \";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.data.languages.language_css = $.vakata.css.add_sheet({ 'str' : str, 'title' : \"jstree-languages\" });\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcreate_node : function (obj, position, js, callback) {\r\n\t\t\t\tvar t = this.__call_old(true, obj, position, js, function (t) {\r\n\t\t\t\t\tvar langs = this._get_settings().languages,\r\n\t\t\t\t\t\ta = t.children(\"a\"),\r\n\t\t\t\t\t\tln;\r\n\t\t\t\t\tif($.isArray(langs) && langs.length) {\r\n\t\t\t\t\t\tfor(ln = 0; ln < langs.length; ln++) {\r\n\t\t\t\t\t\t\tif(!a.is(\".\" + langs[ln])) {\r\n\t\t\t\t\t\t\t\tt.append(a.eq(0).clone().removeClass(langs.join(\" \")).addClass(langs[ln]));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ta.not(\".\" + langs.join(\", .\")).remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(callback) { callback.call(this, t); }\r\n\t\t\t\t});\r\n\t\t\t\treturn t;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree cookies plugin\r\n * Stores the currently opened/selected nodes in a cookie and then restores them\r\n * Depends on the jquery.cookie plugin\r\n */\r\n(function ($) {\r\n\t$.jstree.plugin(\"cookies\", {\r\n\t\t__init : function () {\r\n\t\t\tif(typeof $.cookie === \"undefined\") { throw \"jsTree cookie: jQuery cookie plugin not included.\"; }\r\n\r\n\t\t\tvar s = this._get_settings().cookies,\r\n\t\t\t\ttmp;\r\n\t\t\tif(!!s.save_loaded) {\r\n\t\t\t\ttmp = $.cookie(s.save_loaded);\r\n\t\t\t\tif(tmp && tmp.length) { this.data.core.to_load = tmp.split(\",\"); }\r\n\t\t\t}\r\n\t\t\tif(!!s.save_opened) {\r\n\t\t\t\ttmp = $.cookie(s.save_opened);\r\n\t\t\t\tif(tmp && tmp.length) { this.data.core.to_open = tmp.split(\",\"); }\r\n\t\t\t}\r\n\t\t\tif(!!s.save_selected) {\r\n\t\t\t\ttmp = $.cookie(s.save_selected);\r\n\t\t\t\tif(tmp && tmp.length && this.data.ui) { this.data.ui.to_select = tmp.split(\",\"); }\r\n\t\t\t}\r\n\t\t\tthis.get_container()\r\n\t\t\t\t.one( ( this.data.ui ? \"reselect\" : \"reopen\" ) + \".jstree\", $.proxy(function () {\r\n\t\t\t\t\tthis.get_container()\r\n\t\t\t\t\t\t.bind(\"open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\t\t\tif(this._get_settings().cookies.auto_save) { this.save_cookie((e.handleObj.namespace + e.handleObj.type).replace(\"jstree\",\"\")); }\r\n\t\t\t\t\t\t\t}, this));\r\n\t\t\t\t}, this));\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\tsave_loaded\t\t: \"jstree_load\",\r\n\t\t\tsave_opened\t\t: \"jstree_open\",\r\n\t\t\tsave_selected\t: \"jstree_select\",\r\n\t\t\tauto_save\t\t: true,\r\n\t\t\tcookie_options\t: {}\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\tsave_cookie : function (c) {\r\n\t\t\t\tif(this.data.core.refreshing) { return; }\r\n\t\t\t\tvar s = this._get_settings().cookies;\r\n\t\t\t\tif(!c) { // if called manually and not by event\r\n\t\t\t\t\tif(s.save_loaded) {\r\n\t\t\t\t\t\tthis.save_loaded();\r\n\t\t\t\t\t\t$.cookie(s.save_loaded, this.data.core.to_load.join(\",\"), s.cookie_options);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(s.save_opened) {\r\n\t\t\t\t\t\tthis.save_opened();\r\n\t\t\t\t\t\t$.cookie(s.save_opened, this.data.core.to_open.join(\",\"), s.cookie_options);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(s.save_selected && this.data.ui) {\r\n\t\t\t\t\t\tthis.save_selected();\r\n\t\t\t\t\t\t$.cookie(s.save_selected, this.data.ui.to_select.join(\",\"), s.cookie_options);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tswitch(c) {\r\n\t\t\t\t\tcase \"open_node\":\r\n\t\t\t\t\tcase \"close_node\":\r\n\t\t\t\t\t\tif(!!s.save_opened) {\r\n\t\t\t\t\t\t\tthis.save_opened();\r\n\t\t\t\t\t\t\t$.cookie(s.save_opened, this.data.core.to_open.join(\",\"), s.cookie_options);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!!s.save_loaded) {\r\n\t\t\t\t\t\t\tthis.save_loaded();\r\n\t\t\t\t\t\t\t$.cookie(s.save_loaded, this.data.core.to_load.join(\",\"), s.cookie_options);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"select_node\":\r\n\t\t\t\t\tcase \"deselect_node\":\r\n\t\t\t\t\t\tif(!!s.save_selected && this.data.ui) {\r\n\t\t\t\t\t\t\tthis.save_selected();\r\n\t\t\t\t\t\t\t$.cookie(s.save_selected, this.data.ui.to_select.join(\",\"), s.cookie_options);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\t// include cookies by default\r\n\t// $.jstree.defaults.plugins.push(\"cookies\");\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree sort plugin\r\n * Sorts items alphabetically (or using any other function)\r\n */\r\n(function ($) {\r\n\t$.jstree.plugin(\"sort\", {\r\n\t\t__init : function () {\r\n\t\t\tthis.get_container()\r\n\t\t\t\t.bind(\"load_node.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tvar obj = this._get_node(data.rslt.obj);\r\n\t\t\t\t\t\tobj = obj === -1 ? this.get_container().children(\"ul\") : obj.children(\"ul\");\r\n\t\t\t\t\t\tthis.sort(obj);\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"rename_node.jstree create_node.jstree create.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tthis.sort(data.rslt.obj.parent());\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"move_node.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tvar m = data.rslt.np == -1 ? this.get_container() : data.rslt.np;\r\n\t\t\t\t\t\tthis.sort(m.children(\"ul\"));\r\n\t\t\t\t\t}, this));\r\n\t\t},\r\n\t\tdefaults : function (a, b) { return this.get_text(a) > this.get_text(b) ? 1 : -1; },\r\n\t\t_fn : {\r\n\t\t\tsort : function (obj) {\r\n\t\t\t\tvar s = this._get_settings().sort,\r\n\t\t\t\t\tt = this;\r\n\t\t\t\tobj.append($.makeArray(obj.children(\"li\")).sort($.proxy(s, t)));\r\n\t\t\t\tobj.find(\"> li > ul\").each(function() { t.sort($(this)); });\r\n\t\t\t\tthis.clean_node(obj);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree DND plugin\r\n * Drag and drop plugin for moving/copying nodes\r\n */\r\n(function ($) {\r\n\tvar o = false,\r\n\t\tr = false,\r\n\t\tm = false,\r\n\t\tml = false,\r\n\t\tsli = false,\r\n\t\tsti = false,\r\n\t\tdir1 = false,\r\n\t\tdir2 = false,\r\n\t\tlast_pos = false;\r\n\t$.vakata.dnd = {\r\n\t\tis_down : false,\r\n\t\tis_drag : false,\r\n\t\thelper : false,\r\n\t\tscroll_spd : 10,\r\n\t\tinit_x : 0,\r\n\t\tinit_y : 0,\r\n\t\tthreshold : 5,\r\n\t\thelper_left : 5,\r\n\t\thelper_top : 10,\r\n\t\tuser_data : {},\r\n\r\n\t\tdrag_start : function (e, data, html) {\r\n\t\t\tif($.vakata.dnd.is_drag) { $.vakata.drag_stop({}); }\r\n\t\t\ttry {\r\n\t\t\t\te.currentTarget.unselectable = \"on\";\r\n\t\t\t\te.currentTarget.onselectstart = function() { return false; };\r\n\t\t\t\tif(e.currentTarget.style) { e.currentTarget.style.MozUserSelect = \"none\"; }\r\n\t\t\t} catch(err) { }\r\n\t\t\t$.vakata.dnd.init_x = e.pageX;\r\n\t\t\t$.vakata.dnd.init_y = e.pageY;\r\n\t\t\t$.vakata.dnd.user_data = data;\r\n\t\t\t$.vakata.dnd.is_down = true;\r\n\t\t\t$.vakata.dnd.helper = $(\"<div id='vakata-dragged' />\").html(html); //.fadeTo(10,0.25);\r\n\t\t\t$(document).bind(\"mousemove\", $.vakata.dnd.drag);\r\n\t\t\t$(document).bind(\"mouseup\", $.vakata.dnd.drag_stop);\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tdrag : function (e) {\r\n\t\t\tif(!$.vakata.dnd.is_down) { return; }\r\n\t\t\tif(!$.vakata.dnd.is_drag) {\r\n\t\t\t\tif(Math.abs(e.pageX - $.vakata.dnd.init_x) > 5 || Math.abs(e.pageY - $.vakata.dnd.init_y) > 5) {\r\n\t\t\t\t\t$.vakata.dnd.helper.appendTo(\"body\");\r\n\t\t\t\t\t$.vakata.dnd.is_drag = true;\r\n\t\t\t\t\t$(document).triggerHandler(\"drag_start.vakata\", { \"event\" : e, \"data\" : $.vakata.dnd.user_data });\r\n\t\t\t\t}\r\n\t\t\t\telse { return; }\r\n\t\t\t}\r\n\r\n\t\t\t// maybe use a scrolling parent element instead of document?\r\n\t\t\tif(e.type === \"mousemove\") { // thought of adding scroll in order to move the helper, but mouse poisition is n/a\r\n\t\t\t\tvar d = $(document), t = d.scrollTop(), l = d.scrollLeft();\r\n\t\t\t\tif(e.pageY - t < 20) {\r\n\t\t\t\t\tif(sti && dir1 === \"down\") { clearInterval(sti); sti = false; }\r\n\t\t\t\t\tif(!sti) { dir1 = \"up\"; sti = setInterval(function () { $(document).scrollTop($(document).scrollTop() - $.vakata.dnd.scroll_spd); }, 150); }\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(sti && dir1 === \"up\") { clearInterval(sti); sti = false; }\r\n\t\t\t\t}\r\n\t\t\t\tif($(window).height() - (e.pageY - t) < 20) {\r\n\t\t\t\t\tif(sti && dir1 === \"up\") { clearInterval(sti); sti = false; }\r\n\t\t\t\t\tif(!sti) { dir1 = \"down\"; sti = setInterval(function () { $(document).scrollTop($(document).scrollTop() + $.vakata.dnd.scroll_spd); }, 150); }\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(sti && dir1 === \"down\") { clearInterval(sti); sti = false; }\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(e.pageX - l < 20) {\r\n\t\t\t\t\tif(sli && dir2 === \"right\") { clearInterval(sli); sli = false; }\r\n\t\t\t\t\tif(!sli) { dir2 = \"left\"; sli = setInterval(function () { $(document).scrollLeft($(document).scrollLeft() - $.vakata.dnd.scroll_spd); }, 150); }\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(sli && dir2 === \"left\") { clearInterval(sli); sli = false; }\r\n\t\t\t\t}\r\n\t\t\t\tif($(window).width() - (e.pageX - l) < 20) {\r\n\t\t\t\t\tif(sli && dir2 === \"left\") { clearInterval(sli); sli = false; }\r\n\t\t\t\t\tif(!sli) { dir2 = \"right\"; sli = setInterval(function () { $(document).scrollLeft($(document).scrollLeft() + $.vakata.dnd.scroll_spd); }, 150); }\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(sli && dir2 === \"right\") { clearInterval(sli); sli = false; }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t$.vakata.dnd.helper.css({ left : (e.pageX + $.vakata.dnd.helper_left) + \"px\", top : (e.pageY + $.vakata.dnd.helper_top) + \"px\" });\r\n\t\t\t$(document).triggerHandler(\"drag.vakata\", { \"event\" : e, \"data\" : $.vakata.dnd.user_data });\r\n\t\t},\r\n\t\tdrag_stop : function (e) {\r\n\t\t\tif(sli) { clearInterval(sli); }\r\n\t\t\tif(sti) { clearInterval(sti); }\r\n\t\t\t$(document).unbind(\"mousemove\", $.vakata.dnd.drag);\r\n\t\t\t$(document).unbind(\"mouseup\", $.vakata.dnd.drag_stop);\r\n\t\t\t$(document).triggerHandler(\"drag_stop.vakata\", { \"event\" : e, \"data\" : $.vakata.dnd.user_data });\r\n\t\t\t$.vakata.dnd.helper.remove();\r\n\t\t\t$.vakata.dnd.init_x = 0;\r\n\t\t\t$.vakata.dnd.init_y = 0;\r\n\t\t\t$.vakata.dnd.user_data = {};\r\n\t\t\t$.vakata.dnd.is_down = false;\r\n\t\t\t$.vakata.dnd.is_drag = false;\r\n\t\t}\r\n\t};\r\n\t$(function() {\r\n\t\tvar css_string = '#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ';\r\n\t\t$.vakata.css.add_sheet({ str : css_string, title : \"vakata\" });\r\n\t});\r\n\r\n\t$.jstree.plugin(\"dnd\", {\r\n\t\t__init : function () {\r\n\t\t\tthis.data.dnd = {\r\n\t\t\t\tactive : false,\r\n\t\t\t\tafter : false,\r\n\t\t\t\tinside : false,\r\n\t\t\t\tbefore : false,\r\n\t\t\t\toff : false,\r\n\t\t\t\tprepared : false,\r\n\t\t\t\tw : 0,\r\n\t\t\t\tto1 : false,\r\n\t\t\t\tto2 : false,\r\n\t\t\t\tcof : false,\r\n\t\t\t\tcw : false,\r\n\t\t\t\tch : false,\r\n\t\t\t\ti1 : false,\r\n\t\t\t\ti2 : false,\r\n\t\t\t\tmto : false\r\n\t\t\t};\r\n\t\t\tthis.get_container()\r\n\t\t\t\t.bind(\"mouseenter.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\tif($.vakata.dnd.is_drag && $.vakata.dnd.user_data.jstree) {\r\n\t\t\t\t\t\t\tif(this.data.themes) {\r\n\t\t\t\t\t\t\t\tm.attr(\"class\", \"jstree-\" + this.data.themes.theme);\r\n\t\t\t\t\t\t\t\tif(ml) { ml.attr(\"class\", \"jstree-\" + this.data.themes.theme); }\r\n\t\t\t\t\t\t\t\t$.vakata.dnd.helper.attr(\"class\", \"jstree-dnd-helper jstree-\" + this.data.themes.theme);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t//if($(e.currentTarget).find(\"> ul > li\").length === 0) {\r\n\t\t\t\t\t\t\tif(e.currentTarget === e.target && $.vakata.dnd.user_data.obj && $($.vakata.dnd.user_data.obj).length && $($.vakata.dnd.user_data.obj).parents(\".jstree:eq(0)\")[0] !== e.target) { // node should not be from the same tree\r\n\t\t\t\t\t\t\t\tvar tr = $.jstree._reference(e.target), dc;\r\n\t\t\t\t\t\t\t\tif(tr.data.dnd.foreign) {\r\n\t\t\t\t\t\t\t\t\tdc = tr._get_settings().dnd.drag_check.call(this, { \"o\" : o, \"r\" : tr.get_container(), is_root : true });\r\n\t\t\t\t\t\t\t\t\tif(dc === true || dc.inside === true || dc.before === true || dc.after === true) {\r\n\t\t\t\t\t\t\t\t\t\t$.vakata.dnd.helper.children(\"ins\").attr(\"class\",\"jstree-ok\");\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\ttr.prepare_move(o, tr.get_container(), \"last\");\r\n\t\t\t\t\t\t\t\t\tif(tr.check_move()) {\r\n\t\t\t\t\t\t\t\t\t\t$.vakata.dnd.helper.children(\"ins\").attr(\"class\",\"jstree-ok\");\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"mouseup.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\t//if($.vakata.dnd.is_drag && $.vakata.dnd.user_data.jstree && $(e.currentTarget).find(\"> ul > li\").length === 0) {\r\n\t\t\t\t\t\tif($.vakata.dnd.is_drag && $.vakata.dnd.user_data.jstree && e.currentTarget === e.target && $.vakata.dnd.user_data.obj && $($.vakata.dnd.user_data.obj).length && $($.vakata.dnd.user_data.obj).parents(\".jstree:eq(0)\")[0] !== e.target) { // node should not be from the same tree\r\n\t\t\t\t\t\t\tvar tr = $.jstree._reference(e.currentTarget), dc;\r\n\t\t\t\t\t\t\tif(tr.data.dnd.foreign) {\r\n\t\t\t\t\t\t\t\tdc = tr._get_settings().dnd.drag_check.call(this, { \"o\" : o, \"r\" : tr.get_container(), is_root : true });\r\n\t\t\t\t\t\t\t\tif(dc === true || dc.inside === true || dc.before === true || dc.after === true) {\r\n\t\t\t\t\t\t\t\t\ttr._get_settings().dnd.drag_finish.call(this, { \"o\" : o, \"r\" : tr.get_container(), is_root : true });\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\ttr.move_node(o, tr.get_container(), \"last\", e[tr._get_settings().dnd.copy_modifier + \"Key\"]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"mouseleave.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\tif(e.relatedTarget && e.relatedTarget.id && e.relatedTarget.id === \"jstree-marker-line\") {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif($.vakata.dnd.is_drag && $.vakata.dnd.user_data.jstree) {\r\n\t\t\t\t\t\t\tif(this.data.dnd.i1) { clearInterval(this.data.dnd.i1); }\r\n\t\t\t\t\t\t\tif(this.data.dnd.i2) { clearInterval(this.data.dnd.i2); }\r\n\t\t\t\t\t\t\tif(this.data.dnd.to1) { clearTimeout(this.data.dnd.to1); }\r\n\t\t\t\t\t\t\tif(this.data.dnd.to2) { clearTimeout(this.data.dnd.to2); }\r\n\t\t\t\t\t\t\tif($.vakata.dnd.helper.children(\"ins\").hasClass(\"jstree-ok\")) {\r\n\t\t\t\t\t\t\t\t$.vakata.dnd.helper.children(\"ins\").attr(\"class\",\"jstree-invalid\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"mousemove.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\tif($.vakata.dnd.is_drag && $.vakata.dnd.user_data.jstree) {\r\n\t\t\t\t\t\t\tvar cnt = this.get_container()[0];\r\n\r\n\t\t\t\t\t\t\t// Horizontal scroll\r\n\t\t\t\t\t\t\tif(e.pageX + 24 > this.data.dnd.cof.left + this.data.dnd.cw) {\r\n\t\t\t\t\t\t\t\tif(this.data.dnd.i1) { clearInterval(this.data.dnd.i1); }\r\n\t\t\t\t\t\t\t\tthis.data.dnd.i1 = setInterval($.proxy(function () { this.scrollLeft += $.vakata.dnd.scroll_spd; }, cnt), 100);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(e.pageX - 24 < this.data.dnd.cof.left) {\r\n\t\t\t\t\t\t\t\tif(this.data.dnd.i1) { clearInterval(this.data.dnd.i1); }\r\n\t\t\t\t\t\t\t\tthis.data.dnd.i1 = setInterval($.proxy(function () { this.scrollLeft -= $.vakata.dnd.scroll_spd; }, cnt), 100);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif(this.data.dnd.i1) { clearInterval(this.data.dnd.i1); }\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// Vertical scroll\r\n\t\t\t\t\t\t\tif(e.pageY + 24 > this.data.dnd.cof.top + this.data.dnd.ch) {\r\n\t\t\t\t\t\t\t\tif(this.data.dnd.i2) { clearInterval(this.data.dnd.i2); }\r\n\t\t\t\t\t\t\t\tthis.data.dnd.i2 = setInterval($.proxy(function () { this.scrollTop += $.vakata.dnd.scroll_spd; }, cnt), 100);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(e.pageY - 24 < this.data.dnd.cof.top) {\r\n\t\t\t\t\t\t\t\tif(this.data.dnd.i2) { clearInterval(this.data.dnd.i2); }\r\n\t\t\t\t\t\t\t\tthis.data.dnd.i2 = setInterval($.proxy(function () { this.scrollTop -= $.vakata.dnd.scroll_spd; }, cnt), 100);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif(this.data.dnd.i2) { clearInterval(this.data.dnd.i2); }\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"scroll.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\tif($.vakata.dnd.is_drag && $.vakata.dnd.user_data.jstree && m && ml) {\r\n\t\t\t\t\t\t\tm.hide();\r\n\t\t\t\t\t\t\tml.hide();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.delegate(\"a\", \"mousedown.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\tif(e.which === 1) {\r\n\t\t\t\t\t\t\tthis.start_drag(e.currentTarget, e);\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.delegate(\"a\", \"mouseenter.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\tif($.vakata.dnd.is_drag && $.vakata.dnd.user_data.jstree) {\r\n\t\t\t\t\t\t\tthis.dnd_enter(e.currentTarget);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.delegate(\"a\", \"mousemove.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\tif($.vakata.dnd.is_drag && $.vakata.dnd.user_data.jstree) {\r\n\t\t\t\t\t\t\tif(!r || !r.length || r.children(\"a\")[0] !== e.currentTarget) {\r\n\t\t\t\t\t\t\t\tthis.dnd_enter(e.currentTarget);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(typeof this.data.dnd.off.top === \"undefined\") { this.data.dnd.off = $(e.target).offset(); }\r\n\t\t\t\t\t\t\tthis.data.dnd.w = (e.pageY - (this.data.dnd.off.top || 0)) % this.data.core.li_height;\r\n\t\t\t\t\t\t\tif(this.data.dnd.w < 0) { this.data.dnd.w += this.data.core.li_height; }\r\n\t\t\t\t\t\t\tthis.dnd_show();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.delegate(\"a\", \"mouseleave.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\tif($.vakata.dnd.is_drag && $.vakata.dnd.user_data.jstree) {\r\n\t\t\t\t\t\t\tif(e.relatedTarget && e.relatedTarget.id && e.relatedTarget.id === \"jstree-marker-line\") {\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(m) { m.hide(); }\r\n\t\t\t\t\t\t\t\tif(ml) { ml.hide(); }\r\n\t\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t\tvar ec = $(e.currentTarget).closest(\"li\"),\r\n\t\t\t\t\t\t\t\ter = $(e.relatedTarget).closest(\"li\");\r\n\t\t\t\t\t\t\tif(er[0] !== ec.prev()[0] && er[0] !== ec.next()[0]) {\r\n\t\t\t\t\t\t\t\tif(m) { m.hide(); }\r\n\t\t\t\t\t\t\t\tif(ml) { ml.hide(); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\tthis.data.dnd.mto = setTimeout(\r\n\t\t\t\t\t\t\t\t(function (t) { return function () { t.dnd_leave(e); }; })(this),\r\n\t\t\t\t\t\t\t0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.delegate(\"a\", \"mouseup.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\tif($.vakata.dnd.is_drag && $.vakata.dnd.user_data.jstree) {\r\n\t\t\t\t\t\t\tthis.dnd_finish(e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t$(document)\r\n\t\t\t\t.bind(\"drag_stop.vakata\", $.proxy(function () {\r\n\t\t\t\t\t\tif(this.data.dnd.to1) { clearTimeout(this.data.dnd.to1); }\r\n\t\t\t\t\t\tif(this.data.dnd.to2) { clearTimeout(this.data.dnd.to2); }\r\n\t\t\t\t\t\tif(this.data.dnd.i1) { clearInterval(this.data.dnd.i1); }\r\n\t\t\t\t\t\tif(this.data.dnd.i2) { clearInterval(this.data.dnd.i2); }\r\n\t\t\t\t\t\tthis.data.dnd.after\t\t= false;\r\n\t\t\t\t\t\tthis.data.dnd.before\t= false;\r\n\t\t\t\t\t\tthis.data.dnd.inside\t= false;\r\n\t\t\t\t\t\tthis.data.dnd.off\t\t= false;\r\n\t\t\t\t\t\tthis.data.dnd.prepared\t= false;\r\n\t\t\t\t\t\tthis.data.dnd.w\t\t\t= false;\r\n\t\t\t\t\t\tthis.data.dnd.to1\t\t= false;\r\n\t\t\t\t\t\tthis.data.dnd.to2\t\t= false;\r\n\t\t\t\t\t\tthis.data.dnd.i1\t\t= false;\r\n\t\t\t\t\t\tthis.data.dnd.i2\t\t= false;\r\n\t\t\t\t\t\tthis.data.dnd.active\t= false;\r\n\t\t\t\t\t\tthis.data.dnd.foreign\t= false;\r\n\t\t\t\t\t\tif(m) { m.css({ \"top\" : \"-2000px\" }); }\r\n\t\t\t\t\t\tif(ml) { ml.css({ \"top\" : \"-2000px\" }); }\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"drag_start.vakata\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tif(data.data.jstree) {\r\n\t\t\t\t\t\t\tvar et = $(data.event.target);\r\n\t\t\t\t\t\t\tif(et.closest(\".jstree\").hasClass(\"jstree-\" + this.get_index())) {\r\n\t\t\t\t\t\t\t\tthis.dnd_enter(et);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t/*\r\n\t\t\t\t.bind(\"keydown.jstree-\" + this.get_index() + \" keyup.jstree-\" + this.get_index(), $.proxy(function(e) {\r\n\t\t\t\t\t\tif($.vakata.dnd.is_drag && $.vakata.dnd.user_data.jstree && !this.data.dnd.foreign) {\r\n\t\t\t\t\t\t\tvar h = $.vakata.dnd.helper.children(\"ins\");\r\n\t\t\t\t\t\t\tif(e[this._get_settings().dnd.copy_modifier + \"Key\"] && h.hasClass(\"jstree-ok\")) {\r\n\t\t\t\t\t\t\t\th.parent().html(h.parent().html().replace(/ \\(Copy\\)$/, \"\") + \" (Copy)\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\th.parent().html(h.parent().html().replace(/ \\(Copy\\)$/, \"\"));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this)); */\r\n\r\n\r\n\r\n\t\t\tvar s = this._get_settings().dnd;\r\n\t\t\tif(s.drag_target) {\r\n\t\t\t\t$(document)\r\n\t\t\t\t\t.delegate(s.drag_target, \"mousedown.jstree-\" + this.get_index(), $.proxy(function (e) {\r\n\t\t\t\t\t\to = e.target;\r\n\t\t\t\t\t\t$.vakata.dnd.drag_start(e, { jstree : true, obj : e.target }, \"<ins class='jstree-icon'></ins>\" + $(e.target).text() );\r\n\t\t\t\t\t\tif(this.data.themes) {\r\n\t\t\t\t\t\t\tif(m) { m.attr(\"class\", \"jstree-\" + this.data.themes.theme); }\r\n\t\t\t\t\t\t\tif(ml) { ml.attr(\"class\", \"jstree-\" + this.data.themes.theme); }\r\n\t\t\t\t\t\t\t$.vakata.dnd.helper.attr(\"class\", \"jstree-dnd-helper jstree-\" + this.data.themes.theme);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t$.vakata.dnd.helper.children(\"ins\").attr(\"class\",\"jstree-invalid\");\r\n\t\t\t\t\t\tvar cnt = this.get_container();\r\n\t\t\t\t\t\tthis.data.dnd.cof = cnt.offset();\r\n\t\t\t\t\t\tthis.data.dnd.cw = parseInt(cnt.width(),10);\r\n\t\t\t\t\t\tthis.data.dnd.ch = parseInt(cnt.height(),10);\r\n\t\t\t\t\t\tthis.data.dnd.foreign = true;\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t}, this));\r\n\t\t\t}\r\n\t\t\tif(s.drop_target) {\r\n\t\t\t\t$(document)\r\n\t\t\t\t\t.delegate(s.drop_target, \"mouseenter.jstree-\" + this.get_index(), $.proxy(function (e) {\r\n\t\t\t\t\t\t\tif(this.data.dnd.active && this._get_settings().dnd.drop_check.call(this, { \"o\" : o, \"r\" : $(e.target), \"e\" : e })) {\r\n\t\t\t\t\t\t\t\t$.vakata.dnd.helper.children(\"ins\").attr(\"class\",\"jstree-ok\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, this))\r\n\t\t\t\t\t.delegate(s.drop_target, \"mouseleave.jstree-\" + this.get_index(), $.proxy(function (e) {\r\n\t\t\t\t\t\t\tif(this.data.dnd.active) {\r\n\t\t\t\t\t\t\t\t$.vakata.dnd.helper.children(\"ins\").attr(\"class\",\"jstree-invalid\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, this))\r\n\t\t\t\t\t.delegate(s.drop_target, \"mouseup.jstree-\" + this.get_index(), $.proxy(function (e) {\r\n\t\t\t\t\t\t\tif(this.data.dnd.active && $.vakata.dnd.helper.children(\"ins\").hasClass(\"jstree-ok\")) {\r\n\t\t\t\t\t\t\t\tthis._get_settings().dnd.drop_finish.call(this, { \"o\" : o, \"r\" : $(e.target), \"e\" : e });\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, this));\r\n\t\t\t}\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\tcopy_modifier\t: \"ctrl\",\r\n\t\t\tcheck_timeout\t: 100,\r\n\t\t\topen_timeout\t: 500,\r\n\t\t\tdrop_target\t\t: \".jstree-drop\",\r\n\t\t\tdrop_check\t\t: function (data) { return true; },\r\n\t\t\tdrop_finish\t\t: $.noop,\r\n\t\t\tdrag_target\t\t: \".jstree-draggable\",\r\n\t\t\tdrag_finish\t\t: $.noop,\r\n\t\t\tdrag_check\t\t: function (data) { return { after : false, before : false, inside : true }; }\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\tdnd_prepare : function () {\r\n\t\t\t\tif(!r || !r.length) { return; }\r\n\t\t\t\tthis.data.dnd.off = r.offset();\r\n\t\t\t\tif(this._get_settings().core.rtl) {\r\n\t\t\t\t\tthis.data.dnd.off.right = this.data.dnd.off.left + r.width();\r\n\t\t\t\t}\r\n\t\t\t\tif(this.data.dnd.foreign) {\r\n\t\t\t\t\tvar a = this._get_settings().dnd.drag_check.call(this, { \"o\" : o, \"r\" : r });\r\n\t\t\t\t\tthis.data.dnd.after = a.after;\r\n\t\t\t\t\tthis.data.dnd.before = a.before;\r\n\t\t\t\t\tthis.data.dnd.inside = a.inside;\r\n\t\t\t\t\tthis.data.dnd.prepared = true;\r\n\t\t\t\t\treturn this.dnd_show();\r\n\t\t\t\t}\r\n\t\t\t\tthis.prepare_move(o, r, \"before\");\r\n\t\t\t\tthis.data.dnd.before = this.check_move();\r\n\t\t\t\tthis.prepare_move(o, r, \"after\");\r\n\t\t\t\tthis.data.dnd.after = this.check_move();\r\n\t\t\t\tif(this._is_loaded(r)) {\r\n\t\t\t\t\tthis.prepare_move(o, r, \"inside\");\r\n\t\t\t\t\tthis.data.dnd.inside = this.check_move();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.data.dnd.inside = false;\r\n\t\t\t\t}\r\n\t\t\t\tthis.data.dnd.prepared = true;\r\n\t\t\t\treturn this.dnd_show();\r\n\t\t\t},\r\n\t\t\tdnd_show : function () {\r\n\t\t\t\tif(!this.data.dnd.prepared) { return; }\r\n\t\t\t\tvar o = [\"before\",\"inside\",\"after\"],\r\n\t\t\t\t\tr = false,\r\n\t\t\t\t\trtl = this._get_settings().core.rtl,\r\n\t\t\t\t\tpos;\r\n\t\t\t\tif(this.data.dnd.w < this.data.core.li_height/3) { o = [\"before\",\"inside\",\"after\"]; }\r\n\t\t\t\telse if(this.data.dnd.w <= this.data.core.li_height*2/3) {\r\n\t\t\t\t\to = this.data.dnd.w < this.data.core.li_height/2 ? [\"inside\",\"before\",\"after\"] : [\"inside\",\"after\",\"before\"];\r\n\t\t\t\t}\r\n\t\t\t\telse { o = [\"after\",\"inside\",\"before\"]; }\r\n\t\t\t\t$.each(o, $.proxy(function (i, val) {\r\n\t\t\t\t\tif(this.data.dnd[val]) {\r\n\t\t\t\t\t\t$.vakata.dnd.helper.children(\"ins\").attr(\"class\",\"jstree-ok\");\r\n\t\t\t\t\t\tr = val;\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}, this));\r\n\t\t\t\tif(r === false) { $.vakata.dnd.helper.children(\"ins\").attr(\"class\",\"jstree-invalid\"); }\r\n\r\n\t\t\t\tpos = rtl ? (this.data.dnd.off.right - 18) : (this.data.dnd.off.left + 10);\r\n\t\t\t\tswitch(r) {\r\n\t\t\t\t\tcase \"before\":\r\n\t\t\t\t\t\tm.css({ \"left\" : pos + \"px\", \"top\" : (this.data.dnd.off.top - 6) + \"px\" }).show();\r\n\t\t\t\t\t\tif(ml) { ml.css({ \"left\" : (pos + 8) + \"px\", \"top\" : (this.data.dnd.off.top - 1) + \"px\" }).show(); }\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"after\":\r\n\t\t\t\t\t\tm.css({ \"left\" : pos + \"px\", \"top\" : (this.data.dnd.off.top + this.data.core.li_height - 6) + \"px\" }).show();\r\n\t\t\t\t\t\tif(ml) { ml.css({ \"left\" : (pos + 8) + \"px\", \"top\" : (this.data.dnd.off.top + this.data.core.li_height - 1) + \"px\" }).show(); }\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"inside\":\r\n\t\t\t\t\t\tm.css({ \"left\" : pos + ( rtl ? -4 : 4) + \"px\", \"top\" : (this.data.dnd.off.top + this.data.core.li_height/2 - 5) + \"px\" }).show();\r\n\t\t\t\t\t\tif(ml) { ml.hide(); }\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tm.hide();\r\n\t\t\t\t\t\tif(ml) { ml.hide(); }\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tlast_pos = r;\r\n\t\t\t\treturn r;\r\n\t\t\t},\r\n\t\t\tdnd_open : function () {\r\n\t\t\t\tthis.data.dnd.to2 = false;\r\n\t\t\t\tthis.open_node(r, $.proxy(this.dnd_prepare,this), true);\r\n\t\t\t},\r\n\t\t\tdnd_finish : function (e) {\r\n\t\t\t\tif(this.data.dnd.foreign) {\r\n\t\t\t\t\tif(this.data.dnd.after || this.data.dnd.before || this.data.dnd.inside) {\r\n\t\t\t\t\t\tthis._get_settings().dnd.drag_finish.call(this, { \"o\" : o, \"r\" : r, \"p\" : last_pos });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.dnd_prepare();\r\n\t\t\t\t\tthis.move_node(o, r, last_pos, e[this._get_settings().dnd.copy_modifier + \"Key\"]);\r\n\t\t\t\t}\r\n\t\t\t\to = false;\r\n\t\t\t\tr = false;\r\n\t\t\t\tm.hide();\r\n\t\t\t\tif(ml) { ml.hide(); }\r\n\t\t\t},\r\n\t\t\tdnd_enter : function (obj) {\r\n\t\t\t\tif(this.data.dnd.mto) {\r\n\t\t\t\t\tclearTimeout(this.data.dnd.mto);\r\n\t\t\t\t\tthis.data.dnd.mto = false;\r\n\t\t\t\t}\r\n\t\t\t\tvar s = this._get_settings().dnd;\r\n\t\t\t\tthis.data.dnd.prepared = false;\r\n\t\t\t\tr = this._get_node(obj);\r\n\t\t\t\tif(s.check_timeout) {\r\n\t\t\t\t\t// do the calculations after a minimal timeout (users tend to drag quickly to the desired location)\r\n\t\t\t\t\tif(this.data.dnd.to1) { clearTimeout(this.data.dnd.to1); }\r\n\t\t\t\t\tthis.data.dnd.to1 = setTimeout($.proxy(this.dnd_prepare, this), s.check_timeout);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.dnd_prepare();\r\n\t\t\t\t}\r\n\t\t\t\tif(s.open_timeout) {\r\n\t\t\t\t\tif(this.data.dnd.to2) { clearTimeout(this.data.dnd.to2); }\r\n\t\t\t\t\tif(r && r.length && r.hasClass(\"jstree-closed\")) {\r\n\t\t\t\t\t\t// if the node is closed - open it, then recalculate\r\n\t\t\t\t\t\tthis.data.dnd.to2 = setTimeout($.proxy(this.dnd_open, this), s.open_timeout);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(r && r.length && r.hasClass(\"jstree-closed\")) {\r\n\t\t\t\t\t\tthis.dnd_open();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdnd_leave : function (e) {\r\n\t\t\t\tthis.data.dnd.after\t\t= false;\r\n\t\t\t\tthis.data.dnd.before\t= false;\r\n\t\t\t\tthis.data.dnd.inside\t= false;\r\n\t\t\t\t$.vakata.dnd.helper.children(\"ins\").attr(\"class\",\"jstree-invalid\");\r\n\t\t\t\tm.hide();\r\n\t\t\t\tif(ml) { ml.hide(); }\r\n\t\t\t\tif(r && r[0] === e.target.parentNode) {\r\n\t\t\t\t\tif(this.data.dnd.to1) {\r\n\t\t\t\t\t\tclearTimeout(this.data.dnd.to1);\r\n\t\t\t\t\t\tthis.data.dnd.to1 = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this.data.dnd.to2) {\r\n\t\t\t\t\t\tclearTimeout(this.data.dnd.to2);\r\n\t\t\t\t\t\tthis.data.dnd.to2 = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tstart_drag : function (obj, e) {\r\n\t\t\t\to = this._get_node(obj);\r\n\t\t\t\tif(this.data.ui && this.is_selected(o)) { o = this._get_node(null, true); }\r\n\t\t\t\tvar dt = o.length > 1 ? this._get_string(\"multiple_selection\") : this.get_text(o),\r\n\t\t\t\t\tcnt = this.get_container();\r\n\t\t\t\tif(!this._get_settings().core.html_titles) { dt = dt.replace(/</ig,\"&lt;\").replace(/>/ig,\"&gt;\"); }\r\n\t\t\t\t$.vakata.dnd.drag_start(e, { jstree : true, obj : o }, \"<ins class='jstree-icon'></ins>\" + dt );\r\n\t\t\t\tif(this.data.themes) {\r\n\t\t\t\t\tif(m) { m.attr(\"class\", \"jstree-\" + this.data.themes.theme); }\r\n\t\t\t\t\tif(ml) { ml.attr(\"class\", \"jstree-\" + this.data.themes.theme); }\r\n\t\t\t\t\t$.vakata.dnd.helper.attr(\"class\", \"jstree-dnd-helper jstree-\" + this.data.themes.theme);\r\n\t\t\t\t}\r\n\t\t\t\tthis.data.dnd.cof = cnt.offset();\r\n\t\t\t\tthis.data.dnd.cw = parseInt(cnt.width(),10);\r\n\t\t\t\tthis.data.dnd.ch = parseInt(cnt.height(),10);\r\n\t\t\t\tthis.data.dnd.active = true;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\t$(function() {\r\n\t\tvar css_string = '' +\r\n\t\t\t'#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px; ' +\r\n\t\t\t' -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; ' +\r\n\t\t\t'} ' +\r\n\t\t\t'#vakata-dragged .jstree-ok { background:green; } ' +\r\n\t\t\t'#vakata-dragged .jstree-invalid { background:red; } ' +\r\n\t\t\t'#jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } ' +\r\n\t\t\t'#jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43; ' +\r\n\t\t\t' cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666; ' +\r\n\t\t\t' -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; ' +\r\n\t\t\t'}' +\r\n\t\t\t'';\r\n\t\t$.vakata.css.add_sheet({ str : css_string, title : \"jstree\" });\r\n\t\tm = $(\"<div />\").attr({ id : \"jstree-marker\" }).hide().html(\"&raquo;\")\r\n\t\t\t.bind(\"mouseleave mouseenter\", function (e) {\r\n\t\t\t\tm.hide();\r\n\t\t\t\tml.hide();\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\treturn false;\r\n\t\t\t})\r\n\t\t\t.appendTo(\"body\");\r\n\t\tml = $(\"<div />\").attr({ id : \"jstree-marker-line\" }).hide()\r\n\t\t\t.bind(\"mouseup\", function (e) {\r\n\t\t\t\tif(r && r.length) {\r\n\t\t\t\t\tr.children(\"a\").trigger(e);\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.bind(\"mouseleave\", function (e) {\r\n\t\t\t\tvar rt = $(e.relatedTarget);\r\n\t\t\t\tif(rt.is(\".jstree\") || rt.closest(\".jstree\").length === 0) {\r\n\t\t\t\t\tif(r && r.length) {\r\n\t\t\t\t\t\tr.children(\"a\").trigger(e);\r\n\t\t\t\t\t\tm.hide();\r\n\t\t\t\t\t\tml.hide();\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.appendTo(\"body\");\r\n\t\t$(document).bind(\"drag_start.vakata\", function (e, data) {\r\n\t\t\tif(data.data.jstree) { m.show(); if(ml) { ml.show(); } }\r\n\t\t});\r\n\t\t$(document).bind(\"drag_stop.vakata\", function (e, data) {\r\n\t\t\tif(data.data.jstree) { m.hide(); if(ml) { ml.hide(); } }\r\n\t\t});\r\n\t});\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree checkbox plugin\r\n * Inserts checkboxes in front of every node\r\n * Depends on the ui plugin\r\n * DOES NOT WORK NICELY WITH MULTITREE DRAG'N'DROP\r\n */\r\n(function ($) {\r\n\t$.jstree.plugin(\"checkbox\", {\r\n\t\t__init : function () {\r\n\t\t\tthis.data.checkbox.noui = this._get_settings().checkbox.override_ui;\r\n\t\t\tif(this.data.ui && this.data.checkbox.noui) {\r\n\t\t\t\tthis.select_node = this.deselect_node = this.deselect_all = $.noop;\r\n\t\t\t\tthis.get_selected = this.get_checked;\r\n\t\t\t}\r\n\r\n\t\t\tthis.get_container()\r\n\t\t\t\t.bind(\"open_node.jstree create_node.jstree clean_node.jstree refresh.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tthis._prepare_checkboxes(data.rslt.obj);\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"loaded.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\tthis._prepare_checkboxes();\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.delegate( (this.data.ui && this.data.checkbox.noui ? \"a\" : \"ins.jstree-checkbox\") , \"click.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tif(this._get_node(e.target).hasClass(\"jstree-checked\")) { this.uncheck_node(e.target); }\r\n\t\t\t\t\t\telse { this.check_node(e.target); }\r\n\t\t\t\t\t\tif(this.data.ui && this.data.checkbox.noui) {\r\n\t\t\t\t\t\t\tthis.save_selected();\r\n\t\t\t\t\t\t\tif(this.data.cookies) { this.save_cookie(\"select_node\"); }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this));\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\toverride_ui : false,\r\n\t\t\ttwo_state : false,\r\n\t\t\treal_checkboxes : false,\r\n\t\t\tchecked_parent_open : true,\r\n\t\t\treal_checkboxes_names : function (n) { return [ (\"check_\" + (n[0].id || Math.ceil(Math.random() * 10000))) , 1]; }\r\n\t\t},\r\n\t\t__destroy : function () {\r\n\t\t\tthis.get_container()\r\n\t\t\t\t.find(\"input.jstree-real-checkbox\").removeClass(\"jstree-real-checkbox\").end()\r\n\t\t\t\t.find(\"ins.jstree-checkbox\").remove();\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\t_checkbox_notify : function (n, data) {\r\n\t\t\t\tif(data.checked) {\r\n\t\t\t\t\tthis.check_node(n, false);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t_prepare_checkboxes : function (obj) {\r\n\t\t\t\tobj = !obj || obj == -1 ? this.get_container().find(\"> ul > li\") : this._get_node(obj);\r\n\t\t\t\tif(obj === false) { return; } // added for removing root nodes\r\n\t\t\t\tvar c, _this = this, t, ts = this._get_settings().checkbox.two_state, rc = this._get_settings().checkbox.real_checkboxes, rcn = this._get_settings().checkbox.real_checkboxes_names;\r\n\t\t\t\tobj.each(function () {\r\n\t\t\t\t\tt = $(this);\r\n\t\t\t\t\tc = t.is(\"li\") && (t.hasClass(\"jstree-checked\") || (rc && t.children(\":checked\").length)) ? \"jstree-checked\" : \"jstree-unchecked\";\r\n\t\t\t\t\tt.find(\"li\").addBack().each(function () {\r\n\t\t\t\t\t\tvar $t = $(this), nm;\r\n\t\t\t\t\t\t$t.children(\"a\" + (_this.data.languages ? \"\" : \":eq(0)\") ).not(\":has(.jstree-checkbox)\").prepend(\"<ins class='jstree-checkbox'>&#160;</ins>\").parent().not(\".jstree-checked, .jstree-unchecked\").addClass( ts ? \"jstree-unchecked\" : c );\r\n\t\t\t\t\t\tif(rc) {\r\n\t\t\t\t\t\t\tif(!$t.children(\":checkbox\").length) {\r\n\t\t\t\t\t\t\t\tnm = rcn.call(_this, $t);\r\n\t\t\t\t\t\t\t\t$t.prepend(\"<input type='checkbox' class='jstree-real-checkbox' id='\" + nm[0] + \"' name='\" + nm[0] + \"' value='\" + nm[1] + \"' />\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t$t.children(\":checkbox\").addClass(\"jstree-real-checkbox\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!ts) {\r\n\t\t\t\t\t\t\tif(c === \"jstree-checked\" || $t.hasClass(\"jstree-checked\") || $t.children(':checked').length) {\r\n\t\t\t\t\t\t\t\t$t.find(\"li\").addBack().addClass(\"jstree-checked\").children(\":checkbox\").prop(\"checked\", true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif($t.hasClass(\"jstree-checked\") || $t.children(':checked').length) {\r\n\t\t\t\t\t\t\t\t$t.addClass(\"jstree-checked\").children(\":checkbox\").prop(\"checked\", true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tif(!ts) {\r\n\t\t\t\t\tobj.find(\".jstree-checked\").parent().parent().each(function () { _this._repair_state(this); });\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchange_state : function (obj, state) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tvar coll = false, rc = this._get_settings().checkbox.real_checkboxes;\r\n\t\t\t\tif(!obj || obj === -1) { return false; }\r\n\t\t\t\tstate = (state === false || state === true) ? state : obj.hasClass(\"jstree-checked\");\r\n\t\t\t\tif(this._get_settings().checkbox.two_state) {\r\n\t\t\t\t\tif(state) {\r\n\t\t\t\t\t\tobj.removeClass(\"jstree-checked\").addClass(\"jstree-unchecked\");\r\n\t\t\t\t\t\tif(rc) { obj.children(\":checkbox\").prop(\"checked\", false); }\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tobj.removeClass(\"jstree-unchecked\").addClass(\"jstree-checked\");\r\n\t\t\t\t\t\tif(rc) { obj.children(\":checkbox\").prop(\"checked\", true); }\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(state) {\r\n\t\t\t\t\t\tcoll = obj.find(\"li\").addBack();\r\n\t\t\t\t\t\tif(!coll.filter(\".jstree-checked, .jstree-undetermined\").length) { return false; }\r\n\t\t\t\t\t\tcoll.removeClass(\"jstree-checked jstree-undetermined\").addClass(\"jstree-unchecked\");\r\n\t\t\t\t\t\tif(rc) { coll.children(\":checkbox\").prop(\"checked\", false); }\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tcoll = obj.find(\"li\").addBack();\r\n\t\t\t\t\t\tif(!coll.filter(\".jstree-unchecked, .jstree-undetermined\").length) { return false; }\r\n\t\t\t\t\t\tcoll.removeClass(\"jstree-unchecked jstree-undetermined\").addClass(\"jstree-checked\");\r\n\t\t\t\t\t\tif(rc) { coll.children(\":checkbox\").prop(\"checked\", true); }\r\n\t\t\t\t\t\tif(this.data.ui) { this.data.ui.last_selected = obj; }\r\n\t\t\t\t\t\tthis.data.checkbox.last_selected = obj;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tobj.parentsUntil(\".jstree\", \"li\").each(function () {\r\n\t\t\t\t\t\tvar $this = $(this);\r\n\t\t\t\t\t\tif(state) {\r\n\t\t\t\t\t\t\tif($this.children(\"ul\").children(\"li.jstree-checked, li.jstree-undetermined\").length) {\r\n\t\t\t\t\t\t\t\t$this.parentsUntil(\".jstree\", \"li\").addBack().removeClass(\"jstree-checked jstree-unchecked\").addClass(\"jstree-undetermined\");\r\n\t\t\t\t\t\t\t\tif(rc) { $this.parentsUntil(\".jstree\", \"li\").addBack().children(\":checkbox\").prop(\"checked\", false); }\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t$this.removeClass(\"jstree-checked jstree-undetermined\").addClass(\"jstree-unchecked\");\r\n\t\t\t\t\t\t\t\tif(rc) { $this.children(\":checkbox\").prop(\"checked\", false); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif($this.children(\"ul\").children(\"li.jstree-unchecked, li.jstree-undetermined\").length) {\r\n\t\t\t\t\t\t\t\t$this.parentsUntil(\".jstree\", \"li\").addBack().removeClass(\"jstree-checked jstree-unchecked\").addClass(\"jstree-undetermined\");\r\n\t\t\t\t\t\t\t\tif(rc) { $this.parentsUntil(\".jstree\", \"li\").addBack().children(\":checkbox\").prop(\"checked\", false); }\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t$this.removeClass(\"jstree-unchecked jstree-undetermined\").addClass(\"jstree-checked\");\r\n\t\t\t\t\t\t\t\tif(rc) { $this.children(\":checkbox\").prop(\"checked\", true); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tif(this.data.ui && this.data.checkbox.noui) { this.data.ui.selected = this.get_checked(); }\r\n\t\t\t\tthis.__callback(obj);\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\t\t\tcheck_node : function (obj) {\r\n\t\t\t\tif(this.change_state(obj, false)) {\r\n\t\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\t\tif(this._get_settings().checkbox.checked_parent_open) {\r\n\t\t\t\t\t\tvar t = this;\r\n\t\t\t\t\t\tobj.parents(\".jstree-closed\").each(function () { t.open_node(this, false, true); });\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.__callback({ \"obj\" : obj });\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tuncheck_node : function (obj) {\r\n\t\t\t\tif(this.change_state(obj, true)) { this.__callback({ \"obj\" : this._get_node(obj) }); }\r\n\t\t\t},\r\n\t\t\tcheck_all : function () {\r\n\t\t\t\tvar _this = this,\r\n\t\t\t\t\tcoll = this._get_settings().checkbox.two_state ? this.get_container_ul().find(\"li\") : this.get_container_ul().children(\"li\");\r\n\t\t\t\tcoll.each(function () {\r\n\t\t\t\t\t_this.change_state(this, false);\r\n\t\t\t\t});\r\n\t\t\t\tthis.__callback();\r\n\t\t\t},\r\n\t\t\tuncheck_all : function () {\r\n\t\t\t\tvar _this = this,\r\n\t\t\t\t\tcoll = this._get_settings().checkbox.two_state ? this.get_container_ul().find(\"li\") : this.get_container_ul().children(\"li\");\r\n\t\t\t\tcoll.each(function () {\r\n\t\t\t\t\t_this.change_state(this, true);\r\n\t\t\t\t});\r\n\t\t\t\tthis.__callback();\r\n\t\t\t},\r\n\r\n\t\t\tis_checked : function(obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\treturn obj.length ? obj.is(\".jstree-checked\") : false;\r\n\t\t\t},\r\n\t\t\tget_checked : function (obj, get_all) {\r\n\t\t\t\tobj = !obj || obj === -1 ? this.get_container() : this._get_node(obj);\r\n\t\t\t\treturn get_all || this._get_settings().checkbox.two_state ? obj.find(\".jstree-checked\") : obj.find(\"> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked\");\r\n\t\t\t},\r\n\t\t\tget_unchecked : function (obj, get_all) {\r\n\t\t\t\tobj = !obj || obj === -1 ? this.get_container() : this._get_node(obj);\r\n\t\t\t\treturn get_all || this._get_settings().checkbox.two_state ? obj.find(\".jstree-unchecked\") : obj.find(\"> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked\");\r\n\t\t\t},\r\n\r\n\t\t\tshow_checkboxes : function () { this.get_container().children(\"ul\").removeClass(\"jstree-no-checkboxes\"); },\r\n\t\t\thide_checkboxes : function () { this.get_container().children(\"ul\").addClass(\"jstree-no-checkboxes\"); },\r\n\r\n\t\t\t_repair_state : function (obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(!obj.length) { return; }\r\n\t\t\t\tif(this._get_settings().checkbox.two_state) {\r\n\t\t\t\t\tobj.find('li').addBack().not('.jstree-checked').removeClass('jstree-undetermined').addClass('jstree-unchecked').children(':checkbox').prop('checked', true);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar rc = this._get_settings().checkbox.real_checkboxes,\r\n\t\t\t\t\ta = obj.find(\"> ul > .jstree-checked\").length,\r\n\t\t\t\t\tb = obj.find(\"> ul > .jstree-undetermined\").length,\r\n\t\t\t\t\tc = obj.find(\"> ul > li\").length;\r\n\t\t\t\tif(c === 0) { if(obj.hasClass(\"jstree-undetermined\")) { this.change_state(obj, false); } }\r\n\t\t\t\telse if(a === 0 && b === 0) { this.change_state(obj, true); }\r\n\t\t\t\telse if(a === c) { this.change_state(obj, false); }\r\n\t\t\t\telse {\r\n\t\t\t\t\tobj.parentsUntil(\".jstree\",\"li\").addBack().removeClass(\"jstree-checked jstree-unchecked\").addClass(\"jstree-undetermined\");\r\n\t\t\t\t\tif(rc) { obj.parentsUntil(\".jstree\", \"li\").addBack().children(\":checkbox\").prop(\"checked\", false); }\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\treselect : function () {\r\n\t\t\t\tif(this.data.ui && this.data.checkbox.noui) {\r\n\t\t\t\t\tvar _this = this,\r\n\t\t\t\t\t\ts = this.data.ui.to_select;\r\n\t\t\t\t\ts = $.map($.makeArray(s), function (n) { return \"#\" + n.toString().replace(/^#/,\"\").replace(/\\\\\\//g,\"/\").replace(/\\//g,\"\\\\\\/\").replace(/\\\\\\./g,\".\").replace(/\\./g,\"\\\\.\").replace(/\\:/g,\"\\\\:\"); });\r\n\t\t\t\t\tthis.deselect_all();\r\n\t\t\t\t\t$.each(s, function (i, val) { _this.check_node(val); });\r\n\t\t\t\t\tthis.__callback();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.__call_old();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsave_loaded : function () {\r\n\t\t\t\tvar _this = this;\r\n\t\t\t\tthis.data.core.to_load = [];\r\n\t\t\t\tthis.get_container_ul().find(\"li.jstree-closed.jstree-undetermined\").each(function () {\r\n\t\t\t\t\tif(this.id) { _this.data.core.to_load.push(\"#\" + this.id); }\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\t$(function() {\r\n\t\tvar css_string = '.jstree .jstree-real-checkbox { display:none; } ';\r\n\t\t$.vakata.css.add_sheet({ str : css_string, title : \"jstree\" });\r\n\t});\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree XML plugin\r\n * The XML data store. Datastores are build by overriding the `load_node` and `_is_loaded` functions.\r\n */\r\n(function ($) {\r\n\t$.vakata.xslt = function (xml, xsl, callback) {\r\n\t\tvar rs = \"\", xm, xs, processor, support;\r\n\t\t// TODO: IE9 no XSLTProcessor, no document.recalc\r\n\t\tif(document.recalc) {\r\n\t\t\txm = document.createElement('xml');\r\n\t\t\txs = document.createElement('xml');\r\n\t\t\txm.innerHTML = xml;\r\n\t\t\txs.innerHTML = xsl;\r\n\t\t\t$(\"body\").append(xm).append(xs);\r\n\t\t\tsetTimeout( (function (xm, xs, callback) {\r\n\t\t\t\treturn function () {\r\n\t\t\t\t\tcallback.call(null, xm.transformNode(xs.XMLDocument));\r\n\t\t\t\t\tsetTimeout( (function (xm, xs) { return function () { $(xm).remove(); $(xs).remove(); }; })(xm, xs), 200);\r\n\t\t\t\t};\r\n\t\t\t})(xm, xs, callback), 100);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif(typeof window.DOMParser !== \"undefined\" && typeof window.XMLHttpRequest !== \"undefined\" && typeof window.XSLTProcessor === \"undefined\") {\r\n\t\t\txml = new DOMParser().parseFromString(xml, \"text/xml\");\r\n\t\t\txsl = new DOMParser().parseFromString(xsl, \"text/xml\");\r\n\t\t\t// alert(xml.transformNode());\r\n\t\t\t// callback.call(null, new XMLSerializer().serializeToString(rs));\r\n\r\n\t\t}\r\n\t\tif(typeof window.DOMParser !== \"undefined\" && typeof window.XMLHttpRequest !== \"undefined\" && typeof window.XSLTProcessor !== \"undefined\") {\r\n\t\t\tprocessor = new XSLTProcessor();\r\n\t\t\tsupport = $.isFunction(processor.transformDocument) ? (typeof window.XMLSerializer !== \"undefined\") : true;\r\n\t\t\tif(!support) { return false; }\r\n\t\t\txml = new DOMParser().parseFromString(xml, \"text/xml\");\r\n\t\t\txsl = new DOMParser().parseFromString(xsl, \"text/xml\");\r\n\t\t\tif($.isFunction(processor.transformDocument)) {\r\n\t\t\t\trs = document.implementation.createDocument(\"\", \"\", null);\r\n\t\t\t\tprocessor.transformDocument(xml, xsl, rs, null);\r\n\t\t\t\tcallback.call(null, new XMLSerializer().serializeToString(rs));\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tprocessor.importStylesheet(xsl);\r\n\t\t\t\trs = processor.transformToFragment(xml, document);\r\n\t\t\t\tcallback.call(null, $(\"<div />\").append(rs).html());\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\tvar xsl = {\r\n\t\t'nest' : '<' + '?xml version=\"1.0\" encoding=\"utf-8\" ?>' +\r\n\t\t\t'<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" >' +\r\n\t\t\t'<xsl:output method=\"html\" encoding=\"utf-8\" omit-xml-declaration=\"yes\" standalone=\"no\" indent=\"no\" media-type=\"text/html\" />' +\r\n\t\t\t'<xsl:template match=\"/\">' +\r\n\t\t\t'\t<xsl:call-template name=\"nodes\">' +\r\n\t\t\t'\t\t<xsl:with-param name=\"node\" select=\"/root\" />' +\r\n\t\t\t'\t</xsl:call-template>' +\r\n\t\t\t'</xsl:template>' +\r\n\t\t\t'<xsl:template name=\"nodes\">' +\r\n\t\t\t'\t<xsl:param name=\"node\" />' +\r\n\t\t\t'\t<ul>' +\r\n\t\t\t'\t<xsl:for-each select=\"$node/item\">' +\r\n\t\t\t'\t\t<xsl:variable name=\"children\" select=\"count(./item) &gt; 0\" />' +\r\n\t\t\t'\t\t<li>' +\r\n\t\t\t'\t\t\t<xsl:attribute name=\"class\">' +\r\n\t\t\t'\t\t\t\t<xsl:if test=\"position() = last()\">jstree-last </xsl:if>' +\r\n\t\t\t'\t\t\t\t<xsl:choose>' +\r\n\t\t\t'\t\t\t\t\t<xsl:when test=\"@state = \\'open\\'\">jstree-open </xsl:when>' +\r\n\t\t\t'\t\t\t\t\t<xsl:when test=\"$children or @hasChildren or @state = \\'closed\\'\">jstree-closed </xsl:when>' +\r\n\t\t\t'\t\t\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>' +\r\n\t\t\t'\t\t\t\t</xsl:choose>' +\r\n\t\t\t'\t\t\t\t<xsl:value-of select=\"@class\" />' +\r\n\t\t\t'\t\t\t</xsl:attribute>' +\r\n\t\t\t'\t\t\t<xsl:for-each select=\"@*\">' +\r\n\t\t\t'\t\t\t\t<xsl:if test=\"name() != \\'class\\' and name() != \\'state\\' and name() != \\'hasChildren\\'\">' +\r\n\t\t\t'\t\t\t\t\t<xsl:attribute name=\"{name()}\"><xsl:value-of select=\".\" /></xsl:attribute>' +\r\n\t\t\t'\t\t\t\t</xsl:if>' +\r\n\t\t\t'\t\t\t</xsl:for-each>' +\r\n\t\t\t'\t<ins class=\"jstree-icon\"><xsl:text>&#xa0;</xsl:text></ins>' +\r\n\t\t\t'\t\t\t<xsl:for-each select=\"content/name\">' +\r\n\t\t\t'\t\t\t\t<a>' +\r\n\t\t\t'\t\t\t\t<xsl:attribute name=\"href\">' +\r\n\t\t\t'\t\t\t\t\t<xsl:choose>' +\r\n\t\t\t'\t\t\t\t\t<xsl:when test=\"@href\"><xsl:value-of select=\"@href\" /></xsl:when>' +\r\n\t\t\t'\t\t\t\t\t<xsl:otherwise>#</xsl:otherwise>' +\r\n\t\t\t'\t\t\t\t\t</xsl:choose>' +\r\n\t\t\t'\t\t\t\t</xsl:attribute>' +\r\n\t\t\t'\t\t\t\t<xsl:attribute name=\"class\"><xsl:value-of select=\"@lang\" /> <xsl:value-of select=\"@class\" /></xsl:attribute>' +\r\n\t\t\t'\t\t\t\t<xsl:attribute name=\"style\"><xsl:value-of select=\"@style\" /></xsl:attribute>' +\r\n\t\t\t'\t\t\t\t<xsl:for-each select=\"@*\">' +\r\n\t\t\t'\t\t\t\t\t<xsl:if test=\"name() != \\'style\\' and name() != \\'class\\' and name() != \\'href\\'\">' +\r\n\t\t\t'\t\t\t\t\t\t<xsl:attribute name=\"{name()}\"><xsl:value-of select=\".\" /></xsl:attribute>' +\r\n\t\t\t'\t\t\t\t\t</xsl:if>' +\r\n\t\t\t'\t\t\t\t</xsl:for-each>' +\r\n\t\t\t'\t\t\t\t\t<ins>' +\r\n\t\t\t'\t\t\t\t\t\t<xsl:attribute name=\"class\">jstree-icon ' +\r\n\t\t\t'\t\t\t\t\t\t\t<xsl:if test=\"string-length(attribute::icon) > 0 and not(contains(@icon,\\'/\\'))\"><xsl:value-of select=\"@icon\" /></xsl:if>' +\r\n\t\t\t'\t\t\t\t\t\t</xsl:attribute>' +\r\n\t\t\t'\t\t\t\t\t\t<xsl:if test=\"string-length(attribute::icon) > 0 and contains(@icon,\\'/\\')\"><xsl:attribute name=\"style\">background:url(<xsl:value-of select=\"@icon\" />) center center no-repeat;</xsl:attribute></xsl:if>' +\r\n\t\t\t'\t\t\t\t\t\t<xsl:text>&#xa0;</xsl:text>' +\r\n\t\t\t'\t\t\t\t\t</ins>' +\r\n\t\t\t'\t\t\t\t\t<xsl:copy-of select=\"./child::node()\" />' +\r\n\t\t\t'\t\t\t\t</a>' +\r\n\t\t\t'\t\t\t</xsl:for-each>' +\r\n\t\t\t'\t\t\t<xsl:if test=\"$children or @hasChildren\"><xsl:call-template name=\"nodes\"><xsl:with-param name=\"node\" select=\"current()\" /></xsl:call-template></xsl:if>' +\r\n\t\t\t'\t\t</li>' +\r\n\t\t\t'\t</xsl:for-each>' +\r\n\t\t\t'\t</ul>' +\r\n\t\t\t'</xsl:template>' +\r\n\t\t\t'</xsl:stylesheet>',\r\n\r\n\t\t'flat' : '<' + '?xml version=\"1.0\" encoding=\"utf-8\" ?>' +\r\n\t\t\t'<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" >' +\r\n\t\t\t'<xsl:output method=\"html\" encoding=\"utf-8\" omit-xml-declaration=\"yes\" standalone=\"no\" indent=\"no\" media-type=\"text/xml\" />' +\r\n\t\t\t'<xsl:template match=\"/\">' +\r\n\t\t\t'\t<ul>' +\r\n\t\t\t'\t<xsl:for-each select=\"//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]\">' + /* the last `or` may be removed */\r\n\t\t\t'\t\t<xsl:call-template name=\"nodes\">' +\r\n\t\t\t'\t\t\t<xsl:with-param name=\"node\" select=\".\" />' +\r\n\t\t\t'\t\t\t<xsl:with-param name=\"is_last\" select=\"number(position() = last())\" />' +\r\n\t\t\t'\t\t</xsl:call-template>' +\r\n\t\t\t'\t</xsl:for-each>' +\r\n\t\t\t'\t</ul>' +\r\n\t\t\t'</xsl:template>' +\r\n\t\t\t'<xsl:template name=\"nodes\">' +\r\n\t\t\t'\t<xsl:param name=\"node\" />' +\r\n\t\t\t'\t<xsl:param name=\"is_last\" />' +\r\n\t\t\t'\t<xsl:variable name=\"children\" select=\"count(//item[@parent_id=$node/attribute::id]) &gt; 0\" />' +\r\n\t\t\t'\t<li>' +\r\n\t\t\t'\t<xsl:attribute name=\"class\">' +\r\n\t\t\t'\t\t<xsl:if test=\"$is_last = true()\">jstree-last </xsl:if>' +\r\n\t\t\t'\t\t<xsl:choose>' +\r\n\t\t\t'\t\t\t<xsl:when test=\"@state = \\'open\\'\">jstree-open </xsl:when>' +\r\n\t\t\t'\t\t\t<xsl:when test=\"$children or @hasChildren or @state = \\'closed\\'\">jstree-closed </xsl:when>' +\r\n\t\t\t'\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>' +\r\n\t\t\t'\t\t</xsl:choose>' +\r\n\t\t\t'\t\t<xsl:value-of select=\"@class\" />' +\r\n\t\t\t'\t</xsl:attribute>' +\r\n\t\t\t'\t<xsl:for-each select=\"@*\">' +\r\n\t\t\t'\t\t<xsl:if test=\"name() != \\'parent_id\\' and name() != \\'hasChildren\\' and name() != \\'class\\' and name() != \\'state\\'\">' +\r\n\t\t\t'\t\t<xsl:attribute name=\"{name()}\"><xsl:value-of select=\".\" /></xsl:attribute>' +\r\n\t\t\t'\t\t</xsl:if>' +\r\n\t\t\t'\t</xsl:for-each>' +\r\n\t\t\t'\t<ins class=\"jstree-icon\"><xsl:text>&#xa0;</xsl:text></ins>' +\r\n\t\t\t'\t<xsl:for-each select=\"content/name\">' +\r\n\t\t\t'\t\t<a>' +\r\n\t\t\t'\t\t<xsl:attribute name=\"href\">' +\r\n\t\t\t'\t\t\t<xsl:choose>' +\r\n\t\t\t'\t\t\t<xsl:when test=\"@href\"><xsl:value-of select=\"@href\" /></xsl:when>' +\r\n\t\t\t'\t\t\t<xsl:otherwise>#</xsl:otherwise>' +\r\n\t\t\t'\t\t\t</xsl:choose>' +\r\n\t\t\t'\t\t</xsl:attribute>' +\r\n\t\t\t'\t\t<xsl:attribute name=\"class\"><xsl:value-of select=\"@lang\" /> <xsl:value-of select=\"@class\" /></xsl:attribute>' +\r\n\t\t\t'\t\t<xsl:attribute name=\"style\"><xsl:value-of select=\"@style\" /></xsl:attribute>' +\r\n\t\t\t'\t\t<xsl:for-each select=\"@*\">' +\r\n\t\t\t'\t\t\t<xsl:if test=\"name() != \\'style\\' and name() != \\'class\\' and name() != \\'href\\'\">' +\r\n\t\t\t'\t\t\t\t<xsl:attribute name=\"{name()}\"><xsl:value-of select=\".\" /></xsl:attribute>' +\r\n\t\t\t'\t\t\t</xsl:if>' +\r\n\t\t\t'\t\t</xsl:for-each>' +\r\n\t\t\t'\t\t\t<ins>' +\r\n\t\t\t'\t\t\t\t<xsl:attribute name=\"class\">jstree-icon ' +\r\n\t\t\t'\t\t\t\t\t<xsl:if test=\"string-length(attribute::icon) > 0 and not(contains(@icon,\\'/\\'))\"><xsl:value-of select=\"@icon\" /></xsl:if>' +\r\n\t\t\t'\t\t\t\t</xsl:attribute>' +\r\n\t\t\t'\t\t\t\t<xsl:if test=\"string-length(attribute::icon) > 0 and contains(@icon,\\'/\\')\"><xsl:attribute name=\"style\">background:url(<xsl:value-of select=\"@icon\" />) center center no-repeat;</xsl:attribute></xsl:if>' +\r\n\t\t\t'\t\t\t\t<xsl:text>&#xa0;</xsl:text>' +\r\n\t\t\t'\t\t\t</ins>' +\r\n\t\t\t'\t\t\t<xsl:copy-of select=\"./child::node()\" />' +\r\n\t\t\t'\t\t</a>' +\r\n\t\t\t'\t</xsl:for-each>' +\r\n\t\t\t'\t<xsl:if test=\"$children\">' +\r\n\t\t\t'\t\t<ul>' +\r\n\t\t\t'\t\t<xsl:for-each select=\"//item[@parent_id=$node/attribute::id]\">' +\r\n\t\t\t'\t\t\t<xsl:call-template name=\"nodes\">' +\r\n\t\t\t'\t\t\t\t<xsl:with-param name=\"node\" select=\".\" />' +\r\n\t\t\t'\t\t\t\t<xsl:with-param name=\"is_last\" select=\"number(position() = last())\" />' +\r\n\t\t\t'\t\t\t</xsl:call-template>' +\r\n\t\t\t'\t\t</xsl:for-each>' +\r\n\t\t\t'\t\t</ul>' +\r\n\t\t\t'\t</xsl:if>' +\r\n\t\t\t'\t</li>' +\r\n\t\t\t'</xsl:template>' +\r\n\t\t\t'</xsl:stylesheet>'\r\n\t},\r\n\tescape_xml = function(string) {\r\n\t\treturn string\r\n\t\t\t.toString()\r\n\t\t\t.replace(/&/g, '&amp;')\r\n\t\t\t.replace(/</g, '&lt;')\r\n\t\t\t.replace(/>/g, '&gt;')\r\n\t\t\t.replace(/\"/g, '&quot;')\r\n\t\t\t.replace(/'/g, '&apos;');\r\n\t};\r\n\t$.jstree.plugin(\"xml_data\", {\r\n\t\tdefaults : {\r\n\t\t\tdata : false,\r\n\t\t\tajax : false,\r\n\t\t\txsl : \"flat\",\r\n\t\t\tclean_node : false,\r\n\t\t\tcorrect_state : true,\r\n\t\t\tget_skip_empty : false,\r\n\t\t\tget_include_preamble : true\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\tload_node : function (obj, s_call, e_call) { var _this = this; this.load_node_xml(obj, function () { _this.__callback({ \"obj\" : _this._get_node(obj) }); s_call.call(this); }, e_call); },\r\n\t\t\t_is_loaded : function (obj) {\r\n\t\t\t\tvar s = this._get_settings().xml_data;\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\treturn obj == -1 || !obj || (!s.ajax && !$.isFunction(s.data)) || obj.is(\".jstree-open, .jstree-leaf\") || obj.children(\"ul\").children(\"li\").size() > 0;\r\n\t\t\t},\r\n\t\t\tload_node_xml : function (obj, s_call, e_call) {\r\n\t\t\t\tvar s = this.get_settings().xml_data,\r\n\t\t\t\t\terror_func = function () {},\r\n\t\t\t\t\tsuccess_func = function () {};\r\n\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(obj && obj !== -1) {\r\n\t\t\t\t\tif(obj.data(\"jstree_is_loading\")) { return; }\r\n\t\t\t\t\telse { obj.data(\"jstree_is_loading\",true); }\r\n\t\t\t\t}\r\n\t\t\t\tswitch(!0) {\r\n\t\t\t\t\tcase (!s.data && !s.ajax): throw \"Neither data nor ajax settings supplied.\";\r\n\t\t\t\t\tcase ($.isFunction(s.data)):\r\n\t\t\t\t\t\ts.data.call(this, obj, $.proxy(function (d) {\r\n\t\t\t\t\t\t\tthis.parse_xml(d, $.proxy(function (d) {\r\n\t\t\t\t\t\t\t\tif(d) {\r\n\t\t\t\t\t\t\t\t\td = d.replace(/ ?xmlns=\"[^\"]*\"/ig, \"\");\r\n\t\t\t\t\t\t\t\t\tif(d.length > 10) {\r\n\t\t\t\t\t\t\t\t\t\td = $(d);\r\n\t\t\t\t\t\t\t\t\t\tif(obj === -1 || !obj) { this.get_container().children(\"ul\").empty().append(d.children()); }\r\n\t\t\t\t\t\t\t\t\t\telse { obj.children(\"a.jstree-loading\").removeClass(\"jstree-loading\"); obj.append(d); obj.removeData(\"jstree_is_loading\"); }\r\n\t\t\t\t\t\t\t\t\t\tif(s.clean_node) { this.clean_node(obj); }\r\n\t\t\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\tif(obj && obj !== -1) {\r\n\t\t\t\t\t\t\t\t\t\t\tobj.children(\"a.jstree-loading\").removeClass(\"jstree-loading\");\r\n\t\t\t\t\t\t\t\t\t\t\tobj.removeData(\"jstree_is_loading\");\r\n\t\t\t\t\t\t\t\t\t\t\tif(s.correct_state) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.correct_state(obj);\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\tif(s.correct_state) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.get_container().children(\"ul\").empty();\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, this));\r\n\t\t\t\t\t\t}, this));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase (!!s.data && !s.ajax) || (!!s.data && !!s.ajax && (!obj || obj === -1)):\r\n\t\t\t\t\t\tif(!obj || obj == -1) {\r\n\t\t\t\t\t\t\tthis.parse_xml(s.data, $.proxy(function (d) {\r\n\t\t\t\t\t\t\t\tif(d) {\r\n\t\t\t\t\t\t\t\t\td = d.replace(/ ?xmlns=\"[^\"]*\"/ig, \"\");\r\n\t\t\t\t\t\t\t\t\tif(d.length > 10) {\r\n\t\t\t\t\t\t\t\t\t\td = $(d);\r\n\t\t\t\t\t\t\t\t\t\tthis.get_container().children(\"ul\").empty().append(d.children());\r\n\t\t\t\t\t\t\t\t\t\tif(s.clean_node) { this.clean_node(obj); }\r\n\t\t\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tif(s.correct_state) {\r\n\t\t\t\t\t\t\t\t\t\tthis.get_container().children(\"ul\").empty();\r\n\t\t\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, this));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase (!s.data && !!s.ajax) || (!!s.data && !!s.ajax && obj && obj !== -1):\r\n\t\t\t\t\t\terror_func = function (x, t, e) {\r\n\t\t\t\t\t\t\tvar ef = this.get_settings().xml_data.ajax.error;\r\n\t\t\t\t\t\t\tif(ef) { ef.call(this, x, t, e); }\r\n\t\t\t\t\t\t\tif(obj !== -1 && obj.length) {\r\n\t\t\t\t\t\t\t\tobj.children(\"a.jstree-loading\").removeClass(\"jstree-loading\");\r\n\t\t\t\t\t\t\t\tobj.removeData(\"jstree_is_loading\");\r\n\t\t\t\t\t\t\t\tif(t === \"success\" && s.correct_state) { this.correct_state(obj); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif(t === \"success\" && s.correct_state) { this.get_container().children(\"ul\").empty(); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(e_call) { e_call.call(this); }\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tsuccess_func = function (d, t, x) {\r\n\t\t\t\t\t\t\td = x.responseText;\r\n\t\t\t\t\t\t\tvar sf = this.get_settings().xml_data.ajax.success;\r\n\t\t\t\t\t\t\tif(sf) { d = sf.call(this,d,t,x) || d; }\r\n\t\t\t\t\t\t\tif(d === \"\" || (d && d.toString && d.toString().replace(/^[\\s\\n]+$/,\"\") === \"\")) {\r\n\t\t\t\t\t\t\t\treturn error_func.call(this, x, t, \"\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.parse_xml(d, $.proxy(function (d) {\r\n\t\t\t\t\t\t\t\tif(d) {\r\n\t\t\t\t\t\t\t\t\td = d.replace(/ ?xmlns=\"[^\"]*\"/ig, \"\");\r\n\t\t\t\t\t\t\t\t\tif(d.length > 10) {\r\n\t\t\t\t\t\t\t\t\t\td = $(d);\r\n\t\t\t\t\t\t\t\t\t\tif(obj === -1 || !obj) { this.get_container().children(\"ul\").empty().append(d.children()); }\r\n\t\t\t\t\t\t\t\t\t\telse { obj.children(\"a.jstree-loading\").removeClass(\"jstree-loading\"); obj.append(d); obj.removeData(\"jstree_is_loading\"); }\r\n\t\t\t\t\t\t\t\t\t\tif(s.clean_node) { this.clean_node(obj); }\r\n\t\t\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\tif(obj && obj !== -1) {\r\n\t\t\t\t\t\t\t\t\t\t\tobj.children(\"a.jstree-loading\").removeClass(\"jstree-loading\");\r\n\t\t\t\t\t\t\t\t\t\t\tobj.removeData(\"jstree_is_loading\");\r\n\t\t\t\t\t\t\t\t\t\t\tif(s.correct_state) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.correct_state(obj);\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\tif(s.correct_state) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.get_container().children(\"ul\").empty();\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, this));\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\ts.ajax.context = this;\r\n\t\t\t\t\t\ts.ajax.error = error_func;\r\n\t\t\t\t\t\ts.ajax.success = success_func;\r\n\t\t\t\t\t\tif(!s.ajax.dataType) { s.ajax.dataType = \"xml\"; }\r\n\t\t\t\t\t\tif($.isFunction(s.ajax.url)) { s.ajax.url = s.ajax.url.call(this, obj); }\r\n\t\t\t\t\t\tif($.isFunction(s.ajax.data)) { s.ajax.data = s.ajax.data.call(this, obj); }\r\n\t\t\t\t\t\t$.ajax(s.ajax);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tparse_xml : function (xml, callback) {\r\n\t\t\t\tvar s = this._get_settings().xml_data;\r\n\t\t\t\t$.vakata.xslt(xml, xsl[s.xsl], callback);\r\n\t\t\t},\r\n\t\t\tget_xml : function (tp, obj, li_attr, a_attr, is_callback) {\r\n\t\t\t\tvar result = \"\",\r\n\t\t\t\t\ts = this._get_settings(),\r\n\t\t\t\t\t_this = this,\r\n\t\t\t\t\ttmp1, tmp2, li, a, lang;\r\n\t\t\t\tif(!tp) { tp = \"flat\"; }\r\n\t\t\t\tif(!is_callback) { is_callback = 0; }\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(!obj || obj === -1) { obj = this.get_container().find(\"> ul > li\"); }\r\n\t\t\t\tli_attr = $.isArray(li_attr) ? li_attr : [ \"id\", \"class\" ];\r\n\t\t\t\tif(!is_callback && this.data.types && $.inArray(s.types.type_attr, li_attr) === -1) { li_attr.push(s.types.type_attr); }\r\n\r\n\t\t\t\ta_attr = $.isArray(a_attr) ? a_attr : [ ];\r\n\r\n\t\t\t\tif(!is_callback) {\r\n\t\t\t\t\tif(s.xml_data.get_include_preamble) {\r\n\t\t\t\t\t\tresult += '<' + '?xml version=\"1.0\" encoding=\"UTF-8\"?' + '>';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tresult += \"<root>\";\r\n\t\t\t\t}\r\n\t\t\t\tobj.each(function () {\r\n\t\t\t\t\tresult += \"<item\";\r\n\t\t\t\t\tli = $(this);\r\n\t\t\t\t\t$.each(li_attr, function (i, v) {\r\n\t\t\t\t\t\tvar t = li.attr(v);\r\n\t\t\t\t\t\tif(!s.xml_data.get_skip_empty || typeof t !== \"undefined\") {\r\n\t\t\t\t\t\t\tresult += \" \" + v + \"=\\\"\" + escape_xml((\" \" + (t || \"\")).replace(/ jstree[^ ]*/ig,'').replace(/\\s+$/ig,\" \").replace(/^ /,\"\").replace(/ $/,\"\")) + \"\\\"\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(li.hasClass(\"jstree-open\")) { result += \" state=\\\"open\\\"\"; }\r\n\t\t\t\t\tif(li.hasClass(\"jstree-closed\")) { result += \" state=\\\"closed\\\"\"; }\r\n\t\t\t\t\tif(tp === \"flat\") { result += \" parent_id=\\\"\" + escape_xml(is_callback) + \"\\\"\"; }\r\n\t\t\t\t\tresult += \">\";\r\n\t\t\t\t\tresult += \"<content>\";\r\n\t\t\t\t\ta = li.children(\"a\");\r\n\t\t\t\t\ta.each(function () {\r\n\t\t\t\t\t\ttmp1 = $(this);\r\n\t\t\t\t\t\tlang = false;\r\n\t\t\t\t\t\tresult += \"<name\";\r\n\t\t\t\t\t\tif($.inArray(\"languages\", s.plugins) !== -1) {\r\n\t\t\t\t\t\t\t$.each(s.languages, function (k, z) {\r\n\t\t\t\t\t\t\t\tif(tmp1.hasClass(z)) { result += \" lang=\\\"\" + escape_xml(z) + \"\\\"\"; lang = z; return false; }\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(a_attr.length) {\r\n\t\t\t\t\t\t\t$.each(a_attr, function (k, z) {\r\n\t\t\t\t\t\t\t\tvar t = tmp1.attr(z);\r\n\t\t\t\t\t\t\t\tif(!s.xml_data.get_skip_empty || typeof t !== \"undefined\") {\r\n\t\t\t\t\t\t\t\t\tresult += \" \" + z + \"=\\\"\" + escape_xml((\" \" + t || \"\").replace(/ jstree[^ ]*/ig,'').replace(/\\s+$/ig,\" \").replace(/^ /,\"\").replace(/ $/,\"\")) + \"\\\"\";\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(tmp1.children(\"ins\").get(0).className.replace(/jstree[^ ]*|$/ig,'').replace(/^\\s+$/ig,\"\").length) {\r\n\t\t\t\t\t\t\tresult += ' icon=\"' + escape_xml(tmp1.children(\"ins\").get(0).className.replace(/jstree[^ ]*|$/ig,'').replace(/\\s+$/ig,\" \").replace(/^ /,\"\").replace(/ $/,\"\")) + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(tmp1.children(\"ins\").get(0).style.backgroundImage.length) {\r\n\t\t\t\t\t\t\tresult += ' icon=\"' + escape_xml(tmp1.children(\"ins\").get(0).style.backgroundImage.replace(\"url(\",\"\").replace(\")\",\"\").replace(/'/ig,\"\").replace(/\"/ig,\"\")) + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tresult += \">\";\r\n\t\t\t\t\t\tresult += \"<![CDATA[\" + _this.get_text(tmp1, lang) + \"]]>\";\r\n\t\t\t\t\t\tresult += \"</name>\";\r\n\t\t\t\t\t});\r\n\t\t\t\t\tresult += \"</content>\";\r\n\t\t\t\t\ttmp2 = li[0].id || true;\r\n\t\t\t\t\tli = li.find(\"> ul > li\");\r\n\t\t\t\t\tif(li.length) { tmp2 = _this.get_xml(tp, li, li_attr, a_attr, tmp2); }\r\n\t\t\t\t\telse { tmp2 = \"\"; }\r\n\t\t\t\t\tif(tp == \"nest\") { result += tmp2; }\r\n\t\t\t\t\tresult += \"</item>\";\r\n\t\t\t\t\tif(tp == \"flat\") { result += tmp2; }\r\n\t\t\t\t});\r\n\t\t\t\tif(!is_callback) { result += \"</root>\"; }\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree search plugin\r\n * Enables both sync and async search on the tree\r\n * DOES NOT WORK WITH JSON PROGRESSIVE RENDER\r\n */\r\n(function ($) {\r\n\t$.expr[':'].jstree_contains = function(a,i,m){\r\n\t\treturn (a.textContent || a.innerText || \"\").toLowerCase().indexOf(m[3].toLowerCase())>=0;\r\n\t};\r\n\t$.expr[':'].jstree_title_contains = function(a,i,m) {\r\n\t\treturn (a.getAttribute(\"title\") || \"\").toLowerCase().indexOf(m[3].toLowerCase())>=0;\r\n\t};\r\n\t$.jstree.plugin(\"search\", {\r\n\t\t__init : function () {\r\n\t\t\tthis.data.search.str = \"\";\r\n\t\t\tthis.data.search.result = $();\r\n\t\t\tif(this._get_settings().search.show_only_matches) {\r\n\t\t\t\tthis.get_container()\r\n\t\t\t\t\t.bind(\"search.jstree\", function (e, data) {\r\n\t\t\t\t\t\t$(this).children(\"ul\").find(\"li\").hide().removeClass(\"jstree-last\");\r\n\t\t\t\t\t\tdata.rslt.nodes.parentsUntil(\".jstree\").addBack().show()\r\n\t\t\t\t\t\t\t.filter(\"ul\").each(function () { $(this).children(\"li:visible\").eq(-1).addClass(\"jstree-last\"); });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.bind(\"clear_search.jstree\", function () {\r\n\t\t\t\t\t\t$(this).children(\"ul\").find(\"li\").css(\"display\",\"\").end().end().jstree(\"clean_node\", -1);\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\tajax : false,\r\n\t\t\tsearch_method : \"jstree_contains\", // for case insensitive - jstree_contains\r\n\t\t\tshow_only_matches : false\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\tsearch : function (str, skip_async) {\r\n\t\t\t\tif($.trim(str) === \"\") { this.clear_search(); return; }\r\n\t\t\t\tvar s = this.get_settings().search,\r\n\t\t\t\t\tt = this,\r\n\t\t\t\t\terror_func = function () { },\r\n\t\t\t\t\tsuccess_func = function () { };\r\n\t\t\t\tthis.data.search.str = str;\r\n\r\n\t\t\t\tif(!skip_async && s.ajax !== false && this.get_container_ul().find(\"li.jstree-closed:not(:has(ul)):eq(0)\").length > 0) {\r\n\t\t\t\t\tthis.search.supress_callback = true;\r\n\t\t\t\t\terror_func = function () { };\r\n\t\t\t\t\tsuccess_func = function (d, t, x) {\r\n\t\t\t\t\t\tvar sf = this.get_settings().search.ajax.success;\r\n\t\t\t\t\t\tif(sf) { d = sf.call(this,d,t,x) || d; }\r\n\t\t\t\t\t\tthis.data.search.to_open = d;\r\n\t\t\t\t\t\tthis._search_open();\r\n\t\t\t\t\t};\r\n\t\t\t\t\ts.ajax.context = this;\r\n\t\t\t\t\ts.ajax.error = error_func;\r\n\t\t\t\t\ts.ajax.success = success_func;\r\n\t\t\t\t\tif($.isFunction(s.ajax.url)) { s.ajax.url = s.ajax.url.call(this, str); }\r\n\t\t\t\t\tif($.isFunction(s.ajax.data)) { s.ajax.data = s.ajax.data.call(this, str); }\r\n\t\t\t\t\tif(!s.ajax.data) { s.ajax.data = { \"search_string\" : str }; }\r\n\t\t\t\t\tif(!s.ajax.dataType || /^json/.exec(s.ajax.dataType)) { s.ajax.dataType = \"json\"; }\r\n\t\t\t\t\t$.ajax(s.ajax);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif(this.data.search.result.length) { this.clear_search(); }\r\n\t\t\t\tthis.data.search.result = this.get_container().find(\"a\" + (this.data.languages ? \".\" + this.get_lang() : \"\" ) + \":\" + (s.search_method) + \"(\" + this.data.search.str + \")\");\r\n\t\t\t\tthis.data.search.result.addClass(\"jstree-search\").parent().parents(\".jstree-closed\").each(function () {\r\n\t\t\t\t\tt.open_node(this, false, true);\r\n\t\t\t\t});\r\n\t\t\t\tthis.__callback({ nodes : this.data.search.result, str : str });\r\n\t\t\t},\r\n\t\t\tclear_search : function (str) {\r\n\t\t\t\tthis.data.search.result.removeClass(\"jstree-search\");\r\n\t\t\t\tthis.__callback(this.data.search.result);\r\n\t\t\t\tthis.data.search.result = $();\r\n\t\t\t},\r\n\t\t\t_search_open : function (is_callback) {\r\n\t\t\t\tvar _this = this,\r\n\t\t\t\t\tdone = true,\r\n\t\t\t\t\tcurrent = [],\r\n\t\t\t\t\tremaining = [];\r\n\t\t\t\tif(this.data.search.to_open.length) {\r\n\t\t\t\t\t$.each(this.data.search.to_open, function (i, val) {\r\n\t\t\t\t\t\tif(val == \"#\") { return true; }\r\n\t\t\t\t\t\tif($(val).length && $(val).is(\".jstree-closed\")) { current.push(val); }\r\n\t\t\t\t\t\telse { remaining.push(val); }\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(current.length) {\r\n\t\t\t\t\t\tthis.data.search.to_open = remaining;\r\n\t\t\t\t\t\t$.each(current, function (i, val) {\r\n\t\t\t\t\t\t\t_this.open_node(val, function () { _this._search_open(true); });\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tdone = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(done) { this.search(this.data.search.str, true); }\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree contextmenu plugin\r\n */\r\n(function ($) {\r\n\t$.vakata.context = {\r\n\t\thide_on_mouseleave : false,\r\n\r\n\t\tcnt\t\t: $(\"<div id='vakata-contextmenu' />\"),\r\n\t\tvis\t\t: false,\r\n\t\ttgt\t\t: false,\r\n\t\tpar\t\t: false,\r\n\t\tfunc\t: false,\r\n\t\tdata\t: false,\r\n\t\trtl\t\t: false,\r\n\t\tshow\t: function (s, t, x, y, d, p, rtl) {\r\n\t\t\t$.vakata.context.rtl = !!rtl;\r\n\t\t\tvar html = $.vakata.context.parse(s), h, w;\r\n\t\t\tif(!html) { return; }\r\n\t\t\t$.vakata.context.vis = true;\r\n\t\t\t$.vakata.context.tgt = t;\r\n\t\t\t$.vakata.context.par = p || t || null;\r\n\t\t\t$.vakata.context.data = d || null;\r\n\t\t\t$.vakata.context.cnt\r\n\t\t\t\t.html(html)\r\n\t\t\t\t.css({ \"visibility\" : \"hidden\", \"display\" : \"block\", \"left\" : 0, \"top\" : 0 });\r\n\r\n\t\t\tif($.vakata.context.hide_on_mouseleave) {\r\n\t\t\t\t$.vakata.context.cnt\r\n\t\t\t\t\t.one(\"mouseleave\", function(e) { $.vakata.context.hide(); });\r\n\t\t\t}\r\n\r\n\t\t\th = $.vakata.context.cnt.height();\r\n\t\t\tw = $.vakata.context.cnt.width();\r\n\t\t\tif(x + w > $(document).width()) {\r\n\t\t\t\tx = $(document).width() - (w + 5);\r\n\t\t\t\t$.vakata.context.cnt.find(\"li > ul\").addClass(\"right\");\r\n\t\t\t}\r\n\t\t\tif(y + h > $(document).height()) {\r\n\t\t\t\ty = y - (h + t[0].offsetHeight);\r\n\t\t\t\t$.vakata.context.cnt.find(\"li > ul\").addClass(\"bottom\");\r\n\t\t\t}\r\n\r\n\t\t\t$.vakata.context.cnt\r\n\t\t\t\t.css({ \"left\" : x, \"top\" : y })\r\n\t\t\t\t.find(\"li:has(ul)\")\r\n\t\t\t\t\t.bind(\"mouseenter\", function (e) {\r\n\t\t\t\t\t\tvar w = $(document).width(),\r\n\t\t\t\t\t\t\th = $(document).height(),\r\n\t\t\t\t\t\t\tul = $(this).children(\"ul\").show();\r\n\t\t\t\t\t\tif(w !== $(document).width()) { ul.toggleClass(\"right\"); }\r\n\t\t\t\t\t\tif(h !== $(document).height()) { ul.toggleClass(\"bottom\"); }\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.bind(\"mouseleave\", function (e) {\r\n\t\t\t\t\t\t$(this).children(\"ul\").hide();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.end()\r\n\t\t\t\t.css({ \"visibility\" : \"visible\" })\r\n\t\t\t\t.show();\r\n\t\t\t$(document).triggerHandler(\"context_show.vakata\");\r\n\t\t},\r\n\t\thide\t: function () {\r\n\t\t\t$.vakata.context.vis = false;\r\n\t\t\t$.vakata.context.cnt.attr(\"class\",\"\").css({ \"visibility\" : \"hidden\" });\r\n\t\t\t$(document).triggerHandler(\"context_hide.vakata\");\r\n\t\t},\r\n\t\tparse\t: function (s, is_callback) {\r\n\t\t\tif(!s) { return false; }\r\n\t\t\tvar str = \"\",\r\n\t\t\t\ttmp = false,\r\n\t\t\t\twas_sep = true;\r\n\t\t\tif(!is_callback) { $.vakata.context.func = {}; }\r\n\t\t\tstr += \"<ul>\";\r\n\t\t\t$.each(s, function (i, val) {\r\n\t\t\t\tif(!val) { return true; }\r\n\t\t\t\t$.vakata.context.func[i] = val.action;\r\n\t\t\t\tif(!was_sep && val.separator_before) {\r\n\t\t\t\t\tstr += \"<li class='vakata-separator vakata-separator-before'></li>\";\r\n\t\t\t\t}\r\n\t\t\t\twas_sep = false;\r\n\t\t\t\tstr += \"<li class='\" + (val._class || \"\") + (val._disabled ? \" jstree-contextmenu-disabled \" : \"\") + \"'><ins \";\r\n\t\t\t\tif(val.icon && val.icon.indexOf(\"/\") === -1) { str += \" class='\" + val.icon + \"' \"; }\r\n\t\t\t\tif(val.icon && val.icon.indexOf(\"/\") !== -1) { str += \" style='background:url(\" + val.icon + \") center center no-repeat;' \"; }\r\n\t\t\t\tstr += \">&#160;</ins><a href='#' rel='\" + i + \"'>\";\r\n\t\t\t\tif(val.submenu) {\r\n\t\t\t\t\tstr += \"<span style='float:\" + ($.vakata.context.rtl ? \"left\" : \"right\") + \";'>&raquo;</span>\";\r\n\t\t\t\t}\r\n\t\t\t\tstr += val.label + \"</a>\";\r\n\t\t\t\tif(val.submenu) {\r\n\t\t\t\t\ttmp = $.vakata.context.parse(val.submenu, true);\r\n\t\t\t\t\tif(tmp) { str += tmp; }\r\n\t\t\t\t}\r\n\t\t\t\tstr += \"</li>\";\r\n\t\t\t\tif(val.separator_after) {\r\n\t\t\t\t\tstr += \"<li class='vakata-separator vakata-separator-after'></li>\";\r\n\t\t\t\t\twas_sep = true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tstr = str.replace(/<li class\\='vakata-separator vakata-separator-after'\\><\\/li\\>$/,\"\");\r\n\t\t\tstr += \"</ul>\";\r\n\t\t\t$(document).triggerHandler(\"context_parse.vakata\");\r\n\t\t\treturn str.length > 10 ? str : false;\r\n\t\t},\r\n\t\texec\t: function (i) {\r\n\t\t\tif($.isFunction($.vakata.context.func[i])) {\r\n\t\t\t\t// if is string - eval and call it!\r\n\t\t\t\t$.vakata.context.func[i].call($.vakata.context.data, $.vakata.context.par);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\telse { return false; }\r\n\t\t}\r\n\t};\r\n\t$(function () {\r\n\t\tvar css_string = '' +\r\n\t\t\t'#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } ' +\r\n\t\t\t'#vakata-contextmenu ul { min-width:180px; *width:180px; } ' +\r\n\t\t\t'#vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } ' +\r\n\t\t\t'#vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } ' +\r\n\t\t\t'#vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } ' +\r\n\t\t\t'#vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } ' +\r\n\t\t\t'#vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } ' +\r\n\t\t\t'#vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } ' +\r\n\t\t\t'#vakata-contextmenu .right { right:100%; left:auto; } ' +\r\n\t\t\t'#vakata-contextmenu .bottom { bottom:-1px; top:auto; } ' +\r\n\t\t\t'#vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ';\r\n\t\t$.vakata.css.add_sheet({ str : css_string, title : \"vakata\" });\r\n\t\t$.vakata.context.cnt\r\n\t\t\t.delegate(\"a\",\"click\", function (e) { e.preventDefault(); })\r\n\t\t\t.delegate(\"a\",\"mouseup\", function (e) {\r\n\t\t\t\tif(!$(this).parent().hasClass(\"jstree-contextmenu-disabled\") && $.vakata.context.exec($(this).attr(\"rel\"))) {\r\n\t\t\t\t\t$.vakata.context.hide();\r\n\t\t\t\t}\r\n\t\t\t\telse { $(this).blur(); }\r\n\t\t\t})\r\n\t\t\t.delegate(\"a\",\"mouseover\", function () {\r\n\t\t\t\t$.vakata.context.cnt.find(\".vakata-hover\").removeClass(\"vakata-hover\");\r\n\t\t\t})\r\n\t\t\t.appendTo(\"body\");\r\n\t\t$(document).bind(\"mousedown\", function (e) { if($.vakata.context.vis && !$.contains($.vakata.context.cnt[0], e.target)) { $.vakata.context.hide(); } });\r\n\t\tif(typeof $.hotkeys !== \"undefined\") {\r\n\t\t\t$(document)\r\n\t\t\t\t.bind(\"keydown\", \"up\", function (e) {\r\n\t\t\t\t\tif($.vakata.context.vis) {\r\n\t\t\t\t\t\tvar o = $.vakata.context.cnt.find(\"ul:visible\").last().children(\".vakata-hover\").removeClass(\"vakata-hover\").prevAll(\"li:not(.vakata-separator)\").first();\r\n\t\t\t\t\t\tif(!o.length) { o = $.vakata.context.cnt.find(\"ul:visible\").last().children(\"li:not(.vakata-separator)\").last(); }\r\n\t\t\t\t\t\to.addClass(\"vakata-hover\");\r\n\t\t\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"keydown\", \"down\", function (e) {\r\n\t\t\t\t\tif($.vakata.context.vis) {\r\n\t\t\t\t\t\tvar o = $.vakata.context.cnt.find(\"ul:visible\").last().children(\".vakata-hover\").removeClass(\"vakata-hover\").nextAll(\"li:not(.vakata-separator)\").first();\r\n\t\t\t\t\t\tif(!o.length) { o = $.vakata.context.cnt.find(\"ul:visible\").last().children(\"li:not(.vakata-separator)\").first(); }\r\n\t\t\t\t\t\to.addClass(\"vakata-hover\");\r\n\t\t\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"keydown\", \"right\", function (e) {\r\n\t\t\t\t\tif($.vakata.context.vis) {\r\n\t\t\t\t\t\t$.vakata.context.cnt.find(\".vakata-hover\").children(\"ul\").show().children(\"li:not(.vakata-separator)\").removeClass(\"vakata-hover\").first().addClass(\"vakata-hover\");\r\n\t\t\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"keydown\", \"left\", function (e) {\r\n\t\t\t\t\tif($.vakata.context.vis) {\r\n\t\t\t\t\t\t$.vakata.context.cnt.find(\".vakata-hover\").children(\"ul\").hide().children(\".vakata-separator\").removeClass(\"vakata-hover\");\r\n\t\t\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"keydown\", \"esc\", function (e) {\r\n\t\t\t\t\t$.vakata.context.hide();\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"keydown\", \"space\", function (e) {\r\n\t\t\t\t\t$.vakata.context.cnt.find(\".vakata-hover\").last().children(\"a\").click();\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n\t$.jstree.plugin(\"contextmenu\", {\r\n\t\t__init : function () {\r\n\t\t\tthis.get_container()\r\n\t\t\t\t.delegate(\"a\", \"contextmenu.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tif(!$(e.currentTarget).hasClass(\"jstree-loading\")) {\r\n\t\t\t\t\t\t\tthis.show_contextmenu(e.currentTarget, e.pageX, e.pageY);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.delegate(\"a\", \"click.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\tif(this.data.contextmenu) {\r\n\t\t\t\t\t\t\t$.vakata.context.hide();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"destroy.jstree\", $.proxy(function () {\r\n\t\t\t\t\t\t// TODO: move this to descruct method\r\n\t\t\t\t\t\tif(this.data.contextmenu) {\r\n\t\t\t\t\t\t\t$.vakata.context.hide();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this));\r\n\t\t\t$(document).bind(\"context_hide.vakata\", $.proxy(function () { this.data.contextmenu = false; }, this));\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\tselect_node : false, // requires UI plugin\r\n\t\t\tshow_at_node : true,\r\n\t\t\titems : { // Could be a function that should return an object like this one\r\n\t\t\t\t\"create\" : {\r\n\t\t\t\t\t\"separator_before\"\t: false,\r\n\t\t\t\t\t\"separator_after\"\t: true,\r\n\t\t\t\t\t\"label\"\t\t\t\t: \"Create\",\r\n\t\t\t\t\t\"action\"\t\t\t: function (obj) { this.create(obj); }\r\n\t\t\t\t},\r\n\t\t\t\t\"rename\" : {\r\n\t\t\t\t\t\"separator_before\"\t: false,\r\n\t\t\t\t\t\"separator_after\"\t: false,\r\n\t\t\t\t\t\"label\"\t\t\t\t: \"Rename\",\r\n\t\t\t\t\t\"action\"\t\t\t: function (obj) { this.rename(obj); }\r\n\t\t\t\t},\r\n\t\t\t\t\"remove\" : {\r\n\t\t\t\t\t\"separator_before\"\t: false,\r\n\t\t\t\t\t\"icon\"\t\t\t\t: false,\r\n\t\t\t\t\t\"separator_after\"\t: false,\r\n\t\t\t\t\t\"label\"\t\t\t\t: \"Delete\",\r\n\t\t\t\t\t\"action\"\t\t\t: function (obj) { if(this.is_selected(obj)) { this.remove(); } else { this.remove(obj); } }\r\n\t\t\t\t},\r\n\t\t\t\t\"ccp\" : {\r\n\t\t\t\t\t\"separator_before\"\t: true,\r\n\t\t\t\t\t\"icon\"\t\t\t\t: false,\r\n\t\t\t\t\t\"separator_after\"\t: false,\r\n\t\t\t\t\t\"label\"\t\t\t\t: \"Edit\",\r\n\t\t\t\t\t\"action\"\t\t\t: false,\r\n\t\t\t\t\t\"submenu\" : {\r\n\t\t\t\t\t\t\"cut\" : {\r\n\t\t\t\t\t\t\t\"separator_before\"\t: false,\r\n\t\t\t\t\t\t\t\"separator_after\"\t: false,\r\n\t\t\t\t\t\t\t\"label\"\t\t\t\t: \"Cut\",\r\n\t\t\t\t\t\t\t\"action\"\t\t\t: function (obj) { this.cut(obj); }\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\"copy\" : {\r\n\t\t\t\t\t\t\t\"separator_before\"\t: false,\r\n\t\t\t\t\t\t\t\"icon\"\t\t\t\t: false,\r\n\t\t\t\t\t\t\t\"separator_after\"\t: false,\r\n\t\t\t\t\t\t\t\"label\"\t\t\t\t: \"Copy\",\r\n\t\t\t\t\t\t\t\"action\"\t\t\t: function (obj) { this.copy(obj); }\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\"paste\" : {\r\n\t\t\t\t\t\t\t\"separator_before\"\t: false,\r\n\t\t\t\t\t\t\t\"icon\"\t\t\t\t: false,\r\n\t\t\t\t\t\t\t\"separator_after\"\t: false,\r\n\t\t\t\t\t\t\t\"label\"\t\t\t\t: \"Paste\",\r\n\t\t\t\t\t\t\t\"action\"\t\t\t: function (obj) { this.paste(obj); }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\tshow_contextmenu : function (obj, x, y) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tvar s = this.get_settings().contextmenu,\r\n\t\t\t\t\ta = obj.children(\"a:visible:eq(0)\"),\r\n\t\t\t\t\to = false,\r\n\t\t\t\t\ti = false;\r\n\t\t\t\tif(s.select_node && this.data.ui && !this.is_selected(obj)) {\r\n\t\t\t\t\tthis.deselect_all();\r\n\t\t\t\t\tthis.select_node(obj, true);\r\n\t\t\t\t}\r\n\t\t\t\tif(s.show_at_node || typeof x === \"undefined\" || typeof y === \"undefined\") {\r\n\t\t\t\t\to = a.offset();\r\n\t\t\t\t\tx = o.left;\r\n\t\t\t\t\ty = o.top + this.data.core.li_height;\r\n\t\t\t\t}\r\n\t\t\t\ti = obj.data(\"jstree\") && obj.data(\"jstree\").contextmenu ? obj.data(\"jstree\").contextmenu : s.items;\r\n\t\t\t\tif($.isFunction(i)) { i = i.call(this, obj); }\r\n\t\t\t\tthis.data.contextmenu = true;\r\n\t\t\t\t$.vakata.context.show(i, a, x, y, this, obj, this._get_settings().core.rtl);\r\n\t\t\t\tif(this.data.themes) { $.vakata.context.cnt.attr(\"class\", \"jstree-\" + this.data.themes.theme + \"-context\"); }\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree types plugin\r\n * Adds support types of nodes\r\n * You can set an attribute on each li node, that represents its type.\r\n * According to the type setting the node may get custom icon/validation rules\r\n */\r\n(function ($) {\r\n\t$.jstree.plugin(\"types\", {\r\n\t\t__init : function () {\r\n\t\t\tvar s = this._get_settings().types;\r\n\t\t\tthis.data.types.attach_to = [];\r\n\t\t\tthis.get_container()\r\n\t\t\t\t.bind(\"init.jstree\", $.proxy(function () {\r\n\t\t\t\t\t\tvar types = s.types,\r\n\t\t\t\t\t\t\tattr  = s.type_attr,\r\n\t\t\t\t\t\t\ticons_css = \"\",\r\n\t\t\t\t\t\t\t_this = this;\r\n\r\n\t\t\t\t\t\t$.each(types, function (i, tp) {\r\n\t\t\t\t\t\t\t$.each(tp, function (k, v) {\r\n\t\t\t\t\t\t\t\tif(!/^(max_depth|max_children|icon|valid_children)$/.test(k)) { _this.data.types.attach_to.push(k); }\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif(!tp.icon) { return true; }\r\n\t\t\t\t\t\t\tif( tp.icon.image || tp.icon.position) {\r\n\t\t\t\t\t\t\t\tif(i == \"default\")\t{ icons_css += '.jstree-' + _this.get_index() + ' a > .jstree-icon { '; }\r\n\t\t\t\t\t\t\t\telse\t\t\t\t{ icons_css += '.jstree-' + _this.get_index() + ' li[' + attr + '=\"' + i + '\"] > a > .jstree-icon { '; }\r\n\t\t\t\t\t\t\t\tif(tp.icon.image)\t{ icons_css += ' background-image:url(' + tp.icon.image + '); '; }\r\n\t\t\t\t\t\t\t\tif(tp.icon.position){ icons_css += ' background-position:' + tp.icon.position + '; '; }\r\n\t\t\t\t\t\t\t\telse\t\t\t\t{ icons_css += ' background-position:0 0; '; }\r\n\t\t\t\t\t\t\t\ticons_css += '} ';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif(icons_css !== \"\") { $.vakata.css.add_sheet({ 'str' : icons_css, title : \"jstree-types\" }); }\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"before.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tvar s, t,\r\n\t\t\t\t\t\t\to = this._get_settings().types.use_data ? this._get_node(data.args[0]) : false,\r\n\t\t\t\t\t\t\td = o && o !== -1 && o.length ? o.data(\"jstree\") : false;\r\n\t\t\t\t\t\tif(d && d.types && d.types[data.func] === false) { e.stopImmediatePropagation(); return false; }\r\n\t\t\t\t\t\tif($.inArray(data.func, this.data.types.attach_to) !== -1) {\r\n\t\t\t\t\t\t\tif(!data.args[0] || (!data.args[0].tagName && !data.args[0].jquery)) { return; }\r\n\t\t\t\t\t\t\ts = this._get_settings().types.types;\r\n\t\t\t\t\t\t\tt = this._get_type(data.args[0]);\r\n\t\t\t\t\t\t\tif(\r\n\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t(s[t] && typeof s[t][data.func] !== \"undefined\") ||\r\n\t\t\t\t\t\t\t\t\t(s[\"default\"] && typeof s[\"default\"][data.func] !== \"undefined\")\r\n\t\t\t\t\t\t\t\t) && this._check(data.func, data.args[0]) === false\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this));\r\n\t\t\tif(is_ie6) {\r\n\t\t\t\tthis.get_container()\r\n\t\t\t\t\t.bind(\"load_node.jstree set_type.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\t\tvar r = data && data.rslt && data.rslt.obj && data.rslt.obj !== -1 ? this._get_node(data.rslt.obj).parent() : this.get_container_ul(),\r\n\t\t\t\t\t\t\t\tc = false,\r\n\t\t\t\t\t\t\t\ts = this._get_settings().types;\r\n\t\t\t\t\t\t\t$.each(s.types, function (i, tp) {\r\n\t\t\t\t\t\t\t\tif(tp.icon && (tp.icon.image || tp.icon.position)) {\r\n\t\t\t\t\t\t\t\t\tc = i === \"default\" ? r.find(\"li > a > .jstree-icon\") : r.find(\"li[\" + s.type_attr + \"='\" + i + \"'] > a > .jstree-icon\");\r\n\t\t\t\t\t\t\t\t\tif(tp.icon.image) { c.css(\"backgroundImage\",\"url(\" + tp.icon.image + \")\"); }\r\n\t\t\t\t\t\t\t\t\tc.css(\"backgroundPosition\", tp.icon.position || \"0 0\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}, this));\r\n\t\t\t}\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\t// defines maximum number of root nodes (-1 means unlimited, -2 means disable max_children checking)\r\n\t\t\tmax_children\t\t: -1,\r\n\t\t\t// defines the maximum depth of the tree (-1 means unlimited, -2 means disable max_depth checking)\r\n\t\t\tmax_depth\t\t\t: -1,\r\n\t\t\t// defines valid node types for the root nodes\r\n\t\t\tvalid_children\t\t: \"all\",\r\n\r\n\t\t\t// whether to use $.data\r\n\t\t\tuse_data : false,\r\n\t\t\t// where is the type stores (the rel attribute of the LI element)\r\n\t\t\ttype_attr : \"rel\",\r\n\t\t\t// a list of types\r\n\t\t\ttypes : {\r\n\t\t\t\t// the default type\r\n\t\t\t\t\"default\" : {\r\n\t\t\t\t\t\"max_children\"\t: -1,\r\n\t\t\t\t\t\"max_depth\"\t\t: -1,\r\n\t\t\t\t\t\"valid_children\": \"all\"\r\n\r\n\t\t\t\t\t// Bound functions - you can bind any other function here (using boolean or function)\r\n\t\t\t\t\t//\"select_node\"\t: true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\t_types_notify : function (n, data) {\r\n\t\t\t\tif(data.type && this._get_settings().types.use_data) {\r\n\t\t\t\t\tthis.set_type(data.type, n);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t_get_type : function (obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\treturn (!obj || !obj.length) ? false : obj.attr(this._get_settings().types.type_attr) || \"default\";\r\n\t\t\t},\r\n\t\t\tset_type : function (str, obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tvar ret = (!obj.length || !str) ? false : obj.attr(this._get_settings().types.type_attr, str);\r\n\t\t\t\tif(ret) { this.__callback({ obj : obj, type : str}); }\r\n\t\t\t\treturn ret;\r\n\t\t\t},\r\n\t\t\t_check : function (rule, obj, opts) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tvar v = false, t = this._get_type(obj), d = 0, _this = this, s = this._get_settings().types, data = false;\r\n\t\t\t\tif(obj === -1) {\r\n\t\t\t\t\tif(!!s[rule]) { v = s[rule]; }\r\n\t\t\t\t\telse { return; }\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(t === false) { return; }\r\n\t\t\t\t\tdata = s.use_data ? obj.data(\"jstree\") : false;\r\n\t\t\t\t\tif(data && data.types && typeof data.types[rule] !== \"undefined\") { v = data.types[rule]; }\r\n\t\t\t\t\telse if(!!s.types[t] && typeof s.types[t][rule] !== \"undefined\") { v = s.types[t][rule]; }\r\n\t\t\t\t\telse if(!!s.types[\"default\"] && typeof s.types[\"default\"][rule] !== \"undefined\") { v = s.types[\"default\"][rule]; }\r\n\t\t\t\t}\r\n\t\t\t\tif($.isFunction(v)) { v = v.call(this, obj); }\r\n\t\t\t\tif(rule === \"max_depth\" && obj !== -1 && opts !== false && s.max_depth !== -2 && v !== 0) {\r\n\t\t\t\t\t// also include the node itself - otherwise if root node it is not checked\r\n\t\t\t\t\tobj.children(\"a:eq(0)\").parentsUntil(\".jstree\",\"li\").each(function (i) {\r\n\t\t\t\t\t\t// check if current depth already exceeds global tree depth\r\n\t\t\t\t\t\tif(s.max_depth !== -1 && s.max_depth - (i + 1) <= 0) { v = 0; return false; }\r\n\t\t\t\t\t\td = (i === 0) ? v : _this._check(rule, this, false);\r\n\t\t\t\t\t\t// check if current node max depth is already matched or exceeded\r\n\t\t\t\t\t\tif(d !== -1 && d - (i + 1) <= 0) { v = 0; return false; }\r\n\t\t\t\t\t\t// otherwise - set the max depth to the current value minus current depth\r\n\t\t\t\t\t\tif(d >= 0 && (d - (i + 1) < v || v < 0) ) { v = d - (i + 1); }\r\n\t\t\t\t\t\t// if the global tree depth exists and it minus the nodes calculated so far is less than `v` or `v` is unlimited\r\n\t\t\t\t\t\tif(s.max_depth >= 0 && (s.max_depth - (i + 1) < v || v < 0) ) { v = s.max_depth - (i + 1); }\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn v;\r\n\t\t\t},\r\n\t\t\tcheck_move : function () {\r\n\t\t\t\tif(!this.__call_old()) { return false; }\r\n\t\t\t\tvar m  = this._get_move(),\r\n\t\t\t\t\ts  = m.rt._get_settings().types,\r\n\t\t\t\t\tmc = m.rt._check(\"max_children\", m.cr),\r\n\t\t\t\t\tmd = m.rt._check(\"max_depth\", m.cr),\r\n\t\t\t\t\tvc = m.rt._check(\"valid_children\", m.cr),\r\n\t\t\t\t\tch = 0, d = 1, t;\r\n\r\n\t\t\t\tif(vc === \"none\") { return false; }\r\n\t\t\t\tif($.isArray(vc) && m.ot && m.ot._get_type) {\r\n\t\t\t\t\tm.o.each(function () {\r\n\t\t\t\t\t\tif($.inArray(m.ot._get_type(this), vc) === -1) { d = false; return false; }\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(d === false) { return false; }\r\n\t\t\t\t}\r\n\t\t\t\tif(s.max_children !== -2 && mc !== -1) {\r\n\t\t\t\t\tch = m.cr === -1 ? this.get_container().find(\"> ul > li\").not(m.o).length : m.cr.find(\"> ul > li\").not(m.o).length;\r\n\t\t\t\t\tif(ch + m.o.length > mc) { return false; }\r\n\t\t\t\t}\r\n\t\t\t\tif(s.max_depth !== -2 && md !== -1) {\r\n\t\t\t\t\td = 0;\r\n\t\t\t\t\tif(md === 0) { return false; }\r\n\t\t\t\t\tif(typeof m.o.d === \"undefined\") {\r\n\t\t\t\t\t\t// TODO: deal with progressive rendering and async when checking max_depth (how to know the depth of the moved node)\r\n\t\t\t\t\t\tt = m.o;\r\n\t\t\t\t\t\twhile(t.length > 0) {\r\n\t\t\t\t\t\t\tt = t.find(\"> ul > li\");\r\n\t\t\t\t\t\t\td ++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tm.o.d = d;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(md - m.o.d < 0) { return false; }\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\t\t\tcreate_node : function (obj, position, js, callback, is_loaded, skip_check) {\r\n\t\t\t\tif(!skip_check && (is_loaded || this._is_loaded(obj))) {\r\n\t\t\t\t\tvar p  = (typeof position == \"string\" && position.match(/^before|after$/i) && obj !== -1) ? this._get_parent(obj) : this._get_node(obj),\r\n\t\t\t\t\t\ts  = this._get_settings().types,\r\n\t\t\t\t\t\tmc = this._check(\"max_children\", p),\r\n\t\t\t\t\t\tmd = this._check(\"max_depth\", p),\r\n\t\t\t\t\t\tvc = this._check(\"valid_children\", p),\r\n\t\t\t\t\t\tch;\r\n\t\t\t\t\tif(typeof js === \"string\") { js = { data : js }; }\r\n\t\t\t\t\tif(!js) { js = {}; }\r\n\t\t\t\t\tif(vc === \"none\") { return false; }\r\n\t\t\t\t\tif($.isArray(vc)) {\r\n\t\t\t\t\t\tif(!js.attr || !js.attr[s.type_attr]) {\r\n\t\t\t\t\t\t\tif(!js.attr) { js.attr = {}; }\r\n\t\t\t\t\t\t\tjs.attr[s.type_attr] = vc[0];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif($.inArray(js.attr[s.type_attr], vc) === -1) { return false; }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(s.max_children !== -2 && mc !== -1) {\r\n\t\t\t\t\t\tch = p === -1 ? this.get_container().find(\"> ul > li\").length : p.find(\"> ul > li\").length;\r\n\t\t\t\t\t\tif(ch + 1 > mc) { return false; }\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(s.max_depth !== -2 && md !== -1 && (md - 1) < 0) { return false; }\r\n\t\t\t\t}\r\n\t\t\t\treturn this.__call_old(true, obj, position, js, callback, is_loaded, skip_check);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree HTML plugin\r\n * The HTML data store. Datastores are build by replacing the `load_node` and `_is_loaded` functions.\r\n */\r\n(function ($) {\r\n\t$.jstree.plugin(\"html_data\", {\r\n\t\t__init : function () {\r\n\t\t\t// this used to use html() and clean the whitespace, but this way any attached data was lost\r\n\t\t\tthis.data.html_data.original_container_html = this.get_container().find(\" > ul > li\").clone(true);\r\n\t\t\t// remove white space from LI node - otherwise nodes appear a bit to the right\r\n\t\t\tthis.data.html_data.original_container_html.find(\"li\").addBack().contents().filter(function() { return this.nodeType == 3; }).remove();\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\tdata : false,\r\n\t\t\tajax : false,\r\n\t\t\tcorrect_state : true\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\tload_node : function (obj, s_call, e_call) { var _this = this; this.load_node_html(obj, function () { _this.__callback({ \"obj\" : _this._get_node(obj) }); s_call.call(this); }, e_call); },\r\n\t\t\t_is_loaded : function (obj) {\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\treturn obj == -1 || !obj || (!this._get_settings().html_data.ajax && !$.isFunction(this._get_settings().html_data.data)) || obj.is(\".jstree-open, .jstree-leaf\") || obj.children(\"ul\").children(\"li\").size() > 0;\r\n\t\t\t},\r\n\t\t\tload_node_html : function (obj, s_call, e_call) {\r\n\t\t\t\tvar d,\r\n\t\t\t\t\ts = this.get_settings().html_data,\r\n\t\t\t\t\terror_func = function () {},\r\n\t\t\t\t\tsuccess_func = function () {};\r\n\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\tif(obj && obj !== -1) {\r\n\t\t\t\t\tif(obj.data(\"jstree_is_loading\")) { return; }\r\n\t\t\t\t\telse { obj.data(\"jstree_is_loading\",true); }\r\n\t\t\t\t}\r\n\t\t\t\tswitch(!0) {\r\n\t\t\t\t\tcase ($.isFunction(s.data)):\r\n\t\t\t\t\t\ts.data.call(this, obj, $.proxy(function (d) {\r\n\t\t\t\t\t\t\tif(d && d !== \"\" && d.toString && d.toString().replace(/^[\\s\\n]+$/,\"\") !== \"\") {\r\n\t\t\t\t\t\t\t\td = $(d);\r\n\t\t\t\t\t\t\t\tif(!d.is(\"ul\")) { d = $(\"<ul />\").append(d); }\r\n\t\t\t\t\t\t\t\tif(obj == -1 || !obj) { this.get_container().children(\"ul\").empty().append(d.children()).find(\"li, a\").filter(function () { return !this.firstChild || !this.firstChild.tagName || this.firstChild.tagName !== \"INS\"; }).prepend(\"<ins class='jstree-icon'>&#160;</ins>\").end().filter(\"a\").children(\"ins:first-child\").not(\".jstree-icon\").addClass(\"jstree-icon\"); }\r\n\t\t\t\t\t\t\t\telse { obj.children(\"a.jstree-loading\").removeClass(\"jstree-loading\"); obj.append(d).children(\"ul\").find(\"li, a\").filter(function () { return !this.firstChild || !this.firstChild.tagName || this.firstChild.tagName !== \"INS\"; }).prepend(\"<ins class='jstree-icon'>&#160;</ins>\").end().filter(\"a\").children(\"ins:first-child\").not(\".jstree-icon\").addClass(\"jstree-icon\"); obj.removeData(\"jstree_is_loading\"); }\r\n\t\t\t\t\t\t\t\tthis.clean_node(obj);\r\n\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif(obj && obj !== -1) {\r\n\t\t\t\t\t\t\t\t\tobj.children(\"a.jstree-loading\").removeClass(\"jstree-loading\");\r\n\t\t\t\t\t\t\t\t\tobj.removeData(\"jstree_is_loading\");\r\n\t\t\t\t\t\t\t\t\tif(s.correct_state) {\r\n\t\t\t\t\t\t\t\t\t\tthis.correct_state(obj);\r\n\t\t\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tif(s.correct_state) {\r\n\t\t\t\t\t\t\t\t\t\tthis.get_container().children(\"ul\").empty();\r\n\t\t\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, this));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase (!s.data && !s.ajax):\r\n\t\t\t\t\t\tif(!obj || obj == -1) {\r\n\t\t\t\t\t\t\tthis.get_container()\r\n\t\t\t\t\t\t\t\t.children(\"ul\").empty()\r\n\t\t\t\t\t\t\t\t.append(this.data.html_data.original_container_html)\r\n\t\t\t\t\t\t\t\t.find(\"li, a\").filter(function () { return !this.firstChild || !this.firstChild.tagName || this.firstChild.tagName !== \"INS\"; }).prepend(\"<ins class='jstree-icon'>&#160;</ins>\").end()\r\n\t\t\t\t\t\t\t\t.filter(\"a\").children(\"ins:first-child\").not(\".jstree-icon\").addClass(\"jstree-icon\");\r\n\t\t\t\t\t\t\tthis.clean_node();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase (!!s.data && !s.ajax) || (!!s.data && !!s.ajax && (!obj || obj === -1)):\r\n\t\t\t\t\t\tif(!obj || obj == -1) {\r\n\t\t\t\t\t\t\td = $(s.data);\r\n\t\t\t\t\t\t\tif(!d.is(\"ul\")) { d = $(\"<ul />\").append(d); }\r\n\t\t\t\t\t\t\tthis.get_container()\r\n\t\t\t\t\t\t\t\t.children(\"ul\").empty().append(d.children())\r\n\t\t\t\t\t\t\t\t.find(\"li, a\").filter(function () { return !this.firstChild || !this.firstChild.tagName || this.firstChild.tagName !== \"INS\"; }).prepend(\"<ins class='jstree-icon'>&#160;</ins>\").end()\r\n\t\t\t\t\t\t\t\t.filter(\"a\").children(\"ins:first-child\").not(\".jstree-icon\").addClass(\"jstree-icon\");\r\n\t\t\t\t\t\t\tthis.clean_node();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase (!s.data && !!s.ajax) || (!!s.data && !!s.ajax && obj && obj !== -1):\r\n\t\t\t\t\t\tobj = this._get_node(obj);\r\n\t\t\t\t\t\terror_func = function (x, t, e) {\r\n\t\t\t\t\t\t\tvar ef = this.get_settings().html_data.ajax.error;\r\n\t\t\t\t\t\t\tif(ef) { ef.call(this, x, t, e); }\r\n\t\t\t\t\t\t\tif(obj != -1 && obj.length) {\r\n\t\t\t\t\t\t\t\tobj.children(\"a.jstree-loading\").removeClass(\"jstree-loading\");\r\n\t\t\t\t\t\t\t\tobj.removeData(\"jstree_is_loading\");\r\n\t\t\t\t\t\t\t\tif(t === \"success\" && s.correct_state) { this.correct_state(obj); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif(t === \"success\" && s.correct_state) { this.get_container().children(\"ul\").empty(); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(e_call) { e_call.call(this); }\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tsuccess_func = function (d, t, x) {\r\n\t\t\t\t\t\t\tvar sf = this.get_settings().html_data.ajax.success;\r\n\t\t\t\t\t\t\tif(sf) { d = sf.call(this,d,t,x) || d; }\r\n\t\t\t\t\t\t\tif(d === \"\" || (d && d.toString && d.toString().replace(/^[\\s\\n]+$/,\"\") === \"\")) {\r\n\t\t\t\t\t\t\t\treturn error_func.call(this, x, t, \"\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(d) {\r\n\t\t\t\t\t\t\t\td = $(d);\r\n\t\t\t\t\t\t\t\tif(!d.is(\"ul\")) { d = $(\"<ul />\").append(d); }\r\n\t\t\t\t\t\t\t\tif(obj == -1 || !obj) { this.get_container().children(\"ul\").empty().append(d.children()).find(\"li, a\").filter(function () { return !this.firstChild || !this.firstChild.tagName || this.firstChild.tagName !== \"INS\"; }).prepend(\"<ins class='jstree-icon'>&#160;</ins>\").end().filter(\"a\").children(\"ins:first-child\").not(\".jstree-icon\").addClass(\"jstree-icon\"); }\r\n\t\t\t\t\t\t\t\telse { obj.children(\"a.jstree-loading\").removeClass(\"jstree-loading\"); obj.append(d).children(\"ul\").find(\"li, a\").filter(function () { return !this.firstChild || !this.firstChild.tagName || this.firstChild.tagName !== \"INS\"; }).prepend(\"<ins class='jstree-icon'>&#160;</ins>\").end().filter(\"a\").children(\"ins:first-child\").not(\".jstree-icon\").addClass(\"jstree-icon\"); obj.removeData(\"jstree_is_loading\"); }\r\n\t\t\t\t\t\t\t\tthis.clean_node(obj);\r\n\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif(obj && obj !== -1) {\r\n\t\t\t\t\t\t\t\t\tobj.children(\"a.jstree-loading\").removeClass(\"jstree-loading\");\r\n\t\t\t\t\t\t\t\t\tobj.removeData(\"jstree_is_loading\");\r\n\t\t\t\t\t\t\t\t\tif(s.correct_state) {\r\n\t\t\t\t\t\t\t\t\t\tthis.correct_state(obj);\r\n\t\t\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tif(s.correct_state) {\r\n\t\t\t\t\t\t\t\t\t\tthis.get_container().children(\"ul\").empty();\r\n\t\t\t\t\t\t\t\t\t\tif(s_call) { s_call.call(this); }\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\ts.ajax.context = this;\r\n\t\t\t\t\t\ts.ajax.error = error_func;\r\n\t\t\t\t\t\ts.ajax.success = success_func;\r\n\t\t\t\t\t\tif(!s.ajax.dataType) { s.ajax.dataType = \"html\"; }\r\n\t\t\t\t\t\tif($.isFunction(s.ajax.url)) { s.ajax.url = s.ajax.url.call(this, obj); }\r\n\t\t\t\t\t\tif($.isFunction(s.ajax.data)) { s.ajax.data = s.ajax.data.call(this, obj); }\r\n\t\t\t\t\t\t$.ajax(s.ajax);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\t// include the HTML data plugin by default\r\n\t$.jstree.defaults.plugins.push(\"html_data\");\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree themeroller plugin\r\n * Adds support for jQuery UI themes. Include this at the end of your plugins list, also make sure \"themes\" is not included.\r\n */\r\n(function ($) {\r\n\t$.jstree.plugin(\"themeroller\", {\r\n\t\t__init : function () {\r\n\t\t\tvar s = this._get_settings().themeroller;\r\n\t\t\tthis.get_container()\r\n\t\t\t\t.addClass(\"ui-widget-content\")\r\n\t\t\t\t.addClass(\"jstree-themeroller\")\r\n\t\t\t\t.delegate(\"a\",\"mouseenter.jstree\", function (e) {\r\n\t\t\t\t\tif(!$(e.currentTarget).hasClass(\"jstree-loading\")) {\r\n\t\t\t\t\t\t$(this).addClass(s.item_h);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.delegate(\"a\",\"mouseleave.jstree\", function () {\r\n\t\t\t\t\t$(this).removeClass(s.item_h);\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"init.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tdata.inst.get_container().find(\"> ul > li > .jstree-loading > ins\").addClass(\"ui-icon-refresh\");\r\n\t\t\t\t\t\tthis._themeroller(data.inst.get_container().find(\"> ul > li\"));\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"open_node.jstree create_node.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tthis._themeroller(data.rslt.obj);\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"loaded.jstree refresh.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\tthis._themeroller();\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"close_node.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tthis._themeroller(data.rslt.obj);\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"delete_node.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tthis._themeroller(data.rslt.parent);\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"correct_state.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tdata.rslt.obj\r\n\t\t\t\t\t\t\t.children(\"ins.jstree-icon\").removeClass(s.opened + \" \" + s.closed + \" ui-icon\").end()\r\n\t\t\t\t\t\t\t.find(\"> a > ins.ui-icon\")\r\n\t\t\t\t\t\t\t\t.filter(function() {\r\n\t\t\t\t\t\t\t\t\treturn this.className.toString()\r\n\t\t\t\t\t\t\t\t\t\t.replace(s.item_clsd,\"\").replace(s.item_open,\"\").replace(s.item_leaf,\"\")\r\n\t\t\t\t\t\t\t\t\t\t.indexOf(\"ui-icon-\") === -1;\r\n\t\t\t\t\t\t\t\t}).removeClass(s.item_open + \" \" + s.item_clsd).addClass(s.item_leaf || \"jstree-no-icon\");\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"select_node.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tdata.rslt.obj.children(\"a\").addClass(s.item_a);\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"deselect_node.jstree deselect_all.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tthis.get_container()\r\n\t\t\t\t\t\t\t.find(\"a.\" + s.item_a).removeClass(s.item_a).end()\r\n\t\t\t\t\t\t\t.find(\"a.jstree-clicked\").addClass(s.item_a);\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"dehover_node.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tdata.rslt.obj.children(\"a\").removeClass(s.item_h);\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"hover_node.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tthis.get_container()\r\n\t\t\t\t\t\t\t.find(\"a.\" + s.item_h).not(data.rslt.obj).removeClass(s.item_h);\r\n\t\t\t\t\t\tdata.rslt.obj.children(\"a\").addClass(s.item_h);\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"move_node.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tthis._themeroller(data.rslt.o);\r\n\t\t\t\t\t\tthis._themeroller(data.rslt.op);\r\n\t\t\t\t\t}, this));\r\n\t\t},\r\n\t\t__destroy : function () {\r\n\t\t\tvar s = this._get_settings().themeroller,\r\n\t\t\t\tc = [ \"ui-icon\" ];\r\n\t\t\t$.each(s, function (i, v) {\r\n\t\t\t\tv = v.split(\" \");\r\n\t\t\t\tif(v.length) { c = c.concat(v); }\r\n\t\t\t});\r\n\t\t\tthis.get_container()\r\n\t\t\t\t.removeClass(\"ui-widget-content\")\r\n\t\t\t\t.find(\".\" + c.join(\", .\")).removeClass(c.join(\" \"));\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\t_themeroller : function (obj) {\r\n\t\t\t\tvar s = this._get_settings().themeroller;\r\n\t\t\t\tobj = !obj || obj == -1 ? this.get_container_ul() : this._get_node(obj).parent();\r\n\t\t\t\tobj\r\n\t\t\t\t\t.find(\"li.jstree-closed\")\r\n\t\t\t\t\t\t.children(\"ins.jstree-icon\").removeClass(s.opened).addClass(\"ui-icon \" + s.closed).end()\r\n\t\t\t\t\t\t.children(\"a\").addClass(s.item)\r\n\t\t\t\t\t\t\t.children(\"ins.jstree-icon\").addClass(\"ui-icon\")\r\n\t\t\t\t\t\t\t\t.filter(function() {\r\n\t\t\t\t\t\t\t\t\treturn this.className.toString()\r\n\t\t\t\t\t\t\t\t\t\t.replace(s.item_clsd,\"\").replace(s.item_open,\"\").replace(s.item_leaf,\"\")\r\n\t\t\t\t\t\t\t\t\t\t.indexOf(\"ui-icon-\") === -1;\r\n\t\t\t\t\t\t\t\t}).removeClass(s.item_leaf + \" \" + s.item_open).addClass(s.item_clsd || \"jstree-no-icon\")\r\n\t\t\t\t\t\t\t\t.end()\r\n\t\t\t\t\t\t\t.end()\r\n\t\t\t\t\t\t.end()\r\n\t\t\t\t\t.end()\r\n\t\t\t\t\t.find(\"li.jstree-open\")\r\n\t\t\t\t\t\t.children(\"ins.jstree-icon\").removeClass(s.closed).addClass(\"ui-icon \" + s.opened).end()\r\n\t\t\t\t\t\t.children(\"a\").addClass(s.item)\r\n\t\t\t\t\t\t\t.children(\"ins.jstree-icon\").addClass(\"ui-icon\")\r\n\t\t\t\t\t\t\t\t.filter(function() {\r\n\t\t\t\t\t\t\t\t\treturn this.className.toString()\r\n\t\t\t\t\t\t\t\t\t\t.replace(s.item_clsd,\"\").replace(s.item_open,\"\").replace(s.item_leaf,\"\")\r\n\t\t\t\t\t\t\t\t\t\t.indexOf(\"ui-icon-\") === -1;\r\n\t\t\t\t\t\t\t\t}).removeClass(s.item_leaf + \" \" + s.item_clsd).addClass(s.item_open || \"jstree-no-icon\")\r\n\t\t\t\t\t\t\t\t.end()\r\n\t\t\t\t\t\t\t.end()\r\n\t\t\t\t\t\t.end()\r\n\t\t\t\t\t.end()\r\n\t\t\t\t\t.find(\"li.jstree-leaf\")\r\n\t\t\t\t\t\t.children(\"ins.jstree-icon\").removeClass(s.closed + \" ui-icon \" + s.opened).end()\r\n\t\t\t\t\t\t.children(\"a\").addClass(s.item)\r\n\t\t\t\t\t\t\t.children(\"ins.jstree-icon\").addClass(\"ui-icon\")\r\n\t\t\t\t\t\t\t\t.filter(function() {\r\n\t\t\t\t\t\t\t\t\treturn this.className.toString()\r\n\t\t\t\t\t\t\t\t\t\t.replace(s.item_clsd,\"\").replace(s.item_open,\"\").replace(s.item_leaf,\"\")\r\n\t\t\t\t\t\t\t\t\t\t.indexOf(\"ui-icon-\") === -1;\r\n\t\t\t\t\t\t\t\t}).removeClass(s.item_clsd + \" \" + s.item_open).addClass(s.item_leaf || \"jstree-no-icon\");\r\n\t\t\t}\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\t\"opened\"\t: \"ui-icon-triangle-1-se\",\r\n\t\t\t\"closed\"\t: \"ui-icon-triangle-1-e\",\r\n\t\t\t\"item\"\t\t: \"ui-state-default\",\r\n\t\t\t\"item_h\"\t: \"ui-state-hover\",\r\n\t\t\t\"item_a\"\t: \"ui-state-active\",\r\n\t\t\t\"item_open\"\t: \"ui-icon-folder-open\",\r\n\t\t\t\"item_clsd\"\t: \"ui-icon-folder-collapsed\",\r\n\t\t\t\"item_leaf\"\t: \"ui-icon-document\"\r\n\t\t}\r\n\t});\r\n\t$(function() {\r\n\t\tvar css_string = '' +\r\n\t\t\t'.jstree-themeroller .ui-icon { overflow:visible; } ' +\r\n\t\t\t'.jstree-themeroller a { padding:0 2px; } ' +\r\n\t\t\t'.jstree-themeroller .jstree-no-icon { display:none; }';\r\n\t\t$.vakata.css.add_sheet({ str : css_string, title : \"jstree\" });\r\n\t});\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree unique plugin\r\n * Forces different names amongst siblings (still a bit experimental)\r\n * NOTE: does not check language versions (it will not be possible to have nodes with the same title, even in different languages)\r\n */\r\n(function ($) {\r\n\t$.jstree.plugin(\"unique\", {\r\n\t\t__init : function () {\r\n\t\t\tthis.get_container()\r\n\t\t\t\t.bind(\"before.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tvar nms = [], res = true, p, t;\r\n\t\t\t\t\t\tif(data.func == \"move_node\") {\r\n\t\t\t\t\t\t\t// obj, ref, position, is_copy, is_prepared, skip_check\r\n\t\t\t\t\t\t\tif(data.args[4] === true) {\r\n\t\t\t\t\t\t\t\tif(data.args[0].o && data.args[0].o.length) {\r\n\t\t\t\t\t\t\t\t\tdata.args[0].o.children(\"a\").each(function () { nms.push($(this).text().replace(/^\\s+/g,\"\")); });\r\n\t\t\t\t\t\t\t\t\tres = this._check_unique(nms, data.args[0].np.find(\"> ul > li\").not(data.args[0].o), \"move_node\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(data.func == \"create_node\") {\r\n\t\t\t\t\t\t\t// obj, position, js, callback, is_loaded\r\n\t\t\t\t\t\t\tif(data.args[4] || this._is_loaded(data.args[0])) {\r\n\t\t\t\t\t\t\t\tp = this._get_node(data.args[0]);\r\n\t\t\t\t\t\t\t\tif(data.args[1] && (data.args[1] === \"before\" || data.args[1] === \"after\")) {\r\n\t\t\t\t\t\t\t\t\tp = this._get_parent(data.args[0]);\r\n\t\t\t\t\t\t\t\t\tif(!p || p === -1) { p = this.get_container(); }\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(typeof data.args[2] === \"string\") { nms.push(data.args[2]); }\r\n\t\t\t\t\t\t\t\telse if(!data.args[2] || !data.args[2].data) { nms.push(this._get_string(\"new_node\")); }\r\n\t\t\t\t\t\t\t\telse { nms.push(data.args[2].data); }\r\n\t\t\t\t\t\t\t\tres = this._check_unique(nms, p.find(\"> ul > li\"), \"create_node\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(data.func == \"rename_node\") {\r\n\t\t\t\t\t\t\t// obj, val\r\n\t\t\t\t\t\t\tnms.push(data.args[1]);\r\n\t\t\t\t\t\t\tt = this._get_node(data.args[0]);\r\n\t\t\t\t\t\t\tp = this._get_parent(t);\r\n\t\t\t\t\t\t\tif(!p || p === -1) { p = this.get_container(); }\r\n\t\t\t\t\t\t\tres = this._check_unique(nms, p.find(\"> ul > li\").not(t), \"rename_node\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!res) {\r\n\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this));\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\terror_callback : $.noop\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\t_check_unique : function (nms, p, func) {\r\n\t\t\t\tvar cnms = [];\r\n\t\t\t\tp.children(\"a\").each(function () { cnms.push($(this).text().replace(/^\\s+/g,\"\")); });\r\n\t\t\t\tif(!cnms.length || !nms.length) { return true; }\r\n\t\t\t\tcnms = cnms.sort().join(\",,\").replace(/(,|^)([^,]+)(,,\\2)+(,|$)/g,\"$1$2$4\").replace(/,,+/g,\",\").replace(/,$/,\"\").split(\",\");\r\n\t\t\t\tif((cnms.length + nms.length) != cnms.concat(nms).sort().join(\",,\").replace(/(,|^)([^,]+)(,,\\2)+(,|$)/g,\"$1$2$4\").replace(/,,+/g,\",\").replace(/,$/,\"\").split(\",\").length) {\r\n\t\t\t\t\tthis._get_settings().unique.error_callback.call(null, nms, p, func);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\t\t\tcheck_move : function () {\r\n\t\t\t\tif(!this.__call_old()) { return false; }\r\n\t\t\t\tvar p = this._get_move(), nms = [];\r\n\t\t\t\tif(p.o && p.o.length) {\r\n\t\t\t\t\tp.o.children(\"a\").each(function () { nms.push($(this).text().replace(/^\\s+/g,\"\")); });\r\n\t\t\t\t\treturn this._check_unique(nms, p.np.find(\"> ul > li\").not(p.o), \"check_move\");\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n * jsTree wholerow plugin\r\n * Makes select and hover work on the entire width of the node\r\n * MAY BE HEAVY IN LARGE DOM\r\n */\r\n(function ($) {\r\n\t$.jstree.plugin(\"wholerow\", {\r\n\t\t__init : function () {\r\n\t\t\tif(!this.data.ui) { throw \"jsTree wholerow: jsTree UI plugin not included.\"; }\r\n\t\t\tthis.data.wholerow.html = false;\r\n\t\t\tthis.data.wholerow.to = false;\r\n\t\t\tthis.get_container()\r\n\t\t\t\t.bind(\"init.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tthis._get_settings().core.animation = 0;\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"open_node.jstree create_node.jstree clean_node.jstree loaded.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tthis._prepare_wholerow_span( data && data.rslt && data.rslt.obj ? data.rslt.obj : -1 );\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tif(this.data.to) { clearTimeout(this.data.to); }\r\n\t\t\t\t\t\tthis.data.to = setTimeout( (function (t, o) { return function() { t._prepare_wholerow_ul(o); }; })(this,  data && data.rslt && data.rslt.obj ? data.rslt.obj : -1), 0);\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"deselect_all.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tthis.get_container().find(\" > .jstree-wholerow .jstree-clicked\").removeClass(\"jstree-clicked \" + (this.data.themeroller ? this._get_settings().themeroller.item_a : \"\" ));\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"select_node.jstree deselect_node.jstree \", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tdata.rslt.obj.each(function () {\r\n\t\t\t\t\t\t\tvar ref = data.inst.get_container().find(\" > .jstree-wholerow li:visible:eq(\" + ( parseInt((($(this).offset().top - data.inst.get_container().offset().top + data.inst.get_container()[0].scrollTop) / data.inst.data.core.li_height),10)) + \")\");\r\n\t\t\t\t\t\t\t// ref.children(\"a\")[e.type === \"select_node\" ? \"addClass\" : \"removeClass\"](\"jstree-clicked\");\r\n\t\t\t\t\t\t\tref.children(\"a\").attr(\"class\",data.rslt.obj.children(\"a\").attr(\"class\"));\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.bind(\"hover_node.jstree dehover_node.jstree\", $.proxy(function (e, data) {\r\n\t\t\t\t\t\tthis.get_container().find(\" > .jstree-wholerow .jstree-hovered\").removeClass(\"jstree-hovered \" + (this.data.themeroller ? this._get_settings().themeroller.item_h : \"\" ));\r\n\t\t\t\t\t\tif(e.type === \"hover_node\") {\r\n\t\t\t\t\t\t\tvar ref = this.get_container().find(\" > .jstree-wholerow li:visible:eq(\" + ( parseInt(((data.rslt.obj.offset().top - this.get_container().offset().top + this.get_container()[0].scrollTop) / this.data.core.li_height),10)) + \")\");\r\n\t\t\t\t\t\t\t// ref.children(\"a\").addClass(\"jstree-hovered\");\r\n\t\t\t\t\t\t\tref.children(\"a\").attr(\"class\",data.rslt.obj.children(\".jstree-hovered\").attr(\"class\"));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.delegate(\".jstree-wholerow-span, ins.jstree-icon, li\", \"click.jstree\", function (e) {\r\n\t\t\t\t\t\tvar n = $(e.currentTarget);\r\n\t\t\t\t\t\tif(e.target.tagName === \"A\" || (e.target.tagName === \"INS\" && n.closest(\"li\").is(\".jstree-open, .jstree-closed\"))) { return; }\r\n\t\t\t\t\t\tn.closest(\"li\").children(\"a:visible:eq(0)\").click();\r\n\t\t\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\t\t})\r\n\t\t\t\t.delegate(\"li\", \"mouseover.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\t\t\tif($(e.currentTarget).children(\".jstree-hovered, .jstree-clicked\").length) { return false; }\r\n\t\t\t\t\t\tthis.hover_node(e.currentTarget);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.delegate(\"li\", \"mouseleave.jstree\", $.proxy(function (e) {\r\n\t\t\t\t\t\tif($(e.currentTarget).children(\"a\").hasClass(\"jstree-hovered\").length) { return; }\r\n\t\t\t\t\t\tthis.dehover_node(e.currentTarget);\r\n\t\t\t\t\t}, this));\r\n\t\t\tif(is_ie7 || is_ie6) {\r\n\t\t\t\t$.vakata.css.add_sheet({ str : \".jstree-\" + this.get_index() + \" { position:relative; } \", title : \"jstree\" });\r\n\t\t\t}\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t},\r\n\t\t__destroy : function () {\r\n\t\t\tthis.get_container().children(\".jstree-wholerow\").remove();\r\n\t\t\tthis.get_container().find(\".jstree-wholerow-span\").remove();\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\t_prepare_wholerow_span : function (obj) {\r\n\t\t\t\tobj = !obj || obj == -1 ? this.get_container().find(\"> ul > li\") : this._get_node(obj);\r\n\t\t\t\tif(obj === false) { return; } // added for removing root nodes\r\n\t\t\t\tobj.each(function () {\r\n\t\t\t\t\t$(this).find(\"li\").addBack().each(function () {\r\n\t\t\t\t\t\tvar $t = $(this);\r\n\t\t\t\t\t\tif($t.children(\".jstree-wholerow-span\").length) { return true; }\r\n\t\t\t\t\t\t$t.prepend(\"<span class='jstree-wholerow-span' style='width:\" + ($t.parentsUntil(\".jstree\",\"li\").length * 18) + \"px;'>&#160;</span>\");\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t_prepare_wholerow_ul : function () {\r\n\t\t\t\tvar o = this.get_container().children(\"ul\").eq(0), h = o.html();\r\n\t\t\t\to.addClass(\"jstree-wholerow-real\");\r\n\t\t\t\tif(this.data.wholerow.last_html !== h) {\r\n\t\t\t\t\tthis.data.wholerow.last_html = h;\r\n\t\t\t\t\tthis.get_container().children(\".jstree-wholerow\").remove();\r\n\t\t\t\t\tthis.get_container().append(\r\n\t\t\t\t\t\to.clone().removeClass(\"jstree-wholerow-real\")\r\n\t\t\t\t\t\t\t.wrapAll(\"<div class='jstree-wholerow' />\").parent()\r\n\t\t\t\t\t\t\t.width(o.parent()[0].scrollWidth)\r\n\t\t\t\t\t\t\t.css(\"top\", (o.height() + ( is_ie7 ? 5 : 0)) * -1 )\r\n\t\t\t\t\t\t\t.find(\"li[id]\").each(function () { this.removeAttribute(\"id\"); }).end()\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\t$(function() {\r\n\t\tvar css_string = '' +\r\n\t\t\t'.jstree .jstree-wholerow-real { position:relative; z-index:1; } ' +\r\n\t\t\t'.jstree .jstree-wholerow-real li { cursor:pointer; } ' +\r\n\t\t\t'.jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } ' +\r\n\t\t\t'.jstree .jstree-wholerow { position:relative; z-index:0; height:0; } ' +\r\n\t\t\t'.jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } ' +\r\n\t\t\t'.jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } ' +\r\n\t\t\t'.jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }' +\r\n\t\t\t'.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }' +\r\n\t\t\t'.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } ' +\r\n\t\t\t'.jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }';\r\n\t\tif(is_ff2) {\r\n\t\t\tcss_string += '' +\r\n\t\t\t\t'.jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } ' +\r\n\t\t\t\t'.jstree .jstree-wholerow-real a { border-color:transparent !important; } ';\r\n\t\t}\r\n\t\tif(is_ie7 || is_ie6) {\r\n\t\t\tcss_string += '' +\r\n\t\t\t\t'.jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } ' +\r\n\t\t\t\t'.jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } ';\r\n\t\t}\r\n\t\t$.vakata.css.add_sheet({ str : css_string, title : \"jstree\" });\r\n\t});\r\n})(jQuery);\r\n//*/\r\n\r\n/*\r\n* jsTree model plugin\r\n* This plugin gets jstree to use a class model to retrieve data, creating great dynamism\r\n*/\r\n(function ($) {\r\n\tvar nodeInterface = [\"getChildren\",\"getChildrenCount\",\"getAttr\",\"getName\",\"getProps\"],\r\n\t\tvalidateInterface = function(obj, inter) {\r\n\t\t\tvar valid = true;\r\n\t\t\tobj = obj || {};\r\n\t\t\tinter = [].concat(inter);\r\n\t\t\t$.each(inter, function (i, v) {\r\n\t\t\t\tif(!$.isFunction(obj[v])) { valid = false; return false; }\r\n\t\t\t});\r\n\t\t\treturn valid;\r\n\t\t};\r\n\t$.jstree.plugin(\"model\", {\r\n\t\t__init : function () {\r\n\t\t\tif(!this.data.json_data) { throw \"jsTree model: jsTree json_data plugin not included.\"; }\r\n\t\t\tthis._get_settings().json_data.data = function (n, b) {\r\n\t\t\t\tvar obj = (n == -1) ? this._get_settings().model.object : n.data(\"jstree_model\");\r\n\t\t\t\tif(!validateInterface(obj, nodeInterface)) { return b.call(null, false); }\r\n\t\t\t\tif(this._get_settings().model.async) {\r\n\t\t\t\t\tobj.getChildren($.proxy(function (data) {\r\n\t\t\t\t\t\tthis.model_done(data, b);\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.model_done(obj.getChildren(), b);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tdefaults : {\r\n\t\t\tobject : false,\r\n\t\t\tid_prefix : false,\r\n\t\t\tasync : false\r\n\t\t},\r\n\t\t_fn : {\r\n\t\t\tmodel_done : function (data, callback) {\r\n\t\t\t\tvar ret = [],\r\n\t\t\t\t\ts = this._get_settings(),\r\n\t\t\t\t\t_this = this;\r\n\r\n\t\t\t\tif(!$.isArray(data)) { data = [data]; }\r\n\t\t\t\t$.each(data, function (i, nd) {\r\n\t\t\t\t\tvar r = nd.getProps() || {};\r\n\t\t\t\t\tr.attr = nd.getAttr() || {};\r\n\t\t\t\t\tif(nd.getChildrenCount()) { r.state = \"closed\"; }\r\n\t\t\t\t\tr.data = nd.getName();\r\n\t\t\t\t\tif(!$.isArray(r.data)) { r.data = [r.data]; }\r\n\t\t\t\t\tif(_this.data.types && $.isFunction(nd.getType)) {\r\n\t\t\t\t\t\tr.attr[s.types.type_attr] = nd.getType();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(r.attr.id && s.model.id_prefix) { r.attr.id = s.model.id_prefix + r.attr.id; }\r\n\t\t\t\t\tif(!r.metadata) { r.metadata = { }; }\r\n\t\t\t\t\tr.metadata.jstree_model = nd;\r\n\t\t\t\t\tret.push(r);\r\n\t\t\t\t});\r\n\t\t\t\tcallback.call(null, ret);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n})(jQuery);\r\n//*/\r\n\r\n\r\n/*\r\n * jsTree checkbox plugin copy-paste\r\n * change_state method was modified\r\n * refactoring is needed after update to a newer version of jstree, that supports plugin extending\r\n */\r\n(function ($) {\r\n    $.jstree.plugin(\"vcheckbox\", {\r\n        __init : function () {\r\n            this.data.vcheckbox.noui = this._get_settings().vcheckbox.override_ui;\r\n            if(this.data.ui && this.data.vcheckbox.noui) {\r\n                this.select_node = this.deselect_node = this.deselect_all = $.noop;\r\n                this.get_selected = this.get_checked;\r\n            }\r\n\r\n            this.get_container()\r\n                .bind(\"open_node.jstree create_node.jstree clean_node.jstree refresh.jstree\", $.proxy(function (e, data) {\r\n                    this._prepare_checkboxes(data.rslt.obj);\r\n                }, this))\r\n                .bind(\"loaded.jstree\", $.proxy(function (e) {\r\n                    this._prepare_checkboxes();\r\n                }, this))\r\n                .delegate( (this.data.ui && this.data.vcheckbox.noui ? \"a\" : \"ins.jstree-checkbox\") , \"click.jstree\", $.proxy(function (e) {\r\n                    e.preventDefault();\r\n                    if(this._get_node(e.target).hasClass(\"jstree-checked\")) { this.uncheck_node(e.target); }\r\n                    else { this.check_node(e.target); }\r\n                    if(this.data.ui && this.data.vcheckbox.noui) {\r\n                        this.save_selected();\r\n                        if(this.data.cookies) { this.save_cookie(\"select_node\"); }\r\n                    }\r\n                    else {\r\n                        e.stopImmediatePropagation();\r\n                        return false;\r\n                    }\r\n                }, this));\r\n        },\r\n        defaults : {\r\n            override_ui : false,\r\n            two_state : false,\r\n            real_checkboxes : false,\r\n            checked_parent_open : true,\r\n            real_checkboxes_names : function (n) { return [ (\"check_\" + (n[0].id || Math.ceil(Math.random() * 10000))) , 1]; }\r\n        },\r\n        __destroy : function () {\r\n            this.get_container()\r\n                .find(\"input.jstree-real-checkbox\").removeClass(\"jstree-real-checkbox\").end()\r\n                .find(\"ins.jstree-checkbox\").remove();\r\n        },\r\n        _fn : {\r\n            _checkbox_notify : function (n, data) {\r\n                if(data.checked) {\r\n                    this.check_node(n, false);\r\n                }\r\n            },\r\n            _prepare_checkboxes : function (obj) {\r\n                obj = !obj || obj == -1 ? this.get_container().find(\"> ul > li\") : this._get_node(obj);\r\n                if(obj === false) { return; } // added for removing root nodes\r\n                var c, _this = this, t, ts = this._get_settings().vcheckbox.two_state, rc = this._get_settings().vcheckbox.real_checkboxes, rcn = this._get_settings().vcheckbox.real_checkboxes_names;\r\n                obj.each(function () {\r\n                    t = $(this);\r\n                    c = t.is(\"li\") && (t.hasClass(\"jstree-checked\") || (rc && t.children(\":checked\").length)) ? \"jstree-checked\" : \"jstree-unchecked\";\r\n                    t.find(\"li\").addBack().each(function () {\r\n                        var $t = $(this), nm;\r\n                        $t.children(\"a\" + (_this.data.languages ? \"\" : \":eq(0)\") ).not(\":has(.jstree-checkbox)\").prepend(\"<ins class='jstree-checkbox'>&#160;</ins>\").parent().not(\".jstree-checked, .jstree-unchecked\").addClass( ts ? \"jstree-unchecked\" : c );\r\n                        if(rc) {\r\n                            if(!$t.children(\":checkbox\").length) {\r\n                                nm = rcn.call(_this, $t);\r\n                                $t.prepend(\"<input type='checkbox' class='jstree-real-checkbox' id='\" + nm[0] + \"' name='\" + nm[0] + \"' value='\" + nm[1] + \"' />\");\r\n                            }\r\n                            else {\r\n                                $t.children(\":checkbox\").addClass(\"jstree-real-checkbox\");\r\n                            }\r\n                        }\r\n                        if(!ts) {\r\n                            if(c === \"jstree-checked\" || $t.hasClass(\"jstree-checked\") || $t.children(':checked').length) {\r\n                                $t.find(\"li\").addBack().addClass(\"jstree-checked\").children(\":checkbox\").prop(\"checked\", true);\r\n                            }\r\n                        }\r\n                        else {\r\n                            if($t.hasClass(\"jstree-checked\") || $t.children(':checked').length) {\r\n                                $t.addClass(\"jstree-checked\").children(\":checkbox\").prop(\"checked\", true);\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n                if(!ts) {\r\n                    obj.find(\".jstree-checked\").parent().parent().each(function () { _this._repair_state(this); });\r\n                }\r\n            },\r\n            change_state : function (obj, state) {\r\n                obj = this._get_node(obj);\r\n                var coll = false, rc = this._get_settings().vcheckbox.real_checkboxes;\r\n                if(!obj || obj === -1) { return false; }\r\n                state = (state === false || state === true) ? state : obj.hasClass(\"jstree-checked\");\r\n                if(this._get_settings().vcheckbox.two_state) {\r\n                    if(state) {\r\n                        coll = obj.find(\"li\").addBack();\r\n                        if(!coll.filter(\".jstree-checked\").length) { return false; }\r\n                        coll.removeClass(\"jstree-checked\").addClass(\"jstree-unchecked\");\r\n                        if(rc) { coll.children(\":checkbox\").prop(\"checked\", false); }\r\n                    }\r\n                    else {\r\n                        coll = obj.find(\"li\").addBack();\r\n                        if(!coll.filter(\".jstree-unchecked\").length) { return false; }\r\n                        coll.removeClass(\"jstree-unchecked\").addClass(\"jstree-checked\");\r\n                        if(rc) { coll.children(\":checkbox\").prop(\"checked\", true); }\r\n                        if(this.data.ui) { this.data.ui.last_selected = obj; }\r\n                        this.data.vcheckbox.last_selected = obj;\r\n                    }\r\n                    obj.parentsUntil(\".jstree\", \"li\").each(function () {\r\n                        var $this = $(this);\r\n                        if(state) {\r\n                            if($this.children(\"ul\").children(\"li.jstree-checked\").length) {\r\n                                $this.parentsUntil(\".jstree\", \"li\").addBack().removeClass(\"jstree-unchecked\").addClass(\"jstree-checked\");\r\n                                if(rc) { $this.parentsUntil(\".jstree\", \"li\").addBack().children(\":checkbox\").prop(\"checked\", true); }\r\n                                return false;\r\n                            }\r\n                        }\r\n                        else {\r\n                            if($this.children(\"ul\").children(\"li.jstree-unchecked\").length) {\r\n                                $this.parentsUntil(\".jstree\", \"li\").addBack().removeClass(\"jstree-unchecked\").addClass(\"jstree-checked\");\r\n                                if(rc) { $this.parentsUntil(\".jstree\", \"li\").addBack().children(\":checkbox\").prop(\"checked\", true); }\r\n                                return false;\r\n                            }\r\n                            else {\r\n                                $this.removeClass(\"jstree-unchecked\").addClass(\"jstree-checked\");\r\n                                if(rc) { $this.children(\":checkbox\").prop(\"checked\", true); }\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    if(state) {\r\n                        coll = obj.find(\"li\").addBack();\r\n                        if(!coll.filter(\".jstree-checked, .jstree-undetermined\").length) { return false; }\r\n                        coll.removeClass(\"jstree-checked jstree-undetermined\").addClass(\"jstree-unchecked\");\r\n                        if(rc) { coll.children(\":checkbox\").prop(\"checked\", false); }\r\n                    }\r\n                    else {\r\n                        coll = obj.find(\"li\").addBack();\r\n                        if(!coll.filter(\".jstree-unchecked, .jstree-undetermined\").length) { return false; }\r\n                        coll.removeClass(\"jstree-unchecked jstree-undetermined\").addClass(\"jstree-checked\");\r\n                        if(rc) { coll.children(\":checkbox\").prop(\"checked\", true); }\r\n                        if(this.data.ui) { this.data.ui.last_selected = obj; }\r\n                        this.data.vcheckbox.last_selected = obj;\r\n                    }\r\n                    obj.parentsUntil(\".jstree\", \"li\").each(function () {\r\n                        var $this = $(this);\r\n                        if(state) {\r\n                            if($this.children(\"ul\").children(\"li.jstree-checked, li.jstree-undetermined\").length) {\r\n                                $this.parentsUntil(\".jstree\", \"li\").addBack().removeClass(\"jstree-checked jstree-unchecked\").addClass(\"jstree-undetermined\");\r\n                                if(rc) { $this.parentsUntil(\".jstree\", \"li\").addBack().children(\":checkbox\").prop(\"checked\", false); }\r\n                                return false;\r\n                            }\r\n                            else {\r\n                                $this.removeClass(\"jstree-checked jstree-undetermined\").addClass(\"jstree-unchecked\");\r\n                                if(rc) { $this.children(\":checkbox\").prop(\"checked\", false); }\r\n                            }\r\n                        }\r\n                        else {\r\n                            if($this.children(\"ul\").children(\"li.jstree-unchecked, li.jstree-undetermined\").length) {\r\n                                $this.parentsUntil(\".jstree\", \"li\").addBack().removeClass(\"jstree-checked jstree-unchecked\").addClass(\"jstree-undetermined\");\r\n                                if(rc) { $this.parentsUntil(\".jstree\", \"li\").addBack().children(\":checkbox\").prop(\"checked\", false); }\r\n                                return false;\r\n                            }\r\n                            else {\r\n                                $this.removeClass(\"jstree-unchecked jstree-undetermined\").addClass(\"jstree-checked\");\r\n                                if(rc) { $this.children(\":checkbox\").prop(\"checked\", true); }\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n                if(this.data.ui && this.data.vcheckbox.noui) { this.data.ui.selected = this.get_checked(); }\r\n                this.__callback(obj);\r\n                return true;\r\n            },\r\n            check_node : function (obj) {\r\n                if(this.change_state(obj, false)) {\r\n                    obj = this._get_node(obj);\r\n                    if(this._get_settings().vcheckbox.checked_parent_open) {\r\n                        var t = this;\r\n                        obj.parents(\".jstree-closed\").each(function () { t.open_node(this, false, true); });\r\n                    }\r\n                    this.__callback({ \"obj\" : obj });\r\n                }\r\n            },\r\n            uncheck_node : function (obj) {\r\n                if(this.change_state(obj, true)) { this.__callback({ \"obj\" : this._get_node(obj) }); }\r\n            },\r\n            check_all : function () {\r\n                var _this = this,\r\n                    coll = this._get_settings().vcheckbox.two_state ? this.get_container_ul().find(\"li\") : this.get_container_ul().children(\"li\");\r\n                coll.each(function () {\r\n                    _this.change_state(this, false);\r\n                });\r\n                this.__callback();\r\n            },\r\n            uncheck_all : function () {\r\n                var _this = this,\r\n                    coll = this._get_settings().vcheckbox.two_state ? this.get_container_ul().find(\"li\") : this.get_container_ul().children(\"li\");\r\n                coll.each(function () {\r\n                    _this.change_state(this, true);\r\n                });\r\n                this.__callback();\r\n            },\r\n\r\n            is_checked : function(obj) {\r\n                obj = this._get_node(obj);\r\n                return obj.length ? obj.is(\".jstree-checked\") : false;\r\n            },\r\n            get_checked : function (obj, get_all) {\r\n                obj = !obj || obj === -1 ? this.get_container() : this._get_node(obj);\r\n                return get_all || this._get_settings().vcheckbox.two_state ? obj.find(\".jstree-checked\") : obj.find(\"> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked\");\r\n            },\r\n            get_unchecked : function (obj, get_all) {\r\n                obj = !obj || obj === -1 ? this.get_container() : this._get_node(obj);\r\n                return get_all || this._get_settings().vcheckbox.two_state ? obj.find(\".jstree-unchecked\") : obj.find(\"> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked\");\r\n            },\r\n\r\n            show_checkboxes : function () { this.get_container().children(\"ul\").removeClass(\"jstree-no-checkboxes\"); },\r\n            hide_checkboxes : function () { this.get_container().children(\"ul\").addClass(\"jstree-no-checkboxes\"); },\r\n\r\n            _repair_state : function (obj) {\r\n                obj = this._get_node(obj);\r\n                if(!obj.length) { return; }\r\n                if(this._get_settings().vcheckbox.two_state) {\r\n                    obj.find('li').addBack().not('.jstree-checked').removeClass('jstree-undetermined').addClass('jstree-unchecked').children(':checkbox').prop('checked', true);\r\n                    return;\r\n                }\r\n                var rc = this._get_settings().vcheckbox.real_checkboxes,\r\n                    a = obj.find(\"> ul > .jstree-checked\").length,\r\n                    b = obj.find(\"> ul > .jstree-undetermined\").length,\r\n                    c = obj.find(\"> ul > li\").length;\r\n                if(c === 0) { if(obj.hasClass(\"jstree-undetermined\")) { this.change_state(obj, false); } }\r\n                else if(a === 0 && b === 0) { this.change_state(obj, true); }\r\n                else if(a === c) { this.change_state(obj, false); }\r\n                else {\r\n                    obj.parentsUntil(\".jstree\",\"li\").addBack().removeClass(\"jstree-checked jstree-unchecked\").addClass(\"jstree-undetermined\");\r\n                    if(rc) { obj.parentsUntil(\".jstree\", \"li\").addBack().children(\":checkbox\").prop(\"checked\", false); }\r\n                }\r\n            },\r\n            reselect : function () {\r\n                if(this.data.ui && this.data.vcheckbox.noui) {\r\n                    var _this = this,\r\n                        s = this.data.ui.to_select;\r\n                    s = $.map($.makeArray(s), function (n) { return \"#\" + n.toString().replace(/^#/,\"\").replace(/\\\\\\//g,\"/\").replace(/\\//g,\"\\\\\\/\").replace(/\\\\\\./g,\".\").replace(/\\./g,\"\\\\.\").replace(/\\:/g,\"\\\\:\"); });\r\n                    this.deselect_all();\r\n                    $.each(s, function (i, val) { _this.check_node(val); });\r\n                    this.__callback();\r\n                }\r\n                else {\r\n                    this.__call_old();\r\n                }\r\n            },\r\n            save_loaded : function () {\r\n                var _this = this;\r\n                this.data.core.to_load = [];\r\n                this.get_container_ul().find(\"li.jstree-closed.jstree-undetermined\").each(function () {\r\n                    if(this.id) { _this.data.core.to_load.push(\"#\" + this.id); }\r\n                });\r\n            }\r\n        }\r\n    });\r\n    $(function() {\r\n        var css_string = '.jstree .jstree-real-checkbox { display:none; } ';\r\n        $.vakata.css.add_sheet({ str : css_string, title : \"jstree\" });\r\n    });\r\n})(jQuery);\r\n\r\n\r\n})();\r\n\r\n}));","jquery/patches/jquery-ui.js":"/**\r\n * Copyright \u00a9 Magento, Inc. All rights reserved.\r\n * See COPYING.txt for license details.\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/widget'\r\n    // 'jquery-ui-modules/dialog' - do not enable this dependency because this is already a mixin for the dialog ui component\r\n], function ($) {\r\n    'use strict';\r\n\r\n    /**\r\n     * Patch for CVE-2016-7103 (XSS vulnerability).\r\n     * Can safely remove only when jQuery UI is upgraded to >= 1.12.x.\r\n     * https://www.cvedetails.com/cve/CVE-2016-7103/\r\n     */\r\n    function dialogPatch() {\r\n        $.widget('ui.dialog', $.ui.dialog, {\r\n            /** @inheritdoc */\r\n            _createTitlebar: function () {\r\n                this.options.closeText = $('<a>').text('' + this.options.closeText).html();\r\n\r\n                this._superApply();\r\n            },\r\n\r\n            /** @inheritdoc */\r\n            _setOption: function (key, value) {\r\n                if (key === 'closeText') {\r\n                    value = $('<a>').text('' + value).html();\r\n                }\r\n\r\n                this._super(key, value);\r\n            }\r\n        });\r\n    }\r\n\r\n    return function () {\r\n        var majorVersion = $.ui.version.split('.')[0],\r\n            minorVersion = $.ui.version.split('.')[1];\r\n\r\n        if (majorVersion === 1 && minorVersion >= 12 || majorVersion >= 2) {\r\n            console.warn('jQuery patch for CVE-2016-7103 is no longer necessary, and should be removed');\r\n        }\r\n\r\n        dialogPatch();\r\n    };\r\n});\r\n","jquery/patches/jquery.js":"/**\r\n * Copyright \u00a9 Magento, Inc. All rights reserved.\r\n * See COPYING.txt for license details.\r\n */\r\n\r\ndefine([], function () {\r\n    'use strict';\r\n\r\n    /**\r\n     * Patch for CVE-2015-9251 (XSS vulnerability).\r\n     * Can safely remove only when jQuery UI is upgraded to >= 3.3.x.\r\n     * https://www.cvedetails.com/cve/CVE-2015-9251/\r\n     */\r\n    function ajaxResponsePatch(jQuery) {\r\n        jQuery.ajaxPrefilter(function (s) {\r\n            if (s.crossDomain) {\r\n                s.contents.script = false;\r\n            }\r\n        });\r\n    }\r\n\r\n    return function ($) {\r\n        var majorVersion = $.fn.jquery.split('.')[0];\r\n\r\n        if (majorVersion >= 3) {\r\n            console.warn('jQuery patch for CVE-2015-9251 is no longer necessary, and should be removed');\r\n        }\r\n\r\n        ajaxResponsePatch($);\r\n\r\n        return $;\r\n    };\r\n});\r\n","jquery/spectrum/spectrum.js":"// Spectrum Colorpicker v1.8.0\r\n// https://github.com/bgrins/spectrum\r\n// Author: Brian Grinstead\r\n// License: MIT\r\n\r\n(function (factory) {\r\n    \"use strict\";\r\n\r\n    if (typeof define === 'function' && define.amd) { // AMD\r\n        define(['jquery'], factory);\r\n    }\r\n    else if (typeof exports == \"object\" && typeof module == \"object\") { // CommonJS\r\n        module.exports = factory(require('jquery'));\r\n    }\r\n    else { // Browser\r\n        factory(jQuery);\r\n    }\r\n})(function($, undefined) {\r\n    \"use strict\";\r\n\r\n    var defaultOpts = {\r\n\r\n            // Callbacks\r\n            beforeShow: noop,\r\n            move: noop,\r\n            change: noop,\r\n            show: noop,\r\n            hide: noop,\r\n\r\n            // Options\r\n            color: false,\r\n            flat: false,\r\n            showInput: false,\r\n            allowEmpty: false,\r\n            showButtons: true,\r\n            clickoutFiresChange: true,\r\n            showInitial: false,\r\n            showPalette: false,\r\n            showPaletteOnly: false,\r\n            hideAfterPaletteSelect: false,\r\n            togglePaletteOnly: false,\r\n            showSelectionPalette: true,\r\n            localStorageKey: false,\r\n            appendTo: \"body\",\r\n            maxSelectionSize: 7,\r\n            cancelText: \"cancel\",\r\n            chooseText: \"choose\",\r\n            togglePaletteMoreText: \"more\",\r\n            togglePaletteLessText: \"less\",\r\n            clearText: \"Clear Color Selection\",\r\n            noColorSelectedText: \"No Color Selected\",\r\n            preferredFormat: false,\r\n            className: \"\", // Deprecated - use containerClassName and replacerClassName instead.\r\n            containerClassName: \"\",\r\n            replacerClassName: \"\",\r\n            showAlpha: false,\r\n            theme: \"sp-light\",\r\n            palette: [[\"#ffffff\", \"#000000\", \"#ff0000\", \"#ff8000\", \"#ffff00\", \"#008000\", \"#0000ff\", \"#4b0082\", \"#9400d3\"]],\r\n            selectionPalette: [],\r\n            disabled: false,\r\n            offset: null\r\n        },\r\n        spectrums = [],\r\n        IE = !!/msie/i.exec( window.navigator.userAgent ),\r\n        rgbaSupport = (function() {\r\n            function contains( str, substr ) {\r\n                return !!~('' + str).indexOf(substr);\r\n            }\r\n\r\n            var elem = document.createElement('div');\r\n            var style = elem.style;\r\n            style.cssText = 'background-color:rgba(0,0,0,.5)';\r\n            return contains(style.backgroundColor, 'rgba') || contains(style.backgroundColor, 'hsla');\r\n        })(),\r\n        replaceInput = [\r\n            \"<div class='sp-replacer'>\",\r\n            \"<div class='sp-preview'><div class='sp-preview-inner'></div></div>\",\r\n            \"<div class='sp-dd'>&#9660;</div>\",\r\n            \"</div>\"\r\n        ].join(''),\r\n        markup = (function () {\r\n\r\n            // IE does not support gradients with multiple stops, so we need to simulate\r\n            //  that for the rainbow slider with 8 divs that each have a single gradient\r\n            var gradientFix = \"\";\r\n            if (IE) {\r\n                for (var i = 1; i <= 6; i++) {\r\n                    gradientFix += \"<div class='sp-\" + i + \"'></div>\";\r\n                }\r\n            }\r\n\r\n            return [\r\n                \"<div class='sp-container sp-hidden'>\",\r\n                \"<div class='sp-palette-container'>\",\r\n                \"<div class='sp-palette sp-thumb sp-cf'></div>\",\r\n                \"<div class='sp-palette-button-container sp-cf'>\",\r\n                \"<button type='button' class='sp-palette-toggle'></button>\",\r\n                \"</div>\",\r\n                \"</div>\",\r\n                \"<div class='sp-picker-container'>\",\r\n                \"<div class='sp-top sp-cf'>\",\r\n                \"<div class='sp-fill'></div>\",\r\n                \"<div class='sp-top-inner'>\",\r\n                \"<div class='sp-color'>\",\r\n                \"<div class='sp-sat'>\",\r\n                \"<div class='sp-val'>\",\r\n                \"<div class='sp-dragger'></div>\",\r\n                \"</div>\",\r\n                \"</div>\",\r\n                \"</div>\",\r\n                \"<div class='sp-clear sp-clear-display'>\",\r\n                \"</div>\",\r\n                \"<div class='sp-hue'>\",\r\n                \"<div class='sp-slider'></div>\",\r\n                gradientFix,\r\n                \"</div>\",\r\n                \"</div>\",\r\n                \"<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>\",\r\n                \"</div>\",\r\n                \"<div class='sp-input-container sp-cf'>\",\r\n                \"<input class='sp-input' type='text' spellcheck='false'  />\",\r\n                \"</div>\",\r\n                \"<div class='sp-initial sp-thumb sp-cf'></div>\",\r\n                \"<div class='sp-button-container sp-cf'>\",\r\n                \"<a class='sp-cancel' href='#'></a>\",\r\n                \"<button type='button' class='sp-choose'></button>\",\r\n                \"</div>\",\r\n                \"</div>\",\r\n                \"</div>\"\r\n            ].join(\"\");\r\n        })();\r\n\r\n    function paletteTemplate (p, color, className, opts) {\r\n        var html = [];\r\n        for (var i = 0; i < p.length; i++) {\r\n            var current = p[i];\r\n            if(current) {\r\n                var tiny = tinycolor(current);\r\n                var c = tiny.toHsl().l < 0.5 ? \"sp-thumb-el sp-thumb-dark\" : \"sp-thumb-el sp-thumb-light\";\r\n                c += (tinycolor.equals(color, current)) ? \" sp-thumb-active\" : \"\";\r\n                var formattedString = tiny.toString(opts.preferredFormat || \"rgb\");\r\n                var swatchStyle = rgbaSupport ? (\"background-color:\" + tiny.toRgbString()) : \"filter:\" + tiny.toFilter();\r\n                html.push('<span title=\"' + formattedString + '\" data-color=\"' + tiny.toRgbString() + '\" class=\"' + c + '\"><span class=\"sp-thumb-inner\" style=\"' + swatchStyle + ';\" /></span>');\r\n            } else {\r\n                var cls = 'sp-clear-display';\r\n                html.push($('<div />')\r\n                    .append($('<span data-color=\"\" style=\"background-color:transparent;\" class=\"' + cls + '\"></span>')\r\n                        .attr('title', opts.noColorSelectedText)\r\n                    )\r\n                    .html()\r\n                );\r\n            }\r\n        }\r\n        return \"<div class='sp-cf \" + className + \"'>\" + html.join('') + \"</div>\";\r\n    }\r\n\r\n    function hideAll() {\r\n        for (var i = 0; i < spectrums.length; i++) {\r\n            if (spectrums[i]) {\r\n                spectrums[i].hide();\r\n            }\r\n        }\r\n    }\r\n\r\n    function instanceOptions(o, callbackContext) {\r\n        var opts = $.extend({}, defaultOpts, o);\r\n        opts.callbacks = {\r\n            'move': bind(opts.move, callbackContext),\r\n            'change': bind(opts.change, callbackContext),\r\n            'show': bind(opts.show, callbackContext),\r\n            'hide': bind(opts.hide, callbackContext),\r\n            'beforeShow': bind(opts.beforeShow, callbackContext)\r\n        };\r\n\r\n        return opts;\r\n    }\r\n\r\n    function spectrum(element, o) {\r\n\r\n        var opts = instanceOptions(o, element),\r\n            flat = opts.flat,\r\n            showSelectionPalette = opts.showSelectionPalette,\r\n            localStorageKey = opts.localStorageKey,\r\n            theme = opts.theme,\r\n            callbacks = opts.callbacks,\r\n            resize = throttle(reflow, 10),\r\n            visible = false,\r\n            isDragging = false,\r\n            dragWidth = 0,\r\n            dragHeight = 0,\r\n            dragHelperHeight = 0,\r\n            slideHeight = 0,\r\n            slideWidth = 0,\r\n            alphaWidth = 0,\r\n            alphaSlideHelperWidth = 0,\r\n            slideHelperHeight = 0,\r\n            currentHue = 0,\r\n            currentSaturation = 0,\r\n            currentValue = 0,\r\n            currentAlpha = 1,\r\n            palette = [],\r\n            paletteArray = [],\r\n            paletteLookup = {},\r\n            selectionPalette = opts.selectionPalette.slice(0),\r\n            maxSelectionSize = opts.maxSelectionSize,\r\n            draggingClass = \"sp-dragging\",\r\n            shiftMovementDirection = null;\r\n\r\n        var doc = element.ownerDocument,\r\n            body = doc.body,\r\n            boundElement = $(element),\r\n            disabled = false,\r\n            container = $(markup, doc).addClass(theme),\r\n            pickerContainer = container.find(\".sp-picker-container\"),\r\n            dragger = container.find(\".sp-color\"),\r\n            dragHelper = container.find(\".sp-dragger\"),\r\n            slider = container.find(\".sp-hue\"),\r\n            slideHelper = container.find(\".sp-slider\"),\r\n            alphaSliderInner = container.find(\".sp-alpha-inner\"),\r\n            alphaSlider = container.find(\".sp-alpha\"),\r\n            alphaSlideHelper = container.find(\".sp-alpha-handle\"),\r\n            textInput = container.find(\".sp-input\"),\r\n            paletteContainer = container.find(\".sp-palette\"),\r\n            initialColorContainer = container.find(\".sp-initial\"),\r\n            cancelButton = container.find(\".sp-cancel\"),\r\n            clearButton = container.find(\".sp-clear\"),\r\n            chooseButton = container.find(\".sp-choose\"),\r\n            toggleButton = container.find(\".sp-palette-toggle\"),\r\n            isInput = boundElement.is(\"input\"),\r\n            isInputTypeColor = isInput && boundElement.attr(\"type\") === \"color\" && inputTypeColorSupport(),\r\n            shouldReplace = isInput && !flat,\r\n            replacer = (shouldReplace) ? $(replaceInput).addClass(theme).addClass(opts.className).addClass(opts.replacerClassName) : $([]),\r\n            offsetElement = (shouldReplace) ? replacer : boundElement,\r\n            previewElement = replacer.find(\".sp-preview-inner\"),\r\n            initialColor = opts.color || (isInput && boundElement.val()),\r\n            colorOnShow = false,\r\n            currentPreferredFormat = opts.preferredFormat,\r\n            clickoutFiresChange = !opts.showButtons || opts.clickoutFiresChange,\r\n            isEmpty = !initialColor,\r\n            allowEmpty = opts.allowEmpty && !isInputTypeColor;\r\n\r\n        function applyOptions() {\r\n\r\n            if (opts.showPaletteOnly) {\r\n                opts.showPalette = true;\r\n            }\r\n\r\n            toggleButton.text(opts.showPaletteOnly ? opts.togglePaletteMoreText : opts.togglePaletteLessText);\r\n\r\n            if (opts.palette) {\r\n                palette = opts.palette.slice(0);\r\n                paletteArray = $.isArray(palette[0]) ? palette : [palette];\r\n                paletteLookup = {};\r\n                for (var i = 0; i < paletteArray.length; i++) {\r\n                    for (var j = 0; j < paletteArray[i].length; j++) {\r\n                        var rgb = tinycolor(paletteArray[i][j]).toRgbString();\r\n                        paletteLookup[rgb] = true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            container.toggleClass(\"sp-flat\", flat);\r\n            container.toggleClass(\"sp-input-disabled\", !opts.showInput);\r\n            container.toggleClass(\"sp-alpha-enabled\", opts.showAlpha);\r\n            container.toggleClass(\"sp-clear-enabled\", allowEmpty);\r\n            container.toggleClass(\"sp-buttons-disabled\", !opts.showButtons);\r\n            container.toggleClass(\"sp-palette-buttons-disabled\", !opts.togglePaletteOnly);\r\n            container.toggleClass(\"sp-palette-disabled\", !opts.showPalette);\r\n            container.toggleClass(\"sp-palette-only\", opts.showPaletteOnly);\r\n            container.toggleClass(\"sp-initial-disabled\", !opts.showInitial);\r\n            container.addClass(opts.className).addClass(opts.containerClassName);\r\n\r\n            reflow();\r\n        }\r\n\r\n        function initialize() {\r\n\r\n            if (IE) {\r\n                container.find(\"*:not(input)\").attr(\"unselectable\", \"on\");\r\n            }\r\n\r\n            applyOptions();\r\n\r\n            if (shouldReplace) {\r\n                boundElement.after(replacer).hide();\r\n            }\r\n\r\n            if (!allowEmpty) {\r\n                clearButton.hide();\r\n            }\r\n\r\n            if (flat) {\r\n                boundElement.after(container).hide();\r\n            }\r\n            else {\r\n\r\n                var appendTo = opts.appendTo === \"parent\" ? boundElement.parent() : $(opts.appendTo);\r\n                if (appendTo.length !== 1) {\r\n                    appendTo = $(\"body\");\r\n                }\r\n\r\n                appendTo.append(container);\r\n            }\r\n\r\n            updateSelectionPaletteFromStorage();\r\n\r\n            offsetElement.bind(\"click.spectrum touchstart.spectrum\", function (e) {\r\n                if (!disabled) {\r\n                    toggle();\r\n                }\r\n\r\n                e.stopPropagation();\r\n\r\n                if (!$(e.target).is(\"input\")) {\r\n                    e.preventDefault();\r\n                }\r\n            });\r\n\r\n            if(boundElement.is(\":disabled\") || (opts.disabled === true)) {\r\n                disable();\r\n            }\r\n\r\n            // Prevent clicks from bubbling up to document.  This would cause it to be hidden.\r\n            container.click(stopPropagation);\r\n\r\n            // Handle user typed input\r\n            textInput.change(setFromTextInput);\r\n            textInput.bind(\"paste\", function () {\r\n                setTimeout(setFromTextInput, 1);\r\n            });\r\n            textInput.keydown(function (e) { if (e.keyCode == 13) { setFromTextInput(); } });\r\n\r\n            cancelButton.text(opts.cancelText);\r\n            cancelButton.bind(\"click.spectrum\", function (e) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n                revert();\r\n                hide();\r\n            });\r\n\r\n            clearButton.attr(\"title\", opts.clearText);\r\n            clearButton.bind(\"click.spectrum\", function (e) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n                isEmpty = true;\r\n                move();\r\n\r\n                if(flat) {\r\n                    //for the flat style, this is a change event\r\n                    updateOriginalInput(true);\r\n                }\r\n            });\r\n\r\n            chooseButton.text(opts.chooseText);\r\n            chooseButton.bind(\"click.spectrum\", function (e) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n\r\n                if (IE && textInput.is(\":focus\")) {\r\n                    textInput.trigger('change');\r\n                }\r\n\r\n                if (isValid()) {\r\n                    updateOriginalInput(true);\r\n                    hide();\r\n                }\r\n            });\r\n\r\n            toggleButton.text(opts.showPaletteOnly ? opts.togglePaletteMoreText : opts.togglePaletteLessText);\r\n            toggleButton.bind(\"click.spectrum\", function (e) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n\r\n                opts.showPaletteOnly = !opts.showPaletteOnly;\r\n\r\n                // To make sure the Picker area is drawn on the right, next to the\r\n                // Palette area (and not below the palette), first move the Palette\r\n                // to the left to make space for the picker, plus 5px extra.\r\n                // The 'applyOptions' function puts the whole container back into place\r\n                // and takes care of the button-text and the sp-palette-only CSS class.\r\n                if (!opts.showPaletteOnly && !flat) {\r\n                    container.css('left', '-=' + (pickerContainer.outerWidth(true) + 5));\r\n                }\r\n                applyOptions();\r\n            });\r\n\r\n            draggable(alphaSlider, function (dragX, dragY, e) {\r\n                currentAlpha = (dragX / alphaWidth);\r\n                isEmpty = false;\r\n                if (e.shiftKey) {\r\n                    currentAlpha = Math.round(currentAlpha * 10) / 10;\r\n                }\r\n\r\n                move();\r\n            }, dragStart, dragStop);\r\n\r\n            draggable(slider, function (dragX, dragY) {\r\n                currentHue = parseFloat(dragY / slideHeight);\r\n                isEmpty = false;\r\n                if (!opts.showAlpha) {\r\n                    currentAlpha = 1;\r\n                }\r\n                move();\r\n            }, dragStart, dragStop);\r\n\r\n            draggable(dragger, function (dragX, dragY, e) {\r\n\r\n                // shift+drag should snap the movement to either the x or y axis.\r\n                if (!e.shiftKey) {\r\n                    shiftMovementDirection = null;\r\n                }\r\n                else if (!shiftMovementDirection) {\r\n                    var oldDragX = currentSaturation * dragWidth;\r\n                    var oldDragY = dragHeight - (currentValue * dragHeight);\r\n                    var furtherFromX = Math.abs(dragX - oldDragX) > Math.abs(dragY - oldDragY);\r\n\r\n                    shiftMovementDirection = furtherFromX ? \"x\" : \"y\";\r\n                }\r\n\r\n                var setSaturation = !shiftMovementDirection || shiftMovementDirection === \"x\";\r\n                var setValue = !shiftMovementDirection || shiftMovementDirection === \"y\";\r\n\r\n                if (setSaturation) {\r\n                    currentSaturation = parseFloat(dragX / dragWidth);\r\n                }\r\n                if (setValue) {\r\n                    currentValue = parseFloat((dragHeight - dragY) / dragHeight);\r\n                }\r\n\r\n                isEmpty = false;\r\n                if (!opts.showAlpha) {\r\n                    currentAlpha = 1;\r\n                }\r\n\r\n                move();\r\n\r\n            }, dragStart, dragStop);\r\n\r\n            if (!!initialColor) {\r\n                set(initialColor);\r\n\r\n                // In case color was black - update the preview UI and set the format\r\n                // since the set function will not run (default color is black).\r\n                updateUI();\r\n                currentPreferredFormat = opts.preferredFormat || tinycolor(initialColor).format;\r\n\r\n                addColorToSelectionPalette(initialColor);\r\n            }\r\n            else {\r\n                updateUI();\r\n            }\r\n\r\n            if (flat) {\r\n                show();\r\n            }\r\n\r\n            function paletteElementClick(e) {\r\n                if (e.data && e.data.ignore) {\r\n                    set($(e.target).closest(\".sp-thumb-el\").data(\"color\"));\r\n                    move();\r\n                }\r\n                else {\r\n                    set($(e.target).closest(\".sp-thumb-el\").data(\"color\"));\r\n                    move();\r\n                    updateOriginalInput(true);\r\n                    if (opts.hideAfterPaletteSelect) {\r\n                        hide();\r\n                    }\r\n                }\r\n\r\n                return false;\r\n            }\r\n\r\n            var paletteEvent = IE ? \"mousedown.spectrum\" : \"click.spectrum touchstart.spectrum\";\r\n            paletteContainer.delegate(\".sp-thumb-el\", paletteEvent, paletteElementClick);\r\n            initialColorContainer.delegate(\".sp-thumb-el:nth-child(1)\", paletteEvent, { ignore: true }, paletteElementClick);\r\n        }\r\n\r\n        function updateSelectionPaletteFromStorage() {\r\n\r\n            if (localStorageKey && window.localStorage) {\r\n\r\n                // Migrate old palettes over to new format.  May want to remove this eventually.\r\n                try {\r\n                    var oldPalette = window.localStorage[localStorageKey].split(\",#\");\r\n                    if (oldPalette.length > 1) {\r\n                        delete window.localStorage[localStorageKey];\r\n                        $.each(oldPalette, function(i, c) {\r\n                            addColorToSelectionPalette(c);\r\n                        });\r\n                    }\r\n                }\r\n                catch(e) { }\r\n\r\n                try {\r\n                    selectionPalette = window.localStorage[localStorageKey].split(\";\");\r\n                }\r\n                catch (e) { }\r\n            }\r\n        }\r\n\r\n        function addColorToSelectionPalette(color) {\r\n            if (showSelectionPalette) {\r\n                var rgb = tinycolor(color).toRgbString();\r\n                if (!paletteLookup[rgb] && $.inArray(rgb, selectionPalette) === -1) {\r\n                    selectionPalette.push(rgb);\r\n                    while(selectionPalette.length > maxSelectionSize) {\r\n                        selectionPalette.shift();\r\n                    }\r\n                }\r\n\r\n                if (localStorageKey && window.localStorage) {\r\n                    try {\r\n                        window.localStorage[localStorageKey] = selectionPalette.join(\";\");\r\n                    }\r\n                    catch(e) { }\r\n                }\r\n            }\r\n        }\r\n\r\n        function getUniqueSelectionPalette() {\r\n            var unique = [];\r\n            if (opts.showPalette) {\r\n                for (var i = 0; i < selectionPalette.length; i++) {\r\n                    var rgb = tinycolor(selectionPalette[i]).toRgbString();\r\n\r\n                    if (!paletteLookup[rgb]) {\r\n                        unique.push(selectionPalette[i]);\r\n                    }\r\n                }\r\n            }\r\n\r\n            return unique.reverse().slice(0, opts.maxSelectionSize);\r\n        }\r\n\r\n        function drawPalette() {\r\n\r\n            var currentColor = get();\r\n\r\n            var html = $.map(paletteArray, function (palette, i) {\r\n                return paletteTemplate(palette, currentColor, \"sp-palette-row sp-palette-row-\" + i, opts);\r\n            });\r\n\r\n            updateSelectionPaletteFromStorage();\r\n\r\n            if (selectionPalette) {\r\n                html.push(paletteTemplate(getUniqueSelectionPalette(), currentColor, \"sp-palette-row sp-palette-row-selection\", opts));\r\n            }\r\n\r\n            paletteContainer.html(html.join(\"\"));\r\n        }\r\n\r\n        function drawInitial() {\r\n            if (opts.showInitial) {\r\n                var initial = colorOnShow;\r\n                var current = get();\r\n                initialColorContainer.html(paletteTemplate([initial, current], current, \"sp-palette-row-initial\", opts));\r\n            }\r\n        }\r\n\r\n        function dragStart() {\r\n            if (dragHeight <= 0 || dragWidth <= 0 || slideHeight <= 0) {\r\n                reflow();\r\n            }\r\n            isDragging = true;\r\n            container.addClass(draggingClass);\r\n            shiftMovementDirection = null;\r\n            boundElement.trigger('dragstart.spectrum', [ get() ]);\r\n        }\r\n\r\n        function dragStop() {\r\n            isDragging = false;\r\n            container.removeClass(draggingClass);\r\n            boundElement.trigger('dragstop.spectrum', [ get() ]);\r\n        }\r\n\r\n        function setFromTextInput() {\r\n\r\n            var value = textInput.val();\r\n\r\n            if ((value === null || value === \"\") && allowEmpty) {\r\n                set(null);\r\n                updateOriginalInput(true);\r\n            }\r\n            else {\r\n                var tiny = tinycolor(value);\r\n                if (tiny.isValid()) {\r\n                    set(tiny);\r\n                    updateOriginalInput(true);\r\n                }\r\n                else {\r\n                    textInput.addClass(\"sp-validation-error\");\r\n                }\r\n            }\r\n        }\r\n\r\n        function toggle() {\r\n            if (visible) {\r\n                hide();\r\n            }\r\n            else {\r\n                show();\r\n            }\r\n        }\r\n\r\n        function show() {\r\n            var event = $.Event('beforeShow.spectrum');\r\n\r\n            if (visible) {\r\n                reflow();\r\n                return;\r\n            }\r\n\r\n            boundElement.trigger(event, [ get() ]);\r\n\r\n            if (callbacks.beforeShow(get()) === false || event.isDefaultPrevented()) {\r\n                return;\r\n            }\r\n\r\n            hideAll();\r\n            visible = true;\r\n\r\n            $(doc).bind(\"keydown.spectrum\", onkeydown);\r\n            $(doc).bind(\"click.spectrum\", clickout);\r\n            $(window).bind(\"resize.spectrum\", resize);\r\n            replacer.addClass(\"sp-active\");\r\n            container.removeClass(\"sp-hidden\");\r\n\r\n            reflow();\r\n            updateUI();\r\n\r\n            colorOnShow = get();\r\n\r\n            drawInitial();\r\n            callbacks.show(colorOnShow);\r\n            boundElement.trigger('show.spectrum', [ colorOnShow ]);\r\n        }\r\n\r\n        function onkeydown(e) {\r\n            // Close on ESC\r\n            if (e.keyCode === 27) {\r\n                hide();\r\n            }\r\n        }\r\n\r\n        function clickout(e) {\r\n            // Return on right click.\r\n            if (e.button == 2) { return; }\r\n\r\n            // If a drag event was happening during the mouseup, don't hide\r\n            // on click.\r\n            if (isDragging) { return; }\r\n\r\n            if (clickoutFiresChange) {\r\n                updateOriginalInput(true);\r\n            }\r\n            else {\r\n                revert();\r\n            }\r\n            hide();\r\n        }\r\n\r\n        function hide() {\r\n            // Return if hiding is unnecessary\r\n            if (!visible || flat) { return; }\r\n            visible = false;\r\n\r\n            $(doc).unbind(\"keydown.spectrum\", onkeydown);\r\n            $(doc).unbind(\"click.spectrum\", clickout);\r\n            $(window).unbind(\"resize.spectrum\", resize);\r\n\r\n            replacer.removeClass(\"sp-active\");\r\n            container.addClass(\"sp-hidden\");\r\n\r\n            callbacks.hide(get());\r\n            boundElement.trigger('hide.spectrum', [ get() ]);\r\n        }\r\n\r\n        function revert() {\r\n            set(colorOnShow, true);\r\n        }\r\n\r\n        function set(color, ignoreFormatChange) {\r\n            if (tinycolor.equals(color, get())) {\r\n                // Update UI just in case a validation error needs\r\n                // to be cleared.\r\n                updateUI();\r\n                return;\r\n            }\r\n\r\n            var newColor, newHsv;\r\n            if (!color && allowEmpty) {\r\n                isEmpty = true;\r\n            } else {\r\n                isEmpty = false;\r\n                newColor = tinycolor(color);\r\n                newHsv = newColor.toHsv();\r\n\r\n                currentHue = (newHsv.h % 360) / 360;\r\n                currentSaturation = newHsv.s;\r\n                currentValue = newHsv.v;\r\n                currentAlpha = newHsv.a;\r\n            }\r\n            updateUI();\r\n\r\n            if (newColor && newColor.isValid() && !ignoreFormatChange) {\r\n                currentPreferredFormat = opts.preferredFormat || newColor.getFormat();\r\n            }\r\n        }\r\n\r\n        function get(opts) {\r\n            opts = opts || { };\r\n\r\n            if (allowEmpty && isEmpty) {\r\n                return null;\r\n            }\r\n\r\n            return tinycolor.fromRatio({\r\n                h: currentHue,\r\n                s: currentSaturation,\r\n                v: currentValue,\r\n                a: Math.round(currentAlpha * 100) / 100\r\n            }, { format: opts.format || currentPreferredFormat });\r\n        }\r\n\r\n        function isValid() {\r\n            return !textInput.hasClass(\"sp-validation-error\");\r\n        }\r\n\r\n        function move() {\r\n            updateUI();\r\n\r\n            callbacks.move(get());\r\n            boundElement.trigger('move.spectrum', [ get() ]);\r\n        }\r\n\r\n        function updateUI() {\r\n\r\n            textInput.removeClass(\"sp-validation-error\");\r\n\r\n            updateHelperLocations();\r\n\r\n            // Update dragger background color (gradients take care of saturation and value).\r\n            var flatColor = tinycolor.fromRatio({ h: currentHue, s: 1, v: 1 });\r\n            dragger.css(\"background-color\", flatColor.toHexString());\r\n\r\n            // Get a format that alpha will be included in (hex and names ignore alpha)\r\n            var format = currentPreferredFormat;\r\n            if (currentAlpha < 1 && !(currentAlpha === 0 && format === \"name\")) {\r\n                if (format === \"hex\" || format === \"hex3\" || format === \"hex6\" || format === \"name\") {\r\n                    format = \"rgb\";\r\n                }\r\n            }\r\n\r\n            var realColor = get({ format: format }),\r\n                displayColor = '';\r\n\r\n            //reset background info for preview element\r\n            previewElement.removeClass(\"sp-clear-display\");\r\n            previewElement.css('background-color', 'transparent');\r\n\r\n            if (!realColor && allowEmpty) {\r\n                // Update the replaced elements background with icon indicating no color selection\r\n                previewElement.addClass(\"sp-clear-display\");\r\n            }\r\n            else {\r\n                var realHex = realColor.toHexString(),\r\n                    realRgb = realColor.toRgbString();\r\n\r\n                // Update the replaced elements background color (with actual selected color)\r\n                if (rgbaSupport || realColor.alpha === 1) {\r\n                    previewElement.css(\"background-color\", realRgb);\r\n                }\r\n                else {\r\n                    previewElement.css(\"background-color\", \"transparent\");\r\n                    previewElement.css(\"filter\", realColor.toFilter());\r\n                }\r\n\r\n                if (opts.showAlpha) {\r\n                    var rgb = realColor.toRgb();\r\n                    rgb.a = 0;\r\n                    var realAlpha = tinycolor(rgb).toRgbString();\r\n                    var gradient = \"linear-gradient(left, \" + realAlpha + \", \" + realHex + \")\";\r\n\r\n                    if (IE) {\r\n                        alphaSliderInner.css(\"filter\", tinycolor(realAlpha).toFilter({ gradientType: 1 }, realHex));\r\n                    }\r\n                    else {\r\n                        alphaSliderInner.css(\"background\", \"-webkit-\" + gradient);\r\n                        alphaSliderInner.css(\"background\", \"-moz-\" + gradient);\r\n                        alphaSliderInner.css(\"background\", \"-ms-\" + gradient);\r\n                        // Use current syntax gradient on unprefixed property.\r\n                        alphaSliderInner.css(\"background\",\r\n                            \"linear-gradient(to right, \" + realAlpha + \", \" + realHex + \")\");\r\n                    }\r\n                }\r\n\r\n                displayColor = realColor.toString(format);\r\n            }\r\n\r\n            // Update the text entry input as it changes happen\r\n            if (opts.showInput) {\r\n                textInput.val(displayColor);\r\n            }\r\n\r\n            if (opts.showPalette) {\r\n                drawPalette();\r\n            }\r\n\r\n            drawInitial();\r\n        }\r\n\r\n        function updateHelperLocations() {\r\n            var s = currentSaturation;\r\n            var v = currentValue;\r\n\r\n            if(allowEmpty && isEmpty) {\r\n                //if selected color is empty, hide the helpers\r\n                alphaSlideHelper.hide();\r\n                slideHelper.hide();\r\n                dragHelper.hide();\r\n            }\r\n            else {\r\n                //make sure helpers are visible\r\n                alphaSlideHelper.show();\r\n                slideHelper.show();\r\n                dragHelper.show();\r\n\r\n                // Where to show the little circle in that displays your current selected color\r\n                var dragX = s * dragWidth;\r\n                var dragY = dragHeight - (v * dragHeight);\r\n                dragX = Math.max(\r\n                    -dragHelperHeight,\r\n                    Math.min(dragWidth - dragHelperHeight, dragX - dragHelperHeight)\r\n                );\r\n                dragY = Math.max(\r\n                    -dragHelperHeight,\r\n                    Math.min(dragHeight - dragHelperHeight, dragY - dragHelperHeight)\r\n                );\r\n                dragHelper.css({\r\n                    \"top\": dragY + \"px\",\r\n                    \"left\": dragX + \"px\"\r\n                });\r\n\r\n                var alphaX = currentAlpha * alphaWidth;\r\n                alphaSlideHelper.css({\r\n                    \"left\": (alphaX - (alphaSlideHelperWidth / 2)) + \"px\"\r\n                });\r\n\r\n                // Where to show the bar that displays your current selected hue\r\n                var slideY = (currentHue) * slideHeight;\r\n                slideHelper.css({\r\n                    \"top\": (slideY - slideHelperHeight) + \"px\"\r\n                });\r\n            }\r\n        }\r\n\r\n        function updateOriginalInput(fireCallback) {\r\n            var color = get(),\r\n                displayColor = '',\r\n                hasChanged = !tinycolor.equals(color, colorOnShow);\r\n\r\n            if (color) {\r\n                displayColor = color.toString(currentPreferredFormat);\r\n                // Update the selection palette with the current color\r\n                addColorToSelectionPalette(color);\r\n            }\r\n\r\n            if (isInput) {\r\n                boundElement.val(displayColor);\r\n            }\r\n\r\n            if (fireCallback && hasChanged) {\r\n                callbacks.change(color);\r\n                boundElement.trigger('change', [ color ]);\r\n            }\r\n        }\r\n\r\n        function reflow() {\r\n            if (!visible) {\r\n                return; // Calculations would be useless and wouldn't be reliable anyways\r\n            }\r\n            dragWidth = dragger.width();\r\n            dragHeight = dragger.height();\r\n            dragHelperHeight = dragHelper.height();\r\n            slideWidth = slider.width();\r\n            slideHeight = slider.height();\r\n            slideHelperHeight = slideHelper.height();\r\n            alphaWidth = alphaSlider.width();\r\n            alphaSlideHelperWidth = alphaSlideHelper.width();\r\n\r\n            if (!flat) {\r\n                container.css(\"position\", \"absolute\");\r\n                if (opts.offset) {\r\n                    container.offset(opts.offset);\r\n                } else {\r\n                    container.offset(getOffset(container, offsetElement));\r\n                }\r\n            }\r\n\r\n            updateHelperLocations();\r\n\r\n            if (opts.showPalette) {\r\n                drawPalette();\r\n            }\r\n\r\n            boundElement.trigger('reflow.spectrum');\r\n        }\r\n\r\n        function destroy() {\r\n            boundElement.show();\r\n            offsetElement.unbind(\"click.spectrum touchstart.spectrum\");\r\n            container.remove();\r\n            replacer.remove();\r\n            spectrums[spect.id] = null;\r\n        }\r\n\r\n        function option(optionName, optionValue) {\r\n            if (optionName === undefined) {\r\n                return $.extend({}, opts);\r\n            }\r\n            if (optionValue === undefined) {\r\n                return opts[optionName];\r\n            }\r\n\r\n            opts[optionName] = optionValue;\r\n\r\n            if (optionName === \"preferredFormat\") {\r\n                currentPreferredFormat = opts.preferredFormat;\r\n            }\r\n            applyOptions();\r\n        }\r\n\r\n        function enable() {\r\n            disabled = false;\r\n            boundElement.attr(\"disabled\", false);\r\n            offsetElement.removeClass(\"sp-disabled\");\r\n        }\r\n\r\n        function disable() {\r\n            hide();\r\n            disabled = true;\r\n            boundElement.attr(\"disabled\", true);\r\n            offsetElement.addClass(\"sp-disabled\");\r\n        }\r\n\r\n        function setOffset(coord) {\r\n            opts.offset = coord;\r\n            reflow();\r\n        }\r\n\r\n        initialize();\r\n\r\n        var spect = {\r\n            show: show,\r\n            hide: hide,\r\n            toggle: toggle,\r\n            reflow: reflow,\r\n            option: option,\r\n            enable: enable,\r\n            disable: disable,\r\n            offset: setOffset,\r\n            set: function (c) {\r\n                set(c);\r\n                updateOriginalInput();\r\n            },\r\n            get: get,\r\n            destroy: destroy,\r\n            container: container\r\n        };\r\n\r\n        spect.id = spectrums.push(spect) - 1;\r\n\r\n        return spect;\r\n    }\r\n\r\n    /**\r\n     * checkOffset - get the offset below/above and left/right element depending on screen position\r\n     * Thanks https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.datepicker.js\r\n     */\r\n    function getOffset(picker, input) {\r\n        var extraY = 0;\r\n        var dpWidth = picker.outerWidth();\r\n        var dpHeight = picker.outerHeight();\r\n        var inputHeight = input.outerHeight();\r\n        var doc = picker[0].ownerDocument;\r\n        var docElem = doc.documentElement;\r\n        var viewWidth = docElem.clientWidth + $(doc).scrollLeft();\r\n        var viewHeight = docElem.clientHeight + $(doc).scrollTop();\r\n        var offset = input.offset();\r\n        offset.top += inputHeight;\r\n\r\n        offset.left -=\r\n            Math.min(offset.left, (offset.left + dpWidth > viewWidth && viewWidth > dpWidth) ?\r\n                Math.abs(offset.left + dpWidth - viewWidth) : 0);\r\n\r\n        offset.top -=\r\n            Math.min(offset.top, ((offset.top + dpHeight > viewHeight && viewHeight > dpHeight) ?\r\n                Math.abs(dpHeight + inputHeight - extraY) : extraY));\r\n\r\n        return offset;\r\n    }\r\n\r\n    /**\r\n     * noop - do nothing\r\n     */\r\n    function noop() {\r\n\r\n    }\r\n\r\n    /**\r\n     * stopPropagation - makes the code only doing this a little easier to read in line\r\n     */\r\n    function stopPropagation(e) {\r\n        e.stopPropagation();\r\n    }\r\n\r\n    /**\r\n     * Create a function bound to a given object\r\n     * Thanks to underscore.js\r\n     */\r\n    function bind(func, obj) {\r\n        var slice = Array.prototype.slice;\r\n        var args = slice.call(arguments, 2);\r\n        return function () {\r\n            return func.apply(obj, args.concat(slice.call(arguments)));\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Lightweight drag helper.  Handles containment within the element, so that\r\n     * when dragging, the x is within [0,element.width] and y is within [0,element.height]\r\n     */\r\n    function draggable(element, onmove, onstart, onstop) {\r\n        onmove = onmove || function () { };\r\n        onstart = onstart || function () { };\r\n        onstop = onstop || function () { };\r\n        var doc = document;\r\n        var dragging = false;\r\n        var offset = {};\r\n        var maxHeight = 0;\r\n        var maxWidth = 0;\r\n        var hasTouch = ('ontouchstart' in window);\r\n\r\n        var duringDragEvents = {};\r\n        duringDragEvents[\"selectstart\"] = prevent;\r\n        duringDragEvents[\"dragstart\"] = prevent;\r\n        duringDragEvents[\"touchmove mousemove\"] = move;\r\n        duringDragEvents[\"touchend mouseup\"] = stop;\r\n\r\n        function prevent(e) {\r\n            if (e.stopPropagation) {\r\n                e.stopPropagation();\r\n            }\r\n            if (e.preventDefault) {\r\n                e.preventDefault();\r\n            }\r\n            e.returnValue = false;\r\n        }\r\n\r\n        function move(e) {\r\n            if (dragging) {\r\n                // Mouseup happened outside of window\r\n                if (IE && doc.documentMode < 9 && !e.button) {\r\n                    return stop();\r\n                }\r\n\r\n                var t0 = e.originalEvent && e.originalEvent.touches && e.originalEvent.touches[0];\r\n                var pageX = t0 && t0.pageX || e.pageX;\r\n                var pageY = t0 && t0.pageY || e.pageY;\r\n\r\n                var dragX = Math.max(0, Math.min(pageX - offset.left, maxWidth));\r\n                var dragY = Math.max(0, Math.min(pageY - offset.top, maxHeight));\r\n\r\n                if (hasTouch) {\r\n                    // Stop scrolling in iOS\r\n                    prevent(e);\r\n                }\r\n\r\n                onmove.apply(element, [dragX, dragY, e]);\r\n            }\r\n        }\r\n\r\n        function start(e) {\r\n            var rightclick = (e.which) ? (e.which == 3) : (e.button == 2);\r\n\r\n            if (!rightclick && !dragging) {\r\n                if (onstart.apply(element, arguments) !== false) {\r\n                    dragging = true;\r\n                    maxHeight = $(element).height();\r\n                    maxWidth = $(element).width();\r\n                    offset = $(element).offset();\r\n\r\n                    $(doc).bind(duringDragEvents);\r\n                    $(doc.body).addClass(\"sp-dragging\");\r\n\r\n                    move(e);\r\n\r\n                    prevent(e);\r\n                }\r\n            }\r\n        }\r\n\r\n        function stop() {\r\n            if (dragging) {\r\n                $(doc).unbind(duringDragEvents);\r\n                $(doc.body).removeClass(\"sp-dragging\");\r\n\r\n                // Wait a tick before notifying observers to allow the click event\r\n                // to fire in Chrome.\r\n                setTimeout(function() {\r\n                    onstop.apply(element, arguments);\r\n                }, 0);\r\n            }\r\n            dragging = false;\r\n        }\r\n\r\n        $(element).bind(\"touchstart mousedown\", start);\r\n    }\r\n\r\n    function throttle(func, wait, debounce) {\r\n        var timeout;\r\n        return function () {\r\n            var context = this, args = arguments;\r\n            var throttler = function () {\r\n                timeout = null;\r\n                func.apply(context, args);\r\n            };\r\n            if (debounce) clearTimeout(timeout);\r\n            if (debounce || !timeout) timeout = setTimeout(throttler, wait);\r\n        };\r\n    }\r\n\r\n    function inputTypeColorSupport() {\r\n        return $.fn.spectrum.inputTypeColorSupport();\r\n    }\r\n\r\n    /**\r\n     * Define a jQuery plugin\r\n     */\r\n    var dataID = \"spectrum.id\";\r\n    $.fn.spectrum = function (opts, extra) {\r\n\r\n        if (typeof opts == \"string\") {\r\n\r\n            var returnValue = this;\r\n            var args = Array.prototype.slice.call( arguments, 1 );\r\n\r\n            this.each(function () {\r\n                var spect = spectrums[$(this).data(dataID)];\r\n                if (spect) {\r\n                    var method = spect[opts];\r\n                    if (!method) {\r\n                        throw new Error( \"Spectrum: no such method: '\" + opts + \"'\" );\r\n                    }\r\n\r\n                    if (opts == \"get\") {\r\n                        returnValue = spect.get();\r\n                    }\r\n                    else if (opts == \"container\") {\r\n                        returnValue = spect.container;\r\n                    }\r\n                    else if (opts == \"option\") {\r\n                        returnValue = spect.option.apply(spect, args);\r\n                    }\r\n                    else if (opts == \"destroy\") {\r\n                        spect.destroy();\r\n                        $(this).removeData(dataID);\r\n                    }\r\n                    else {\r\n                        method.apply(spect, args);\r\n                    }\r\n                }\r\n            });\r\n\r\n            return returnValue;\r\n        }\r\n\r\n        // Initializing a new instance of spectrum\r\n        return this.spectrum(\"destroy\").each(function () {\r\n            var options = $.extend({}, opts, $(this).data());\r\n            var spect = spectrum(this, options);\r\n            $(this).data(dataID, spect.id);\r\n        });\r\n    };\r\n\r\n    $.fn.spectrum.load = true;\r\n    $.fn.spectrum.loadOpts = {};\r\n    $.fn.spectrum.draggable = draggable;\r\n    $.fn.spectrum.defaults = defaultOpts;\r\n    $.fn.spectrum.inputTypeColorSupport = function inputTypeColorSupport() {\r\n        if (typeof inputTypeColorSupport._cachedResult === \"undefined\") {\r\n            var colorInput = $(\"<input type='color'/>\")[0]; // if color element is supported, value will default to not null\r\n            inputTypeColorSupport._cachedResult = colorInput.type === \"color\" && colorInput.value !== \"\";\r\n        }\r\n        return inputTypeColorSupport._cachedResult;\r\n    };\r\n\r\n    $.spectrum = { };\r\n    $.spectrum.localization = { };\r\n    $.spectrum.palettes = { };\r\n\r\n    $.fn.spectrum.processNativeColorInputs = function () {\r\n        var colorInputs = $(\"input[type=color]\");\r\n        if (colorInputs.length && !inputTypeColorSupport()) {\r\n            colorInputs.spectrum({\r\n                preferredFormat: \"hex6\"\r\n            });\r\n        }\r\n    };\r\n\r\n    // TinyColor v1.1.2\r\n    // https://github.com/bgrins/TinyColor\r\n    // Brian Grinstead, MIT License\r\n\r\n    (function() {\r\n\r\n        var trimLeft = /^[\\s,#]+/,\r\n            trimRight = /\\s+$/,\r\n            tinyCounter = 0,\r\n            math = Math,\r\n            mathRound = math.round,\r\n            mathMin = math.min,\r\n            mathMax = math.max,\r\n            mathRandom = math.random;\r\n\r\n        var tinycolor = function(color, opts) {\r\n\r\n            color = (color) ? color : '';\r\n            opts = opts || { };\r\n\r\n            // If input is already a tinycolor, return itself\r\n            if (color instanceof tinycolor) {\r\n                return color;\r\n            }\r\n            // If we are called as a function, call using new instead\r\n            if (!(this instanceof tinycolor)) {\r\n                return new tinycolor(color, opts);\r\n            }\r\n\r\n            var rgb = inputToRGB(color);\r\n            this._originalInput = color,\r\n                this._r = rgb.r,\r\n                this._g = rgb.g,\r\n                this._b = rgb.b,\r\n                this._a = rgb.a,\r\n                this._roundA = mathRound(100*this._a) / 100,\r\n                this._format = opts.format || rgb.format;\r\n            this._gradientType = opts.gradientType;\r\n\r\n            // Don't let the range of [0,255] come back in [0,1].\r\n            // Potentially lose a little bit of precision here, but will fix issues where\r\n            // .5 gets interpreted as half of the total, instead of half of 1\r\n            // If it was supposed to be 128, this was already taken care of by `inputToRgb`\r\n            if (this._r < 1) { this._r = mathRound(this._r); }\r\n            if (this._g < 1) { this._g = mathRound(this._g); }\r\n            if (this._b < 1) { this._b = mathRound(this._b); }\r\n\r\n            this._ok = rgb.ok;\r\n            this._tc_id = tinyCounter++;\r\n        };\r\n\r\n        tinycolor.prototype = {\r\n            isDark: function() {\r\n                return this.getBrightness() < 128;\r\n            },\r\n            isLight: function() {\r\n                return !this.isDark();\r\n            },\r\n            isValid: function() {\r\n                return this._ok;\r\n            },\r\n            getOriginalInput: function() {\r\n                return this._originalInput;\r\n            },\r\n            getFormat: function() {\r\n                return this._format;\r\n            },\r\n            getAlpha: function() {\r\n                return this._a;\r\n            },\r\n            getBrightness: function() {\r\n                var rgb = this.toRgb();\r\n                return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;\r\n            },\r\n            setAlpha: function(value) {\r\n                this._a = boundAlpha(value);\r\n                this._roundA = mathRound(100*this._a) / 100;\r\n                return this;\r\n            },\r\n            toHsv: function() {\r\n                var hsv = rgbToHsv(this._r, this._g, this._b);\r\n                return { h: hsv.h * 360, s: hsv.s, v: hsv.v, a: this._a };\r\n            },\r\n            toHsvString: function() {\r\n                var hsv = rgbToHsv(this._r, this._g, this._b);\r\n                var h = mathRound(hsv.h * 360), s = mathRound(hsv.s * 100), v = mathRound(hsv.v * 100);\r\n                return (this._a == 1) ?\r\n                    \"hsv(\"  + h + \", \" + s + \"%, \" + v + \"%)\" :\r\n                    \"hsva(\" + h + \", \" + s + \"%, \" + v + \"%, \"+ this._roundA + \")\";\r\n            },\r\n            toHsl: function() {\r\n                var hsl = rgbToHsl(this._r, this._g, this._b);\r\n                return { h: hsl.h * 360, s: hsl.s, l: hsl.l, a: this._a };\r\n            },\r\n            toHslString: function() {\r\n                var hsl = rgbToHsl(this._r, this._g, this._b);\r\n                var h = mathRound(hsl.h * 360), s = mathRound(hsl.s * 100), l = mathRound(hsl.l * 100);\r\n                return (this._a == 1) ?\r\n                    \"hsl(\"  + h + \", \" + s + \"%, \" + l + \"%)\" :\r\n                    \"hsla(\" + h + \", \" + s + \"%, \" + l + \"%, \"+ this._roundA + \")\";\r\n            },\r\n            toHex: function(allow3Char) {\r\n                return rgbToHex(this._r, this._g, this._b, allow3Char);\r\n            },\r\n            toHexString: function(allow3Char) {\r\n                return '#' + this.toHex(allow3Char);\r\n            },\r\n            toHex8: function() {\r\n                return rgbaToHex(this._r, this._g, this._b, this._a);\r\n            },\r\n            toHex8String: function() {\r\n                return '#' + this.toHex8();\r\n            },\r\n            toRgb: function() {\r\n                return { r: mathRound(this._r), g: mathRound(this._g), b: mathRound(this._b), a: this._a };\r\n            },\r\n            toRgbString: function() {\r\n                return (this._a == 1) ?\r\n                    \"rgb(\"  + mathRound(this._r) + \", \" + mathRound(this._g) + \", \" + mathRound(this._b) + \")\" :\r\n                    \"rgba(\" + mathRound(this._r) + \", \" + mathRound(this._g) + \", \" + mathRound(this._b) + \", \" + this._roundA + \")\";\r\n            },\r\n            toPercentageRgb: function() {\r\n                return { r: mathRound(bound01(this._r, 255) * 100) + \"%\", g: mathRound(bound01(this._g, 255) * 100) + \"%\", b: mathRound(bound01(this._b, 255) * 100) + \"%\", a: this._a };\r\n            },\r\n            toPercentageRgbString: function() {\r\n                return (this._a == 1) ?\r\n                    \"rgb(\"  + mathRound(bound01(this._r, 255) * 100) + \"%, \" + mathRound(bound01(this._g, 255) * 100) + \"%, \" + mathRound(bound01(this._b, 255) * 100) + \"%)\" :\r\n                    \"rgba(\" + mathRound(bound01(this._r, 255) * 100) + \"%, \" + mathRound(bound01(this._g, 255) * 100) + \"%, \" + mathRound(bound01(this._b, 255) * 100) + \"%, \" + this._roundA + \")\";\r\n            },\r\n            toName: function() {\r\n                if (this._a === 0) {\r\n                    return \"transparent\";\r\n                }\r\n\r\n                if (this._a < 1) {\r\n                    return false;\r\n                }\r\n\r\n                return hexNames[rgbToHex(this._r, this._g, this._b, true)] || false;\r\n            },\r\n            toFilter: function(secondColor) {\r\n                var hex8String = '#' + rgbaToHex(this._r, this._g, this._b, this._a);\r\n                var secondHex8String = hex8String;\r\n                var gradientType = this._gradientType ? \"GradientType = 1, \" : \"\";\r\n\r\n                if (secondColor) {\r\n                    var s = tinycolor(secondColor);\r\n                    secondHex8String = s.toHex8String();\r\n                }\r\n\r\n                return \"progid:DXImageTransform.Microsoft.gradient(\"+gradientType+\"startColorstr=\"+hex8String+\",endColorstr=\"+secondHex8String+\")\";\r\n            },\r\n            toString: function(format) {\r\n                var formatSet = !!format;\r\n                format = format || this._format;\r\n\r\n                var formattedString = false;\r\n                var hasAlpha = this._a < 1 && this._a >= 0;\r\n                var needsAlphaFormat = !formatSet && hasAlpha && (format === \"hex\" || format === \"hex6\" || format === \"hex3\" || format === \"name\");\r\n\r\n                if (needsAlphaFormat) {\r\n                    // Special case for \"transparent\", all other non-alpha formats\r\n                    // will return rgba when there is transparency.\r\n                    if (format === \"name\" && this._a === 0) {\r\n                        return this.toName();\r\n                    }\r\n                    return this.toRgbString();\r\n                }\r\n                if (format === \"rgb\") {\r\n                    formattedString = this.toRgbString();\r\n                }\r\n                if (format === \"prgb\") {\r\n                    formattedString = this.toPercentageRgbString();\r\n                }\r\n                if (format === \"hex\" || format === \"hex6\") {\r\n                    formattedString = this.toHexString();\r\n                }\r\n                if (format === \"hex3\") {\r\n                    formattedString = this.toHexString(true);\r\n                }\r\n                if (format === \"hex8\") {\r\n                    formattedString = this.toHex8String();\r\n                }\r\n                if (format === \"name\") {\r\n                    formattedString = this.toName();\r\n                }\r\n                if (format === \"hsl\") {\r\n                    formattedString = this.toHslString();\r\n                }\r\n                if (format === \"hsv\") {\r\n                    formattedString = this.toHsvString();\r\n                }\r\n\r\n                return formattedString || this.toHexString();\r\n            },\r\n\r\n            _applyModification: function(fn, args) {\r\n                var color = fn.apply(null, [this].concat([].slice.call(args)));\r\n                this._r = color._r;\r\n                this._g = color._g;\r\n                this._b = color._b;\r\n                this.setAlpha(color._a);\r\n                return this;\r\n            },\r\n            lighten: function() {\r\n                return this._applyModification(lighten, arguments);\r\n            },\r\n            brighten: function() {\r\n                return this._applyModification(brighten, arguments);\r\n            },\r\n            darken: function() {\r\n                return this._applyModification(darken, arguments);\r\n            },\r\n            desaturate: function() {\r\n                return this._applyModification(desaturate, arguments);\r\n            },\r\n            saturate: function() {\r\n                return this._applyModification(saturate, arguments);\r\n            },\r\n            greyscale: function() {\r\n                return this._applyModification(greyscale, arguments);\r\n            },\r\n            spin: function() {\r\n                return this._applyModification(spin, arguments);\r\n            },\r\n\r\n            _applyCombination: function(fn, args) {\r\n                return fn.apply(null, [this].concat([].slice.call(args)));\r\n            },\r\n            analogous: function() {\r\n                return this._applyCombination(analogous, arguments);\r\n            },\r\n            complement: function() {\r\n                return this._applyCombination(complement, arguments);\r\n            },\r\n            monochromatic: function() {\r\n                return this._applyCombination(monochromatic, arguments);\r\n            },\r\n            splitcomplement: function() {\r\n                return this._applyCombination(splitcomplement, arguments);\r\n            },\r\n            triad: function() {\r\n                return this._applyCombination(triad, arguments);\r\n            },\r\n            tetrad: function() {\r\n                return this._applyCombination(tetrad, arguments);\r\n            }\r\n        };\r\n\r\n        // If input is an object, force 1 into \"1.0\" to handle ratios properly\r\n        // String input requires \"1.0\" as input, so 1 will be treated as 1\r\n        tinycolor.fromRatio = function(color, opts) {\r\n            if (typeof color == \"object\") {\r\n                var newColor = {};\r\n                for (var i in color) {\r\n                    if (color.hasOwnProperty(i)) {\r\n                        if (i === \"a\") {\r\n                            newColor[i] = color[i];\r\n                        }\r\n                        else {\r\n                            newColor[i] = convertToPercentage(color[i]);\r\n                        }\r\n                    }\r\n                }\r\n                color = newColor;\r\n            }\r\n\r\n            return tinycolor(color, opts);\r\n        };\r\n\r\n        // Given a string or object, convert that input to RGB\r\n        // Possible string inputs:\r\n        //\r\n        //     \"red\"\r\n        //     \"#f00\" or \"f00\"\r\n        //     \"#ff0000\" or \"ff0000\"\r\n        //     \"#ff000000\" or \"ff000000\"\r\n        //     \"rgb 255 0 0\" or \"rgb (255, 0, 0)\"\r\n        //     \"rgb 1.0 0 0\" or \"rgb (1, 0, 0)\"\r\n        //     \"rgba (255, 0, 0, 1)\" or \"rgba 255, 0, 0, 1\"\r\n        //     \"rgba (1.0, 0, 0, 1)\" or \"rgba 1.0, 0, 0, 1\"\r\n        //     \"hsl(0, 100%, 50%)\" or \"hsl 0 100% 50%\"\r\n        //     \"hsla(0, 100%, 50%, 1)\" or \"hsla 0 100% 50%, 1\"\r\n        //     \"hsv(0, 100%, 100%)\" or \"hsv 0 100% 100%\"\r\n        //\r\n        function inputToRGB(color) {\r\n\r\n            var rgb = { r: 0, g: 0, b: 0 };\r\n            var a = 1;\r\n            var ok = false;\r\n            var format = false;\r\n\r\n            if (typeof color == \"string\") {\r\n                color = stringInputToObject(color);\r\n            }\r\n\r\n            if (typeof color == \"object\") {\r\n                if (color.hasOwnProperty(\"r\") && color.hasOwnProperty(\"g\") && color.hasOwnProperty(\"b\")) {\r\n                    rgb = rgbToRgb(color.r, color.g, color.b);\r\n                    ok = true;\r\n                    format = String(color.r).substr(-1) === \"%\" ? \"prgb\" : \"rgb\";\r\n                }\r\n                else if (color.hasOwnProperty(\"h\") && color.hasOwnProperty(\"s\") && color.hasOwnProperty(\"v\")) {\r\n                    color.s = convertToPercentage(color.s);\r\n                    color.v = convertToPercentage(color.v);\r\n                    rgb = hsvToRgb(color.h, color.s, color.v);\r\n                    ok = true;\r\n                    format = \"hsv\";\r\n                }\r\n                else if (color.hasOwnProperty(\"h\") && color.hasOwnProperty(\"s\") && color.hasOwnProperty(\"l\")) {\r\n                    color.s = convertToPercentage(color.s);\r\n                    color.l = convertToPercentage(color.l);\r\n                    rgb = hslToRgb(color.h, color.s, color.l);\r\n                    ok = true;\r\n                    format = \"hsl\";\r\n                }\r\n\r\n                if (color.hasOwnProperty(\"a\")) {\r\n                    a = color.a;\r\n                }\r\n            }\r\n\r\n            a = boundAlpha(a);\r\n\r\n            return {\r\n                ok: ok,\r\n                format: color.format || format,\r\n                r: mathMin(255, mathMax(rgb.r, 0)),\r\n                g: mathMin(255, mathMax(rgb.g, 0)),\r\n                b: mathMin(255, mathMax(rgb.b, 0)),\r\n                a: a\r\n            };\r\n        }\r\n\r\n\r\n        // Conversion Functions\r\n        // --------------------\r\n\r\n        // `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:\r\n        // <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>\r\n\r\n        // `rgbToRgb`\r\n        // Handle bounds / percentage checking to conform to CSS color spec\r\n        // <http://www.w3.org/TR/css3-color/>\r\n        // *Assumes:* r, g, b in [0, 255] or [0, 1]\r\n        // *Returns:* { r, g, b } in [0, 255]\r\n        function rgbToRgb(r, g, b){\r\n            return {\r\n                r: bound01(r, 255) * 255,\r\n                g: bound01(g, 255) * 255,\r\n                b: bound01(b, 255) * 255\r\n            };\r\n        }\r\n\r\n        // `rgbToHsl`\r\n        // Converts an RGB color value to HSL.\r\n        // *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]\r\n        // *Returns:* { h, s, l } in [0,1]\r\n        function rgbToHsl(r, g, b) {\r\n\r\n            r = bound01(r, 255);\r\n            g = bound01(g, 255);\r\n            b = bound01(b, 255);\r\n\r\n            var max = mathMax(r, g, b), min = mathMin(r, g, b);\r\n            var h, s, l = (max + min) / 2;\r\n\r\n            if(max == min) {\r\n                h = s = 0; // achromatic\r\n            }\r\n            else {\r\n                var d = max - min;\r\n                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n                switch(max) {\r\n                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;\r\n                    case g: h = (b - r) / d + 2; break;\r\n                    case b: h = (r - g) / d + 4; break;\r\n                }\r\n\r\n                h /= 6;\r\n            }\r\n\r\n            return { h: h, s: s, l: l };\r\n        }\r\n\r\n        // `hslToRgb`\r\n        // Converts an HSL color value to RGB.\r\n        // *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]\r\n        // *Returns:* { r, g, b } in the set [0, 255]\r\n        function hslToRgb(h, s, l) {\r\n            var r, g, b;\r\n\r\n            h = bound01(h, 360);\r\n            s = bound01(s, 100);\r\n            l = bound01(l, 100);\r\n\r\n            function hue2rgb(p, q, t) {\r\n                if(t < 0) t += 1;\r\n                if(t > 1) t -= 1;\r\n                if(t < 1/6) return p + (q - p) * 6 * t;\r\n                if(t < 1/2) return q;\r\n                if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;\r\n                return p;\r\n            }\r\n\r\n            if(s === 0) {\r\n                r = g = b = l; // achromatic\r\n            }\r\n            else {\r\n                var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n                var p = 2 * l - q;\r\n                r = hue2rgb(p, q, h + 1/3);\r\n                g = hue2rgb(p, q, h);\r\n                b = hue2rgb(p, q, h - 1/3);\r\n            }\r\n\r\n            return { r: r * 255, g: g * 255, b: b * 255 };\r\n        }\r\n\r\n        // `rgbToHsv`\r\n        // Converts an RGB color value to HSV\r\n        // *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]\r\n        // *Returns:* { h, s, v } in [0,1]\r\n        function rgbToHsv(r, g, b) {\r\n\r\n            r = bound01(r, 255);\r\n            g = bound01(g, 255);\r\n            b = bound01(b, 255);\r\n\r\n            var max = mathMax(r, g, b), min = mathMin(r, g, b);\r\n            var h, s, v = max;\r\n\r\n            var d = max - min;\r\n            s = max === 0 ? 0 : d / max;\r\n\r\n            if(max == min) {\r\n                h = 0; // achromatic\r\n            }\r\n            else {\r\n                switch(max) {\r\n                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;\r\n                    case g: h = (b - r) / d + 2; break;\r\n                    case b: h = (r - g) / d + 4; break;\r\n                }\r\n                h /= 6;\r\n            }\r\n            return { h: h, s: s, v: v };\r\n        }\r\n\r\n        // `hsvToRgb`\r\n        // Converts an HSV color value to RGB.\r\n        // *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]\r\n        // *Returns:* { r, g, b } in the set [0, 255]\r\n        function hsvToRgb(h, s, v) {\r\n\r\n            h = bound01(h, 360) * 6;\r\n            s = bound01(s, 100);\r\n            v = bound01(v, 100);\r\n\r\n            var i = math.floor(h),\r\n                f = h - i,\r\n                p = v * (1 - s),\r\n                q = v * (1 - f * s),\r\n                t = v * (1 - (1 - f) * s),\r\n                mod = i % 6,\r\n                r = [v, q, p, p, t, v][mod],\r\n                g = [t, v, v, q, p, p][mod],\r\n                b = [p, p, t, v, v, q][mod];\r\n\r\n            return { r: r * 255, g: g * 255, b: b * 255 };\r\n        }\r\n\r\n        // `rgbToHex`\r\n        // Converts an RGB color to hex\r\n        // Assumes r, g, and b are contained in the set [0, 255]\r\n        // Returns a 3 or 6 character hex\r\n        function rgbToHex(r, g, b, allow3Char) {\r\n\r\n            var hex = [\r\n                pad2(mathRound(r).toString(16)),\r\n                pad2(mathRound(g).toString(16)),\r\n                pad2(mathRound(b).toString(16))\r\n            ];\r\n\r\n            // Return a 3 character hex if possible\r\n            if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {\r\n                return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);\r\n            }\r\n\r\n            return hex.join(\"\");\r\n        }\r\n        // `rgbaToHex`\r\n        // Converts an RGBA color plus alpha transparency to hex\r\n        // Assumes r, g, b and a are contained in the set [0, 255]\r\n        // Returns an 8 character hex\r\n        function rgbaToHex(r, g, b, a) {\r\n\r\n            var hex = [\r\n                pad2(convertDecimalToHex(a)),\r\n                pad2(mathRound(r).toString(16)),\r\n                pad2(mathRound(g).toString(16)),\r\n                pad2(mathRound(b).toString(16))\r\n            ];\r\n\r\n            return hex.join(\"\");\r\n        }\r\n\r\n        // `equals`\r\n        // Can be called with any tinycolor input\r\n        tinycolor.equals = function (color1, color2) {\r\n            if (!color1 || !color2) { return false; }\r\n            return tinycolor(color1).toRgbString() == tinycolor(color2).toRgbString();\r\n        };\r\n        tinycolor.random = function() {\r\n            return tinycolor.fromRatio({\r\n                r: mathRandom(),\r\n                g: mathRandom(),\r\n                b: mathRandom()\r\n            });\r\n        };\r\n\r\n\r\n        // Modification Functions\r\n        // ----------------------\r\n        // Thanks to less.js for some of the basics here\r\n        // <https://github.com/cloudhead/less.js/blob/master/lib/less/functions.js>\r\n\r\n        function desaturate(color, amount) {\r\n            amount = (amount === 0) ? 0 : (amount || 10);\r\n            var hsl = tinycolor(color).toHsl();\r\n            hsl.s -= amount / 100;\r\n            hsl.s = clamp01(hsl.s);\r\n            return tinycolor(hsl);\r\n        }\r\n\r\n        function saturate(color, amount) {\r\n            amount = (amount === 0) ? 0 : (amount || 10);\r\n            var hsl = tinycolor(color).toHsl();\r\n            hsl.s += amount / 100;\r\n            hsl.s = clamp01(hsl.s);\r\n            return tinycolor(hsl);\r\n        }\r\n\r\n        function greyscale(color) {\r\n            return tinycolor(color).desaturate(100);\r\n        }\r\n\r\n        function lighten (color, amount) {\r\n            amount = (amount === 0) ? 0 : (amount || 10);\r\n            var hsl = tinycolor(color).toHsl();\r\n            hsl.l += amount / 100;\r\n            hsl.l = clamp01(hsl.l);\r\n            return tinycolor(hsl);\r\n        }\r\n\r\n        function brighten(color, amount) {\r\n            amount = (amount === 0) ? 0 : (amount || 10);\r\n            var rgb = tinycolor(color).toRgb();\r\n            rgb.r = mathMax(0, mathMin(255, rgb.r - mathRound(255 * - (amount / 100))));\r\n            rgb.g = mathMax(0, mathMin(255, rgb.g - mathRound(255 * - (amount / 100))));\r\n            rgb.b = mathMax(0, mathMin(255, rgb.b - mathRound(255 * - (amount / 100))));\r\n            return tinycolor(rgb);\r\n        }\r\n\r\n        function darken (color, amount) {\r\n            amount = (amount === 0) ? 0 : (amount || 10);\r\n            var hsl = tinycolor(color).toHsl();\r\n            hsl.l -= amount / 100;\r\n            hsl.l = clamp01(hsl.l);\r\n            return tinycolor(hsl);\r\n        }\r\n\r\n        // Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.\r\n        // Values outside of this range will be wrapped into this range.\r\n        function spin(color, amount) {\r\n            var hsl = tinycolor(color).toHsl();\r\n            var hue = (mathRound(hsl.h) + amount) % 360;\r\n            hsl.h = hue < 0 ? 360 + hue : hue;\r\n            return tinycolor(hsl);\r\n        }\r\n\r\n        // Combination Functions\r\n        // ---------------------\r\n        // Thanks to jQuery xColor for some of the ideas behind these\r\n        // <https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js>\r\n\r\n        function complement(color) {\r\n            var hsl = tinycolor(color).toHsl();\r\n            hsl.h = (hsl.h + 180) % 360;\r\n            return tinycolor(hsl);\r\n        }\r\n\r\n        function triad(color) {\r\n            var hsl = tinycolor(color).toHsl();\r\n            var h = hsl.h;\r\n            return [\r\n                tinycolor(color),\r\n                tinycolor({ h: (h + 120) % 360, s: hsl.s, l: hsl.l }),\r\n                tinycolor({ h: (h + 240) % 360, s: hsl.s, l: hsl.l })\r\n            ];\r\n        }\r\n\r\n        function tetrad(color) {\r\n            var hsl = tinycolor(color).toHsl();\r\n            var h = hsl.h;\r\n            return [\r\n                tinycolor(color),\r\n                tinycolor({ h: (h + 90) % 360, s: hsl.s, l: hsl.l }),\r\n                tinycolor({ h: (h + 180) % 360, s: hsl.s, l: hsl.l }),\r\n                tinycolor({ h: (h + 270) % 360, s: hsl.s, l: hsl.l })\r\n            ];\r\n        }\r\n\r\n        function splitcomplement(color) {\r\n            var hsl = tinycolor(color).toHsl();\r\n            var h = hsl.h;\r\n            return [\r\n                tinycolor(color),\r\n                tinycolor({ h: (h + 72) % 360, s: hsl.s, l: hsl.l}),\r\n                tinycolor({ h: (h + 216) % 360, s: hsl.s, l: hsl.l})\r\n            ];\r\n        }\r\n\r\n        function analogous(color, results, slices) {\r\n            results = results || 6;\r\n            slices = slices || 30;\r\n\r\n            var hsl = tinycolor(color).toHsl();\r\n            var part = 360 / slices;\r\n            var ret = [tinycolor(color)];\r\n\r\n            for (hsl.h = ((hsl.h - (part * results >> 1)) + 720) % 360; --results; ) {\r\n                hsl.h = (hsl.h + part) % 360;\r\n                ret.push(tinycolor(hsl));\r\n            }\r\n            return ret;\r\n        }\r\n\r\n        function monochromatic(color, results) {\r\n            results = results || 6;\r\n            var hsv = tinycolor(color).toHsv();\r\n            var h = hsv.h, s = hsv.s, v = hsv.v;\r\n            var ret = [];\r\n            var modification = 1 / results;\r\n\r\n            while (results--) {\r\n                ret.push(tinycolor({ h: h, s: s, v: v}));\r\n                v = (v + modification) % 1;\r\n            }\r\n\r\n            return ret;\r\n        }\r\n\r\n        // Utility Functions\r\n        // ---------------------\r\n\r\n        tinycolor.mix = function(color1, color2, amount) {\r\n            amount = (amount === 0) ? 0 : (amount || 50);\r\n\r\n            var rgb1 = tinycolor(color1).toRgb();\r\n            var rgb2 = tinycolor(color2).toRgb();\r\n\r\n            var p = amount / 100;\r\n            var w = p * 2 - 1;\r\n            var a = rgb2.a - rgb1.a;\r\n\r\n            var w1;\r\n\r\n            if (w * a == -1) {\r\n                w1 = w;\r\n            } else {\r\n                w1 = (w + a) / (1 + w * a);\r\n            }\r\n\r\n            w1 = (w1 + 1) / 2;\r\n\r\n            var w2 = 1 - w1;\r\n\r\n            var rgba = {\r\n                r: rgb2.r * w1 + rgb1.r * w2,\r\n                g: rgb2.g * w1 + rgb1.g * w2,\r\n                b: rgb2.b * w1 + rgb1.b * w2,\r\n                a: rgb2.a * p  + rgb1.a * (1 - p)\r\n            };\r\n\r\n            return tinycolor(rgba);\r\n        };\r\n\r\n\r\n        // Readability Functions\r\n        // ---------------------\r\n        // <http://www.w3.org/TR/AERT#color-contrast>\r\n\r\n        // `readability`\r\n        // Analyze the 2 colors and returns an object with the following properties:\r\n        //    `brightness`: difference in brightness between the two colors\r\n        //    `color`: difference in color/hue between the two colors\r\n        tinycolor.readability = function(color1, color2) {\r\n            var c1 = tinycolor(color1);\r\n            var c2 = tinycolor(color2);\r\n            var rgb1 = c1.toRgb();\r\n            var rgb2 = c2.toRgb();\r\n            var brightnessA = c1.getBrightness();\r\n            var brightnessB = c2.getBrightness();\r\n            var colorDiff = (\r\n                Math.max(rgb1.r, rgb2.r) - Math.min(rgb1.r, rgb2.r) +\r\n                Math.max(rgb1.g, rgb2.g) - Math.min(rgb1.g, rgb2.g) +\r\n                Math.max(rgb1.b, rgb2.b) - Math.min(rgb1.b, rgb2.b)\r\n            );\r\n\r\n            return {\r\n                brightness: Math.abs(brightnessA - brightnessB),\r\n                color: colorDiff\r\n            };\r\n        };\r\n\r\n        // `readable`\r\n        // http://www.w3.org/TR/AERT#color-contrast\r\n        // Ensure that foreground and background color combinations provide sufficient contrast.\r\n        // *Example*\r\n        //    tinycolor.isReadable(\"#000\", \"#111\") => false\r\n        tinycolor.isReadable = function(color1, color2) {\r\n            var readability = tinycolor.readability(color1, color2);\r\n            return readability.brightness > 125 && readability.color > 500;\r\n        };\r\n\r\n        // `mostReadable`\r\n        // Given a base color and a list of possible foreground or background\r\n        // colors for that base, returns the most readable color.\r\n        // *Example*\r\n        //    tinycolor.mostReadable(\"#123\", [\"#fff\", \"#000\"]) => \"#000\"\r\n        tinycolor.mostReadable = function(baseColor, colorList) {\r\n            var bestColor = null;\r\n            var bestScore = 0;\r\n            var bestIsReadable = false;\r\n            for (var i=0; i < colorList.length; i++) {\r\n\r\n                // We normalize both around the \"acceptable\" breaking point,\r\n                // but rank brightness constrast higher than hue.\r\n\r\n                var readability = tinycolor.readability(baseColor, colorList[i]);\r\n                var readable = readability.brightness > 125 && readability.color > 500;\r\n                var score = 3 * (readability.brightness / 125) + (readability.color / 500);\r\n\r\n                if ((readable && ! bestIsReadable) ||\r\n                    (readable && bestIsReadable && score > bestScore) ||\r\n                    ((! readable) && (! bestIsReadable) && score > bestScore)) {\r\n                    bestIsReadable = readable;\r\n                    bestScore = score;\r\n                    bestColor = tinycolor(colorList[i]);\r\n                }\r\n            }\r\n            return bestColor;\r\n        };\r\n\r\n\r\n        // Big List of Colors\r\n        // ------------------\r\n        // <http://www.w3.org/TR/css3-color/#svg-color>\r\n        var names = tinycolor.names = {\r\n            aliceblue: \"f0f8ff\",\r\n            antiquewhite: \"faebd7\",\r\n            aqua: \"0ff\",\r\n            aquamarine: \"7fffd4\",\r\n            azure: \"f0ffff\",\r\n            beige: \"f5f5dc\",\r\n            bisque: \"ffe4c4\",\r\n            black: \"000\",\r\n            blanchedalmond: \"ffebcd\",\r\n            blue: \"00f\",\r\n            blueviolet: \"8a2be2\",\r\n            brown: \"a52a2a\",\r\n            burlywood: \"deb887\",\r\n            burntsienna: \"ea7e5d\",\r\n            cadetblue: \"5f9ea0\",\r\n            chartreuse: \"7fff00\",\r\n            chocolate: \"d2691e\",\r\n            coral: \"ff7f50\",\r\n            cornflowerblue: \"6495ed\",\r\n            cornsilk: \"fff8dc\",\r\n            crimson: \"dc143c\",\r\n            cyan: \"0ff\",\r\n            darkblue: \"00008b\",\r\n            darkcyan: \"008b8b\",\r\n            darkgoldenrod: \"b8860b\",\r\n            darkgray: \"a9a9a9\",\r\n            darkgreen: \"006400\",\r\n            darkgrey: \"a9a9a9\",\r\n            darkkhaki: \"bdb76b\",\r\n            darkmagenta: \"8b008b\",\r\n            darkolivegreen: \"556b2f\",\r\n            darkorange: \"ff8c00\",\r\n            darkorchid: \"9932cc\",\r\n            darkred: \"8b0000\",\r\n            darksalmon: \"e9967a\",\r\n            darkseagreen: \"8fbc8f\",\r\n            darkslateblue: \"483d8b\",\r\n            darkslategray: \"2f4f4f\",\r\n            darkslategrey: \"2f4f4f\",\r\n            darkturquoise: \"00ced1\",\r\n            darkviolet: \"9400d3\",\r\n            deeppink: \"ff1493\",\r\n            deepskyblue: \"00bfff\",\r\n            dimgray: \"696969\",\r\n            dimgrey: \"696969\",\r\n            dodgerblue: \"1e90ff\",\r\n            firebrick: \"b22222\",\r\n            floralwhite: \"fffaf0\",\r\n            forestgreen: \"228b22\",\r\n            fuchsia: \"f0f\",\r\n            gainsboro: \"dcdcdc\",\r\n            ghostwhite: \"f8f8ff\",\r\n            gold: \"ffd700\",\r\n            goldenrod: \"daa520\",\r\n            gray: \"808080\",\r\n            green: \"008000\",\r\n            greenyellow: \"adff2f\",\r\n            grey: \"808080\",\r\n            honeydew: \"f0fff0\",\r\n            hotpink: \"ff69b4\",\r\n            indianred: \"cd5c5c\",\r\n            indigo: \"4b0082\",\r\n            ivory: \"fffff0\",\r\n            khaki: \"f0e68c\",\r\n            lavender: \"e6e6fa\",\r\n            lavenderblush: \"fff0f5\",\r\n            lawngreen: \"7cfc00\",\r\n            lemonchiffon: \"fffacd\",\r\n            lightblue: \"add8e6\",\r\n            lightcoral: \"f08080\",\r\n            lightcyan: \"e0ffff\",\r\n            lightgoldenrodyellow: \"fafad2\",\r\n            lightgray: \"d3d3d3\",\r\n            lightgreen: \"90ee90\",\r\n            lightgrey: \"d3d3d3\",\r\n            lightpink: \"ffb6c1\",\r\n            lightsalmon: \"ffa07a\",\r\n            lightseagreen: \"20b2aa\",\r\n            lightskyblue: \"87cefa\",\r\n            lightslategray: \"789\",\r\n            lightslategrey: \"789\",\r\n            lightsteelblue: \"b0c4de\",\r\n            lightyellow: \"ffffe0\",\r\n            lime: \"0f0\",\r\n            limegreen: \"32cd32\",\r\n            linen: \"faf0e6\",\r\n            magenta: \"f0f\",\r\n            maroon: \"800000\",\r\n            mediumaquamarine: \"66cdaa\",\r\n            mediumblue: \"0000cd\",\r\n            mediumorchid: \"ba55d3\",\r\n            mediumpurple: \"9370db\",\r\n            mediumseagreen: \"3cb371\",\r\n            mediumslateblue: \"7b68ee\",\r\n            mediumspringgreen: \"00fa9a\",\r\n            mediumturquoise: \"48d1cc\",\r\n            mediumvioletred: \"c71585\",\r\n            midnightblue: \"191970\",\r\n            mintcream: \"f5fffa\",\r\n            mistyrose: \"ffe4e1\",\r\n            moccasin: \"ffe4b5\",\r\n            navajowhite: \"ffdead\",\r\n            navy: \"000080\",\r\n            oldlace: \"fdf5e6\",\r\n            olive: \"808000\",\r\n            olivedrab: \"6b8e23\",\r\n            orange: \"ffa500\",\r\n            orangered: \"ff4500\",\r\n            orchid: \"da70d6\",\r\n            palegoldenrod: \"eee8aa\",\r\n            palegreen: \"98fb98\",\r\n            paleturquoise: \"afeeee\",\r\n            palevioletred: \"db7093\",\r\n            papayawhip: \"ffefd5\",\r\n            peachpuff: \"ffdab9\",\r\n            peru: \"cd853f\",\r\n            pink: \"ffc0cb\",\r\n            plum: \"dda0dd\",\r\n            powderblue: \"b0e0e6\",\r\n            purple: \"800080\",\r\n            rebeccapurple: \"663399\",\r\n            red: \"f00\",\r\n            rosybrown: \"bc8f8f\",\r\n            royalblue: \"4169e1\",\r\n            saddlebrown: \"8b4513\",\r\n            salmon: \"fa8072\",\r\n            sandybrown: \"f4a460\",\r\n            seagreen: \"2e8b57\",\r\n            seashell: \"fff5ee\",\r\n            sienna: \"a0522d\",\r\n            silver: \"c0c0c0\",\r\n            skyblue: \"87ceeb\",\r\n            slateblue: \"6a5acd\",\r\n            slategray: \"708090\",\r\n            slategrey: \"708090\",\r\n            snow: \"fffafa\",\r\n            springgreen: \"00ff7f\",\r\n            steelblue: \"4682b4\",\r\n            tan: \"d2b48c\",\r\n            teal: \"008080\",\r\n            thistle: \"d8bfd8\",\r\n            tomato: \"ff6347\",\r\n            turquoise: \"40e0d0\",\r\n            violet: \"ee82ee\",\r\n            wheat: \"f5deb3\",\r\n            white: \"fff\",\r\n            whitesmoke: \"f5f5f5\",\r\n            yellow: \"ff0\",\r\n            yellowgreen: \"9acd32\"\r\n        };\r\n\r\n        // Make it easy to access colors via `hexNames[hex]`\r\n        var hexNames = tinycolor.hexNames = flip(names);\r\n\r\n\r\n        // Utilities\r\n        // ---------\r\n\r\n        // `{ 'name1': 'val1' }` becomes `{ 'val1': 'name1' }`\r\n        function flip(o) {\r\n            var flipped = { };\r\n            for (var i in o) {\r\n                if (o.hasOwnProperty(i)) {\r\n                    flipped[o[i]] = i;\r\n                }\r\n            }\r\n            return flipped;\r\n        }\r\n\r\n        // Return a valid alpha value [0,1] with all invalid values being set to 1\r\n        function boundAlpha(a) {\r\n            a = parseFloat(a);\r\n\r\n            if (isNaN(a) || a < 0 || a > 1) {\r\n                a = 1;\r\n            }\r\n\r\n            return a;\r\n        }\r\n\r\n        // Take input from [0, n] and return it as [0, 1]\r\n        function bound01(n, max) {\r\n            if (isOnePointZero(n)) { n = \"100%\"; }\r\n\r\n            var processPercent = isPercentage(n);\r\n            n = mathMin(max, mathMax(0, parseFloat(n)));\r\n\r\n            // Automatically convert percentage into number\r\n            if (processPercent) {\r\n                n = parseInt(n * max, 10) / 100;\r\n            }\r\n\r\n            // Handle floating point rounding errors\r\n            if ((math.abs(n - max) < 0.000001)) {\r\n                return 1;\r\n            }\r\n\r\n            // Convert into [0, 1] range if it isn't already\r\n            return (n % max) / parseFloat(max);\r\n        }\r\n\r\n        // Force a number between 0 and 1\r\n        function clamp01(val) {\r\n            return mathMin(1, mathMax(0, val));\r\n        }\r\n\r\n        // Parse a base-16 hex value into a base-10 integer\r\n        function parseIntFromHex(val) {\r\n            return parseInt(val, 16);\r\n        }\r\n\r\n        // Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1\r\n        // <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>\r\n        function isOnePointZero(n) {\r\n            return typeof n == \"string\" && n.indexOf('.') != -1 && parseFloat(n) === 1;\r\n        }\r\n\r\n        // Check to see if string passed in is a percentage\r\n        function isPercentage(n) {\r\n            return typeof n === \"string\" && n.indexOf('%') != -1;\r\n        }\r\n\r\n        // Force a hex value to have 2 characters\r\n        function pad2(c) {\r\n            return c.length == 1 ? '0' + c : '' + c;\r\n        }\r\n\r\n        // Replace a decimal with it's percentage value\r\n        function convertToPercentage(n) {\r\n            if (n <= 1) {\r\n                n = (n * 100) + \"%\";\r\n            }\r\n\r\n            return n;\r\n        }\r\n\r\n        // Converts a decimal to a hex value\r\n        function convertDecimalToHex(d) {\r\n            return Math.round(parseFloat(d) * 255).toString(16);\r\n        }\r\n        // Converts a hex value to a decimal\r\n        function convertHexToDecimal(h) {\r\n            return (parseIntFromHex(h) / 255);\r\n        }\r\n\r\n        var matchers = (function() {\r\n\r\n            // <http://www.w3.org/TR/css3-values/#integers>\r\n            var CSS_INTEGER = \"[-\\\\+]?\\\\d+%?\";\r\n\r\n            // <http://www.w3.org/TR/css3-values/#number-value>\r\n            var CSS_NUMBER = \"[-\\\\+]?\\\\d*\\\\.\\\\d+%?\";\r\n\r\n            // Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.\r\n            var CSS_UNIT = \"(?:\" + CSS_NUMBER + \")|(?:\" + CSS_INTEGER + \")\";\r\n\r\n            // Actual matching.\r\n            // Parentheses and commas are optional, but not required.\r\n            // Whitespace can take the place of commas or opening paren\r\n            var PERMISSIVE_MATCH3 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\r\n            var PERMISSIVE_MATCH4 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\r\n\r\n            return {\r\n                rgb: new RegExp(\"rgb\" + PERMISSIVE_MATCH3),\r\n                rgba: new RegExp(\"rgba\" + PERMISSIVE_MATCH4),\r\n                hsl: new RegExp(\"hsl\" + PERMISSIVE_MATCH3),\r\n                hsla: new RegExp(\"hsla\" + PERMISSIVE_MATCH4),\r\n                hsv: new RegExp(\"hsv\" + PERMISSIVE_MATCH3),\r\n                hsva: new RegExp(\"hsva\" + PERMISSIVE_MATCH4),\r\n                hex3: /^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\r\n                hex6: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\r\n                hex8: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/\r\n            };\r\n        })();\r\n\r\n        // `stringInputToObject`\r\n        // Permissive string parsing.  Take in a number of formats, and output an object\r\n        // based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`\r\n        function stringInputToObject(color) {\r\n\r\n            color = color.replace(trimLeft,'').replace(trimRight, '').toLowerCase();\r\n            var named = false;\r\n            if (names[color]) {\r\n                color = names[color];\r\n                named = true;\r\n            }\r\n            else if (color == 'transparent') {\r\n                return { r: 0, g: 0, b: 0, a: 0, format: \"name\" };\r\n            }\r\n\r\n            // Try to match string input using regular expressions.\r\n            // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]\r\n            // Just return an object and let the conversion functions handle that.\r\n            // This way the result will be the same whether the tinycolor is initialized with string or object.\r\n            var match;\r\n            if ((match = matchers.rgb.exec(color))) {\r\n                return { r: match[1], g: match[2], b: match[3] };\r\n            }\r\n            if ((match = matchers.rgba.exec(color))) {\r\n                return { r: match[1], g: match[2], b: match[3], a: match[4] };\r\n            }\r\n            if ((match = matchers.hsl.exec(color))) {\r\n                return { h: match[1], s: match[2], l: match[3] };\r\n            }\r\n            if ((match = matchers.hsla.exec(color))) {\r\n                return { h: match[1], s: match[2], l: match[3], a: match[4] };\r\n            }\r\n            if ((match = matchers.hsv.exec(color))) {\r\n                return { h: match[1], s: match[2], v: match[3] };\r\n            }\r\n            if ((match = matchers.hsva.exec(color))) {\r\n                return { h: match[1], s: match[2], v: match[3], a: match[4] };\r\n            }\r\n            if ((match = matchers.hex8.exec(color))) {\r\n                return {\r\n                    a: convertHexToDecimal(match[1]),\r\n                    r: parseIntFromHex(match[2]),\r\n                    g: parseIntFromHex(match[3]),\r\n                    b: parseIntFromHex(match[4]),\r\n                    format: named ? \"name\" : \"hex8\"\r\n                };\r\n            }\r\n            if ((match = matchers.hex6.exec(color))) {\r\n                return {\r\n                    r: parseIntFromHex(match[1]),\r\n                    g: parseIntFromHex(match[2]),\r\n                    b: parseIntFromHex(match[3]),\r\n                    format: named ? \"name\" : \"hex\"\r\n                };\r\n            }\r\n            if ((match = matchers.hex3.exec(color))) {\r\n                return {\r\n                    r: parseIntFromHex(match[1] + '' + match[1]),\r\n                    g: parseIntFromHex(match[2] + '' + match[2]),\r\n                    b: parseIntFromHex(match[3] + '' + match[3]),\r\n                    format: named ? \"name\" : \"hex\"\r\n                };\r\n            }\r\n\r\n            return false;\r\n        }\r\n\r\n        window.tinycolor = tinycolor;\r\n    })();\r\n\r\n    $(function () {\r\n        if ($.fn.spectrum.load) {\r\n            $.fn.spectrum.processNativeColorInputs();\r\n        }\r\n    });\r\n\r\n});\r\n","jquery/spectrum/tinycolor.js":"// TinyColor v1.4.1\r\n// https://github.com/bgrins/TinyColor\r\n// Brian Grinstead, MIT License\r\n\r\n(function(Math) {\r\n\r\n    var trimLeft = /^\\s+/,\r\n        trimRight = /\\s+$/,\r\n        tinyCounter = 0,\r\n        mathRound = Math.round,\r\n        mathMin = Math.min,\r\n        mathMax = Math.max,\r\n        mathRandom = Math.random;\r\n\r\n    function tinycolor (color, opts) {\r\n\r\n        color = (color) ? color : '';\r\n        opts = opts || { };\r\n\r\n        // If input is already a tinycolor, return itself\r\n        if (color instanceof tinycolor) {\r\n            return color;\r\n        }\r\n        // If we are called as a function, call using new instead\r\n        if (!(this instanceof tinycolor)) {\r\n            return new tinycolor(color, opts);\r\n        }\r\n\r\n        var rgb = inputToRGB(color);\r\n        this._originalInput = color,\r\n            this._r = rgb.r,\r\n            this._g = rgb.g,\r\n            this._b = rgb.b,\r\n            this._a = rgb.a,\r\n            this._roundA = mathRound(100*this._a) / 100,\r\n            this._format = opts.format || rgb.format;\r\n        this._gradientType = opts.gradientType;\r\n\r\n        // Don't let the range of [0,255] come back in [0,1].\r\n        // Potentially lose a little bit of precision here, but will fix issues where\r\n        // .5 gets interpreted as half of the total, instead of half of 1\r\n        // If it was supposed to be 128, this was already taken care of by `inputToRgb`\r\n        if (this._r < 1) { this._r = mathRound(this._r); }\r\n        if (this._g < 1) { this._g = mathRound(this._g); }\r\n        if (this._b < 1) { this._b = mathRound(this._b); }\r\n\r\n        this._ok = rgb.ok;\r\n        this._tc_id = tinyCounter++;\r\n    }\r\n\r\n    tinycolor.prototype = {\r\n        isDark: function() {\r\n            return this.getBrightness() < 128;\r\n        },\r\n        isLight: function() {\r\n            return !this.isDark();\r\n        },\r\n        isValid: function() {\r\n            return this._ok;\r\n        },\r\n        getOriginalInput: function() {\r\n            return this._originalInput;\r\n        },\r\n        getFormat: function() {\r\n            return this._format;\r\n        },\r\n        getAlpha: function() {\r\n            return this._a;\r\n        },\r\n        getBrightness: function() {\r\n            //http://www.w3.org/TR/AERT#color-contrast\r\n            var rgb = this.toRgb();\r\n            return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;\r\n        },\r\n        getLuminance: function() {\r\n            //http://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef\r\n            var rgb = this.toRgb();\r\n            var RsRGB, GsRGB, BsRGB, R, G, B;\r\n            RsRGB = rgb.r/255;\r\n            GsRGB = rgb.g/255;\r\n            BsRGB = rgb.b/255;\r\n\r\n            if (RsRGB <= 0.03928) {R = RsRGB / 12.92;} else {R = Math.pow(((RsRGB + 0.055) / 1.055), 2.4);}\r\n            if (GsRGB <= 0.03928) {G = GsRGB / 12.92;} else {G = Math.pow(((GsRGB + 0.055) / 1.055), 2.4);}\r\n            if (BsRGB <= 0.03928) {B = BsRGB / 12.92;} else {B = Math.pow(((BsRGB + 0.055) / 1.055), 2.4);}\r\n            return (0.2126 * R) + (0.7152 * G) + (0.0722 * B);\r\n        },\r\n        setAlpha: function(value) {\r\n            this._a = boundAlpha(value);\r\n            this._roundA = mathRound(100*this._a) / 100;\r\n            return this;\r\n        },\r\n        toHsv: function() {\r\n            var hsv = rgbToHsv(this._r, this._g, this._b);\r\n            return { h: hsv.h * 360, s: hsv.s, v: hsv.v, a: this._a };\r\n        },\r\n        toHsvString: function() {\r\n            var hsv = rgbToHsv(this._r, this._g, this._b);\r\n            var h = mathRound(hsv.h * 360), s = mathRound(hsv.s * 100), v = mathRound(hsv.v * 100);\r\n            return (this._a == 1) ?\r\n                \"hsv(\"  + h + \", \" + s + \"%, \" + v + \"%)\" :\r\n                \"hsva(\" + h + \", \" + s + \"%, \" + v + \"%, \"+ this._roundA + \")\";\r\n        },\r\n        toHsl: function() {\r\n            var hsl = rgbToHsl(this._r, this._g, this._b);\r\n            return { h: hsl.h * 360, s: hsl.s, l: hsl.l, a: this._a };\r\n        },\r\n        toHslString: function() {\r\n            var hsl = rgbToHsl(this._r, this._g, this._b);\r\n            var h = mathRound(hsl.h * 360), s = mathRound(hsl.s * 100), l = mathRound(hsl.l * 100);\r\n            return (this._a == 1) ?\r\n                \"hsl(\"  + h + \", \" + s + \"%, \" + l + \"%)\" :\r\n                \"hsla(\" + h + \", \" + s + \"%, \" + l + \"%, \"+ this._roundA + \")\";\r\n        },\r\n        toHex: function(allow3Char) {\r\n            return rgbToHex(this._r, this._g, this._b, allow3Char);\r\n        },\r\n        toHexString: function(allow3Char) {\r\n            return '#' + this.toHex(allow3Char);\r\n        },\r\n        toHex8: function(allow4Char) {\r\n            return rgbaToHex(this._r, this._g, this._b, this._a, allow4Char);\r\n        },\r\n        toHex8String: function(allow4Char) {\r\n            return '#' + this.toHex8(allow4Char);\r\n        },\r\n        toRgb: function() {\r\n            return { r: mathRound(this._r), g: mathRound(this._g), b: mathRound(this._b), a: this._a };\r\n        },\r\n        toRgbString: function() {\r\n            return (this._a == 1) ?\r\n                \"rgb(\"  + mathRound(this._r) + \", \" + mathRound(this._g) + \", \" + mathRound(this._b) + \")\" :\r\n                \"rgba(\" + mathRound(this._r) + \", \" + mathRound(this._g) + \", \" + mathRound(this._b) + \", \" + this._roundA + \")\";\r\n        },\r\n        toPercentageRgb: function() {\r\n            return { r: mathRound(bound01(this._r, 255) * 100) + \"%\", g: mathRound(bound01(this._g, 255) * 100) + \"%\", b: mathRound(bound01(this._b, 255) * 100) + \"%\", a: this._a };\r\n        },\r\n        toPercentageRgbString: function() {\r\n            return (this._a == 1) ?\r\n                \"rgb(\"  + mathRound(bound01(this._r, 255) * 100) + \"%, \" + mathRound(bound01(this._g, 255) * 100) + \"%, \" + mathRound(bound01(this._b, 255) * 100) + \"%)\" :\r\n                \"rgba(\" + mathRound(bound01(this._r, 255) * 100) + \"%, \" + mathRound(bound01(this._g, 255) * 100) + \"%, \" + mathRound(bound01(this._b, 255) * 100) + \"%, \" + this._roundA + \")\";\r\n        },\r\n        toName: function() {\r\n            if (this._a === 0) {\r\n                return \"transparent\";\r\n            }\r\n\r\n            if (this._a < 1) {\r\n                return false;\r\n            }\r\n\r\n            return hexNames[rgbToHex(this._r, this._g, this._b, true)] || false;\r\n        },\r\n        toFilter: function(secondColor) {\r\n            var hex8String = '#' + rgbaToArgbHex(this._r, this._g, this._b, this._a);\r\n            var secondHex8String = hex8String;\r\n            var gradientType = this._gradientType ? \"GradientType = 1, \" : \"\";\r\n\r\n            if (secondColor) {\r\n                var s = tinycolor(secondColor);\r\n                secondHex8String = '#' + rgbaToArgbHex(s._r, s._g, s._b, s._a);\r\n            }\r\n\r\n            return \"progid:DXImageTransform.Microsoft.gradient(\"+gradientType+\"startColorstr=\"+hex8String+\",endColorstr=\"+secondHex8String+\")\";\r\n        },\r\n        toString: function(format) {\r\n            var formatSet = !!format;\r\n            format = format || this._format;\r\n\r\n            var formattedString = false;\r\n            var hasAlpha = this._a < 1 && this._a >= 0;\r\n            var needsAlphaFormat = !formatSet && hasAlpha && (format === \"hex\" || format === \"hex6\" || format === \"hex3\" || format === \"hex4\" || format === \"hex8\" || format === \"name\");\r\n\r\n            if (needsAlphaFormat) {\r\n                // Special case for \"transparent\", all other non-alpha formats\r\n                // will return rgba when there is transparency.\r\n                if (format === \"name\" && this._a === 0) {\r\n                    return this.toName();\r\n                }\r\n                return this.toRgbString();\r\n            }\r\n            if (format === \"rgb\") {\r\n                formattedString = this.toRgbString();\r\n            }\r\n            if (format === \"prgb\") {\r\n                formattedString = this.toPercentageRgbString();\r\n            }\r\n            if (format === \"hex\" || format === \"hex6\") {\r\n                formattedString = this.toHexString();\r\n            }\r\n            if (format === \"hex3\") {\r\n                formattedString = this.toHexString(true);\r\n            }\r\n            if (format === \"hex4\") {\r\n                formattedString = this.toHex8String(true);\r\n            }\r\n            if (format === \"hex8\") {\r\n                formattedString = this.toHex8String();\r\n            }\r\n            if (format === \"name\") {\r\n                formattedString = this.toName();\r\n            }\r\n            if (format === \"hsl\") {\r\n                formattedString = this.toHslString();\r\n            }\r\n            if (format === \"hsv\") {\r\n                formattedString = this.toHsvString();\r\n            }\r\n\r\n            return formattedString || this.toHexString();\r\n        },\r\n        clone: function() {\r\n            return tinycolor(this.toString());\r\n        },\r\n\r\n        _applyModification: function(fn, args) {\r\n            var color = fn.apply(null, [this].concat([].slice.call(args)));\r\n            this._r = color._r;\r\n            this._g = color._g;\r\n            this._b = color._b;\r\n            this.setAlpha(color._a);\r\n            return this;\r\n        },\r\n        lighten: function() {\r\n            return this._applyModification(lighten, arguments);\r\n        },\r\n        brighten: function() {\r\n            return this._applyModification(brighten, arguments);\r\n        },\r\n        darken: function() {\r\n            return this._applyModification(darken, arguments);\r\n        },\r\n        desaturate: function() {\r\n            return this._applyModification(desaturate, arguments);\r\n        },\r\n        saturate: function() {\r\n            return this._applyModification(saturate, arguments);\r\n        },\r\n        greyscale: function() {\r\n            return this._applyModification(greyscale, arguments);\r\n        },\r\n        spin: function() {\r\n            return this._applyModification(spin, arguments);\r\n        },\r\n\r\n        _applyCombination: function(fn, args) {\r\n            return fn.apply(null, [this].concat([].slice.call(args)));\r\n        },\r\n        analogous: function() {\r\n            return this._applyCombination(analogous, arguments);\r\n        },\r\n        complement: function() {\r\n            return this._applyCombination(complement, arguments);\r\n        },\r\n        monochromatic: function() {\r\n            return this._applyCombination(monochromatic, arguments);\r\n        },\r\n        splitcomplement: function() {\r\n            return this._applyCombination(splitcomplement, arguments);\r\n        },\r\n        triad: function() {\r\n            return this._applyCombination(triad, arguments);\r\n        },\r\n        tetrad: function() {\r\n            return this._applyCombination(tetrad, arguments);\r\n        }\r\n    };\r\n\r\n// If input is an object, force 1 into \"1.0\" to handle ratios properly\r\n// String input requires \"1.0\" as input, so 1 will be treated as 1\r\n    tinycolor.fromRatio = function(color, opts) {\r\n        if (typeof color == \"object\") {\r\n            var newColor = {};\r\n            for (var i in color) {\r\n                if (color.hasOwnProperty(i)) {\r\n                    if (i === \"a\") {\r\n                        newColor[i] = color[i];\r\n                    }\r\n                    else {\r\n                        newColor[i] = convertToPercentage(color[i]);\r\n                    }\r\n                }\r\n            }\r\n            color = newColor;\r\n        }\r\n\r\n        return tinycolor(color, opts);\r\n    };\r\n\r\n// Given a string or object, convert that input to RGB\r\n// Possible string inputs:\r\n//\r\n//     \"red\"\r\n//     \"#f00\" or \"f00\"\r\n//     \"#ff0000\" or \"ff0000\"\r\n//     \"#ff000000\" or \"ff000000\"\r\n//     \"rgb 255 0 0\" or \"rgb (255, 0, 0)\"\r\n//     \"rgb 1.0 0 0\" or \"rgb (1, 0, 0)\"\r\n//     \"rgba (255, 0, 0, 1)\" or \"rgba 255, 0, 0, 1\"\r\n//     \"rgba (1.0, 0, 0, 1)\" or \"rgba 1.0, 0, 0, 1\"\r\n//     \"hsl(0, 100%, 50%)\" or \"hsl 0 100% 50%\"\r\n//     \"hsla(0, 100%, 50%, 1)\" or \"hsla 0 100% 50%, 1\"\r\n//     \"hsv(0, 100%, 100%)\" or \"hsv 0 100% 100%\"\r\n//\r\n    function inputToRGB(color) {\r\n\r\n        var rgb = { r: 0, g: 0, b: 0 };\r\n        var a = 1;\r\n        var s = null;\r\n        var v = null;\r\n        var l = null;\r\n        var ok = false;\r\n        var format = false;\r\n\r\n        if (typeof color == \"string\") {\r\n            color = stringInputToObject(color);\r\n        }\r\n\r\n        if (typeof color == \"object\") {\r\n            if (isValidCSSUnit(color.r) && isValidCSSUnit(color.g) && isValidCSSUnit(color.b)) {\r\n                rgb = rgbToRgb(color.r, color.g, color.b);\r\n                ok = true;\r\n                format = String(color.r).substr(-1) === \"%\" ? \"prgb\" : \"rgb\";\r\n            }\r\n            else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.v)) {\r\n                s = convertToPercentage(color.s);\r\n                v = convertToPercentage(color.v);\r\n                rgb = hsvToRgb(color.h, s, v);\r\n                ok = true;\r\n                format = \"hsv\";\r\n            }\r\n            else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.l)) {\r\n                s = convertToPercentage(color.s);\r\n                l = convertToPercentage(color.l);\r\n                rgb = hslToRgb(color.h, s, l);\r\n                ok = true;\r\n                format = \"hsl\";\r\n            }\r\n\r\n            if (color.hasOwnProperty(\"a\")) {\r\n                a = color.a;\r\n            }\r\n        }\r\n\r\n        a = boundAlpha(a);\r\n\r\n        return {\r\n            ok: ok,\r\n            format: color.format || format,\r\n            r: mathMin(255, mathMax(rgb.r, 0)),\r\n            g: mathMin(255, mathMax(rgb.g, 0)),\r\n            b: mathMin(255, mathMax(rgb.b, 0)),\r\n            a: a\r\n        };\r\n    }\r\n\r\n\r\n// Conversion Functions\r\n// --------------------\r\n\r\n// `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:\r\n// <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>\r\n\r\n// `rgbToRgb`\r\n// Handle bounds / percentage checking to conform to CSS color spec\r\n// <http://www.w3.org/TR/css3-color/>\r\n// *Assumes:* r, g, b in [0, 255] or [0, 1]\r\n// *Returns:* { r, g, b } in [0, 255]\r\n    function rgbToRgb(r, g, b){\r\n        return {\r\n            r: bound01(r, 255) * 255,\r\n            g: bound01(g, 255) * 255,\r\n            b: bound01(b, 255) * 255\r\n        };\r\n    }\r\n\r\n// `rgbToHsl`\r\n// Converts an RGB color value to HSL.\r\n// *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]\r\n// *Returns:* { h, s, l } in [0,1]\r\n    function rgbToHsl(r, g, b) {\r\n\r\n        r = bound01(r, 255);\r\n        g = bound01(g, 255);\r\n        b = bound01(b, 255);\r\n\r\n        var max = mathMax(r, g, b), min = mathMin(r, g, b);\r\n        var h, s, l = (max + min) / 2;\r\n\r\n        if(max == min) {\r\n            h = s = 0; // achromatic\r\n        }\r\n        else {\r\n            var d = max - min;\r\n            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n            switch(max) {\r\n                case r: h = (g - b) / d + (g < b ? 6 : 0); break;\r\n                case g: h = (b - r) / d + 2; break;\r\n                case b: h = (r - g) / d + 4; break;\r\n            }\r\n\r\n            h /= 6;\r\n        }\r\n\r\n        return { h: h, s: s, l: l };\r\n    }\r\n\r\n// `hslToRgb`\r\n// Converts an HSL color value to RGB.\r\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]\r\n// *Returns:* { r, g, b } in the set [0, 255]\r\n    function hslToRgb(h, s, l) {\r\n        var r, g, b;\r\n\r\n        h = bound01(h, 360);\r\n        s = bound01(s, 100);\r\n        l = bound01(l, 100);\r\n\r\n        function hue2rgb(p, q, t) {\r\n            if(t < 0) t += 1;\r\n            if(t > 1) t -= 1;\r\n            if(t < 1/6) return p + (q - p) * 6 * t;\r\n            if(t < 1/2) return q;\r\n            if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;\r\n            return p;\r\n        }\r\n\r\n        if(s === 0) {\r\n            r = g = b = l; // achromatic\r\n        }\r\n        else {\r\n            var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n            var p = 2 * l - q;\r\n            r = hue2rgb(p, q, h + 1/3);\r\n            g = hue2rgb(p, q, h);\r\n            b = hue2rgb(p, q, h - 1/3);\r\n        }\r\n\r\n        return { r: r * 255, g: g * 255, b: b * 255 };\r\n    }\r\n\r\n// `rgbToHsv`\r\n// Converts an RGB color value to HSV\r\n// *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]\r\n// *Returns:* { h, s, v } in [0,1]\r\n    function rgbToHsv(r, g, b) {\r\n\r\n        r = bound01(r, 255);\r\n        g = bound01(g, 255);\r\n        b = bound01(b, 255);\r\n\r\n        var max = mathMax(r, g, b), min = mathMin(r, g, b);\r\n        var h, s, v = max;\r\n\r\n        var d = max - min;\r\n        s = max === 0 ? 0 : d / max;\r\n\r\n        if(max == min) {\r\n            h = 0; // achromatic\r\n        }\r\n        else {\r\n            switch(max) {\r\n                case r: h = (g - b) / d + (g < b ? 6 : 0); break;\r\n                case g: h = (b - r) / d + 2; break;\r\n                case b: h = (r - g) / d + 4; break;\r\n            }\r\n            h /= 6;\r\n        }\r\n        return { h: h, s: s, v: v };\r\n    }\r\n\r\n// `hsvToRgb`\r\n// Converts an HSV color value to RGB.\r\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]\r\n// *Returns:* { r, g, b } in the set [0, 255]\r\n    function hsvToRgb(h, s, v) {\r\n\r\n        h = bound01(h, 360) * 6;\r\n        s = bound01(s, 100);\r\n        v = bound01(v, 100);\r\n\r\n        var i = Math.floor(h),\r\n            f = h - i,\r\n            p = v * (1 - s),\r\n            q = v * (1 - f * s),\r\n            t = v * (1 - (1 - f) * s),\r\n            mod = i % 6,\r\n            r = [v, q, p, p, t, v][mod],\r\n            g = [t, v, v, q, p, p][mod],\r\n            b = [p, p, t, v, v, q][mod];\r\n\r\n        return { r: r * 255, g: g * 255, b: b * 255 };\r\n    }\r\n\r\n// `rgbToHex`\r\n// Converts an RGB color to hex\r\n// Assumes r, g, and b are contained in the set [0, 255]\r\n// Returns a 3 or 6 character hex\r\n    function rgbToHex(r, g, b, allow3Char) {\r\n\r\n        var hex = [\r\n            pad2(mathRound(r).toString(16)),\r\n            pad2(mathRound(g).toString(16)),\r\n            pad2(mathRound(b).toString(16))\r\n        ];\r\n\r\n        // Return a 3 character hex if possible\r\n        if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {\r\n            return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);\r\n        }\r\n\r\n        return hex.join(\"\");\r\n    }\r\n\r\n// `rgbaToHex`\r\n// Converts an RGBA color plus alpha transparency to hex\r\n// Assumes r, g, b are contained in the set [0, 255] and\r\n// a in [0, 1]. Returns a 4 or 8 character rgba hex\r\n    function rgbaToHex(r, g, b, a, allow4Char) {\r\n\r\n        var hex = [\r\n            pad2(mathRound(r).toString(16)),\r\n            pad2(mathRound(g).toString(16)),\r\n            pad2(mathRound(b).toString(16)),\r\n            pad2(convertDecimalToHex(a))\r\n        ];\r\n\r\n        // Return a 4 character hex if possible\r\n        if (allow4Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1) && hex[3].charAt(0) == hex[3].charAt(1)) {\r\n            return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0) + hex[3].charAt(0);\r\n        }\r\n\r\n        return hex.join(\"\");\r\n    }\r\n\r\n// `rgbaToArgbHex`\r\n// Converts an RGBA color to an ARGB Hex8 string\r\n// Rarely used, but required for \"toFilter()\"\r\n    function rgbaToArgbHex(r, g, b, a) {\r\n\r\n        var hex = [\r\n            pad2(convertDecimalToHex(a)),\r\n            pad2(mathRound(r).toString(16)),\r\n            pad2(mathRound(g).toString(16)),\r\n            pad2(mathRound(b).toString(16))\r\n        ];\r\n\r\n        return hex.join(\"\");\r\n    }\r\n\r\n// `equals`\r\n// Can be called with any tinycolor input\r\n    tinycolor.equals = function (color1, color2) {\r\n        if (!color1 || !color2) { return false; }\r\n        return tinycolor(color1).toRgbString() == tinycolor(color2).toRgbString();\r\n    };\r\n\r\n    tinycolor.random = function() {\r\n        return tinycolor.fromRatio({\r\n            r: mathRandom(),\r\n            g: mathRandom(),\r\n            b: mathRandom()\r\n        });\r\n    };\r\n\r\n\r\n// Modification Functions\r\n// ----------------------\r\n// Thanks to less.js for some of the basics here\r\n// <https://github.com/cloudhead/less.js/blob/master/lib/less/functions.js>\r\n\r\n    function desaturate(color, amount) {\r\n        amount = (amount === 0) ? 0 : (amount || 10);\r\n        var hsl = tinycolor(color).toHsl();\r\n        hsl.s -= amount / 100;\r\n        hsl.s = clamp01(hsl.s);\r\n        return tinycolor(hsl);\r\n    }\r\n\r\n    function saturate(color, amount) {\r\n        amount = (amount === 0) ? 0 : (amount || 10);\r\n        var hsl = tinycolor(color).toHsl();\r\n        hsl.s += amount / 100;\r\n        hsl.s = clamp01(hsl.s);\r\n        return tinycolor(hsl);\r\n    }\r\n\r\n    function greyscale(color) {\r\n        return tinycolor(color).desaturate(100);\r\n    }\r\n\r\n    function lighten (color, amount) {\r\n        amount = (amount === 0) ? 0 : (amount || 10);\r\n        var hsl = tinycolor(color).toHsl();\r\n        hsl.l += amount / 100;\r\n        hsl.l = clamp01(hsl.l);\r\n        return tinycolor(hsl);\r\n    }\r\n\r\n    function brighten(color, amount) {\r\n        amount = (amount === 0) ? 0 : (amount || 10);\r\n        var rgb = tinycolor(color).toRgb();\r\n        rgb.r = mathMax(0, mathMin(255, rgb.r - mathRound(255 * - (amount / 100))));\r\n        rgb.g = mathMax(0, mathMin(255, rgb.g - mathRound(255 * - (amount / 100))));\r\n        rgb.b = mathMax(0, mathMin(255, rgb.b - mathRound(255 * - (amount / 100))));\r\n        return tinycolor(rgb);\r\n    }\r\n\r\n    function darken (color, amount) {\r\n        amount = (amount === 0) ? 0 : (amount || 10);\r\n        var hsl = tinycolor(color).toHsl();\r\n        hsl.l -= amount / 100;\r\n        hsl.l = clamp01(hsl.l);\r\n        return tinycolor(hsl);\r\n    }\r\n\r\n// Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.\r\n// Values outside of this range will be wrapped into this range.\r\n    function spin(color, amount) {\r\n        var hsl = tinycolor(color).toHsl();\r\n        var hue = (hsl.h + amount) % 360;\r\n        hsl.h = hue < 0 ? 360 + hue : hue;\r\n        return tinycolor(hsl);\r\n    }\r\n\r\n// Combination Functions\r\n// ---------------------\r\n// Thanks to jQuery xColor for some of the ideas behind these\r\n// <https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js>\r\n\r\n    function complement(color) {\r\n        var hsl = tinycolor(color).toHsl();\r\n        hsl.h = (hsl.h + 180) % 360;\r\n        return tinycolor(hsl);\r\n    }\r\n\r\n    function triad(color) {\r\n        var hsl = tinycolor(color).toHsl();\r\n        var h = hsl.h;\r\n        return [\r\n            tinycolor(color),\r\n            tinycolor({ h: (h + 120) % 360, s: hsl.s, l: hsl.l }),\r\n            tinycolor({ h: (h + 240) % 360, s: hsl.s, l: hsl.l })\r\n        ];\r\n    }\r\n\r\n    function tetrad(color) {\r\n        var hsl = tinycolor(color).toHsl();\r\n        var h = hsl.h;\r\n        return [\r\n            tinycolor(color),\r\n            tinycolor({ h: (h + 90) % 360, s: hsl.s, l: hsl.l }),\r\n            tinycolor({ h: (h + 180) % 360, s: hsl.s, l: hsl.l }),\r\n            tinycolor({ h: (h + 270) % 360, s: hsl.s, l: hsl.l })\r\n        ];\r\n    }\r\n\r\n    function splitcomplement(color) {\r\n        var hsl = tinycolor(color).toHsl();\r\n        var h = hsl.h;\r\n        return [\r\n            tinycolor(color),\r\n            tinycolor({ h: (h + 72) % 360, s: hsl.s, l: hsl.l}),\r\n            tinycolor({ h: (h + 216) % 360, s: hsl.s, l: hsl.l})\r\n        ];\r\n    }\r\n\r\n    function analogous(color, results, slices) {\r\n        results = results || 6;\r\n        slices = slices || 30;\r\n\r\n        var hsl = tinycolor(color).toHsl();\r\n        var part = 360 / slices;\r\n        var ret = [tinycolor(color)];\r\n\r\n        for (hsl.h = ((hsl.h - (part * results >> 1)) + 720) % 360; --results; ) {\r\n            hsl.h = (hsl.h + part) % 360;\r\n            ret.push(tinycolor(hsl));\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    function monochromatic(color, results) {\r\n        results = results || 6;\r\n        var hsv = tinycolor(color).toHsv();\r\n        var h = hsv.h, s = hsv.s, v = hsv.v;\r\n        var ret = [];\r\n        var modification = 1 / results;\r\n\r\n        while (results--) {\r\n            ret.push(tinycolor({ h: h, s: s, v: v}));\r\n            v = (v + modification) % 1;\r\n        }\r\n\r\n        return ret;\r\n    }\r\n\r\n// Utility Functions\r\n// ---------------------\r\n\r\n    tinycolor.mix = function(color1, color2, amount) {\r\n        amount = (amount === 0) ? 0 : (amount || 50);\r\n\r\n        var rgb1 = tinycolor(color1).toRgb();\r\n        var rgb2 = tinycolor(color2).toRgb();\r\n\r\n        var p = amount / 100;\r\n\r\n        var rgba = {\r\n            r: ((rgb2.r - rgb1.r) * p) + rgb1.r,\r\n            g: ((rgb2.g - rgb1.g) * p) + rgb1.g,\r\n            b: ((rgb2.b - rgb1.b) * p) + rgb1.b,\r\n            a: ((rgb2.a - rgb1.a) * p) + rgb1.a\r\n        };\r\n\r\n        return tinycolor(rgba);\r\n    };\r\n\r\n\r\n// Readability Functions\r\n// ---------------------\r\n// <http://www.w3.org/TR/2008/REC-WCAG20-20081211/#contrast-ratiodef (WCAG Version 2)\r\n\r\n// `contrast`\r\n// Analyze the 2 colors and returns the color contrast defined by (WCAG Version 2)\r\n    tinycolor.readability = function(color1, color2) {\r\n        var c1 = tinycolor(color1);\r\n        var c2 = tinycolor(color2);\r\n        return (Math.max(c1.getLuminance(),c2.getLuminance())+0.05) / (Math.min(c1.getLuminance(),c2.getLuminance())+0.05);\r\n    };\r\n\r\n// `isReadable`\r\n// Ensure that foreground and background color combinations meet WCAG2 guidelines.\r\n// The third argument is an optional Object.\r\n//      the 'level' property states 'AA' or 'AAA' - if missing or invalid, it defaults to 'AA';\r\n//      the 'size' property states 'large' or 'small' - if missing or invalid, it defaults to 'small'.\r\n// If the entire object is absent, isReadable defaults to {level:\"AA\",size:\"small\"}.\r\n\r\n// *Example*\r\n//    tinycolor.isReadable(\"#000\", \"#111\") => false\r\n//    tinycolor.isReadable(\"#000\", \"#111\",{level:\"AA\",size:\"large\"}) => false\r\n    tinycolor.isReadable = function(color1, color2, wcag2) {\r\n        var readability = tinycolor.readability(color1, color2);\r\n        var wcag2Parms, out;\r\n\r\n        out = false;\r\n\r\n        wcag2Parms = validateWCAG2Parms(wcag2);\r\n        switch (wcag2Parms.level + wcag2Parms.size) {\r\n            case \"AAsmall\":\r\n            case \"AAAlarge\":\r\n                out = readability >= 4.5;\r\n                break;\r\n            case \"AAlarge\":\r\n                out = readability >= 3;\r\n                break;\r\n            case \"AAAsmall\":\r\n                out = readability >= 7;\r\n                break;\r\n        }\r\n        return out;\r\n\r\n    };\r\n\r\n// `mostReadable`\r\n// Given a base color and a list of possible foreground or background\r\n// colors for that base, returns the most readable color.\r\n// Optionally returns Black or White if the most readable color is unreadable.\r\n// *Example*\r\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:false}).toHexString(); // \"#112255\"\r\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:true}).toHexString();  // \"#ffffff\"\r\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"large\"}).toHexString(); // \"#faf3f3\"\r\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"small\"}).toHexString(); // \"#ffffff\"\r\n    tinycolor.mostReadable = function(baseColor, colorList, args) {\r\n        var bestColor = null;\r\n        var bestScore = 0;\r\n        var readability;\r\n        var includeFallbackColors, level, size ;\r\n        args = args || {};\r\n        includeFallbackColors = args.includeFallbackColors ;\r\n        level = args.level;\r\n        size = args.size;\r\n\r\n        for (var i= 0; i < colorList.length ; i++) {\r\n            readability = tinycolor.readability(baseColor, colorList[i]);\r\n            if (readability > bestScore) {\r\n                bestScore = readability;\r\n                bestColor = tinycolor(colorList[i]);\r\n            }\r\n        }\r\n\r\n        if (tinycolor.isReadable(baseColor, bestColor, {\"level\":level,\"size\":size}) || !includeFallbackColors) {\r\n            return bestColor;\r\n        }\r\n        else {\r\n            args.includeFallbackColors=false;\r\n            return tinycolor.mostReadable(baseColor,[\"#fff\", \"#000\"],args);\r\n        }\r\n    };\r\n\r\n\r\n// Big List of Colors\r\n// ------------------\r\n// <http://www.w3.org/TR/css3-color/#svg-color>\r\n    var names = tinycolor.names = {\r\n        aliceblue: \"f0f8ff\",\r\n        antiquewhite: \"faebd7\",\r\n        aqua: \"0ff\",\r\n        aquamarine: \"7fffd4\",\r\n        azure: \"f0ffff\",\r\n        beige: \"f5f5dc\",\r\n        bisque: \"ffe4c4\",\r\n        black: \"000\",\r\n        blanchedalmond: \"ffebcd\",\r\n        blue: \"00f\",\r\n        blueviolet: \"8a2be2\",\r\n        brown: \"a52a2a\",\r\n        burlywood: \"deb887\",\r\n        burntsienna: \"ea7e5d\",\r\n        cadetblue: \"5f9ea0\",\r\n        chartreuse: \"7fff00\",\r\n        chocolate: \"d2691e\",\r\n        coral: \"ff7f50\",\r\n        cornflowerblue: \"6495ed\",\r\n        cornsilk: \"fff8dc\",\r\n        crimson: \"dc143c\",\r\n        cyan: \"0ff\",\r\n        darkblue: \"00008b\",\r\n        darkcyan: \"008b8b\",\r\n        darkgoldenrod: \"b8860b\",\r\n        darkgray: \"a9a9a9\",\r\n        darkgreen: \"006400\",\r\n        darkgrey: \"a9a9a9\",\r\n        darkkhaki: \"bdb76b\",\r\n        darkmagenta: \"8b008b\",\r\n        darkolivegreen: \"556b2f\",\r\n        darkorange: \"ff8c00\",\r\n        darkorchid: \"9932cc\",\r\n        darkred: \"8b0000\",\r\n        darksalmon: \"e9967a\",\r\n        darkseagreen: \"8fbc8f\",\r\n        darkslateblue: \"483d8b\",\r\n        darkslategray: \"2f4f4f\",\r\n        darkslategrey: \"2f4f4f\",\r\n        darkturquoise: \"00ced1\",\r\n        darkviolet: \"9400d3\",\r\n        deeppink: \"ff1493\",\r\n        deepskyblue: \"00bfff\",\r\n        dimgray: \"696969\",\r\n        dimgrey: \"696969\",\r\n        dodgerblue: \"1e90ff\",\r\n        firebrick: \"b22222\",\r\n        floralwhite: \"fffaf0\",\r\n        forestgreen: \"228b22\",\r\n        fuchsia: \"f0f\",\r\n        gainsboro: \"dcdcdc\",\r\n        ghostwhite: \"f8f8ff\",\r\n        gold: \"ffd700\",\r\n        goldenrod: \"daa520\",\r\n        gray: \"808080\",\r\n        green: \"008000\",\r\n        greenyellow: \"adff2f\",\r\n        grey: \"808080\",\r\n        honeydew: \"f0fff0\",\r\n        hotpink: \"ff69b4\",\r\n        indianred: \"cd5c5c\",\r\n        indigo: \"4b0082\",\r\n        ivory: \"fffff0\",\r\n        khaki: \"f0e68c\",\r\n        lavender: \"e6e6fa\",\r\n        lavenderblush: \"fff0f5\",\r\n        lawngreen: \"7cfc00\",\r\n        lemonchiffon: \"fffacd\",\r\n        lightblue: \"add8e6\",\r\n        lightcoral: \"f08080\",\r\n        lightcyan: \"e0ffff\",\r\n        lightgoldenrodyellow: \"fafad2\",\r\n        lightgray: \"d3d3d3\",\r\n        lightgreen: \"90ee90\",\r\n        lightgrey: \"d3d3d3\",\r\n        lightpink: \"ffb6c1\",\r\n        lightsalmon: \"ffa07a\",\r\n        lightseagreen: \"20b2aa\",\r\n        lightskyblue: \"87cefa\",\r\n        lightslategray: \"789\",\r\n        lightslategrey: \"789\",\r\n        lightsteelblue: \"b0c4de\",\r\n        lightyellow: \"ffffe0\",\r\n        lime: \"0f0\",\r\n        limegreen: \"32cd32\",\r\n        linen: \"faf0e6\",\r\n        magenta: \"f0f\",\r\n        maroon: \"800000\",\r\n        mediumaquamarine: \"66cdaa\",\r\n        mediumblue: \"0000cd\",\r\n        mediumorchid: \"ba55d3\",\r\n        mediumpurple: \"9370db\",\r\n        mediumseagreen: \"3cb371\",\r\n        mediumslateblue: \"7b68ee\",\r\n        mediumspringgreen: \"00fa9a\",\r\n        mediumturquoise: \"48d1cc\",\r\n        mediumvioletred: \"c71585\",\r\n        midnightblue: \"191970\",\r\n        mintcream: \"f5fffa\",\r\n        mistyrose: \"ffe4e1\",\r\n        moccasin: \"ffe4b5\",\r\n        navajowhite: \"ffdead\",\r\n        navy: \"000080\",\r\n        oldlace: \"fdf5e6\",\r\n        olive: \"808000\",\r\n        olivedrab: \"6b8e23\",\r\n        orange: \"ffa500\",\r\n        orangered: \"ff4500\",\r\n        orchid: \"da70d6\",\r\n        palegoldenrod: \"eee8aa\",\r\n        palegreen: \"98fb98\",\r\n        paleturquoise: \"afeeee\",\r\n        palevioletred: \"db7093\",\r\n        papayawhip: \"ffefd5\",\r\n        peachpuff: \"ffdab9\",\r\n        peru: \"cd853f\",\r\n        pink: \"ffc0cb\",\r\n        plum: \"dda0dd\",\r\n        powderblue: \"b0e0e6\",\r\n        purple: \"800080\",\r\n        rebeccapurple: \"663399\",\r\n        red: \"f00\",\r\n        rosybrown: \"bc8f8f\",\r\n        royalblue: \"4169e1\",\r\n        saddlebrown: \"8b4513\",\r\n        salmon: \"fa8072\",\r\n        sandybrown: \"f4a460\",\r\n        seagreen: \"2e8b57\",\r\n        seashell: \"fff5ee\",\r\n        sienna: \"a0522d\",\r\n        silver: \"c0c0c0\",\r\n        skyblue: \"87ceeb\",\r\n        slateblue: \"6a5acd\",\r\n        slategray: \"708090\",\r\n        slategrey: \"708090\",\r\n        snow: \"fffafa\",\r\n        springgreen: \"00ff7f\",\r\n        steelblue: \"4682b4\",\r\n        tan: \"d2b48c\",\r\n        teal: \"008080\",\r\n        thistle: \"d8bfd8\",\r\n        tomato: \"ff6347\",\r\n        turquoise: \"40e0d0\",\r\n        violet: \"ee82ee\",\r\n        wheat: \"f5deb3\",\r\n        white: \"fff\",\r\n        whitesmoke: \"f5f5f5\",\r\n        yellow: \"ff0\",\r\n        yellowgreen: \"9acd32\"\r\n    };\r\n\r\n// Make it easy to access colors via `hexNames[hex]`\r\n    var hexNames = tinycolor.hexNames = flip(names);\r\n\r\n\r\n// Utilities\r\n// ---------\r\n\r\n// `{ 'name1': 'val1' }` becomes `{ 'val1': 'name1' }`\r\n    function flip(o) {\r\n        var flipped = { };\r\n        for (var i in o) {\r\n            if (o.hasOwnProperty(i)) {\r\n                flipped[o[i]] = i;\r\n            }\r\n        }\r\n        return flipped;\r\n    }\r\n\r\n// Return a valid alpha value [0,1] with all invalid values being set to 1\r\n    function boundAlpha(a) {\r\n        a = parseFloat(a);\r\n\r\n        if (isNaN(a) || a < 0 || a > 1) {\r\n            a = 1;\r\n        }\r\n\r\n        return a;\r\n    }\r\n\r\n// Take input from [0, n] and return it as [0, 1]\r\n    function bound01(n, max) {\r\n        if (isOnePointZero(n)) { n = \"100%\"; }\r\n\r\n        var processPercent = isPercentage(n);\r\n        n = mathMin(max, mathMax(0, parseFloat(n)));\r\n\r\n        // Automatically convert percentage into number\r\n        if (processPercent) {\r\n            n = parseInt(n * max, 10) / 100;\r\n        }\r\n\r\n        // Handle floating point rounding errors\r\n        if ((Math.abs(n - max) < 0.000001)) {\r\n            return 1;\r\n        }\r\n\r\n        // Convert into [0, 1] range if it isn't already\r\n        return (n % max) / parseFloat(max);\r\n    }\r\n\r\n// Force a number between 0 and 1\r\n    function clamp01(val) {\r\n        return mathMin(1, mathMax(0, val));\r\n    }\r\n\r\n// Parse a base-16 hex value into a base-10 integer\r\n    function parseIntFromHex(val) {\r\n        return parseInt(val, 16);\r\n    }\r\n\r\n// Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1\r\n// <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>\r\n    function isOnePointZero(n) {\r\n        return typeof n == \"string\" && n.indexOf('.') != -1 && parseFloat(n) === 1;\r\n    }\r\n\r\n// Check to see if string passed in is a percentage\r\n    function isPercentage(n) {\r\n        return typeof n === \"string\" && n.indexOf('%') != -1;\r\n    }\r\n\r\n// Force a hex value to have 2 characters\r\n    function pad2(c) {\r\n        return c.length == 1 ? '0' + c : '' + c;\r\n    }\r\n\r\n// Replace a decimal with it's percentage value\r\n    function convertToPercentage(n) {\r\n        if (n <= 1) {\r\n            n = (n * 100) + \"%\";\r\n        }\r\n\r\n        return n;\r\n    }\r\n\r\n// Converts a decimal to a hex value\r\n    function convertDecimalToHex(d) {\r\n        return Math.round(parseFloat(d) * 255).toString(16);\r\n    }\r\n// Converts a hex value to a decimal\r\n    function convertHexToDecimal(h) {\r\n        return (parseIntFromHex(h) / 255);\r\n    }\r\n\r\n    var matchers = (function() {\r\n\r\n        // <http://www.w3.org/TR/css3-values/#integers>\r\n        var CSS_INTEGER = \"[-\\\\+]?\\\\d+%?\";\r\n\r\n        // <http://www.w3.org/TR/css3-values/#number-value>\r\n        var CSS_NUMBER = \"[-\\\\+]?\\\\d*\\\\.\\\\d+%?\";\r\n\r\n        // Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.\r\n        var CSS_UNIT = \"(?:\" + CSS_NUMBER + \")|(?:\" + CSS_INTEGER + \")\";\r\n\r\n        // Actual matching.\r\n        // Parentheses and commas are optional, but not required.\r\n        // Whitespace can take the place of commas or opening paren\r\n        var PERMISSIVE_MATCH3 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\r\n        var PERMISSIVE_MATCH4 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\r\n\r\n        return {\r\n            CSS_UNIT: new RegExp(CSS_UNIT),\r\n            rgb: new RegExp(\"rgb\" + PERMISSIVE_MATCH3),\r\n            rgba: new RegExp(\"rgba\" + PERMISSIVE_MATCH4),\r\n            hsl: new RegExp(\"hsl\" + PERMISSIVE_MATCH3),\r\n            hsla: new RegExp(\"hsla\" + PERMISSIVE_MATCH4),\r\n            hsv: new RegExp(\"hsv\" + PERMISSIVE_MATCH3),\r\n            hsva: new RegExp(\"hsva\" + PERMISSIVE_MATCH4),\r\n            hex3: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\r\n            hex6: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\r\n            hex4: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\r\n            hex8: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/\r\n        };\r\n    })();\r\n\r\n// `isValidCSSUnit`\r\n// Take in a single string / number and check to see if it looks like a CSS unit\r\n// (see `matchers` above for definition).\r\n    function isValidCSSUnit(color) {\r\n        return !!matchers.CSS_UNIT.exec(color);\r\n    }\r\n\r\n// `stringInputToObject`\r\n// Permissive string parsing.  Take in a number of formats, and output an object\r\n// based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`\r\n    function stringInputToObject(color) {\r\n\r\n        color = color.replace(trimLeft,'').replace(trimRight, '').toLowerCase();\r\n        var named = false;\r\n        if (names[color]) {\r\n            color = names[color];\r\n            named = true;\r\n        }\r\n        else if (color == 'transparent') {\r\n            return { r: 0, g: 0, b: 0, a: 0, format: \"name\" };\r\n        }\r\n\r\n        // Try to match string input using regular expressions.\r\n        // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]\r\n        // Just return an object and let the conversion functions handle that.\r\n        // This way the result will be the same whether the tinycolor is initialized with string or object.\r\n        var match;\r\n        if ((match = matchers.rgb.exec(color))) {\r\n            return { r: match[1], g: match[2], b: match[3] };\r\n        }\r\n        if ((match = matchers.rgba.exec(color))) {\r\n            return { r: match[1], g: match[2], b: match[3], a: match[4] };\r\n        }\r\n        if ((match = matchers.hsl.exec(color))) {\r\n            return { h: match[1], s: match[2], l: match[3] };\r\n        }\r\n        if ((match = matchers.hsla.exec(color))) {\r\n            return { h: match[1], s: match[2], l: match[3], a: match[4] };\r\n        }\r\n        if ((match = matchers.hsv.exec(color))) {\r\n            return { h: match[1], s: match[2], v: match[3] };\r\n        }\r\n        if ((match = matchers.hsva.exec(color))) {\r\n            return { h: match[1], s: match[2], v: match[3], a: match[4] };\r\n        }\r\n        if ((match = matchers.hex8.exec(color))) {\r\n            return {\r\n                r: parseIntFromHex(match[1]),\r\n                g: parseIntFromHex(match[2]),\r\n                b: parseIntFromHex(match[3]),\r\n                a: convertHexToDecimal(match[4]),\r\n                format: named ? \"name\" : \"hex8\"\r\n            };\r\n        }\r\n        if ((match = matchers.hex6.exec(color))) {\r\n            return {\r\n                r: parseIntFromHex(match[1]),\r\n                g: parseIntFromHex(match[2]),\r\n                b: parseIntFromHex(match[3]),\r\n                format: named ? \"name\" : \"hex\"\r\n            };\r\n        }\r\n        if ((match = matchers.hex4.exec(color))) {\r\n            return {\r\n                r: parseIntFromHex(match[1] + '' + match[1]),\r\n                g: parseIntFromHex(match[2] + '' + match[2]),\r\n                b: parseIntFromHex(match[3] + '' + match[3]),\r\n                a: convertHexToDecimal(match[4] + '' + match[4]),\r\n                format: named ? \"name\" : \"hex8\"\r\n            };\r\n        }\r\n        if ((match = matchers.hex3.exec(color))) {\r\n            return {\r\n                r: parseIntFromHex(match[1] + '' + match[1]),\r\n                g: parseIntFromHex(match[2] + '' + match[2]),\r\n                b: parseIntFromHex(match[3] + '' + match[3]),\r\n                format: named ? \"name\" : \"hex\"\r\n            };\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    function validateWCAG2Parms(parms) {\r\n        // return valid WCAG2 parms for isReadable.\r\n        // If input parms are invalid, return {\"level\":\"AA\", \"size\":\"small\"}\r\n        var level, size;\r\n        parms = parms || {\"level\":\"AA\", \"size\":\"small\"};\r\n        level = (parms.level || \"AA\").toUpperCase();\r\n        size = (parms.size || \"small\").toLowerCase();\r\n        if (level !== \"AA\" && level !== \"AAA\") {\r\n            level = \"AA\";\r\n        }\r\n        if (size !== \"small\" && size !== \"large\") {\r\n            size = \"small\";\r\n        }\r\n        return {\"level\":level, \"size\":size};\r\n    }\r\n\r\n// Node: Export function\r\n    if (typeof module !== \"undefined\" && module.exports) {\r\n        module.exports = tinycolor;\r\n    }\r\n// AMD/requirejs: Define the module\r\n    else if (typeof define === 'function' && define.amd) {\r\n        define(function () {return tinycolor;});\r\n    }\r\n// Browser: Expose to window\r\n    else {\r\n        window.tinycolor = tinycolor;\r\n    }\r\n\r\n})(Math);\r\n","jquery/ui-modules/accordion.js":"/*!\r\n * jQuery UI Accordion - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/accordion/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/core',\r\n    'jquery-ui-modules/widget'\r\n], function ($, undefined) {\r\n\r\n    var uid = 0,\r\n        hideProps = {},\r\n        showProps = {};\r\n\r\n    hideProps.height = hideProps.paddingTop = hideProps.paddingBottom =\r\n        hideProps.borderTopWidth = hideProps.borderBottomWidth = \"hide\";\r\n    showProps.height = showProps.paddingTop = showProps.paddingBottom =\r\n        showProps.borderTopWidth = showProps.borderBottomWidth = \"show\";\r\n\r\n    $.widget(\"ui.accordion\", {\r\n        version: \"1.10.4\",\r\n        options: {\r\n            active: 0,\r\n            animate: {},\r\n            collapsible: false,\r\n            event: \"click\",\r\n            header: \"> li > :first-child,> :not(li):even\",\r\n            heightStyle: \"auto\",\r\n            icons: {\r\n                activeHeader: \"ui-icon-triangle-1-s\",\r\n                header: \"ui-icon-triangle-1-e\"\r\n            },\r\n\r\n            // callbacks\r\n            activate: null,\r\n            beforeActivate: null\r\n        },\r\n\r\n        _create: function () {\r\n            var options = this.options;\r\n            this.prevShow = this.prevHide = $();\r\n            this.element.addClass(\"ui-accordion ui-widget ui-helper-reset\")\r\n            // ARIA\r\n                .attr(\"role\", \"tablist\");\r\n\r\n            // don't allow collapsible: false and active: false / null\r\n            if (!options.collapsible && (options.active === false || options.active == null)) {\r\n                options.active = 0;\r\n            }\r\n\r\n            this._processPanels();\r\n            // handle negative values\r\n            if (options.active < 0) {\r\n                options.active += this.headers.length;\r\n            }\r\n            this._refresh();\r\n        },\r\n\r\n        _getCreateEventData: function () {\r\n            return {\r\n                header: this.active,\r\n                panel: !this.active.length ? $() : this.active.next(),\r\n                content: !this.active.length ? $() : this.active.next()\r\n            };\r\n        },\r\n\r\n        _createIcons: function () {\r\n            var icons = this.options.icons;\r\n            if (icons) {\r\n                $(\"<span>\")\r\n                    .addClass(\"ui-accordion-header-icon ui-icon \" + icons.header)\r\n                    .prependTo(this.headers);\r\n                this.active.children(\".ui-accordion-header-icon\")\r\n                    .removeClass(icons.header)\r\n                    .addClass(icons.activeHeader);\r\n                this.headers.addClass(\"ui-accordion-icons\");\r\n            }\r\n        },\r\n\r\n        _destroyIcons: function () {\r\n            this.headers\r\n                .removeClass(\"ui-accordion-icons\")\r\n                .children(\".ui-accordion-header-icon\")\r\n                .remove();\r\n        },\r\n\r\n        _destroy: function () {\r\n            var contents;\r\n\r\n            // clean up main element\r\n            this.element\r\n                .removeClass(\"ui-accordion ui-widget ui-helper-reset\")\r\n                .removeAttr(\"role\");\r\n\r\n            // clean up headers\r\n            this.headers\r\n                .removeClass(\"ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top\")\r\n                .removeAttr(\"role\")\r\n                .removeAttr(\"aria-expanded\")\r\n                .removeAttr(\"aria-selected\")\r\n                .removeAttr(\"aria-controls\")\r\n                .removeAttr(\"tabIndex\")\r\n                .each(function () {\r\n                    if (/^ui-accordion/.test(this.id)) {\r\n                        this.removeAttribute(\"id\");\r\n                    }\r\n                });\r\n            this._destroyIcons();\r\n\r\n            // clean up content panels\r\n            contents = this.headers.next()\r\n                .css(\"display\", \"\")\r\n                .removeAttr(\"role\")\r\n                .removeAttr(\"aria-hidden\")\r\n                .removeAttr(\"aria-labelledby\")\r\n                .removeClass(\"ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled\")\r\n                .each(function () {\r\n                    if (/^ui-accordion/.test(this.id)) {\r\n                        this.removeAttribute(\"id\");\r\n                    }\r\n                });\r\n            if (this.options.heightStyle !== \"content\") {\r\n                contents.css(\"height\", \"\");\r\n            }\r\n        },\r\n\r\n        _setOption: function (key, value) {\r\n            if (key === \"active\") {\r\n                // _activate() will handle invalid values and update this.options\r\n                this._activate(value);\r\n                return;\r\n            }\r\n\r\n            if (key === \"event\") {\r\n                if (this.options.event) {\r\n                    this._off(this.headers, this.options.event);\r\n                }\r\n                this._setupEvents(value);\r\n            }\r\n\r\n            this._super(key, value);\r\n\r\n            // setting collapsible: false while collapsed; open first panel\r\n            if (key === \"collapsible\" && !value && this.options.active === false) {\r\n                this._activate(0);\r\n            }\r\n\r\n            if (key === \"icons\") {\r\n                this._destroyIcons();\r\n                if (value) {\r\n                    this._createIcons();\r\n                }\r\n            }\r\n\r\n            // #5332 - opacity doesn't cascade to positioned elements in IE\r\n            // so we need to add the disabled class to the headers and panels\r\n            if (key === \"disabled\") {\r\n                this.headers.add(this.headers.next())\r\n                    .toggleClass(\"ui-state-disabled\", !!value);\r\n            }\r\n        },\r\n\r\n        _keydown: function (event) {\r\n            if (event.altKey || event.ctrlKey) {\r\n                return;\r\n            }\r\n\r\n            var keyCode = $.ui.keyCode,\r\n                length = this.headers.length,\r\n                currentIndex = this.headers.index(event.target),\r\n                toFocus = false;\r\n\r\n            switch (event.keyCode) {\r\n                case keyCode.RIGHT:\r\n                case keyCode.DOWN:\r\n                    toFocus = this.headers[(currentIndex + 1) % length];\r\n                    break;\r\n                case keyCode.LEFT:\r\n                case keyCode.UP:\r\n                    toFocus = this.headers[(currentIndex - 1 + length) % length];\r\n                    break;\r\n                case keyCode.SPACE:\r\n                case keyCode.ENTER:\r\n                    this._eventHandler(event);\r\n                    break;\r\n                case keyCode.HOME:\r\n                    toFocus = this.headers[0];\r\n                    break;\r\n                case keyCode.END:\r\n                    toFocus = this.headers[length - 1];\r\n                    break;\r\n            }\r\n\r\n            if (toFocus) {\r\n                $(event.target).attr(\"tabIndex\", -1);\r\n                $(toFocus).attr(\"tabIndex\", 0);\r\n                toFocus.focus();\r\n                event.preventDefault();\r\n            }\r\n        },\r\n\r\n        _panelKeyDown: function (event) {\r\n            if (event.keyCode === $.ui.keyCode.UP && event.ctrlKey) {\r\n                $(event.currentTarget).prev().focus();\r\n            }\r\n        },\r\n\r\n        refresh: function () {\r\n            var options = this.options;\r\n            this._processPanels();\r\n\r\n            // was collapsed or no panel\r\n            if ((options.active === false && options.collapsible === true) || !this.headers.length) {\r\n                options.active = false;\r\n                this.active = $();\r\n                // active false only when collapsible is true\r\n            } else if (options.active === false) {\r\n                this._activate(0);\r\n                // was active, but active panel is gone\r\n            } else if (this.active.length && !$.contains(this.element[0], this.active[0])) {\r\n                // all remaining panel are disabled\r\n                if (this.headers.length === this.headers.find(\".ui-state-disabled\").length) {\r\n                    options.active = false;\r\n                    this.active = $();\r\n                    // activate previous panel\r\n                } else {\r\n                    this._activate(Math.max(0, options.active - 1));\r\n                }\r\n                // was active, active panel still exists\r\n            } else {\r\n                // make sure active index is correct\r\n                options.active = this.headers.index(this.active);\r\n            }\r\n\r\n            this._destroyIcons();\r\n\r\n            this._refresh();\r\n        },\r\n\r\n        _processPanels: function () {\r\n            this.headers = this.element.find(this.options.header)\r\n                .addClass(\"ui-accordion-header ui-helper-reset ui-state-default ui-corner-all\");\r\n\r\n            this.headers.next()\r\n                .addClass(\"ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom\")\r\n                .filter(\":not(.ui-accordion-content-active)\")\r\n                .hide();\r\n        },\r\n\r\n        _refresh: function () {\r\n            var maxHeight,\r\n                options = this.options,\r\n                heightStyle = options.heightStyle,\r\n                parent = this.element.parent(),\r\n                accordionId = this.accordionId = \"ui-accordion-\" +\r\n                    (this.element.attr(\"id\") || ++uid);\r\n\r\n            this.active = this._findActive(options.active)\r\n                .addClass(\"ui-accordion-header-active ui-state-active ui-corner-top\")\r\n                .removeClass(\"ui-corner-all\");\r\n            this.active.next()\r\n                .addClass(\"ui-accordion-content-active\")\r\n                .show();\r\n\r\n            this.headers\r\n                .attr(\"role\", \"tab\")\r\n                .each(function (i) {\r\n                    var header = $(this),\r\n                        headerId = header.attr(\"id\"),\r\n                        panel = header.next(),\r\n                        panelId = panel.attr(\"id\");\r\n                    if (!headerId) {\r\n                        headerId = accordionId + \"-header-\" + i;\r\n                        header.attr(\"id\", headerId);\r\n                    }\r\n                    if (!panelId) {\r\n                        panelId = accordionId + \"-panel-\" + i;\r\n                        panel.attr(\"id\", panelId);\r\n                    }\r\n                    header.attr(\"aria-controls\", panelId);\r\n                    panel.attr(\"aria-labelledby\", headerId);\r\n                })\r\n                .next()\r\n                .attr(\"role\", \"tabpanel\");\r\n\r\n            this.headers\r\n                .not(this.active)\r\n                .attr({\r\n                    \"aria-selected\": \"false\",\r\n                    \"aria-expanded\": \"false\",\r\n                    tabIndex: -1\r\n                })\r\n                .next()\r\n                .attr({\r\n                    \"aria-hidden\": \"true\"\r\n                })\r\n                .hide();\r\n\r\n            // make sure at least one header is in the tab order\r\n            if (!this.active.length) {\r\n                this.headers.eq(0).attr(\"tabIndex\", 0);\r\n            } else {\r\n                this.active.attr({\r\n                    \"aria-selected\": \"true\",\r\n                    \"aria-expanded\": \"true\",\r\n                    tabIndex: 0\r\n                })\r\n                    .next()\r\n                    .attr({\r\n                        \"aria-hidden\": \"false\"\r\n                    });\r\n            }\r\n\r\n            this._createIcons();\r\n\r\n            this._setupEvents(options.event);\r\n\r\n            if (heightStyle === \"fill\") {\r\n                maxHeight = parent.height();\r\n                this.element.siblings(\":visible\").each(function () {\r\n                    var elem = $(this),\r\n                        position = elem.css(\"position\");\r\n\r\n                    if (position === \"absolute\" || position === \"fixed\") {\r\n                        return;\r\n                    }\r\n                    maxHeight -= elem.outerHeight(true);\r\n                });\r\n\r\n                this.headers.each(function () {\r\n                    maxHeight -= $(this).outerHeight(true);\r\n                });\r\n\r\n                this.headers.next()\r\n                    .each(function () {\r\n                        $(this).height(Math.max(0, maxHeight -\r\n                            $(this).innerHeight() + $(this).height()));\r\n                    })\r\n                    .css(\"overflow\", \"auto\");\r\n            } else if (heightStyle === \"auto\") {\r\n                maxHeight = 0;\r\n                this.headers.next()\r\n                    .each(function () {\r\n                        maxHeight = Math.max(maxHeight, $(this).css(\"height\", \"\").height());\r\n                    })\r\n                    .height(maxHeight);\r\n            }\r\n        },\r\n\r\n        _activate: function (index) {\r\n            var active = this._findActive(index)[0];\r\n\r\n            // trying to activate the already active panel\r\n            if (active === this.active[0]) {\r\n                return;\r\n            }\r\n\r\n            // trying to collapse, simulate a click on the currently active header\r\n            active = active || this.active[0];\r\n\r\n            this._eventHandler({\r\n                target: active,\r\n                currentTarget: active,\r\n                preventDefault: $.noop\r\n            });\r\n        },\r\n\r\n        _findActive: function (selector) {\r\n            return typeof selector === \"number\" ? this.headers.eq(selector) : $();\r\n        },\r\n\r\n        _setupEvents: function (event) {\r\n            var events = {\r\n                keydown: \"_keydown\"\r\n            };\r\n            if (event) {\r\n                $.each(event.split(\" \"), function (index, eventName) {\r\n                    events[eventName] = \"_eventHandler\";\r\n                });\r\n            }\r\n\r\n            this._off(this.headers.add(this.headers.next()));\r\n            this._on(this.headers, events);\r\n            this._on(this.headers.next(), {keydown: \"_panelKeyDown\"});\r\n            this._hoverable(this.headers);\r\n            this._focusable(this.headers);\r\n        },\r\n\r\n        _eventHandler: function (event) {\r\n            var options = this.options,\r\n                active = this.active,\r\n                clicked = $(event.currentTarget),\r\n                clickedIsActive = clicked[0] === active[0],\r\n                collapsing = clickedIsActive && options.collapsible,\r\n                toShow = collapsing ? $() : clicked.next(),\r\n                toHide = active.next(),\r\n                eventData = {\r\n                    oldHeader: active,\r\n                    oldPanel: toHide,\r\n                    newHeader: collapsing ? $() : clicked,\r\n                    newPanel: toShow\r\n                };\r\n\r\n            event.preventDefault();\r\n\r\n            if (\r\n                // click on active header, but not collapsible\r\n                (clickedIsActive && !options.collapsible) ||\r\n                // allow canceling activation\r\n                (this._trigger(\"beforeActivate\", event, eventData) === false)) {\r\n                return;\r\n            }\r\n\r\n            options.active = collapsing ? false : this.headers.index(clicked);\r\n\r\n            // when the call to ._toggle() comes after the class changes\r\n            // it causes a very odd bug in IE 8 (see #6720)\r\n            this.active = clickedIsActive ? $() : clicked;\r\n            this._toggle(eventData);\r\n\r\n            // switch classes\r\n            // corner classes on the previously active header stay after the animation\r\n            active.removeClass(\"ui-accordion-header-active ui-state-active\");\r\n            if (options.icons) {\r\n                active.children(\".ui-accordion-header-icon\")\r\n                    .removeClass(options.icons.activeHeader)\r\n                    .addClass(options.icons.header);\r\n            }\r\n\r\n            if (!clickedIsActive) {\r\n                clicked\r\n                    .removeClass(\"ui-corner-all\")\r\n                    .addClass(\"ui-accordion-header-active ui-state-active ui-corner-top\");\r\n                if (options.icons) {\r\n                    clicked.children(\".ui-accordion-header-icon\")\r\n                        .removeClass(options.icons.header)\r\n                        .addClass(options.icons.activeHeader);\r\n                }\r\n\r\n                clicked\r\n                    .next()\r\n                    .addClass(\"ui-accordion-content-active\");\r\n            }\r\n        },\r\n\r\n        _toggle: function (data) {\r\n            var toShow = data.newPanel,\r\n                toHide = this.prevShow.length ? this.prevShow : data.oldPanel;\r\n\r\n            // handle activating a panel during the animation for another activation\r\n            this.prevShow.add(this.prevHide).stop(true, true);\r\n            this.prevShow = toShow;\r\n            this.prevHide = toHide;\r\n\r\n            if (this.options.animate) {\r\n                this._animate(toShow, toHide, data);\r\n            } else {\r\n                toHide.hide();\r\n                toShow.show();\r\n                this._toggleComplete(data);\r\n            }\r\n\r\n            toHide.attr({\r\n                \"aria-hidden\": \"true\"\r\n            });\r\n            toHide.prev().attr(\"aria-selected\", \"false\");\r\n            // if we're switching panels, remove the old header from the tab order\r\n            // if we're opening from collapsed state, remove the previous header from the tab order\r\n            // if we're collapsing, then keep the collapsing header in the tab order\r\n            if (toShow.length && toHide.length) {\r\n                toHide.prev().attr({\r\n                    \"tabIndex\": -1,\r\n                    \"aria-expanded\": \"false\"\r\n                });\r\n            } else if (toShow.length) {\r\n                this.headers.filter(function () {\r\n                    return $(this).attr(\"tabIndex\") === 0;\r\n                })\r\n                    .attr(\"tabIndex\", -1);\r\n            }\r\n\r\n            toShow\r\n                .attr(\"aria-hidden\", \"false\")\r\n                .prev()\r\n                .attr({\r\n                    \"aria-selected\": \"true\",\r\n                    tabIndex: 0,\r\n                    \"aria-expanded\": \"true\"\r\n                });\r\n        },\r\n\r\n        _animate: function (toShow, toHide, data) {\r\n            var total, easing, duration,\r\n                that = this,\r\n                adjust = 0,\r\n                down = toShow.length &&\r\n                    (!toHide.length || (toShow.index() < toHide.index())),\r\n                animate = this.options.animate || {},\r\n                options = down && animate.down || animate,\r\n                complete = function () {\r\n                    that._toggleComplete(data);\r\n                };\r\n\r\n            if (typeof options === \"number\") {\r\n                duration = options;\r\n            }\r\n            if (typeof options === \"string\") {\r\n                easing = options;\r\n            }\r\n            // fall back from options to animation in case of partial down settings\r\n            easing = easing || options.easing || animate.easing;\r\n            duration = duration || options.duration || animate.duration;\r\n\r\n            if (!toHide.length) {\r\n                return toShow.animate(showProps, duration, easing, complete);\r\n            }\r\n            if (!toShow.length) {\r\n                return toHide.animate(hideProps, duration, easing, complete);\r\n            }\r\n\r\n            total = toShow.show().outerHeight();\r\n            toHide.animate(hideProps, {\r\n                duration: duration,\r\n                easing: easing,\r\n                step: function (now, fx) {\r\n                    fx.now = Math.round(now);\r\n                }\r\n            });\r\n            toShow\r\n                .hide()\r\n                .animate(showProps, {\r\n                    duration: duration,\r\n                    easing: easing,\r\n                    complete: complete,\r\n                    step: function (now, fx) {\r\n                        fx.now = Math.round(now);\r\n                        if (fx.prop !== \"height\") {\r\n                            adjust += fx.now;\r\n                        } else if (that.options.heightStyle !== \"content\") {\r\n                            fx.now = Math.round(total - toHide.outerHeight() - adjust);\r\n                            adjust = 0;\r\n                        }\r\n                    }\r\n                });\r\n        },\r\n\r\n        _toggleComplete: function (data) {\r\n            var toHide = data.oldPanel;\r\n\r\n            toHide\r\n                .removeClass(\"ui-accordion-content-active\")\r\n                .prev()\r\n                .removeClass(\"ui-corner-top\")\r\n                .addClass(\"ui-corner-all\");\r\n\r\n            // Work around for rendering bug in IE (#5421)\r\n            if (toHide.length) {\r\n                toHide.parent()[0].className = toHide.parent()[0].className;\r\n            }\r\n            this._trigger(\"activate\", null, data);\r\n        }\r\n    });\r\n});\r\n","jquery/ui-modules/autocomplete.js":"/*!\r\n * jQuery UI Autocomplete - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/autocomplete/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/menu'\r\n], function ($, undefined) {\r\n\r\n    $.widget(\"ui.autocomplete\", {\r\n        version: \"1.10.4\",\r\n        defaultElement: \"<input>\",\r\n        options: {\r\n            appendTo: null,\r\n            autoFocus: false,\r\n            delay: 300,\r\n            minLength: 1,\r\n            position: {\r\n                my: \"left top\",\r\n                at: \"left bottom\",\r\n                collision: \"none\"\r\n            },\r\n            source: null,\r\n\r\n            // callbacks\r\n            change: null,\r\n            close: null,\r\n            focus: null,\r\n            open: null,\r\n            response: null,\r\n            search: null,\r\n            select: null\r\n        },\r\n\r\n        requestIndex: 0,\r\n        pending: 0,\r\n\r\n        _create: function () {\r\n            // Some browsers only repeat keydown events, not keypress events,\r\n            // so we use the suppressKeyPress flag to determine if we've already\r\n            // handled the keydown event. #7269\r\n            // Unfortunately the code for & in keypress is the same as the up arrow,\r\n            // so we use the suppressKeyPressRepeat flag to avoid handling keypress\r\n            // events when we know the keydown event was used to modify the\r\n            // search term. #7799\r\n            var suppressKeyPress, suppressKeyPressRepeat, suppressInput,\r\n                nodeName = this.element[0].nodeName.toLowerCase(),\r\n                isTextarea = nodeName === \"textarea\",\r\n                isInput = nodeName === \"input\";\r\n\r\n            this.isMultiLine =\r\n                // Textareas are always multi-line\r\n                isTextarea ? true :\r\n                    // Inputs are always single-line, even if inside a contentEditable element\r\n                    // IE also treats inputs as contentEditable\r\n                    isInput ? false :\r\n                        // All other element types are determined by whether or not they're contentEditable\r\n                        this.element.prop(\"isContentEditable\");\r\n\r\n            this.valueMethod = this.element[isTextarea || isInput ? \"val\" : \"text\"];\r\n            this.isNewMenu = true;\r\n\r\n            this.element\r\n                .addClass(\"ui-autocomplete-input\")\r\n                .attr(\"autocomplete\", \"off\");\r\n\r\n            this._on(this.element, {\r\n                keydown: function (event) {\r\n                    if (this.element.prop(\"readOnly\")) {\r\n                        suppressKeyPress = true;\r\n                        suppressInput = true;\r\n                        suppressKeyPressRepeat = true;\r\n                        return;\r\n                    }\r\n\r\n                    suppressKeyPress = false;\r\n                    suppressInput = false;\r\n                    suppressKeyPressRepeat = false;\r\n                    var keyCode = $.ui.keyCode;\r\n                    switch (event.keyCode) {\r\n                        case keyCode.PAGE_UP:\r\n                            suppressKeyPress = true;\r\n                            this._move(\"previousPage\", event);\r\n                            break;\r\n                        case keyCode.PAGE_DOWN:\r\n                            suppressKeyPress = true;\r\n                            this._move(\"nextPage\", event);\r\n                            break;\r\n                        case keyCode.UP:\r\n                            suppressKeyPress = true;\r\n                            this._keyEvent(\"previous\", event);\r\n                            break;\r\n                        case keyCode.DOWN:\r\n                            suppressKeyPress = true;\r\n                            this._keyEvent(\"next\", event);\r\n                            break;\r\n                        case keyCode.ENTER:\r\n                        case keyCode.NUMPAD_ENTER:\r\n                            // when menu is open and has focus\r\n                            if (this.menu.active) {\r\n                                // #6055 - Opera still allows the keypress to occur\r\n                                // which causes forms to submit\r\n                                suppressKeyPress = true;\r\n                                event.preventDefault();\r\n                                this.menu.select(event);\r\n                            }\r\n                            break;\r\n                        case keyCode.TAB:\r\n                            if (this.menu.active) {\r\n                                this.menu.select(event);\r\n                            }\r\n                            break;\r\n                        case keyCode.ESCAPE:\r\n                            if (this.menu.element.is(\":visible\")) {\r\n                                this._value(this.term);\r\n                                this.close(event);\r\n                                // Different browsers have different default behavior for escape\r\n                                // Single press can mean undo or clear\r\n                                // Double press in IE means clear the whole form\r\n                                event.preventDefault();\r\n                            }\r\n                            break;\r\n                        default:\r\n                            suppressKeyPressRepeat = true;\r\n                            // search timeout should be triggered before the input value is changed\r\n                            this._searchTimeout(event);\r\n                            break;\r\n                    }\r\n                },\r\n                keypress: function (event) {\r\n                    if (suppressKeyPress) {\r\n                        suppressKeyPress = false;\r\n                        if (!this.isMultiLine || this.menu.element.is(\":visible\")) {\r\n                            event.preventDefault();\r\n                        }\r\n                        return;\r\n                    }\r\n                    if (suppressKeyPressRepeat) {\r\n                        return;\r\n                    }\r\n\r\n                    // replicate some key handlers to allow them to repeat in Firefox and Opera\r\n                    var keyCode = $.ui.keyCode;\r\n                    switch (event.keyCode) {\r\n                        case keyCode.PAGE_UP:\r\n                            this._move(\"previousPage\", event);\r\n                            break;\r\n                        case keyCode.PAGE_DOWN:\r\n                            this._move(\"nextPage\", event);\r\n                            break;\r\n                        case keyCode.UP:\r\n                            this._keyEvent(\"previous\", event);\r\n                            break;\r\n                        case keyCode.DOWN:\r\n                            this._keyEvent(\"next\", event);\r\n                            break;\r\n                    }\r\n                },\r\n                input: function (event) {\r\n                    if (suppressInput) {\r\n                        suppressInput = false;\r\n                        event.preventDefault();\r\n                        return;\r\n                    }\r\n                    this._searchTimeout(event);\r\n                },\r\n                focus: function () {\r\n                    this.selectedItem = null;\r\n                    this.previous = this._value();\r\n                },\r\n                blur: function (event) {\r\n                    if (this.cancelBlur) {\r\n                        delete this.cancelBlur;\r\n                        return;\r\n                    }\r\n\r\n                    clearTimeout(this.searching);\r\n                    this.close(event);\r\n                    this._change(event);\r\n                }\r\n            });\r\n\r\n            this._initSource();\r\n            this.menu = $(\"<ul>\")\r\n                .addClass(\"ui-autocomplete ui-front\")\r\n                .appendTo(this._appendTo())\r\n                .menu({\r\n                    // disable ARIA support, the live region takes care of that\r\n                    role: null\r\n                })\r\n                .hide()\r\n                .data(\"ui-menu\");\r\n\r\n            this._on(this.menu.element, {\r\n                mousedown: function (event) {\r\n                    // prevent moving focus out of the text field\r\n                    event.preventDefault();\r\n\r\n                    // IE doesn't prevent moving focus even with event.preventDefault()\r\n                    // so we set a flag to know when we should ignore the blur event\r\n                    this.cancelBlur = true;\r\n                    this._delay(function () {\r\n                        delete this.cancelBlur;\r\n                    });\r\n\r\n                    // clicking on the scrollbar causes focus to shift to the body\r\n                    // but we can't detect a mouseup or a click immediately afterward\r\n                    // so we have to track the next mousedown and close the menu if\r\n                    // the user clicks somewhere outside of the autocomplete\r\n                    var menuElement = this.menu.element[0];\r\n                    if (!$(event.target).closest(\".ui-menu-item\").length) {\r\n                        this._delay(function () {\r\n                            var that = this;\r\n                            this.document.one(\"mousedown\", function (event) {\r\n                                if (event.target !== that.element[0] &&\r\n                                    event.target !== menuElement &&\r\n                                    !$.contains(menuElement, event.target)) {\r\n                                    that.close();\r\n                                }\r\n                            });\r\n                        });\r\n                    }\r\n                },\r\n                menufocus: function (event, ui) {\r\n                    // support: Firefox\r\n                    // Prevent accidental activation of menu items in Firefox (#7024 #9118)\r\n                    if (this.isNewMenu) {\r\n                        this.isNewMenu = false;\r\n                        if (event.originalEvent && /^mouse/.test(event.originalEvent.type)) {\r\n                            this.menu.blur();\r\n\r\n                            this.document.one(\"mousemove\", function () {\r\n                                $(event.target).trigger(event.originalEvent);\r\n                            });\r\n\r\n                            return;\r\n                        }\r\n                    }\r\n\r\n                    var item = ui.item.data(\"ui-autocomplete-item\");\r\n                    if (false !== this._trigger(\"focus\", event, {item: item})) {\r\n                        // use value to match what will end up in the input, if it was a key event\r\n                        if (event.originalEvent && /^key/.test(event.originalEvent.type)) {\r\n                            this._value(item.value);\r\n                        }\r\n                    } else {\r\n                        // Normally the input is populated with the item's value as the\r\n                        // menu is navigated, causing screen readers to notice a change and\r\n                        // announce the item. Since the focus event was canceled, this doesn't\r\n                        // happen, so we update the live region so that screen readers can\r\n                        // still notice the change and announce it.\r\n                        this.liveRegion.text(item.value);\r\n                    }\r\n                },\r\n                menuselect: function (event, ui) {\r\n                    var item = ui.item.data(\"ui-autocomplete-item\"),\r\n                        previous = this.previous;\r\n\r\n                    // only trigger when focus was lost (click on menu)\r\n                    if (this.element[0] !== this.document[0].activeElement) {\r\n                        this.element.focus();\r\n                        this.previous = previous;\r\n                        // #6109 - IE triggers two focus events and the second\r\n                        // is asynchronous, so we need to reset the previous\r\n                        // term synchronously and asynchronously :-(\r\n                        this._delay(function () {\r\n                            this.previous = previous;\r\n                            this.selectedItem = item;\r\n                        });\r\n                    }\r\n\r\n                    if (false !== this._trigger(\"select\", event, {item: item})) {\r\n                        this._value(item.value);\r\n                    }\r\n                    // reset the term after the select event\r\n                    // this allows custom select handling to work properly\r\n                    this.term = this._value();\r\n\r\n                    this.close(event);\r\n                    this.selectedItem = item;\r\n                }\r\n            });\r\n\r\n            this.liveRegion = $(\"<span>\", {\r\n                role: \"status\",\r\n                \"aria-live\": \"polite\"\r\n            })\r\n                .addClass(\"ui-helper-hidden-accessible\")\r\n                .insertBefore(this.element);\r\n\r\n            // turning off autocomplete prevents the browser from remembering the\r\n            // value when navigating through history, so we re-enable autocomplete\r\n            // if the page is unloaded before the widget is destroyed. #7790\r\n            this._on(this.window, {\r\n                beforeunload: function () {\r\n                    this.element.removeAttr(\"autocomplete\");\r\n                }\r\n            });\r\n        },\r\n\r\n        _destroy: function () {\r\n            clearTimeout(this.searching);\r\n            this.element\r\n                .removeClass(\"ui-autocomplete-input\")\r\n                .removeAttr(\"autocomplete\");\r\n            this.menu.element.remove();\r\n            this.liveRegion.remove();\r\n        },\r\n\r\n        _setOption: function (key, value) {\r\n            this._super(key, value);\r\n            if (key === \"source\") {\r\n                this._initSource();\r\n            }\r\n            if (key === \"appendTo\") {\r\n                this.menu.element.appendTo(this._appendTo());\r\n            }\r\n            if (key === \"disabled\" && value && this.xhr) {\r\n                this.xhr.abort();\r\n            }\r\n        },\r\n\r\n        _appendTo: function () {\r\n            var element = this.options.appendTo;\r\n\r\n            if (element) {\r\n                element = element.jquery || element.nodeType ?\r\n                    $(element) :\r\n                    this.document.find(element).eq(0);\r\n            }\r\n\r\n            if (!element) {\r\n                element = this.element.closest(\".ui-front\");\r\n            }\r\n\r\n            if (!element.length) {\r\n                element = this.document[0].body;\r\n            }\r\n\r\n            return element;\r\n        },\r\n\r\n        _initSource: function () {\r\n            var array, url,\r\n                that = this;\r\n            if ($.isArray(this.options.source)) {\r\n                array = this.options.source;\r\n                this.source = function (request, response) {\r\n                    response($.ui.autocomplete.filter(array, request.term));\r\n                };\r\n            } else if (typeof this.options.source === \"string\") {\r\n                url = this.options.source;\r\n                this.source = function (request, response) {\r\n                    if (that.xhr) {\r\n                        that.xhr.abort();\r\n                    }\r\n                    that.xhr = $.ajax({\r\n                        url: url,\r\n                        data: request,\r\n                        dataType: \"json\",\r\n                        success: function (data) {\r\n                            response(data);\r\n                        },\r\n                        error: function () {\r\n                            response([]);\r\n                        }\r\n                    });\r\n                };\r\n            } else {\r\n                this.source = this.options.source;\r\n            }\r\n        },\r\n\r\n        _searchTimeout: function (event) {\r\n            clearTimeout(this.searching);\r\n            this.searching = this._delay(function () {\r\n                // only search if the value has changed\r\n                if (this.term !== this._value()) {\r\n                    this.selectedItem = null;\r\n                    this.search(null, event);\r\n                }\r\n            }, this.options.delay);\r\n        },\r\n\r\n        search: function (value, event) {\r\n            value = value != null ? value : this._value();\r\n\r\n            // always save the actual value, not the one passed as an argument\r\n            this.term = this._value();\r\n\r\n            if (value.length < this.options.minLength) {\r\n                return this.close(event);\r\n            }\r\n\r\n            if (this._trigger(\"search\", event) === false) {\r\n                return;\r\n            }\r\n\r\n            return this._search(value);\r\n        },\r\n\r\n        _search: function (value) {\r\n            this.pending++;\r\n            this.element.addClass(\"ui-autocomplete-loading\");\r\n            this.cancelSearch = false;\r\n\r\n            this.source({term: value}, this._response());\r\n        },\r\n\r\n        _response: function () {\r\n            var index = ++this.requestIndex;\r\n\r\n            return $.proxy(function (content) {\r\n                if (index === this.requestIndex) {\r\n                    this.__response(content);\r\n                }\r\n\r\n                this.pending--;\r\n                if (!this.pending) {\r\n                    this.element.removeClass(\"ui-autocomplete-loading\");\r\n                }\r\n            }, this);\r\n        },\r\n\r\n        __response: function (content) {\r\n            if (content) {\r\n                content = this._normalize(content);\r\n            }\r\n            this._trigger(\"response\", null, {content: content});\r\n            if (!this.options.disabled && content && content.length && !this.cancelSearch) {\r\n                this._suggest(content);\r\n                this._trigger(\"open\");\r\n            } else {\r\n                // use ._close() instead of .close() so we don't cancel future searches\r\n                this._close();\r\n            }\r\n        },\r\n\r\n        close: function (event) {\r\n            this.cancelSearch = true;\r\n            this._close(event);\r\n        },\r\n\r\n        _close: function (event) {\r\n            if (this.menu.element.is(\":visible\")) {\r\n                this.menu.element.hide();\r\n                this.menu.blur();\r\n                this.isNewMenu = true;\r\n                this._trigger(\"close\", event);\r\n            }\r\n        },\r\n\r\n        _change: function (event) {\r\n            if (this.previous !== this._value()) {\r\n                this._trigger(\"change\", event, {item: this.selectedItem});\r\n            }\r\n        },\r\n\r\n        _normalize: function (items) {\r\n            // assume all items have the right format when the first item is complete\r\n            if (items.length && items[0].label && items[0].value) {\r\n                return items;\r\n            }\r\n            return $.map(items, function (item) {\r\n                if (typeof item === \"string\") {\r\n                    return {\r\n                        label: item,\r\n                        value: item\r\n                    };\r\n                }\r\n                return $.extend({\r\n                    label: item.label || item.value,\r\n                    value: item.value || item.label\r\n                }, item);\r\n            });\r\n        },\r\n\r\n        _suggest: function (items) {\r\n            var ul = this.menu.element.empty();\r\n            this._renderMenu(ul, items);\r\n            this.isNewMenu = true;\r\n            this.menu.refresh();\r\n\r\n            // size and position menu\r\n            ul.show();\r\n            this._resizeMenu();\r\n            ul.position($.extend({\r\n                of: this.element\r\n            }, this.options.position));\r\n\r\n            if (this.options.autoFocus) {\r\n                this.menu.next();\r\n            }\r\n        },\r\n\r\n        _resizeMenu: function () {\r\n            var ul = this.menu.element;\r\n            ul.outerWidth(Math.max(\r\n                // Firefox wraps long text (possibly a rounding bug)\r\n                // so we add 1px to avoid the wrapping (#7513)\r\n                ul.width(\"\").outerWidth() + 1,\r\n                this.element.outerWidth()\r\n            ));\r\n        },\r\n\r\n        _renderMenu: function (ul, items) {\r\n            var that = this;\r\n            $.each(items, function (index, item) {\r\n                that._renderItemData(ul, item);\r\n            });\r\n        },\r\n\r\n        _renderItemData: function (ul, item) {\r\n            return this._renderItem(ul, item).data(\"ui-autocomplete-item\", item);\r\n        },\r\n\r\n        _renderItem: function (ul, item) {\r\n            return $(\"<li>\")\r\n                .append($(\"<a>\").text(item.label))\r\n                .appendTo(ul);\r\n        },\r\n\r\n        _move: function (direction, event) {\r\n            if (!this.menu.element.is(\":visible\")) {\r\n                this.search(null, event);\r\n                return;\r\n            }\r\n            if (this.menu.isFirstItem() && /^previous/.test(direction) ||\r\n                this.menu.isLastItem() && /^next/.test(direction)) {\r\n                this._value(this.term);\r\n                this.menu.blur();\r\n                return;\r\n            }\r\n            this.menu[direction](event);\r\n        },\r\n\r\n        widget: function () {\r\n            return this.menu.element;\r\n        },\r\n\r\n        _value: function () {\r\n            return this.valueMethod.apply(this.element, arguments);\r\n        },\r\n\r\n        _keyEvent: function (keyEvent, event) {\r\n            if (!this.isMultiLine || this.menu.element.is(\":visible\")) {\r\n                this._move(keyEvent, event);\r\n\r\n                // prevents moving cursor to beginning/end of the text field in some browsers\r\n                event.preventDefault();\r\n            }\r\n        }\r\n    });\r\n\r\n    $.extend($.ui.autocomplete, {\r\n        escapeRegex: function (value) {\r\n            return value.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g, \"\\\\$&\");\r\n        },\r\n        filter: function (array, term) {\r\n            var matcher = new RegExp($.ui.autocomplete.escapeRegex(term), \"i\");\r\n            return $.grep(array, function (value) {\r\n                return matcher.test(value.label || value.value || value);\r\n            });\r\n        }\r\n    });\r\n\r\n\r\n    // live region extension, adding a `messages` option\r\n    // NOTE: This is an experimental API. We are still investigating\r\n    // a full solution for string manipulation and internationalization.\r\n    $.widget(\"ui.autocomplete\", $.ui.autocomplete, {\r\n        options: {\r\n            messages: {\r\n                noResults: \"No search results.\",\r\n                results: function (amount) {\r\n                    return amount + (amount > 1 ? \" results are\" : \" result is\") +\r\n                        \" available, use up and down arrow keys to navigate.\";\r\n                }\r\n            }\r\n        },\r\n\r\n        __response: function (content) {\r\n            var message;\r\n            this._superApply(arguments);\r\n            if (this.options.disabled || this.cancelSearch) {\r\n                return;\r\n            }\r\n            if (content && content.length) {\r\n                message = this.options.messages.results(content.length);\r\n            } else {\r\n                message = this.options.messages.noResults;\r\n            }\r\n            this.liveRegion.text(message);\r\n        }\r\n    });\r\n});\r\n","jquery/ui-modules/button.js":"/*!\r\n * jQuery UI Button - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/button/\r\n */\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/core',\r\n    'jquery-ui-modules/widget'\r\n], function ($, undefined) {\r\n\r\n    var lastActive,\r\n        baseClasses = \"ui-button ui-widget ui-state-default ui-corner-all\",\r\n        typeClasses = \"ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only\",\r\n        formResetHandler = function () {\r\n            var form = $(this);\r\n            setTimeout(function () {\r\n                form.find(\":ui-button\").button(\"refresh\");\r\n            }, 1);\r\n        },\r\n        radioGroup = function (radio) {\r\n            var name = radio.name,\r\n                form = radio.form,\r\n                radios = $([]);\r\n            if (name) {\r\n                name = name.replace(/'/g, \"\\\\'\");\r\n                if (form) {\r\n                    radios = $(form).find(\"[name='\" + name + \"']\");\r\n                } else {\r\n                    radios = $(\"[name='\" + name + \"']\", radio.ownerDocument)\r\n                        .filter(function () {\r\n                            return !this.form;\r\n                        });\r\n                }\r\n            }\r\n            return radios;\r\n        };\r\n\r\n    $.widget(\"ui.button\", {\r\n        version: \"1.10.4\",\r\n        defaultElement: \"<button>\",\r\n        options: {\r\n            disabled: null,\r\n            text: true,\r\n            label: null,\r\n            icons: {\r\n                primary: null,\r\n                secondary: null\r\n            }\r\n        },\r\n        _create: function () {\r\n            this.element.closest(\"form\")\r\n                .unbind(\"reset\" + this.eventNamespace)\r\n                .bind(\"reset\" + this.eventNamespace, formResetHandler);\r\n\r\n            if (typeof this.options.disabled !== \"boolean\") {\r\n                this.options.disabled = !!this.element.prop(\"disabled\");\r\n            } else {\r\n                this.element.prop(\"disabled\", this.options.disabled);\r\n            }\r\n\r\n            this._determineButtonType();\r\n            this.hasTitle = !!this.buttonElement.attr(\"title\");\r\n\r\n            var that = this,\r\n                options = this.options,\r\n                toggleButton = this.type === \"checkbox\" || this.type === \"radio\",\r\n                activeClass = !toggleButton ? \"ui-state-active\" : \"\";\r\n\r\n            if (options.label === null) {\r\n                options.label = (this.type === \"input\" ? this.buttonElement.val() : this.buttonElement.html());\r\n            }\r\n\r\n            this._hoverable(this.buttonElement);\r\n\r\n            this.buttonElement\r\n                .addClass(baseClasses)\r\n                .attr(\"role\", \"button\")\r\n                .bind(\"mouseenter\" + this.eventNamespace, function () {\r\n                    if (options.disabled) {\r\n                        return;\r\n                    }\r\n                    if (this === lastActive) {\r\n                        $(this).addClass(\"ui-state-active\");\r\n                    }\r\n                })\r\n                .bind(\"mouseleave\" + this.eventNamespace, function () {\r\n                    if (options.disabled) {\r\n                        return;\r\n                    }\r\n                    $(this).removeClass(activeClass);\r\n                })\r\n                .bind(\"click\" + this.eventNamespace, function (event) {\r\n                    if (options.disabled) {\r\n                        event.preventDefault();\r\n                        event.stopImmediatePropagation();\r\n                    }\r\n                });\r\n\r\n            // Can't use _focusable() because the element that receives focus\r\n            // and the element that gets the ui-state-focus class are different\r\n            this._on({\r\n                focus: function () {\r\n                    this.buttonElement.addClass(\"ui-state-focus\");\r\n                },\r\n                blur: function () {\r\n                    this.buttonElement.removeClass(\"ui-state-focus\");\r\n                }\r\n            });\r\n\r\n            if (toggleButton) {\r\n                this.element.bind(\"change\" + this.eventNamespace, function () {\r\n                    that.refresh();\r\n                });\r\n            }\r\n\r\n            if (this.type === \"checkbox\") {\r\n                this.buttonElement.bind(\"click\" + this.eventNamespace, function () {\r\n                    if (options.disabled) {\r\n                        return false;\r\n                    }\r\n                });\r\n            } else if (this.type === \"radio\") {\r\n                this.buttonElement.bind(\"click\" + this.eventNamespace, function () {\r\n                    if (options.disabled) {\r\n                        return false;\r\n                    }\r\n                    $(this).addClass(\"ui-state-active\");\r\n                    that.buttonElement.attr(\"aria-pressed\", \"true\");\r\n\r\n                    var radio = that.element[0];\r\n                    radioGroup(radio)\r\n                        .not(radio)\r\n                        .map(function () {\r\n                            return $(this).button(\"widget\")[0];\r\n                        })\r\n                        .removeClass(\"ui-state-active\")\r\n                        .attr(\"aria-pressed\", \"false\");\r\n                });\r\n            } else {\r\n                this.buttonElement\r\n                    .bind(\"mousedown\" + this.eventNamespace, function () {\r\n                        if (options.disabled) {\r\n                            return false;\r\n                        }\r\n                        $(this).addClass(\"ui-state-active\");\r\n                        lastActive = this;\r\n                        that.document.one(\"mouseup\", function () {\r\n                            lastActive = null;\r\n                        });\r\n                    })\r\n                    .bind(\"mouseup\" + this.eventNamespace, function () {\r\n                        if (options.disabled) {\r\n                            return false;\r\n                        }\r\n                        $(this).removeClass(\"ui-state-active\");\r\n                    })\r\n                    .bind(\"keydown\" + this.eventNamespace, function (event) {\r\n                        if (options.disabled) {\r\n                            return false;\r\n                        }\r\n                        if (event.keyCode === $.ui.keyCode.SPACE || event.keyCode === $.ui.keyCode.ENTER) {\r\n                            $(this).addClass(\"ui-state-active\");\r\n                        }\r\n                    })\r\n                    // see #8559, we bind to blur here in case the button element loses\r\n                    // focus between keydown and keyup, it would be left in an \"active\" state\r\n                    .bind(\"keyup\" + this.eventNamespace + \" blur\" + this.eventNamespace, function () {\r\n                        $(this).removeClass(\"ui-state-active\");\r\n                    });\r\n\r\n                if (this.buttonElement.is(\"a\")) {\r\n                    this.buttonElement.keyup(function (event) {\r\n                        if (event.keyCode === $.ui.keyCode.SPACE) {\r\n                            // TODO pass through original event correctly (just as 2nd argument doesn't work)\r\n                            $(this).click();\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            // TODO: pull out $.Widget's handling for the disabled option into\r\n            // $.Widget.prototype._setOptionDisabled so it's easy to proxy and can\r\n            // be overridden by individual plugins\r\n            this._setOption(\"disabled\", options.disabled);\r\n            this._resetButton();\r\n        },\r\n\r\n        _determineButtonType: function () {\r\n            var ancestor, labelSelector, checked;\r\n\r\n            if (this.element.is(\"[type=checkbox]\")) {\r\n                this.type = \"checkbox\";\r\n            } else if (this.element.is(\"[type=radio]\")) {\r\n                this.type = \"radio\";\r\n            } else if (this.element.is(\"input\")) {\r\n                this.type = \"input\";\r\n            } else {\r\n                this.type = \"button\";\r\n            }\r\n\r\n            if (this.type === \"checkbox\" || this.type === \"radio\") {\r\n                // we don't search against the document in case the element\r\n                // is disconnected from the DOM\r\n                ancestor = this.element.parents().last();\r\n                labelSelector = \"label[for='\" + this.element.attr(\"id\") + \"']\";\r\n                this.buttonElement = ancestor.find(labelSelector);\r\n                if (!this.buttonElement.length) {\r\n                    ancestor = ancestor.length ? ancestor.siblings() : this.element.siblings();\r\n                    this.buttonElement = ancestor.filter(labelSelector);\r\n                    if (!this.buttonElement.length) {\r\n                        this.buttonElement = ancestor.find(labelSelector);\r\n                    }\r\n                }\r\n                this.element.addClass(\"ui-helper-hidden-accessible\");\r\n\r\n                checked = this.element.is(\":checked\");\r\n                if (checked) {\r\n                    this.buttonElement.addClass(\"ui-state-active\");\r\n                }\r\n                this.buttonElement.prop(\"aria-pressed\", checked);\r\n            } else {\r\n                this.buttonElement = this.element;\r\n            }\r\n        },\r\n\r\n        widget: function () {\r\n            return this.buttonElement;\r\n        },\r\n\r\n        _destroy: function () {\r\n            this.element\r\n                .removeClass(\"ui-helper-hidden-accessible\");\r\n            this.buttonElement\r\n                .removeClass(baseClasses + \" ui-state-active \" + typeClasses)\r\n                .removeAttr(\"role\")\r\n                .removeAttr(\"aria-pressed\")\r\n                .html(this.buttonElement.find(\".ui-button-text\").html());\r\n\r\n            if (!this.hasTitle) {\r\n                this.buttonElement.removeAttr(\"title\");\r\n            }\r\n        },\r\n\r\n        _setOption: function (key, value) {\r\n            this._super(key, value);\r\n            if (key === \"disabled\") {\r\n                this.element.prop(\"disabled\", !!value);\r\n                if (value) {\r\n                    this.buttonElement.removeClass(\"ui-state-focus\");\r\n                }\r\n                return;\r\n            }\r\n            this._resetButton();\r\n        },\r\n\r\n        refresh: function () {\r\n            //See #8237 & #8828\r\n            var isDisabled = this.element.is(\"input, button\") ? this.element.is(\":disabled\") : this.element.hasClass(\"ui-button-disabled\");\r\n\r\n            if (isDisabled !== this.options.disabled) {\r\n                this._setOption(\"disabled\", isDisabled);\r\n            }\r\n            if (this.type === \"radio\") {\r\n                radioGroup(this.element[0]).each(function () {\r\n                    if ($(this).is(\":checked\")) {\r\n                        $(this).button(\"widget\")\r\n                            .addClass(\"ui-state-active\")\r\n                            .attr(\"aria-pressed\", \"true\");\r\n                    } else {\r\n                        $(this).button(\"widget\")\r\n                            .removeClass(\"ui-state-active\")\r\n                            .attr(\"aria-pressed\", \"false\");\r\n                    }\r\n                });\r\n            } else if (this.type === \"checkbox\") {\r\n                if (this.element.is(\":checked\")) {\r\n                    this.buttonElement\r\n                        .addClass(\"ui-state-active\")\r\n                        .attr(\"aria-pressed\", \"true\");\r\n                } else {\r\n                    this.buttonElement\r\n                        .removeClass(\"ui-state-active\")\r\n                        .attr(\"aria-pressed\", \"false\");\r\n                }\r\n            }\r\n        },\r\n\r\n        _resetButton: function () {\r\n            if (this.type === \"input\") {\r\n                if (this.options.label) {\r\n                    this.element.val(this.options.label);\r\n                }\r\n                return;\r\n            }\r\n            var buttonElement = this.buttonElement.removeClass(typeClasses),\r\n                buttonText = $(\"<span></span>\", this.document[0])\r\n                    .addClass(\"ui-button-text\")\r\n                    .html(this.options.label)\r\n                    .appendTo(buttonElement.empty())\r\n                    .text(),\r\n                icons = this.options.icons,\r\n                multipleIcons = icons.primary && icons.secondary,\r\n                buttonClasses = [];\r\n\r\n            if (icons.primary || icons.secondary) {\r\n                if (this.options.text) {\r\n                    buttonClasses.push(\"ui-button-text-icon\" + (multipleIcons ? \"s\" : (icons.primary ? \"-primary\" : \"-secondary\")));\r\n                }\r\n\r\n                if (icons.primary) {\r\n                    buttonElement.prepend(\"<span class='ui-button-icon-primary ui-icon \" + icons.primary + \"'></span>\");\r\n                }\r\n\r\n                if (icons.secondary) {\r\n                    buttonElement.append(\"<span class='ui-button-icon-secondary ui-icon \" + icons.secondary + \"'></span>\");\r\n                }\r\n\r\n                if (!this.options.text) {\r\n                    buttonClasses.push(multipleIcons ? \"ui-button-icons-only\" : \"ui-button-icon-only\");\r\n\r\n                    if (!this.hasTitle) {\r\n                        buttonElement.attr(\"title\", $.trim(buttonText));\r\n                    }\r\n                }\r\n            } else {\r\n                buttonClasses.push(\"ui-button-text-only\");\r\n            }\r\n            buttonElement.addClass(buttonClasses.join(\" \"));\r\n        }\r\n    });\r\n\r\n    $.widget(\"ui.buttonset\", {\r\n        version: \"1.10.4\",\r\n        options: {\r\n            items: \"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)\"\r\n        },\r\n\r\n        _create: function () {\r\n            this.element.addClass(\"ui-buttonset\");\r\n        },\r\n\r\n        _init: function () {\r\n            this.refresh();\r\n        },\r\n\r\n        _setOption: function (key, value) {\r\n            if (key === \"disabled\") {\r\n                this.buttons.button(\"option\", key, value);\r\n            }\r\n\r\n            this._super(key, value);\r\n        },\r\n\r\n        refresh: function () {\r\n            var rtl = this.element.css(\"direction\") === \"rtl\";\r\n\r\n            this.buttons = this.element.find(this.options.items)\r\n                .filter(\":ui-button\")\r\n                .button(\"refresh\")\r\n                .end()\r\n                .not(\":ui-button\")\r\n                .button()\r\n                .end()\r\n                .map(function () {\r\n                    return $(this).button(\"widget\")[0];\r\n                })\r\n                .removeClass(\"ui-corner-all ui-corner-left ui-corner-right\")\r\n                .filter(\":first\")\r\n                .addClass(rtl ? \"ui-corner-right\" : \"ui-corner-left\")\r\n                .end()\r\n                .filter(\":last\")\r\n                .addClass(rtl ? \"ui-corner-left\" : \"ui-corner-right\")\r\n                .end()\r\n                .end();\r\n        },\r\n\r\n        _destroy: function () {\r\n            this.element.removeClass(\"ui-buttonset\");\r\n            this.buttons\r\n                .map(function () {\r\n                    return $(this).button(\"widget\")[0];\r\n                })\r\n                .removeClass(\"ui-corner-left ui-corner-right\")\r\n                .end()\r\n                .button(\"destroy\");\r\n        }\r\n    });\r\n\r\n});\r\n","jquery/ui-modules/core.js":"/*!\r\n * jQuery UI Core - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/category/ui-core/\r\n */\r\ndefine([\r\n    'jquery'\r\n], function ($, undefined) {\r\n\r\n    var uuid = 0,\r\n        runiqueId = /^ui-id-\\d+$/;\r\n\r\n// $.ui might exist from components with no dependencies, e.g., $.ui.position\r\n    $.ui = $.ui || {};\r\n\r\n    $.extend($.ui, {\r\n        version: \"1.10.4\",\r\n\r\n        keyCode: {\r\n            BACKSPACE: 8,\r\n            COMMA: 188,\r\n            DELETE: 46,\r\n            DOWN: 40,\r\n            END: 35,\r\n            ENTER: 13,\r\n            ESCAPE: 27,\r\n            HOME: 36,\r\n            LEFT: 37,\r\n            NUMPAD_ADD: 107,\r\n            NUMPAD_DECIMAL: 110,\r\n            NUMPAD_DIVIDE: 111,\r\n            NUMPAD_ENTER: 108,\r\n            NUMPAD_MULTIPLY: 106,\r\n            NUMPAD_SUBTRACT: 109,\r\n            PAGE_DOWN: 34,\r\n            PAGE_UP: 33,\r\n            PERIOD: 190,\r\n            RIGHT: 39,\r\n            SPACE: 32,\r\n            TAB: 9,\r\n            UP: 38\r\n        }\r\n    });\r\n\r\n// plugins\r\n    $.fn.extend({\r\n        focus: (function (orig) {\r\n            return function (delay, fn) {\r\n                return typeof delay === \"number\" ?\r\n                    this.each(function () {\r\n                        var elem = this;\r\n                        setTimeout(function () {\r\n                            $(elem).focus();\r\n                            if (fn) {\r\n                                fn.call(elem);\r\n                            }\r\n                        }, delay);\r\n                    }) :\r\n                    orig.apply(this, arguments);\r\n            };\r\n        })($.fn.focus),\r\n\r\n        scrollParent: function () {\r\n            var scrollParent;\r\n            if (($.ui.ie && (/(static|relative)/).test(this.css(\"position\"))) || (/absolute/).test(this.css(\"position\"))) {\r\n                scrollParent = this.parents().filter(function () {\r\n                    return (/(relative|absolute|fixed)/).test($.css(this, \"position\")) && (/(auto|scroll)/).test($.css(this, \"overflow\") + $.css(this, \"overflow-y\") + $.css(this, \"overflow-x\"));\r\n                }).eq(0);\r\n            } else {\r\n                scrollParent = this.parents().filter(function () {\r\n                    return (/(auto|scroll)/).test($.css(this, \"overflow\") + $.css(this, \"overflow-y\") + $.css(this, \"overflow-x\"));\r\n                }).eq(0);\r\n            }\r\n\r\n            return (/fixed/).test(this.css(\"position\")) || !scrollParent.length ? $(document) : scrollParent;\r\n        },\r\n\r\n        zIndex: function (zIndex) {\r\n            if (zIndex !== undefined) {\r\n                return this.css(\"zIndex\", zIndex);\r\n            }\r\n\r\n            if (this.length) {\r\n                var elem = $(this[0]), position, value;\r\n                while (elem.length && elem[0] !== document) {\r\n                    // Ignore z-index if position is set to a value where z-index is ignored by the browser\r\n                    // This makes behavior of this function consistent across browsers\r\n                    // WebKit always returns auto if the element is positioned\r\n                    position = elem.css(\"position\");\r\n                    if (position === \"absolute\" || position === \"relative\" || position === \"fixed\") {\r\n                        // IE returns 0 when zIndex is not specified\r\n                        // other browsers return a string\r\n                        // we ignore the case of nested elements with an explicit value of 0\r\n                        // <div style=\"z-index: -10;\"><div style=\"z-index: 0;\"></div></div>\r\n                        value = parseInt(elem.css(\"zIndex\"), 10);\r\n                        if (!isNaN(value) && value !== 0) {\r\n                            return value;\r\n                        }\r\n                    }\r\n                    elem = elem.parent();\r\n                }\r\n            }\r\n\r\n            return 0;\r\n        },\r\n\r\n        uniqueId: function () {\r\n            return this.each(function () {\r\n                if (!this.id) {\r\n                    this.id = \"ui-id-\" + (++uuid);\r\n                }\r\n            });\r\n        },\r\n\r\n        removeUniqueId: function () {\r\n            return this.each(function () {\r\n                if (runiqueId.test(this.id)) {\r\n                    $(this).removeAttr(\"id\");\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n// selectors\r\n    function focusable(element, isTabIndexNotNaN) {\r\n        var map, mapName, img,\r\n            nodeName = element.nodeName.toLowerCase();\r\n        if (\"area\" === nodeName) {\r\n            map = element.parentNode;\r\n            mapName = map.name;\r\n            if (!element.href || !mapName || map.nodeName.toLowerCase() !== \"map\") {\r\n                return false;\r\n            }\r\n            img = $(\"img[usemap=#\" + mapName + \"]\")[0];\r\n            return !!img && visible(img);\r\n        }\r\n        return (/input|select|textarea|button|object/.test(nodeName) ?\r\n            !element.disabled :\r\n            \"a\" === nodeName ?\r\n                element.href || isTabIndexNotNaN :\r\n                isTabIndexNotNaN) &&\r\n            // the element and all of its ancestors must be visible\r\n            visible(element);\r\n    }\r\n\r\n    function visible(element) {\r\n        return $.expr.filters.visible(element) &&\r\n            !$(element).parents().addBack().filter(function () {\r\n                return $.css(this, \"visibility\") === \"hidden\";\r\n            }).length;\r\n    }\r\n\r\n    $.extend($.expr[\":\"], {\r\n        data: $.expr.createPseudo ?\r\n            $.expr.createPseudo(function (dataName) {\r\n                return function (elem) {\r\n                    return !!$.data(elem, dataName);\r\n                };\r\n            }) :\r\n            // support: jQuery <1.8\r\n            function (elem, i, match) {\r\n                return !!$.data(elem, match[3]);\r\n            },\r\n\r\n        focusable: function (element) {\r\n            return focusable(element, !isNaN($.attr(element, \"tabindex\")));\r\n        },\r\n\r\n        tabbable: function (element) {\r\n            var tabIndex = $.attr(element, \"tabindex\"),\r\n                isTabIndexNaN = isNaN(tabIndex);\r\n            return (isTabIndexNaN || tabIndex >= 0) && focusable(element, !isTabIndexNaN);\r\n        }\r\n    });\r\n\r\n// support: jQuery <1.8\r\n    if (!$(\"<a>\").outerWidth(1).jquery) {\r\n        $.each([\"Width\", \"Height\"], function (i, name) {\r\n            var side = name === \"Width\" ? [\"Left\", \"Right\"] : [\"Top\", \"Bottom\"],\r\n                type = name.toLowerCase(),\r\n                orig = {\r\n                    innerWidth: $.fn.innerWidth,\r\n                    innerHeight: $.fn.innerHeight,\r\n                    outerWidth: $.fn.outerWidth,\r\n                    outerHeight: $.fn.outerHeight\r\n                };\r\n\r\n            function reduce(elem, size, border, margin) {\r\n                $.each(side, function () {\r\n                    size -= parseFloat($.css(elem, \"padding\" + this)) || 0;\r\n                    if (border) {\r\n                        size -= parseFloat($.css(elem, \"border\" + this + \"Width\")) || 0;\r\n                    }\r\n                    if (margin) {\r\n                        size -= parseFloat($.css(elem, \"margin\" + this)) || 0;\r\n                    }\r\n                });\r\n                return size;\r\n            }\r\n\r\n            $.fn[\"inner\" + name] = function (size) {\r\n                if (size === undefined) {\r\n                    return orig[\"inner\" + name].call(this);\r\n                }\r\n\r\n                return this.each(function () {\r\n                    $(this).css(type, reduce(this, size) + \"px\");\r\n                });\r\n            };\r\n\r\n            $.fn[\"outer\" + name] = function (size, margin) {\r\n                if (typeof size !== \"number\") {\r\n                    return orig[\"outer\" + name].call(this, size);\r\n                }\r\n\r\n                return this.each(function () {\r\n                    $(this).css(type, reduce(this, size, true, margin) + \"px\");\r\n                });\r\n            };\r\n        });\r\n    }\r\n\r\n// support: jQuery <1.8\r\n    if (!$.fn.addBack) {\r\n        $.fn.addBack = function (selector) {\r\n            return this.add(selector == null ?\r\n                this.prevObject : this.prevObject.filter(selector)\r\n            );\r\n        };\r\n    }\r\n\r\n// support: jQuery 1.6.1, 1.6.2 (http://bugs.jquery.com/ticket/9413)\r\n    if ($(\"<a>\").data(\"a-b\", \"a\").removeData(\"a-b\").data(\"a-b\")) {\r\n        $.fn.removeData = (function (removeData) {\r\n            return function (key) {\r\n                if (arguments.length) {\r\n                    return removeData.call(this, $.camelCase(key));\r\n                } else {\r\n                    return removeData.call(this);\r\n                }\r\n            };\r\n        })($.fn.removeData);\r\n    }\r\n\r\n\r\n// deprecated\r\n    $.ui.ie = !!/msie [\\w.]+/.exec(navigator.userAgent.toLowerCase());\r\n\r\n    $.support.selectstart = \"onselectstart\" in document.createElement(\"div\");\r\n    $.fn.extend({\r\n        disableSelection: function () {\r\n            return this.bind(($.support.selectstart ? \"selectstart\" : \"mousedown\") +\r\n                \".ui-disableSelection\", function (event) {\r\n                event.preventDefault();\r\n            });\r\n        },\r\n\r\n        enableSelection: function () {\r\n            return this.unbind(\".ui-disableSelection\");\r\n        }\r\n    });\r\n\r\n    $.extend($.ui, {\r\n        // $.ui.plugin is deprecated. Use $.widget() extensions instead.\r\n        plugin: {\r\n            add: function (module, option, set) {\r\n                var i,\r\n                    proto = $.ui[module].prototype;\r\n                for (i in set) {\r\n                    proto.plugins[i] = proto.plugins[i] || [];\r\n                    proto.plugins[i].push([option, set[i]]);\r\n                }\r\n            },\r\n            call: function (instance, name, args) {\r\n                var i,\r\n                    set = instance.plugins[name];\r\n                if (!set || !instance.element[0].parentNode || instance.element[0].parentNode.nodeType === 11) {\r\n                    return;\r\n                }\r\n\r\n                for (i = 0; i < set.length; i++) {\r\n                    if (instance.options[set[i][0]]) {\r\n                        set[i][1].apply(instance.element, args);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        // only used by resizable\r\n        hasScroll: function (el, a) {\r\n\r\n            //If overflow is hidden, the element might have extra content, but the user wants to hide it\r\n            if ($(el).css(\"overflow\") === \"hidden\") {\r\n                return false;\r\n            }\r\n\r\n            var scroll = (a && a === \"left\") ? \"scrollLeft\" : \"scrollTop\",\r\n                has = false;\r\n\r\n            if (el[scroll] > 0) {\r\n                return true;\r\n            }\r\n\r\n            // TODO: determine which cases actually cause this to happen\r\n            // if the element doesn't have the scroll set, see if it's possible to\r\n            // set the scroll\r\n            el[scroll] = 1;\r\n            has = (el[scroll] > 0);\r\n            el[scroll] = 0;\r\n            return has;\r\n        }\r\n    });\r\n\r\n});\r\n","jquery/ui-modules/datepicker.js":"/*!\r\n * jQuery UI Datepicker - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/datepicker/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/core',\r\n], function ($, undefined) {\r\n\r\n    $.extend($.ui, {datepicker: {version: \"1.10.4\"}});\r\n\r\n    var PROP_NAME = \"datepicker\",\r\n        instActive;\r\n\r\n    /* Date picker manager.\r\n       Use the singleton instance of this class, $.datepicker, to interact with the date picker.\r\n       Settings for (groups of) date pickers are maintained in an instance object,\r\n       allowing multiple different settings on the same page. */\r\n\r\n    function Datepicker() {\r\n        this._curInst = null; // The current instance in use\r\n        this._keyEvent = false; // If the last event was a key event\r\n        this._disabledInputs = []; // List of date picker inputs that have been disabled\r\n        this._datepickerShowing = false; // True if the popup picker is showing , false if not\r\n        this._inDialog = false; // True if showing within a \"dialog\", false if not\r\n        this._mainDivId = \"ui-datepicker-div\"; // The ID of the main datepicker division\r\n        this._inlineClass = \"ui-datepicker-inline\"; // The name of the inline marker class\r\n        this._appendClass = \"ui-datepicker-append\"; // The name of the append marker class\r\n        this._triggerClass = \"ui-datepicker-trigger\"; // The name of the trigger marker class\r\n        this._dialogClass = \"ui-datepicker-dialog\"; // The name of the dialog marker class\r\n        this._disableClass = \"ui-datepicker-disabled\"; // The name of the disabled covering marker class\r\n        this._unselectableClass = \"ui-datepicker-unselectable\"; // The name of the unselectable cell marker class\r\n        this._currentClass = \"ui-datepicker-current-day\"; // The name of the current day marker class\r\n        this._dayOverClass = \"ui-datepicker-days-cell-over\"; // The name of the day hover marker class\r\n        this.regional = []; // Available regional settings, indexed by language code\r\n        this.regional[\"\"] = { // Default regional settings\r\n            closeText: \"Done\", // Display text for close link\r\n            prevText: \"Prev\", // Display text for previous month link\r\n            nextText: \"Next\", // Display text for next month link\r\n            currentText: \"Today\", // Display text for current month link\r\n            monthNames: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\r\n                \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"], // Names of months for drop-down and formatting\r\n            monthNamesShort: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"], // For formatting\r\n            dayNames: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"], // For formatting\r\n            dayNamesShort: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"], // For formatting\r\n            dayNamesMin: [\"Su\", \"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\"], // Column headings for days starting at Sunday\r\n            weekHeader: \"Wk\", // Column header for week of the year\r\n            dateFormat: \"mm/dd/yy\", // See format options on parseDate\r\n            firstDay: 0, // The first day of the week, Sun = 0, Mon = 1, ...\r\n            isRTL: false, // True if right-to-left language, false if left-to-right\r\n            showMonthAfterYear: false, // True if the year select precedes month, false for month then year\r\n            yearSuffix: \"\" // Additional text to append to the year in the month headers\r\n        };\r\n        this._defaults = { // Global defaults for all the date picker instances\r\n            showOn: \"focus\", // \"focus\" for popup on focus,\r\n            // \"button\" for trigger button, or \"both\" for either\r\n            showAnim: \"fadeIn\", // Name of jQuery animation for popup\r\n            showOptions: {}, // Options for enhanced animations\r\n            defaultDate: null, // Used when field is blank: actual date,\r\n            // +/-number for offset from today, null for today\r\n            appendText: \"\", // Display text following the input box, e.g. showing the format\r\n            buttonText: \"...\", // Text for trigger button\r\n            buttonImage: \"\", // URL for trigger button image\r\n            buttonImageOnly: false, // True if the image appears alone, false if it appears on a button\r\n            hideIfNoPrevNext: false, // True to hide next/previous month links\r\n            // if not applicable, false to just disable them\r\n            navigationAsDateFormat: false, // True if date formatting applied to prev/today/next links\r\n            gotoCurrent: false, // True if today link goes back to current selection instead\r\n            changeMonth: false, // True if month can be selected directly, false if only prev/next\r\n            changeYear: false, // True if year can be selected directly, false if only prev/next\r\n            yearRange: \"c-10:c+10\", // Range of years to display in drop-down,\r\n            // either relative to today's year (-nn:+nn), relative to currently displayed year\r\n            // (c-nn:c+nn), absolute (nnnn:nnnn), or a combination of the above (nnnn:-n)\r\n            showOtherMonths: false, // True to show dates in other months, false to leave blank\r\n            selectOtherMonths: false, // True to allow selection of dates in other months, false for unselectable\r\n            showWeek: false, // True to show week of the year, false to not show it\r\n            calculateWeek: this.iso8601Week, // How to calculate the week of the year,\r\n            // takes a Date and returns the number of the week for it\r\n            shortYearCutoff: \"+10\", // Short year values < this are in the current century,\r\n            // > this are in the previous century,\r\n            // string value starting with \"+\" for current year + value\r\n            minDate: null, // The earliest selectable date, or null for no limit\r\n            maxDate: null, // The latest selectable date, or null for no limit\r\n            duration: \"fast\", // Duration of display/closure\r\n            beforeShowDay: null, // Function that takes a date and returns an array with\r\n            // [0] = true if selectable, false if not, [1] = custom CSS class name(s) or \"\",\r\n            // [2] = cell title (optional), e.g. $.datepicker.noWeekends\r\n            beforeShow: null, // Function that takes an input field and\r\n            // returns a set of custom settings for the date picker\r\n            onSelect: null, // Define a callback function when a date is selected\r\n            onChangeMonthYear: null, // Define a callback function when the month or year is changed\r\n            onClose: null, // Define a callback function when the datepicker is closed\r\n            numberOfMonths: 1, // Number of months to show at a time\r\n            showCurrentAtPos: 0, // The position in multipe months at which to show the current month (starting at 0)\r\n            stepMonths: 1, // Number of months to step back/forward\r\n            stepBigMonths: 12, // Number of months to step back/forward for the big links\r\n            altField: \"\", // Selector for an alternate field to store selected dates into\r\n            altFormat: \"\", // The date format to use for the alternate field\r\n            constrainInput: true, // The input is constrained by the current date format\r\n            showButtonPanel: false, // True to show button panel, false to not show it\r\n            autoSize: false, // True to size the input for the date format, false to leave as is\r\n            disabled: false // The initial disabled state\r\n        };\r\n        $.extend(this._defaults, this.regional[\"\"]);\r\n        this.dpDiv = bindHover($(\"<div id='\" + this._mainDivId + \"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>\"));\r\n    }\r\n\r\n    $.extend(Datepicker.prototype, {\r\n        /* Class name added to elements to indicate already configured with a date picker. */\r\n        markerClassName: \"hasDatepicker\",\r\n\r\n        //Keep track of the maximum number of rows displayed (see #7043)\r\n        maxRows: 4,\r\n\r\n        // TODO rename to \"widget\" when switching to widget factory\r\n        _widgetDatepicker: function () {\r\n            return this.dpDiv;\r\n        },\r\n\r\n        /* Override the default settings for all instances of the date picker.\r\n         * @param  settings  object - the new settings to use as defaults (anonymous object)\r\n         * @return the manager object\r\n         */\r\n        setDefaults: function (settings) {\r\n            extendRemove(this._defaults, settings || {});\r\n            return this;\r\n        },\r\n\r\n        /* Attach the date picker to a jQuery selection.\r\n         * @param  target\telement - the target input field or division or span\r\n         * @param  settings  object - the new settings to use for this date picker instance (anonymous)\r\n         */\r\n        _attachDatepicker: function (target, settings) {\r\n            var nodeName, inline, inst;\r\n            nodeName = target.nodeName.toLowerCase();\r\n            inline = (nodeName === \"div\" || nodeName === \"span\");\r\n            if (!target.id) {\r\n                this.uuid += 1;\r\n                target.id = \"dp\" + this.uuid;\r\n            }\r\n            inst = this._newInst($(target), inline);\r\n            inst.settings = $.extend({}, settings || {});\r\n            if (nodeName === \"input\") {\r\n                this._connectDatepicker(target, inst);\r\n            } else if (inline) {\r\n                this._inlineDatepicker(target, inst);\r\n            }\r\n        },\r\n\r\n        /* Create a new instance object. */\r\n        _newInst: function (target, inline) {\r\n            var id = target[0].id.replace(/([^A-Za-z0-9_\\-])/g, \"\\\\\\\\$1\"); // escape jQuery meta chars\r\n            return {\r\n                id: id, input: target, // associated target\r\n                selectedDay: 0, selectedMonth: 0, selectedYear: 0, // current selection\r\n                drawMonth: 0, drawYear: 0, // month being drawn\r\n                inline: inline, // is datepicker inline or not\r\n                dpDiv: (!inline ? this.dpDiv : // presentation div\r\n                    bindHover($(\"<div class='\" + this._inlineClass + \" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>\")))\r\n            };\r\n        },\r\n\r\n        /* Attach the date picker to an input field. */\r\n        _connectDatepicker: function (target, inst) {\r\n            var input = $(target);\r\n            inst.append = $([]);\r\n            inst.trigger = $([]);\r\n            if (input.hasClass(this.markerClassName)) {\r\n                return;\r\n            }\r\n            this._attachments(input, inst);\r\n            input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp);\r\n            this._autoSize(inst);\r\n            $.data(target, PROP_NAME, inst);\r\n            //If disabled option is true, disable the datepicker once it has been attached to the input (see ticket #5665)\r\n            if (inst.settings.disabled) {\r\n                this._disableDatepicker(target);\r\n            }\r\n        },\r\n\r\n        /* Make attachments based on settings. */\r\n        _attachments: function (input, inst) {\r\n            var showOn, buttonText, buttonImage,\r\n                appendText = this._get(inst, \"appendText\"),\r\n                isRTL = this._get(inst, \"isRTL\");\r\n\r\n            if (inst.append) {\r\n                inst.append.remove();\r\n            }\r\n            if (appendText) {\r\n                inst.append = $(\"<span class='\" + this._appendClass + \"'>\" + appendText + \"</span>\");\r\n                input[isRTL ? \"before\" : \"after\"](inst.append);\r\n            }\r\n\r\n            input.unbind(\"focus\", this._showDatepicker);\r\n\r\n            if (inst.trigger) {\r\n                inst.trigger.remove();\r\n            }\r\n\r\n            showOn = this._get(inst, \"showOn\");\r\n            if (showOn === \"focus\" || showOn === \"both\") { // pop-up date picker when in the marked field\r\n                input.focus(this._showDatepicker);\r\n            }\r\n            if (showOn === \"button\" || showOn === \"both\") { // pop-up date picker when button clicked\r\n                buttonText = this._get(inst, \"buttonText\");\r\n                buttonImage = this._get(inst, \"buttonImage\");\r\n                inst.trigger = $(this._get(inst, \"buttonImageOnly\") ?\r\n                    $(\"<img/>\").addClass(this._triggerClass).attr({\r\n                        src: buttonImage,\r\n                        alt: buttonText,\r\n                        title: buttonText\r\n                    }) :\r\n                    $(\"<button type='button'></button>\").addClass(this._triggerClass).html(!buttonImage ? buttonText : $(\"<img/>\").attr(\r\n                        {src: buttonImage, alt: buttonText, title: buttonText})));\r\n                input[isRTL ? \"before\" : \"after\"](inst.trigger);\r\n                inst.trigger.click(function () {\r\n                    if ($.datepicker._datepickerShowing && $.datepicker._lastInput === input[0]) {\r\n                        $.datepicker._hideDatepicker();\r\n                    } else if ($.datepicker._datepickerShowing && $.datepicker._lastInput !== input[0]) {\r\n                        $.datepicker._hideDatepicker();\r\n                        $.datepicker._showDatepicker(input[0]);\r\n                    } else {\r\n                        $.datepicker._showDatepicker(input[0]);\r\n                    }\r\n                    return false;\r\n                });\r\n            }\r\n        },\r\n\r\n        /* Apply the maximum length for the date format. */\r\n        _autoSize: function (inst) {\r\n            if (this._get(inst, \"autoSize\") && !inst.inline) {\r\n                var findMax, max, maxI, i,\r\n                    date = new Date(2009, 12 - 1, 20), // Ensure double digits\r\n                    dateFormat = this._get(inst, \"dateFormat\");\r\n\r\n                if (dateFormat.match(/[DM]/)) {\r\n                    findMax = function (names) {\r\n                        max = 0;\r\n                        maxI = 0;\r\n                        for (i = 0; i < names.length; i++) {\r\n                            if (names[i].length > max) {\r\n                                max = names[i].length;\r\n                                maxI = i;\r\n                            }\r\n                        }\r\n                        return maxI;\r\n                    };\r\n                    date.setMonth(findMax(this._get(inst, (dateFormat.match(/MM/) ?\r\n                        \"monthNames\" : \"monthNamesShort\"))));\r\n                    date.setDate(findMax(this._get(inst, (dateFormat.match(/DD/) ?\r\n                        \"dayNames\" : \"dayNamesShort\"))) + 20 - date.getDay());\r\n                }\r\n                inst.input.attr(\"size\", this._formatDate(inst, date).length);\r\n            }\r\n        },\r\n\r\n        /* Attach an inline date picker to a div. */\r\n        _inlineDatepicker: function (target, inst) {\r\n            var divSpan = $(target);\r\n            if (divSpan.hasClass(this.markerClassName)) {\r\n                return;\r\n            }\r\n            divSpan.addClass(this.markerClassName).append(inst.dpDiv);\r\n            $.data(target, PROP_NAME, inst);\r\n            this._setDate(inst, this._getDefaultDate(inst), true);\r\n            this._updateDatepicker(inst);\r\n            this._updateAlternate(inst);\r\n            //If disabled option is true, disable the datepicker before showing it (see ticket #5665)\r\n            if (inst.settings.disabled) {\r\n                this._disableDatepicker(target);\r\n            }\r\n            // Set display:block in place of inst.dpDiv.show() which won't work on disconnected elements\r\n            // http://bugs.jqueryui.com/ticket/7552 - A Datepicker created on a detached div has zero height\r\n            inst.dpDiv.css(\"display\", \"block\");\r\n        },\r\n\r\n        /* Pop-up the date picker in a \"dialog\" box.\r\n         * @param  input element - ignored\r\n         * @param  date\tstring or Date - the initial date to display\r\n         * @param  onSelect  function - the function to call when a date is selected\r\n         * @param  settings  object - update the dialog date picker instance's settings (anonymous object)\r\n         * @param  pos int[2] - coordinates for the dialog's position within the screen or\r\n         *\t\t\t\t\tevent - with x/y coordinates or\r\n         *\t\t\t\t\tleave empty for default (screen centre)\r\n         * @return the manager object\r\n         */\r\n        _dialogDatepicker: function (input, date, onSelect, settings, pos) {\r\n            var id, browserWidth, browserHeight, scrollX, scrollY,\r\n                inst = this._dialogInst; // internal instance\r\n\r\n            if (!inst) {\r\n                this.uuid += 1;\r\n                id = \"dp\" + this.uuid;\r\n                this._dialogInput = $(\"<input type='text' id='\" + id +\r\n                    \"' style='position: absolute; top: -100px; width: 0px;'/>\");\r\n                this._dialogInput.keydown(this._doKeyDown);\r\n                $(\"body\").append(this._dialogInput);\r\n                inst = this._dialogInst = this._newInst(this._dialogInput, false);\r\n                inst.settings = {};\r\n                $.data(this._dialogInput[0], PROP_NAME, inst);\r\n            }\r\n            extendRemove(inst.settings, settings || {});\r\n            date = (date && date.constructor === Date ? this._formatDate(inst, date) : date);\r\n            this._dialogInput.val(date);\r\n\r\n            this._pos = (pos ? (pos.length ? pos : [pos.pageX, pos.pageY]) : null);\r\n            if (!this._pos) {\r\n                browserWidth = document.documentElement.clientWidth;\r\n                browserHeight = document.documentElement.clientHeight;\r\n                scrollX = document.documentElement.scrollLeft || document.body.scrollLeft;\r\n                scrollY = document.documentElement.scrollTop || document.body.scrollTop;\r\n                this._pos = // should use actual width/height below\r\n                    [(browserWidth / 2) - 100 + scrollX, (browserHeight / 2) - 150 + scrollY];\r\n            }\r\n\r\n            // move input on screen for focus, but hidden behind dialog\r\n            this._dialogInput.css(\"left\", (this._pos[0] + 20) + \"px\").css(\"top\", this._pos[1] + \"px\");\r\n            inst.settings.onSelect = onSelect;\r\n            this._inDialog = true;\r\n            this.dpDiv.addClass(this._dialogClass);\r\n            this._showDatepicker(this._dialogInput[0]);\r\n            if ($.blockUI) {\r\n                $.blockUI(this.dpDiv);\r\n            }\r\n            $.data(this._dialogInput[0], PROP_NAME, inst);\r\n            return this;\r\n        },\r\n\r\n        /* Detach a datepicker from its control.\r\n         * @param  target\telement - the target input field or division or span\r\n         */\r\n        _destroyDatepicker: function (target) {\r\n            var nodeName,\r\n                $target = $(target),\r\n                inst = $.data(target, PROP_NAME);\r\n\r\n            if (!$target.hasClass(this.markerClassName)) {\r\n                return;\r\n            }\r\n\r\n            nodeName = target.nodeName.toLowerCase();\r\n            $.removeData(target, PROP_NAME);\r\n            if (nodeName === \"input\") {\r\n                inst.append.remove();\r\n                inst.trigger.remove();\r\n                $target.removeClass(this.markerClassName).unbind(\"focus\", this._showDatepicker).unbind(\"keydown\", this._doKeyDown).unbind(\"keypress\", this._doKeyPress).unbind(\"keyup\", this._doKeyUp);\r\n            } else if (nodeName === \"div\" || nodeName === \"span\") {\r\n                $target.removeClass(this.markerClassName).empty();\r\n            }\r\n        },\r\n\r\n        /* Enable the date picker to a jQuery selection.\r\n         * @param  target\telement - the target input field or division or span\r\n         */\r\n        _enableDatepicker: function (target) {\r\n            var nodeName, inline,\r\n                $target = $(target),\r\n                inst = $.data(target, PROP_NAME);\r\n\r\n            if (!$target.hasClass(this.markerClassName)) {\r\n                return;\r\n            }\r\n\r\n            nodeName = target.nodeName.toLowerCase();\r\n            if (nodeName === \"input\") {\r\n                target.disabled = false;\r\n                inst.trigger.filter(\"button\").each(function () {\r\n                    this.disabled = false;\r\n                }).end().filter(\"img\").css({opacity: \"1.0\", cursor: \"\"});\r\n            } else if (nodeName === \"div\" || nodeName === \"span\") {\r\n                inline = $target.children(\".\" + this._inlineClass);\r\n                inline.children().removeClass(\"ui-state-disabled\");\r\n                inline.find(\"select.ui-datepicker-month, select.ui-datepicker-year\").prop(\"disabled\", false);\r\n            }\r\n            this._disabledInputs = $.map(this._disabledInputs,\r\n                function (value) {\r\n                    return (value === target ? null : value);\r\n                }); // delete entry\r\n        },\r\n\r\n        /* Disable the date picker to a jQuery selection.\r\n         * @param  target\telement - the target input field or division or span\r\n         */\r\n        _disableDatepicker: function (target) {\r\n            var nodeName, inline,\r\n                $target = $(target),\r\n                inst = $.data(target, PROP_NAME);\r\n\r\n            if (!$target.hasClass(this.markerClassName)) {\r\n                return;\r\n            }\r\n\r\n            nodeName = target.nodeName.toLowerCase();\r\n            if (nodeName === \"input\") {\r\n                target.disabled = true;\r\n                inst.trigger.filter(\"button\").each(function () {\r\n                    this.disabled = true;\r\n                }).end().filter(\"img\").css({opacity: \"0.5\", cursor: \"default\"});\r\n            } else if (nodeName === \"div\" || nodeName === \"span\") {\r\n                inline = $target.children(\".\" + this._inlineClass);\r\n                inline.children().addClass(\"ui-state-disabled\");\r\n                inline.find(\"select.ui-datepicker-month, select.ui-datepicker-year\").prop(\"disabled\", true);\r\n            }\r\n            this._disabledInputs = $.map(this._disabledInputs,\r\n                function (value) {\r\n                    return (value === target ? null : value);\r\n                }); // delete entry\r\n            this._disabledInputs[this._disabledInputs.length] = target;\r\n        },\r\n\r\n        /* Is the first field in a jQuery collection disabled as a datepicker?\r\n         * @param  target\telement - the target input field or division or span\r\n         * @return boolean - true if disabled, false if enabled\r\n         */\r\n        _isDisabledDatepicker: function (target) {\r\n            if (!target) {\r\n                return false;\r\n            }\r\n            for (var i = 0; i < this._disabledInputs.length; i++) {\r\n                if (this._disabledInputs[i] === target) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n\r\n        /* Retrieve the instance data for the target control.\r\n         * @param  target  element - the target input field or division or span\r\n         * @return  object - the associated instance data\r\n         * @throws  error if a jQuery problem getting data\r\n         */\r\n        _getInst: function (target) {\r\n            try {\r\n                return $.data(target, PROP_NAME);\r\n            } catch (err) {\r\n                throw \"Missing instance data for this datepicker\";\r\n            }\r\n        },\r\n\r\n        /* Update or retrieve the settings for a date picker attached to an input field or division.\r\n         * @param  target  element - the target input field or division or span\r\n         * @param  name\tobject - the new settings to update or\r\n         *\t\t\t\tstring - the name of the setting to change or retrieve,\r\n         *\t\t\t\twhen retrieving also \"all\" for all instance settings or\r\n         *\t\t\t\t\"defaults\" for all global defaults\r\n         * @param  value   any - the new value for the setting\r\n         *\t\t\t\t(omit if above is an object or to retrieve a value)\r\n         */\r\n        _optionDatepicker: function (target, name, value) {\r\n            var settings, date, minDate, maxDate,\r\n                inst = this._getInst(target);\r\n\r\n            if (arguments.length === 2 && typeof name === \"string\") {\r\n                return (name === \"defaults\" ? $.extend({}, $.datepicker._defaults) :\r\n                    (inst ? (name === \"all\" ? $.extend({}, inst.settings) :\r\n                        this._get(inst, name)) : null));\r\n            }\r\n\r\n            settings = name || {};\r\n            if (typeof name === \"string\") {\r\n                settings = {};\r\n                settings[name] = value;\r\n            }\r\n\r\n            if (inst) {\r\n                if (this._curInst === inst) {\r\n                    this._hideDatepicker();\r\n                }\r\n\r\n                date = this._getDateDatepicker(target, true);\r\n                minDate = this._getMinMaxDate(inst, \"min\");\r\n                maxDate = this._getMinMaxDate(inst, \"max\");\r\n                extendRemove(inst.settings, settings);\r\n                // reformat the old minDate/maxDate values if dateFormat changes and a new minDate/maxDate isn't provided\r\n                if (minDate !== null && settings.dateFormat !== undefined && settings.minDate === undefined) {\r\n                    inst.settings.minDate = this._formatDate(inst, minDate);\r\n                }\r\n                if (maxDate !== null && settings.dateFormat !== undefined && settings.maxDate === undefined) {\r\n                    inst.settings.maxDate = this._formatDate(inst, maxDate);\r\n                }\r\n                if (\"disabled\" in settings) {\r\n                    if (settings.disabled) {\r\n                        this._disableDatepicker(target);\r\n                    } else {\r\n                        this._enableDatepicker(target);\r\n                    }\r\n                }\r\n                this._attachments($(target), inst);\r\n                this._autoSize(inst);\r\n                this._setDate(inst, date);\r\n                this._updateAlternate(inst);\r\n                this._updateDatepicker(inst);\r\n            }\r\n        },\r\n\r\n        // change method deprecated\r\n        _changeDatepicker: function (target, name, value) {\r\n            this._optionDatepicker(target, name, value);\r\n        },\r\n\r\n        /* Redraw the date picker attached to an input field or division.\r\n         * @param  target  element - the target input field or division or span\r\n         */\r\n        _refreshDatepicker: function (target) {\r\n            var inst = this._getInst(target);\r\n            if (inst) {\r\n                this._updateDatepicker(inst);\r\n            }\r\n        },\r\n\r\n        /* Set the dates for a jQuery selection.\r\n         * @param  target element - the target input field or division or span\r\n         * @param  date\tDate - the new date\r\n         */\r\n        _setDateDatepicker: function (target, date) {\r\n            var inst = this._getInst(target);\r\n            if (inst) {\r\n                this._setDate(inst, date);\r\n                this._updateDatepicker(inst);\r\n                this._updateAlternate(inst);\r\n            }\r\n        },\r\n\r\n        /* Get the date(s) for the first entry in a jQuery selection.\r\n         * @param  target element - the target input field or division or span\r\n         * @param  noDefault boolean - true if no default date is to be used\r\n         * @return Date - the current date\r\n         */\r\n        _getDateDatepicker: function (target, noDefault) {\r\n            var inst = this._getInst(target);\r\n            if (inst && !inst.inline) {\r\n                this._setDateFromField(inst, noDefault);\r\n            }\r\n            return (inst ? this._getDate(inst) : null);\r\n        },\r\n\r\n        /* Handle keystrokes. */\r\n        _doKeyDown: function (event) {\r\n            var onSelect, dateStr, sel,\r\n                inst = $.datepicker._getInst(event.target),\r\n                handled = true,\r\n                isRTL = inst.dpDiv.is(\".ui-datepicker-rtl\");\r\n\r\n            inst._keyEvent = true;\r\n            if ($.datepicker._datepickerShowing) {\r\n                switch (event.keyCode) {\r\n                    case 9:\r\n                        $.datepicker._hideDatepicker();\r\n                        handled = false;\r\n                        break; // hide on tab out\r\n                    case 13:\r\n                        sel = $(\"td.\" + $.datepicker._dayOverClass + \":not(.\" +\r\n                            $.datepicker._currentClass + \")\", inst.dpDiv);\r\n                        if (sel[0]) {\r\n                            $.datepicker._selectDay(event.target, inst.selectedMonth, inst.selectedYear, sel[0]);\r\n                        }\r\n\r\n                        onSelect = $.datepicker._get(inst, \"onSelect\");\r\n                        if (onSelect) {\r\n                            dateStr = $.datepicker._formatDate(inst);\r\n\r\n                            // trigger custom callback\r\n                            onSelect.apply((inst.input ? inst.input[0] : null), [dateStr, inst]);\r\n                        } else {\r\n                            $.datepicker._hideDatepicker();\r\n                        }\r\n\r\n                        return false; // don't submit the form\r\n                    case 27:\r\n                        $.datepicker._hideDatepicker();\r\n                        break; // hide on escape\r\n                    case 33:\r\n                        $.datepicker._adjustDate(event.target, (event.ctrlKey ?\r\n                            -$.datepicker._get(inst, \"stepBigMonths\") :\r\n                            -$.datepicker._get(inst, \"stepMonths\")), \"M\");\r\n                        break; // previous month/year on page up/+ ctrl\r\n                    case 34:\r\n                        $.datepicker._adjustDate(event.target, (event.ctrlKey ?\r\n                            +$.datepicker._get(inst, \"stepBigMonths\") :\r\n                            +$.datepicker._get(inst, \"stepMonths\")), \"M\");\r\n                        break; // next month/year on page down/+ ctrl\r\n                    case 35:\r\n                        if (event.ctrlKey || event.metaKey) {\r\n                            $.datepicker._clearDate(event.target);\r\n                        }\r\n                        handled = event.ctrlKey || event.metaKey;\r\n                        break; // clear on ctrl or command +end\r\n                    case 36:\r\n                        if (event.ctrlKey || event.metaKey) {\r\n                            $.datepicker._gotoToday(event.target);\r\n                        }\r\n                        handled = event.ctrlKey || event.metaKey;\r\n                        break; // current on ctrl or command +home\r\n                    case 37:\r\n                        if (event.ctrlKey || event.metaKey) {\r\n                            $.datepicker._adjustDate(event.target, (isRTL ? +1 : -1), \"D\");\r\n                        }\r\n                        handled = event.ctrlKey || event.metaKey;\r\n                        // -1 day on ctrl or command +left\r\n                        if (event.originalEvent.altKey) {\r\n                            $.datepicker._adjustDate(event.target, (event.ctrlKey ?\r\n                                -$.datepicker._get(inst, \"stepBigMonths\") :\r\n                                -$.datepicker._get(inst, \"stepMonths\")), \"M\");\r\n                        }\r\n                        // next month/year on alt +left on Mac\r\n                        break;\r\n                    case 38:\r\n                        if (event.ctrlKey || event.metaKey) {\r\n                            $.datepicker._adjustDate(event.target, -7, \"D\");\r\n                        }\r\n                        handled = event.ctrlKey || event.metaKey;\r\n                        break; // -1 week on ctrl or command +up\r\n                    case 39:\r\n                        if (event.ctrlKey || event.metaKey) {\r\n                            $.datepicker._adjustDate(event.target, (isRTL ? -1 : +1), \"D\");\r\n                        }\r\n                        handled = event.ctrlKey || event.metaKey;\r\n                        // +1 day on ctrl or command +right\r\n                        if (event.originalEvent.altKey) {\r\n                            $.datepicker._adjustDate(event.target, (event.ctrlKey ?\r\n                                +$.datepicker._get(inst, \"stepBigMonths\") :\r\n                                +$.datepicker._get(inst, \"stepMonths\")), \"M\");\r\n                        }\r\n                        // next month/year on alt +right\r\n                        break;\r\n                    case 40:\r\n                        if (event.ctrlKey || event.metaKey) {\r\n                            $.datepicker._adjustDate(event.target, +7, \"D\");\r\n                        }\r\n                        handled = event.ctrlKey || event.metaKey;\r\n                        break; // +1 week on ctrl or command +down\r\n                    default:\r\n                        handled = false;\r\n                }\r\n            } else if (event.keyCode === 36 && event.ctrlKey) { // display the date picker on ctrl+home\r\n                $.datepicker._showDatepicker(this);\r\n            } else {\r\n                handled = false;\r\n            }\r\n\r\n            if (handled) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n            }\r\n        },\r\n\r\n        /* Filter entered characters - based on date format. */\r\n        _doKeyPress: function (event) {\r\n            var chars, chr,\r\n                inst = $.datepicker._getInst(event.target);\r\n\r\n            if ($.datepicker._get(inst, \"constrainInput\")) {\r\n                chars = $.datepicker._possibleChars($.datepicker._get(inst, \"dateFormat\"));\r\n                chr = String.fromCharCode(event.charCode == null ? event.keyCode : event.charCode);\r\n                return event.ctrlKey || event.metaKey || (chr < \" \" || !chars || chars.indexOf(chr) > -1);\r\n            }\r\n        },\r\n\r\n        /* Synchronise manual entry and field/alternate field. */\r\n        _doKeyUp: function (event) {\r\n            var date,\r\n                inst = $.datepicker._getInst(event.target);\r\n\r\n            if (inst.input.val() !== inst.lastVal) {\r\n                try {\r\n                    date = $.datepicker.parseDate($.datepicker._get(inst, \"dateFormat\"),\r\n                        (inst.input ? inst.input.val() : null),\r\n                        $.datepicker._getFormatConfig(inst));\r\n\r\n                    if (date) { // only if valid\r\n                        $.datepicker._setDateFromField(inst);\r\n                        $.datepicker._updateAlternate(inst);\r\n                        $.datepicker._updateDatepicker(inst);\r\n                    }\r\n                } catch (err) {\r\n                }\r\n            }\r\n            return true;\r\n        },\r\n\r\n        /* Pop-up the date picker for a given input field.\r\n         * If false returned from beforeShow event handler do not show.\r\n         * @param  input  element - the input field attached to the date picker or\r\n         *\t\t\t\t\tevent - if triggered by focus\r\n         */\r\n        _showDatepicker: function (input) {\r\n            input = input.target || input;\r\n            if (input.nodeName.toLowerCase() !== \"input\") { // find from button/image trigger\r\n                input = $(\"input\", input.parentNode)[0];\r\n            }\r\n\r\n            if ($.datepicker._isDisabledDatepicker(input) || $.datepicker._lastInput === input) { // already here\r\n                return;\r\n            }\r\n\r\n            var inst, beforeShow, beforeShowSettings, isFixed,\r\n                offset, showAnim, duration;\r\n\r\n            inst = $.datepicker._getInst(input);\r\n            if ($.datepicker._curInst && $.datepicker._curInst !== inst) {\r\n                $.datepicker._curInst.dpDiv.stop(true, true);\r\n                if (inst && $.datepicker._datepickerShowing) {\r\n                    $.datepicker._hideDatepicker($.datepicker._curInst.input[0]);\r\n                }\r\n            }\r\n\r\n            beforeShow = $.datepicker._get(inst, \"beforeShow\");\r\n            beforeShowSettings = beforeShow ? beforeShow.apply(input, [input, inst]) : {};\r\n            if (beforeShowSettings === false) {\r\n                return;\r\n            }\r\n            extendRemove(inst.settings, beforeShowSettings);\r\n\r\n            inst.lastVal = null;\r\n            $.datepicker._lastInput = input;\r\n            $.datepicker._setDateFromField(inst);\r\n\r\n            if ($.datepicker._inDialog) { // hide cursor\r\n                input.value = \"\";\r\n            }\r\n            if (!$.datepicker._pos) { // position below input\r\n                $.datepicker._pos = $.datepicker._findPos(input);\r\n                $.datepicker._pos[1] += input.offsetHeight; // add the height\r\n            }\r\n\r\n            isFixed = false;\r\n            $(input).parents().each(function () {\r\n                isFixed |= $(this).css(\"position\") === \"fixed\";\r\n                return !isFixed;\r\n            });\r\n\r\n            offset = {left: $.datepicker._pos[0], top: $.datepicker._pos[1]};\r\n            $.datepicker._pos = null;\r\n            //to avoid flashes on Firefox\r\n            inst.dpDiv.empty();\r\n            // determine sizing offscreen\r\n            inst.dpDiv.css({position: \"absolute\", display: \"block\", top: \"-1000px\"});\r\n            $.datepicker._updateDatepicker(inst);\r\n            // fix width for dynamic number of date pickers\r\n            // and adjust position before showing\r\n            offset = $.datepicker._checkOffset(inst, offset, isFixed);\r\n            inst.dpDiv.css({\r\n                position: ($.datepicker._inDialog && $.blockUI ?\r\n                    \"static\" : (isFixed ? \"fixed\" : \"absolute\")), display: \"none\",\r\n                left: offset.left + \"px\", top: offset.top + \"px\"\r\n            });\r\n\r\n            if (!inst.inline) {\r\n                showAnim = $.datepicker._get(inst, \"showAnim\");\r\n                duration = $.datepicker._get(inst, \"duration\");\r\n                inst.dpDiv.zIndex($(input).zIndex() + 1);\r\n                $.datepicker._datepickerShowing = true;\r\n\r\n                if ($.effects && $.effects.effect[showAnim]) {\r\n                    inst.dpDiv.show(showAnim, $.datepicker._get(inst, \"showOptions\"), duration);\r\n                } else {\r\n                    inst.dpDiv[showAnim || \"show\"](showAnim ? duration : null);\r\n                }\r\n\r\n                if ($.datepicker._shouldFocusInput(inst)) {\r\n                    inst.input.focus();\r\n                }\r\n\r\n                $.datepicker._curInst = inst;\r\n            }\r\n        },\r\n\r\n        /* Generate the date picker content. */\r\n        _updateDatepicker: function (inst) {\r\n            this.maxRows = 4; //Reset the max number of rows being displayed (see #7043)\r\n            instActive = inst; // for delegate hover events\r\n            inst.dpDiv.empty().append(this._generateHTML(inst));\r\n            this._attachHandlers(inst);\r\n            inst.dpDiv.find(\".\" + this._dayOverClass + \" a\").mouseover();\r\n\r\n            var origyearshtml,\r\n                numMonths = this._getNumberOfMonths(inst),\r\n                cols = numMonths[1],\r\n                width = 17;\r\n\r\n            inst.dpDiv.removeClass(\"ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4\").width(\"\");\r\n            if (cols > 1) {\r\n                inst.dpDiv.addClass(\"ui-datepicker-multi-\" + cols).css(\"width\", (width * cols) + \"em\");\r\n            }\r\n            inst.dpDiv[(numMonths[0] !== 1 || numMonths[1] !== 1 ? \"add\" : \"remove\") +\r\n            \"Class\"](\"ui-datepicker-multi\");\r\n            inst.dpDiv[(this._get(inst, \"isRTL\") ? \"add\" : \"remove\") +\r\n            \"Class\"](\"ui-datepicker-rtl\");\r\n\r\n            if (inst === $.datepicker._curInst && $.datepicker._datepickerShowing && $.datepicker._shouldFocusInput(inst)) {\r\n                inst.input.focus();\r\n            }\r\n\r\n            // deffered render of the years select (to avoid flashes on Firefox)\r\n            if (inst.yearshtml) {\r\n                origyearshtml = inst.yearshtml;\r\n                setTimeout(function () {\r\n                    //assure that inst.yearshtml didn't change.\r\n                    if (origyearshtml === inst.yearshtml && inst.yearshtml) {\r\n                        inst.dpDiv.find(\"select.ui-datepicker-year:first\").replaceWith(inst.yearshtml);\r\n                    }\r\n                    origyearshtml = inst.yearshtml = null;\r\n                }, 0);\r\n            }\r\n        },\r\n\r\n        // #6694 - don't focus the input if it's already focused\r\n        // this breaks the change event in IE\r\n        // Support: IE and jQuery <1.9\r\n        _shouldFocusInput: function (inst) {\r\n            return inst.input && inst.input.is(\":visible\") && !inst.input.is(\":disabled\") && !inst.input.is(\":focus\");\r\n        },\r\n\r\n        /* Check positioning to remain on screen. */\r\n        _checkOffset: function (inst, offset, isFixed) {\r\n            var dpWidth = inst.dpDiv.outerWidth(),\r\n                dpHeight = inst.dpDiv.outerHeight(),\r\n                inputWidth = inst.input ? inst.input.outerWidth() : 0,\r\n                inputHeight = inst.input ? inst.input.outerHeight() : 0,\r\n                viewWidth = document.documentElement.clientWidth + (isFixed ? 0 : $(document).scrollLeft()),\r\n                viewHeight = document.documentElement.clientHeight + (isFixed ? 0 : $(document).scrollTop());\r\n\r\n            offset.left -= (this._get(inst, \"isRTL\") ? (dpWidth - inputWidth) : 0);\r\n            offset.left -= (isFixed && offset.left === inst.input.offset().left) ? $(document).scrollLeft() : 0;\r\n            offset.top -= (isFixed && offset.top === (inst.input.offset().top + inputHeight)) ? $(document).scrollTop() : 0;\r\n\r\n            // now check if datepicker is showing outside window viewport - move to a better place if so.\r\n            offset.left -= Math.min(offset.left, (offset.left + dpWidth > viewWidth && viewWidth > dpWidth) ?\r\n                Math.abs(offset.left + dpWidth - viewWidth) : 0);\r\n            offset.top -= Math.min(offset.top, (offset.top + dpHeight > viewHeight && viewHeight > dpHeight) ?\r\n                Math.abs(dpHeight + inputHeight) : 0);\r\n\r\n            return offset;\r\n        },\r\n\r\n        /* Find an object's position on the screen. */\r\n        _findPos: function (obj) {\r\n            var position,\r\n                inst = this._getInst(obj),\r\n                isRTL = this._get(inst, \"isRTL\");\r\n\r\n            while (obj && (obj.type === \"hidden\" || obj.nodeType !== 1 || $.expr.filters.hidden(obj))) {\r\n                obj = obj[isRTL ? \"previousSibling\" : \"nextSibling\"];\r\n            }\r\n\r\n            position = $(obj).offset();\r\n            return [position.left, position.top];\r\n        },\r\n\r\n        /* Hide the date picker from view.\r\n         * @param  input  element - the input field attached to the date picker\r\n         */\r\n        _hideDatepicker: function (input) {\r\n            var showAnim, duration, postProcess, onClose,\r\n                inst = this._curInst;\r\n\r\n            if (!inst || (input && inst !== $.data(input, PROP_NAME))) {\r\n                return;\r\n            }\r\n\r\n            if (this._datepickerShowing) {\r\n                showAnim = this._get(inst, \"showAnim\");\r\n                duration = this._get(inst, \"duration\");\r\n                postProcess = function () {\r\n                    $.datepicker._tidyDialog(inst);\r\n                };\r\n\r\n                // DEPRECATED: after BC for 1.8.x $.effects[ showAnim ] is not needed\r\n                if ($.effects && ($.effects.effect[showAnim] || $.effects[showAnim])) {\r\n                    inst.dpDiv.hide(showAnim, $.datepicker._get(inst, \"showOptions\"), duration, postProcess);\r\n                } else {\r\n                    inst.dpDiv[(showAnim === \"slideDown\" ? \"slideUp\" :\r\n                        (showAnim === \"fadeIn\" ? \"fadeOut\" : \"hide\"))]((showAnim ? duration : null), postProcess);\r\n                }\r\n\r\n                if (!showAnim) {\r\n                    postProcess();\r\n                }\r\n                this._datepickerShowing = false;\r\n\r\n                onClose = this._get(inst, \"onClose\");\r\n                if (onClose) {\r\n                    onClose.apply((inst.input ? inst.input[0] : null), [(inst.input ? inst.input.val() : \"\"), inst]);\r\n                }\r\n\r\n                this._lastInput = null;\r\n                if (this._inDialog) {\r\n                    this._dialogInput.css({position: \"absolute\", left: \"0\", top: \"-100px\"});\r\n                    if ($.blockUI) {\r\n                        $.unblockUI();\r\n                        $(\"body\").append(this.dpDiv);\r\n                    }\r\n                }\r\n                this._inDialog = false;\r\n            }\r\n        },\r\n\r\n        /* Tidy up after a dialog display. */\r\n        _tidyDialog: function (inst) {\r\n            inst.dpDiv.removeClass(this._dialogClass).unbind(\".ui-datepicker-calendar\");\r\n        },\r\n\r\n        /* Close date picker if clicked elsewhere. */\r\n        _checkExternalClick: function (event) {\r\n            if (!$.datepicker._curInst) {\r\n                return;\r\n            }\r\n\r\n            var $target = $(event.target),\r\n                inst = $.datepicker._getInst($target[0]);\r\n\r\n            if ((($target[0].id !== $.datepicker._mainDivId &&\r\n                $target.parents(\"#\" + $.datepicker._mainDivId).length === 0 &&\r\n                !$target.hasClass($.datepicker.markerClassName) &&\r\n                !$target.closest(\".\" + $.datepicker._triggerClass).length &&\r\n                $.datepicker._datepickerShowing && !($.datepicker._inDialog && $.blockUI))) ||\r\n                ($target.hasClass($.datepicker.markerClassName) && $.datepicker._curInst !== inst)) {\r\n                $.datepicker._hideDatepicker();\r\n            }\r\n        },\r\n\r\n        /* Adjust one of the date sub-fields. */\r\n        _adjustDate: function (id, offset, period) {\r\n            var target = $(id),\r\n                inst = this._getInst(target[0]);\r\n\r\n            if (this._isDisabledDatepicker(target[0])) {\r\n                return;\r\n            }\r\n            this._adjustInstDate(inst, offset +\r\n                (period === \"M\" ? this._get(inst, \"showCurrentAtPos\") : 0), // undo positioning\r\n                period);\r\n            this._updateDatepicker(inst);\r\n        },\r\n\r\n        /* Action for current link. */\r\n        _gotoToday: function (id) {\r\n            var date,\r\n                target = $(id),\r\n                inst = this._getInst(target[0]);\r\n\r\n            if (this._get(inst, \"gotoCurrent\") && inst.currentDay) {\r\n                inst.selectedDay = inst.currentDay;\r\n                inst.drawMonth = inst.selectedMonth = inst.currentMonth;\r\n                inst.drawYear = inst.selectedYear = inst.currentYear;\r\n            } else {\r\n                date = new Date();\r\n                inst.selectedDay = date.getDate();\r\n                inst.drawMonth = inst.selectedMonth = date.getMonth();\r\n                inst.drawYear = inst.selectedYear = date.getFullYear();\r\n            }\r\n            this._notifyChange(inst);\r\n            this._adjustDate(target);\r\n        },\r\n\r\n        /* Action for selecting a new month/year. */\r\n        _selectMonthYear: function (id, select, period) {\r\n            var target = $(id),\r\n                inst = this._getInst(target[0]);\r\n\r\n            inst[\"selected\" + (period === \"M\" ? \"Month\" : \"Year\")] =\r\n                inst[\"draw\" + (period === \"M\" ? \"Month\" : \"Year\")] =\r\n                    parseInt(select.options[select.selectedIndex].value, 10);\r\n\r\n            this._notifyChange(inst);\r\n            this._adjustDate(target);\r\n        },\r\n\r\n        /* Action for selecting a day. */\r\n        _selectDay: function (id, month, year, td) {\r\n            var inst,\r\n                target = $(id);\r\n\r\n            if ($(td).hasClass(this._unselectableClass) || this._isDisabledDatepicker(target[0])) {\r\n                return;\r\n            }\r\n\r\n            inst = this._getInst(target[0]);\r\n            inst.selectedDay = inst.currentDay = $(\"a\", td).html();\r\n            inst.selectedMonth = inst.currentMonth = month;\r\n            inst.selectedYear = inst.currentYear = year;\r\n            this._selectDate(id, this._formatDate(inst,\r\n                inst.currentDay, inst.currentMonth, inst.currentYear));\r\n        },\r\n\r\n        /* Erase the input field and hide the date picker. */\r\n        _clearDate: function (id) {\r\n            var target = $(id);\r\n            this._selectDate(target, \"\");\r\n        },\r\n\r\n        /* Update the input field with the selected date. */\r\n        _selectDate: function (id, dateStr) {\r\n            var onSelect,\r\n                target = $(id),\r\n                inst = this._getInst(target[0]);\r\n\r\n            dateStr = (dateStr != null ? dateStr : this._formatDate(inst));\r\n            if (inst.input) {\r\n                inst.input.val(dateStr);\r\n            }\r\n            this._updateAlternate(inst);\r\n\r\n            onSelect = this._get(inst, \"onSelect\");\r\n            if (onSelect) {\r\n                onSelect.apply((inst.input ? inst.input[0] : null), [dateStr, inst]);  // trigger custom callback\r\n            } else if (inst.input) {\r\n                inst.input.trigger(\"change\"); // fire the change event\r\n            }\r\n\r\n            if (inst.inline) {\r\n                this._updateDatepicker(inst);\r\n            } else {\r\n                this._hideDatepicker();\r\n                this._lastInput = inst.input[0];\r\n                if (typeof (inst.input[0]) !== \"object\") {\r\n                    inst.input.focus(); // restore focus\r\n                }\r\n                this._lastInput = null;\r\n            }\r\n        },\r\n\r\n        /* Update any alternate field to synchronise with the main field. */\r\n        _updateAlternate: function (inst) {\r\n            var altFormat, date, dateStr,\r\n                altField = this._get(inst, \"altField\");\r\n\r\n            if (altField) { // update alternate field too\r\n                altFormat = this._get(inst, \"altFormat\") || this._get(inst, \"dateFormat\");\r\n                date = this._getDate(inst);\r\n                dateStr = this.formatDate(altFormat, date, this._getFormatConfig(inst));\r\n                $(altField).each(function () {\r\n                    $(this).val(dateStr);\r\n                });\r\n            }\r\n        },\r\n\r\n        /* Set as beforeShowDay function to prevent selection of weekends.\r\n         * @param  date  Date - the date to customise\r\n         * @return [boolean, string] - is this date selectable?, what is its CSS class?\r\n         */\r\n        noWeekends: function (date) {\r\n            var day = date.getDay();\r\n            return [(day > 0 && day < 6), \"\"];\r\n        },\r\n\r\n        /* Set as calculateWeek to determine the week of the year based on the ISO 8601 definition.\r\n         * @param  date  Date - the date to get the week for\r\n         * @return  number - the number of the week within the year that contains this date\r\n         */\r\n        iso8601Week: function (date) {\r\n            var time,\r\n                checkDate = new Date(date.getTime());\r\n\r\n            // Find Thursday of this week starting on Monday\r\n            checkDate.setDate(checkDate.getDate() + 4 - (checkDate.getDay() || 7));\r\n\r\n            time = checkDate.getTime();\r\n            checkDate.setMonth(0); // Compare with Jan 1\r\n            checkDate.setDate(1);\r\n            return Math.floor(Math.round((time - checkDate) / 86400000) / 7) + 1;\r\n        },\r\n\r\n        /* Parse a string value into a date object.\r\n         * See formatDate below for the possible formats.\r\n         *\r\n         * @param  format string - the expected format of the date\r\n         * @param  value string - the date in the above format\r\n         * @param  settings Object - attributes include:\r\n         *\t\t\t\t\tshortYearCutoff  number - the cutoff year for determining the century (optional)\r\n         *\t\t\t\t\tdayNamesShort\tstring[7] - abbreviated names of the days from Sunday (optional)\r\n         *\t\t\t\t\tdayNames\t\tstring[7] - names of the days from Sunday (optional)\r\n         *\t\t\t\t\tmonthNamesShort string[12] - abbreviated names of the months (optional)\r\n         *\t\t\t\t\tmonthNames\t\tstring[12] - names of the months (optional)\r\n         * @return  Date - the extracted date value or null if value is blank\r\n         */\r\n        parseDate: function (format, value, settings) {\r\n            if (format == null || value == null) {\r\n                throw \"Invalid arguments\";\r\n            }\r\n\r\n            value = (typeof value === \"object\" ? value.toString() : value + \"\");\r\n            if (value === \"\") {\r\n                return null;\r\n            }\r\n\r\n            var iFormat, dim, extra,\r\n                iValue = 0,\r\n                shortYearCutoffTemp = (settings ? settings.shortYearCutoff : null) || this._defaults.shortYearCutoff,\r\n                shortYearCutoff = (typeof shortYearCutoffTemp !== \"string\" ? shortYearCutoffTemp :\r\n                    new Date().getFullYear() % 100 + parseInt(shortYearCutoffTemp, 10)),\r\n                dayNamesShort = (settings ? settings.dayNamesShort : null) || this._defaults.dayNamesShort,\r\n                dayNames = (settings ? settings.dayNames : null) || this._defaults.dayNames,\r\n                monthNamesShort = (settings ? settings.monthNamesShort : null) || this._defaults.monthNamesShort,\r\n                monthNames = (settings ? settings.monthNames : null) || this._defaults.monthNames,\r\n                year = -1,\r\n                month = -1,\r\n                day = -1,\r\n                doy = -1,\r\n                literal = false,\r\n                date,\r\n                // Check whether a format character is doubled\r\n                lookAhead = function (match) {\r\n                    var matches = (iFormat + 1 < format.length && format.charAt(iFormat + 1) === match);\r\n                    if (matches) {\r\n                        iFormat++;\r\n                    }\r\n                    return matches;\r\n                },\r\n                // Extract a number from the string value\r\n                getNumber = function (match) {\r\n                    var isDoubled = lookAhead(match),\r\n                        size = (match === \"@\" ? 14 : (match === \"!\" ? 20 :\r\n                            (match === \"y\" && isDoubled ? 4 : (match === \"o\" ? 3 : 2)))),\r\n                        digits = new RegExp(\"^\\\\d{1,\" + size + \"}\"),\r\n                        num = value.substring(iValue).match(digits);\r\n                    if (!num) {\r\n                        throw \"Missing number at position \" + iValue;\r\n                    }\r\n                    iValue += num[0].length;\r\n                    return parseInt(num[0], 10);\r\n                },\r\n                // Extract a name from the string value and convert to an index\r\n                getName = function (match, shortNames, longNames) {\r\n                    var index = -1,\r\n                        names = $.map(lookAhead(match) ? longNames : shortNames, function (v, k) {\r\n                            return [[k, v]];\r\n                        }).sort(function (a, b) {\r\n                            return -(a[1].length - b[1].length);\r\n                        });\r\n\r\n                    $.each(names, function (i, pair) {\r\n                        var name = pair[1];\r\n                        if (value.substr(iValue, name.length).toLowerCase() === name.toLowerCase()) {\r\n                            index = pair[0];\r\n                            iValue += name.length;\r\n                            return false;\r\n                        }\r\n                    });\r\n                    if (index !== -1) {\r\n                        return index + 1;\r\n                    } else {\r\n                        throw \"Unknown name at position \" + iValue;\r\n                    }\r\n                },\r\n                // Confirm that a literal character matches the string value\r\n                checkLiteral = function () {\r\n                    if (value.charAt(iValue) !== format.charAt(iFormat)) {\r\n                        throw \"Unexpected literal at position \" + iValue;\r\n                    }\r\n                    iValue++;\r\n                };\r\n\r\n            for (iFormat = 0; iFormat < format.length; iFormat++) {\r\n                if (literal) {\r\n                    if (format.charAt(iFormat) === \"'\" && !lookAhead(\"'\")) {\r\n                        literal = false;\r\n                    } else {\r\n                        checkLiteral();\r\n                    }\r\n                } else {\r\n                    switch (format.charAt(iFormat)) {\r\n                        case \"d\":\r\n                            day = getNumber(\"d\");\r\n                            break;\r\n                        case \"D\":\r\n                            getName(\"D\", dayNamesShort, dayNames);\r\n                            break;\r\n                        case \"o\":\r\n                            doy = getNumber(\"o\");\r\n                            break;\r\n                        case \"m\":\r\n                            month = getNumber(\"m\");\r\n                            break;\r\n                        case \"M\":\r\n                            month = getName(\"M\", monthNamesShort, monthNames);\r\n                            break;\r\n                        case \"y\":\r\n                            year = getNumber(\"y\");\r\n                            break;\r\n                        case \"@\":\r\n                            date = new Date(getNumber(\"@\"));\r\n                            year = date.getFullYear();\r\n                            month = date.getMonth() + 1;\r\n                            day = date.getDate();\r\n                            break;\r\n                        case \"!\":\r\n                            date = new Date((getNumber(\"!\") - this._ticksTo1970) / 10000);\r\n                            year = date.getFullYear();\r\n                            month = date.getMonth() + 1;\r\n                            day = date.getDate();\r\n                            break;\r\n                        case \"'\":\r\n                            if (lookAhead(\"'\")) {\r\n                                checkLiteral();\r\n                            } else {\r\n                                literal = true;\r\n                            }\r\n                            break;\r\n                        default:\r\n                            checkLiteral();\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (iValue < value.length) {\r\n                extra = value.substr(iValue);\r\n                if (!/^\\s+/.test(extra)) {\r\n                    throw \"Extra/unparsed characters found in date: \" + extra;\r\n                }\r\n            }\r\n\r\n            if (year === -1) {\r\n                year = new Date().getFullYear();\r\n            } else if (year < 100) {\r\n                year += new Date().getFullYear() - new Date().getFullYear() % 100 +\r\n                    (year <= shortYearCutoff ? 0 : -100);\r\n            }\r\n\r\n            if (doy > -1) {\r\n                month = 1;\r\n                day = doy;\r\n                do {\r\n                    dim = this._getDaysInMonth(year, month - 1);\r\n                    if (day <= dim) {\r\n                        break;\r\n                    }\r\n                    month++;\r\n                    day -= dim;\r\n                } while (true);\r\n            }\r\n\r\n            date = this._daylightSavingAdjust(new Date(year, month - 1, day));\r\n            if (date.getFullYear() !== year || date.getMonth() + 1 !== month || date.getDate() !== day) {\r\n                throw \"Invalid date\"; // E.g. 31/02/00\r\n            }\r\n            return date;\r\n        },\r\n\r\n        /* Standard date formats. */\r\n        ATOM: \"yy-mm-dd\", // RFC 3339 (ISO 8601)\r\n        COOKIE: \"D, dd M yy\",\r\n        ISO_8601: \"yy-mm-dd\",\r\n        RFC_822: \"D, d M y\",\r\n        RFC_850: \"DD, dd-M-y\",\r\n        RFC_1036: \"D, d M y\",\r\n        RFC_1123: \"D, d M yy\",\r\n        RFC_2822: \"D, d M yy\",\r\n        RSS: \"D, d M y\", // RFC 822\r\n        TICKS: \"!\",\r\n        TIMESTAMP: \"@\",\r\n        W3C: \"yy-mm-dd\", // ISO 8601\r\n\r\n        _ticksTo1970: (((1970 - 1) * 365 + Math.floor(1970 / 4) - Math.floor(1970 / 100) +\r\n            Math.floor(1970 / 400)) * 24 * 60 * 60 * 10000000),\r\n\r\n        /* Format a date object into a string value.\r\n         * The format can be combinations of the following:\r\n         * d  - day of month (no leading zero)\r\n         * dd - day of month (two digit)\r\n         * o  - day of year (no leading zeros)\r\n         * oo - day of year (three digit)\r\n         * D  - day name short\r\n         * DD - day name long\r\n         * m  - month of year (no leading zero)\r\n         * mm - month of year (two digit)\r\n         * M  - month name short\r\n         * MM - month name long\r\n         * y  - year (two digit)\r\n         * yy - year (four digit)\r\n         * @ - Unix timestamp (ms since 01/01/1970)\r\n         * ! - Windows ticks (100ns since 01/01/0001)\r\n         * \"...\" - literal text\r\n         * '' - single quote\r\n         *\r\n         * @param  format string - the desired format of the date\r\n         * @param  date Date - the date value to format\r\n         * @param  settings Object - attributes include:\r\n         *\t\t\t\t\tdayNamesShort\tstring[7] - abbreviated names of the days from Sunday (optional)\r\n         *\t\t\t\t\tdayNames\t\tstring[7] - names of the days from Sunday (optional)\r\n         *\t\t\t\t\tmonthNamesShort string[12] - abbreviated names of the months (optional)\r\n         *\t\t\t\t\tmonthNames\t\tstring[12] - names of the months (optional)\r\n         * @return  string - the date in the above format\r\n         */\r\n        formatDate: function (format, date, settings) {\r\n            if (!date) {\r\n                return \"\";\r\n            }\r\n\r\n            var iFormat,\r\n                dayNamesShort = (settings ? settings.dayNamesShort : null) || this._defaults.dayNamesShort,\r\n                dayNames = (settings ? settings.dayNames : null) || this._defaults.dayNames,\r\n                monthNamesShort = (settings ? settings.monthNamesShort : null) || this._defaults.monthNamesShort,\r\n                monthNames = (settings ? settings.monthNames : null) || this._defaults.monthNames,\r\n                // Check whether a format character is doubled\r\n                lookAhead = function (match) {\r\n                    var matches = (iFormat + 1 < format.length && format.charAt(iFormat + 1) === match);\r\n                    if (matches) {\r\n                        iFormat++;\r\n                    }\r\n                    return matches;\r\n                },\r\n                // Format a number, with leading zero if necessary\r\n                formatNumber = function (match, value, len) {\r\n                    var num = \"\" + value;\r\n                    if (lookAhead(match)) {\r\n                        while (num.length < len) {\r\n                            num = \"0\" + num;\r\n                        }\r\n                    }\r\n                    return num;\r\n                },\r\n                // Format a name, short or long as requested\r\n                formatName = function (match, value, shortNames, longNames) {\r\n                    return (lookAhead(match) ? longNames[value] : shortNames[value]);\r\n                },\r\n                output = \"\",\r\n                literal = false;\r\n\r\n            if (date) {\r\n                for (iFormat = 0; iFormat < format.length; iFormat++) {\r\n                    if (literal) {\r\n                        if (format.charAt(iFormat) === \"'\" && !lookAhead(\"'\")) {\r\n                            literal = false;\r\n                        } else {\r\n                            output += format.charAt(iFormat);\r\n                        }\r\n                    } else {\r\n                        switch (format.charAt(iFormat)) {\r\n                            case \"d\":\r\n                                output += formatNumber(\"d\", date.getDate(), 2);\r\n                                break;\r\n                            case \"D\":\r\n                                output += formatName(\"D\", date.getDay(), dayNamesShort, dayNames);\r\n                                break;\r\n                            case \"o\":\r\n                                output += formatNumber(\"o\",\r\n                                    Math.round((new Date(date.getFullYear(), date.getMonth(), date.getDate()).getTime() - new Date(date.getFullYear(), 0, 0).getTime()) / 86400000), 3);\r\n                                break;\r\n                            case \"m\":\r\n                                output += formatNumber(\"m\", date.getMonth() + 1, 2);\r\n                                break;\r\n                            case \"M\":\r\n                                output += formatName(\"M\", date.getMonth(), monthNamesShort, monthNames);\r\n                                break;\r\n                            case \"y\":\r\n                                output += (lookAhead(\"y\") ? date.getFullYear() :\r\n                                    (date.getYear() % 100 < 10 ? \"0\" : \"\") + date.getYear() % 100);\r\n                                break;\r\n                            case \"@\":\r\n                                output += date.getTime();\r\n                                break;\r\n                            case \"!\":\r\n                                output += date.getTime() * 10000 + this._ticksTo1970;\r\n                                break;\r\n                            case \"'\":\r\n                                if (lookAhead(\"'\")) {\r\n                                    output += \"'\";\r\n                                } else {\r\n                                    literal = true;\r\n                                }\r\n                                break;\r\n                            default:\r\n                                output += format.charAt(iFormat);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return output;\r\n        },\r\n\r\n        /* Extract all possible characters from the date format. */\r\n        _possibleChars: function (format) {\r\n            var iFormat,\r\n                chars = \"\",\r\n                literal = false,\r\n                // Check whether a format character is doubled\r\n                lookAhead = function (match) {\r\n                    var matches = (iFormat + 1 < format.length && format.charAt(iFormat + 1) === match);\r\n                    if (matches) {\r\n                        iFormat++;\r\n                    }\r\n                    return matches;\r\n                };\r\n\r\n            for (iFormat = 0; iFormat < format.length; iFormat++) {\r\n                if (literal) {\r\n                    if (format.charAt(iFormat) === \"'\" && !lookAhead(\"'\")) {\r\n                        literal = false;\r\n                    } else {\r\n                        chars += format.charAt(iFormat);\r\n                    }\r\n                } else {\r\n                    switch (format.charAt(iFormat)) {\r\n                        case \"d\":\r\n                        case \"m\":\r\n                        case \"y\":\r\n                        case \"@\":\r\n                            chars += \"0123456789\";\r\n                            break;\r\n                        case \"D\":\r\n                        case \"M\":\r\n                            return null; // Accept anything\r\n                        case \"'\":\r\n                            if (lookAhead(\"'\")) {\r\n                                chars += \"'\";\r\n                            } else {\r\n                                literal = true;\r\n                            }\r\n                            break;\r\n                        default:\r\n                            chars += format.charAt(iFormat);\r\n                    }\r\n                }\r\n            }\r\n            return chars;\r\n        },\r\n\r\n        /* Get a setting value, defaulting if necessary. */\r\n        _get: function (inst, name) {\r\n            return inst.settings[name] !== undefined ?\r\n                inst.settings[name] : this._defaults[name];\r\n        },\r\n\r\n        /* Parse existing date and initialise date picker. */\r\n        _setDateFromField: function (inst, noDefault) {\r\n            if (inst.input.val() === inst.lastVal) {\r\n                return;\r\n            }\r\n\r\n            var dateFormat = this._get(inst, \"dateFormat\"),\r\n                dates = inst.lastVal = inst.input ? inst.input.val() : null,\r\n                defaultDate = this._getDefaultDate(inst),\r\n                date = defaultDate,\r\n                settings = this._getFormatConfig(inst);\r\n\r\n            try {\r\n                date = this.parseDate(dateFormat, dates, settings) || defaultDate;\r\n            } catch (event) {\r\n                dates = (noDefault ? \"\" : dates);\r\n            }\r\n            inst.selectedDay = date.getDate();\r\n            inst.drawMonth = inst.selectedMonth = date.getMonth();\r\n            inst.drawYear = inst.selectedYear = date.getFullYear();\r\n            inst.currentDay = (dates ? date.getDate() : 0);\r\n            inst.currentMonth = (dates ? date.getMonth() : 0);\r\n            inst.currentYear = (dates ? date.getFullYear() : 0);\r\n            this._adjustInstDate(inst);\r\n        },\r\n\r\n        /* Retrieve the default date shown on opening. */\r\n        _getDefaultDate: function (inst) {\r\n            return this._restrictMinMax(inst,\r\n                this._determineDate(inst, this._get(inst, \"defaultDate\"), new Date()));\r\n        },\r\n\r\n        /* A date may be specified as an exact value or a relative one. */\r\n        _determineDate: function (inst, date, defaultDate) {\r\n            var offsetNumeric = function (offset) {\r\n                    var date = new Date();\r\n                    date.setDate(date.getDate() + offset);\r\n                    return date;\r\n                },\r\n                offsetString = function (offset) {\r\n                    try {\r\n                        return $.datepicker.parseDate($.datepicker._get(inst, \"dateFormat\"),\r\n                            offset, $.datepicker._getFormatConfig(inst));\r\n                    } catch (e) {\r\n                        // Ignore\r\n                    }\r\n\r\n                    var date = (offset.toLowerCase().match(/^c/) ?\r\n                        $.datepicker._getDate(inst) : null) || new Date(),\r\n                        year = date.getFullYear(),\r\n                        month = date.getMonth(),\r\n                        day = date.getDate(),\r\n                        pattern = /([+\\-]?[0-9]+)\\s*(d|D|w|W|m|M|y|Y)?/g,\r\n                        matches = pattern.exec(offset);\r\n\r\n                    while (matches) {\r\n                        switch (matches[2] || \"d\") {\r\n                            case \"d\" :\r\n                            case \"D\" :\r\n                                day += parseInt(matches[1], 10);\r\n                                break;\r\n                            case \"w\" :\r\n                            case \"W\" :\r\n                                day += parseInt(matches[1], 10) * 7;\r\n                                break;\r\n                            case \"m\" :\r\n                            case \"M\" :\r\n                                month += parseInt(matches[1], 10);\r\n                                day = Math.min(day, $.datepicker._getDaysInMonth(year, month));\r\n                                break;\r\n                            case \"y\":\r\n                            case \"Y\" :\r\n                                year += parseInt(matches[1], 10);\r\n                                day = Math.min(day, $.datepicker._getDaysInMonth(year, month));\r\n                                break;\r\n                        }\r\n                        matches = pattern.exec(offset);\r\n                    }\r\n                    return new Date(year, month, day);\r\n                },\r\n                newDate = (date == null || date === \"\" ? defaultDate : (typeof date === \"string\" ? offsetString(date) :\r\n                    (typeof date === \"number\" ? (isNaN(date) ? defaultDate : offsetNumeric(date)) : new Date(date.getTime()))));\r\n\r\n            newDate = (newDate && newDate.toString() === \"Invalid Date\" ? defaultDate : newDate);\r\n            if (newDate) {\r\n                newDate.setHours(0);\r\n                newDate.setMinutes(0);\r\n                newDate.setSeconds(0);\r\n                newDate.setMilliseconds(0);\r\n            }\r\n            return this._daylightSavingAdjust(newDate);\r\n        },\r\n\r\n        /* Handle switch to/from daylight saving.\r\n         * Hours may be non-zero on daylight saving cut-over:\r\n         * > 12 when midnight changeover, but then cannot generate\r\n         * midnight datetime, so jump to 1AM, otherwise reset.\r\n         * @param  date  (Date) the date to check\r\n         * @return  (Date) the corrected date\r\n         */\r\n        _daylightSavingAdjust: function (date) {\r\n            if (!date) {\r\n                return null;\r\n            }\r\n            date.setHours(date.getHours() > 12 ? date.getHours() + 2 : 0);\r\n            return date;\r\n        },\r\n\r\n        /* Set the date(s) directly. */\r\n        _setDate: function (inst, date, noChange) {\r\n            var clear = !date,\r\n                origMonth = inst.selectedMonth,\r\n                origYear = inst.selectedYear,\r\n                newDate = this._restrictMinMax(inst, this._determineDate(inst, date, new Date()));\r\n\r\n            inst.selectedDay = inst.currentDay = newDate.getDate();\r\n            inst.drawMonth = inst.selectedMonth = inst.currentMonth = newDate.getMonth();\r\n            inst.drawYear = inst.selectedYear = inst.currentYear = newDate.getFullYear();\r\n            if ((origMonth !== inst.selectedMonth || origYear !== inst.selectedYear) && !noChange) {\r\n                this._notifyChange(inst);\r\n            }\r\n            this._adjustInstDate(inst);\r\n            if (inst.input) {\r\n                inst.input.val(clear ? \"\" : this._formatDate(inst));\r\n            }\r\n        },\r\n\r\n        /* Retrieve the date(s) directly. */\r\n        _getDate: function (inst) {\r\n            var startDate = (!inst.currentYear || (inst.input && inst.input.val() === \"\") ? null :\r\n                this._daylightSavingAdjust(new Date(\r\n                    inst.currentYear, inst.currentMonth, inst.currentDay)));\r\n            return startDate;\r\n        },\r\n\r\n        /* Attach the onxxx handlers.  These are declared statically so\r\n         * they work with static code transformers like Caja.\r\n         */\r\n        _attachHandlers: function (inst) {\r\n            var stepMonths = this._get(inst, \"stepMonths\"),\r\n                id = \"#\" + inst.id.replace(/\\\\\\\\/g, \"\\\\\");\r\n            inst.dpDiv.find(\"[data-handler]\").map(function () {\r\n                var handler = {\r\n                    prev: function () {\r\n                        $.datepicker._adjustDate(id, -stepMonths, \"M\");\r\n                    },\r\n                    next: function () {\r\n                        $.datepicker._adjustDate(id, +stepMonths, \"M\");\r\n                    },\r\n                    hide: function () {\r\n                        $.datepicker._hideDatepicker();\r\n                    },\r\n                    today: function () {\r\n                        $.datepicker._gotoToday(id);\r\n                    },\r\n                    selectDay: function () {\r\n                        $.datepicker._selectDay(id, +this.getAttribute(\"data-month\"), +this.getAttribute(\"data-year\"), this);\r\n                        return false;\r\n                    },\r\n                    selectMonth: function () {\r\n                        $.datepicker._selectMonthYear(id, this, \"M\");\r\n                        return false;\r\n                    },\r\n                    selectYear: function () {\r\n                        $.datepicker._selectMonthYear(id, this, \"Y\");\r\n                        return false;\r\n                    }\r\n                };\r\n                $(this).bind(this.getAttribute(\"data-event\"), handler[this.getAttribute(\"data-handler\")]);\r\n            });\r\n        },\r\n\r\n        /* Generate the HTML for the current state of the date picker. */\r\n        _generateHTML: function (inst) {\r\n            var maxDraw, prevText, prev, nextText, next, currentText, gotoDate,\r\n                controls, buttonPanel, firstDay, showWeek, dayNames, dayNamesMin,\r\n                monthNames, monthNamesShort, beforeShowDay, showOtherMonths,\r\n                selectOtherMonths, defaultDate, html, dow, row, group, col, selectedDate,\r\n                cornerClass, calender, thead, day, daysInMonth, leadDays, curRows, numRows,\r\n                printDate, dRow, tbody, daySettings, otherMonth, unselectable,\r\n                tempDate = new Date(),\r\n                today = this._daylightSavingAdjust(\r\n                    new Date(tempDate.getFullYear(), tempDate.getMonth(), tempDate.getDate())), // clear time\r\n                isRTL = this._get(inst, \"isRTL\"),\r\n                showButtonPanel = this._get(inst, \"showButtonPanel\"),\r\n                hideIfNoPrevNext = this._get(inst, \"hideIfNoPrevNext\"),\r\n                navigationAsDateFormat = this._get(inst, \"navigationAsDateFormat\"),\r\n                numMonths = this._getNumberOfMonths(inst),\r\n                showCurrentAtPos = this._get(inst, \"showCurrentAtPos\"),\r\n                stepMonths = this._get(inst, \"stepMonths\"),\r\n                isMultiMonth = (numMonths[0] !== 1 || numMonths[1] !== 1),\r\n                currentDate = this._daylightSavingAdjust((!inst.currentDay ? new Date(9999, 9, 9) :\r\n                    new Date(inst.currentYear, inst.currentMonth, inst.currentDay))),\r\n                minDate = this._getMinMaxDate(inst, \"min\"),\r\n                maxDate = this._getMinMaxDate(inst, \"max\"),\r\n                drawMonth = inst.drawMonth - showCurrentAtPos,\r\n                drawYear = inst.drawYear;\r\n\r\n            if (drawMonth < 0) {\r\n                drawMonth += 12;\r\n                drawYear--;\r\n            }\r\n            if (maxDate) {\r\n                maxDraw = this._daylightSavingAdjust(new Date(maxDate.getFullYear(),\r\n                    maxDate.getMonth() - (numMonths[0] * numMonths[1]) + 1, maxDate.getDate()));\r\n                maxDraw = (minDate && maxDraw < minDate ? minDate : maxDraw);\r\n                while (this._daylightSavingAdjust(new Date(drawYear, drawMonth, 1)) > maxDraw) {\r\n                    drawMonth--;\r\n                    if (drawMonth < 0) {\r\n                        drawMonth = 11;\r\n                        drawYear--;\r\n                    }\r\n                }\r\n            }\r\n            inst.drawMonth = drawMonth;\r\n            inst.drawYear = drawYear;\r\n\r\n            prevText = this._get(inst, \"prevText\");\r\n            prevText = (!navigationAsDateFormat ? prevText : this.formatDate(prevText,\r\n                this._daylightSavingAdjust(new Date(drawYear, drawMonth - stepMonths, 1)),\r\n                this._getFormatConfig(inst)));\r\n\r\n            prev = (this._canAdjustMonth(inst, -1, drawYear, drawMonth) ?\r\n                \"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click'\" +\r\n                \" title='\" + prevText + \"'><span class='ui-icon ui-icon-circle-triangle-\" + (isRTL ? \"e\" : \"w\") + \"'>\" + prevText + \"</span></a>\" :\r\n                (hideIfNoPrevNext ? \"\" : \"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='\" + prevText + \"'><span class='ui-icon ui-icon-circle-triangle-\" + (isRTL ? \"e\" : \"w\") + \"'>\" + prevText + \"</span></a>\"));\r\n\r\n            nextText = this._get(inst, \"nextText\");\r\n            nextText = (!navigationAsDateFormat ? nextText : this.formatDate(nextText,\r\n                this._daylightSavingAdjust(new Date(drawYear, drawMonth + stepMonths, 1)),\r\n                this._getFormatConfig(inst)));\r\n\r\n            next = (this._canAdjustMonth(inst, +1, drawYear, drawMonth) ?\r\n                \"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click'\" +\r\n                \" title='\" + nextText + \"'><span class='ui-icon ui-icon-circle-triangle-\" + (isRTL ? \"w\" : \"e\") + \"'>\" + nextText + \"</span></a>\" :\r\n                (hideIfNoPrevNext ? \"\" : \"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='\" + nextText + \"'><span class='ui-icon ui-icon-circle-triangle-\" + (isRTL ? \"w\" : \"e\") + \"'>\" + nextText + \"</span></a>\"));\r\n\r\n            currentText = this._get(inst, \"currentText\");\r\n            gotoDate = (this._get(inst, \"gotoCurrent\") && inst.currentDay ? currentDate : today);\r\n            currentText = (!navigationAsDateFormat ? currentText :\r\n                this.formatDate(currentText, gotoDate, this._getFormatConfig(inst)));\r\n\r\n            controls = (!inst.inline ? \"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>\" +\r\n                this._get(inst, \"closeText\") + \"</button>\" : \"\");\r\n\r\n            buttonPanel = (showButtonPanel) ? \"<div class='ui-datepicker-buttonpane ui-widget-content'>\" + (isRTL ? controls : \"\") +\r\n                (this._isInRange(inst, gotoDate) ? \"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'\" +\r\n                    \">\" + currentText + \"</button>\" : \"\") + (isRTL ? \"\" : controls) + \"</div>\" : \"\";\r\n\r\n            firstDay = parseInt(this._get(inst, \"firstDay\"), 10);\r\n            firstDay = (isNaN(firstDay) ? 0 : firstDay);\r\n\r\n            showWeek = this._get(inst, \"showWeek\");\r\n            dayNames = this._get(inst, \"dayNames\");\r\n            dayNamesMin = this._get(inst, \"dayNamesMin\");\r\n            monthNames = this._get(inst, \"monthNames\");\r\n            monthNamesShort = this._get(inst, \"monthNamesShort\");\r\n            beforeShowDay = this._get(inst, \"beforeShowDay\");\r\n            showOtherMonths = this._get(inst, \"showOtherMonths\");\r\n            selectOtherMonths = this._get(inst, \"selectOtherMonths\");\r\n            defaultDate = this._getDefaultDate(inst);\r\n            html = \"\";\r\n            dow;\r\n            for (row = 0; row < numMonths[0]; row++) {\r\n                group = \"\";\r\n                this.maxRows = 4;\r\n                for (col = 0; col < numMonths[1]; col++) {\r\n                    selectedDate = this._daylightSavingAdjust(new Date(drawYear, drawMonth, inst.selectedDay));\r\n                    cornerClass = \" ui-corner-all\";\r\n                    calender = \"\";\r\n                    if (isMultiMonth) {\r\n                        calender += \"<div class='ui-datepicker-group\";\r\n                        if (numMonths[1] > 1) {\r\n                            switch (col) {\r\n                                case 0:\r\n                                    calender += \" ui-datepicker-group-first\";\r\n                                    cornerClass = \" ui-corner-\" + (isRTL ? \"right\" : \"left\");\r\n                                    break;\r\n                                case numMonths[1] - 1:\r\n                                    calender += \" ui-datepicker-group-last\";\r\n                                    cornerClass = \" ui-corner-\" + (isRTL ? \"left\" : \"right\");\r\n                                    break;\r\n                                default:\r\n                                    calender += \" ui-datepicker-group-middle\";\r\n                                    cornerClass = \"\";\r\n                                    break;\r\n                            }\r\n                        }\r\n                        calender += \"'>\";\r\n                    }\r\n                    calender += \"<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix\" + cornerClass + \"'>\" +\r\n                        (/all|left/.test(cornerClass) && row === 0 ? (isRTL ? next : prev) : \"\") +\r\n                        (/all|right/.test(cornerClass) && row === 0 ? (isRTL ? prev : next) : \"\") +\r\n                        this._generateMonthYearHeader(inst, drawMonth, drawYear, minDate, maxDate,\r\n                            row > 0 || col > 0, monthNames, monthNamesShort) + // draw month headers\r\n                        \"</div><table class='ui-datepicker-calendar'><thead>\" +\r\n                        \"<tr>\";\r\n                    thead = (showWeek ? \"<th class='ui-datepicker-week-col'>\" + this._get(inst, \"weekHeader\") + \"</th>\" : \"\");\r\n                    for (dow = 0; dow < 7; dow++) { // days of the week\r\n                        day = (dow + firstDay) % 7;\r\n                        thead += \"<th\" + ((dow + firstDay + 6) % 7 >= 5 ? \" class='ui-datepicker-week-end'\" : \"\") + \">\" +\r\n                            \"<span title='\" + dayNames[day] + \"'>\" + dayNamesMin[day] + \"</span></th>\";\r\n                    }\r\n                    calender += thead + \"</tr></thead><tbody>\";\r\n                    daysInMonth = this._getDaysInMonth(drawYear, drawMonth);\r\n                    if (drawYear === inst.selectedYear && drawMonth === inst.selectedMonth) {\r\n                        inst.selectedDay = Math.min(inst.selectedDay, daysInMonth);\r\n                    }\r\n                    leadDays = (this._getFirstDayOfMonth(drawYear, drawMonth) - firstDay + 7) % 7;\r\n                    curRows = Math.ceil((leadDays + daysInMonth) / 7); // calculate the number of rows to generate\r\n                    numRows = (isMultiMonth ? this.maxRows > curRows ? this.maxRows : curRows : curRows); //If multiple months, use the higher number of rows (see #7043)\r\n                    this.maxRows = numRows;\r\n                    printDate = this._daylightSavingAdjust(new Date(drawYear, drawMonth, 1 - leadDays));\r\n                    for (dRow = 0; dRow < numRows; dRow++) { // create date picker rows\r\n                        calender += \"<tr>\";\r\n                        tbody = (!showWeek ? \"\" : \"<td class='ui-datepicker-week-col'>\" +\r\n                            this._get(inst, \"calculateWeek\")(printDate) + \"</td>\");\r\n                        for (dow = 0; dow < 7; dow++) { // create date picker days\r\n                            daySettings = (beforeShowDay ?\r\n                                beforeShowDay.apply((inst.input ? inst.input[0] : null), [printDate]) : [true, \"\"]);\r\n                            otherMonth = (printDate.getMonth() !== drawMonth);\r\n                            unselectable = (otherMonth && !selectOtherMonths) || !daySettings[0] ||\r\n                                (minDate && printDate < minDate) || (maxDate && printDate > maxDate);\r\n                            tbody += \"<td class='\" +\r\n                                ((dow + firstDay + 6) % 7 >= 5 ? \" ui-datepicker-week-end\" : \"\") + // highlight weekends\r\n                                (otherMonth ? \" ui-datepicker-other-month\" : \"\") + // highlight days from other months\r\n                                ((printDate.getTime() === selectedDate.getTime() && drawMonth === inst.selectedMonth && inst._keyEvent) || // user pressed key\r\n                                (defaultDate.getTime() === printDate.getTime() && defaultDate.getTime() === selectedDate.getTime()) ?\r\n                                    // or defaultDate is current printedDate and defaultDate is selectedDate\r\n                                    \" \" + this._dayOverClass : \"\") + // highlight selected day\r\n                                (unselectable ? \" \" + this._unselectableClass + \" ui-state-disabled\" : \"\") +  // highlight unselectable days\r\n                                (otherMonth && !showOtherMonths ? \"\" : \" \" + daySettings[1] + // highlight custom dates\r\n                                    (printDate.getTime() === currentDate.getTime() ? \" \" + this._currentClass : \"\") + // highlight selected day\r\n                                    (printDate.getTime() === today.getTime() ? \" ui-datepicker-today\" : \"\")) + \"'\" + // highlight today (if different)\r\n                                ((!otherMonth || showOtherMonths) && daySettings[2] ? \" title='\" + daySettings[2].replace(/'/g, \"&#39;\") + \"'\" : \"\") + // cell title\r\n                                (unselectable ? \"\" : \" data-handler='selectDay' data-event='click' data-month='\" + printDate.getMonth() + \"' data-year='\" + printDate.getFullYear() + \"'\") + \">\" + // actions\r\n                                (otherMonth && !showOtherMonths ? \"&#xa0;\" : // display for other months\r\n                                    (unselectable ? \"<span class='ui-state-default'>\" + printDate.getDate() + \"</span>\" : \"<a class='ui-state-default\" +\r\n                                        (printDate.getTime() === today.getTime() ? \" ui-state-highlight\" : \"\") +\r\n                                        (printDate.getTime() === currentDate.getTime() ? \" ui-state-active\" : \"\") + // highlight selected day\r\n                                        (otherMonth ? \" ui-priority-secondary\" : \"\") + // distinguish dates from other months\r\n                                        \"' href='#'>\" + printDate.getDate() + \"</a>\")) + \"</td>\"; // display selectable date\r\n                            printDate.setDate(printDate.getDate() + 1);\r\n                            printDate = this._daylightSavingAdjust(printDate);\r\n                        }\r\n                        calender += tbody + \"</tr>\";\r\n                    }\r\n                    drawMonth++;\r\n                    if (drawMonth > 11) {\r\n                        drawMonth = 0;\r\n                        drawYear++;\r\n                    }\r\n                    calender += \"</tbody></table>\" + (isMultiMonth ? \"</div>\" +\r\n                        ((numMonths[0] > 0 && col === numMonths[1] - 1) ? \"<div class='ui-datepicker-row-break'></div>\" : \"\") : \"\");\r\n                    group += calender;\r\n                }\r\n                html += group;\r\n            }\r\n            html += buttonPanel;\r\n            inst._keyEvent = false;\r\n            return html;\r\n        },\r\n\r\n        /* Generate the month and year header. */\r\n        _generateMonthYearHeader: function (inst, drawMonth, drawYear, minDate, maxDate,\r\n                                            secondary, monthNames, monthNamesShort) {\r\n\r\n            var inMinYear, inMaxYear, month, years, thisYear, determineYear, year, endYear,\r\n                changeMonth = this._get(inst, \"changeMonth\"),\r\n                changeYear = this._get(inst, \"changeYear\"),\r\n                showMonthAfterYear = this._get(inst, \"showMonthAfterYear\"),\r\n                html = \"<div class='ui-datepicker-title'>\",\r\n                monthHtml = \"\";\r\n\r\n            // month selection\r\n            if (secondary || !changeMonth) {\r\n                monthHtml += \"<span class='ui-datepicker-month'>\" + monthNames[drawMonth] + \"</span>\";\r\n            } else {\r\n                inMinYear = (minDate && minDate.getFullYear() === drawYear);\r\n                inMaxYear = (maxDate && maxDate.getFullYear() === drawYear);\r\n                monthHtml += \"<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>\";\r\n                for (month = 0; month < 12; month++) {\r\n                    if ((!inMinYear || month >= minDate.getMonth()) && (!inMaxYear || month <= maxDate.getMonth())) {\r\n                        monthHtml += \"<option value='\" + month + \"'\" +\r\n                            (month === drawMonth ? \" selected='selected'\" : \"\") +\r\n                            \">\" + monthNamesShort[month] + \"</option>\";\r\n                    }\r\n                }\r\n                monthHtml += \"</select>\";\r\n            }\r\n\r\n            if (!showMonthAfterYear) {\r\n                html += monthHtml + (secondary || !(changeMonth && changeYear) ? \"&#xa0;\" : \"\");\r\n            }\r\n\r\n            // year selection\r\n            if (!inst.yearshtml) {\r\n                inst.yearshtml = \"\";\r\n                if (secondary || !changeYear) {\r\n                    html += \"<span class='ui-datepicker-year'>\" + drawYear + \"</span>\";\r\n                } else {\r\n                    // determine range of years to display\r\n                    years = this._get(inst, \"yearRange\").split(\":\");\r\n                    thisYear = new Date().getFullYear();\r\n                    determineYear = function (value) {\r\n                        var year = (value.match(/c[+\\-].*/) ? drawYear + parseInt(value.substring(1), 10) :\r\n                            (value.match(/[+\\-].*/) ? thisYear + parseInt(value, 10) :\r\n                                parseInt(value, 10)));\r\n                        return (isNaN(year) ? thisYear : year);\r\n                    };\r\n                    year = determineYear(years[0]);\r\n                    endYear = Math.max(year, determineYear(years[1] || \"\"));\r\n                    year = (minDate ? Math.max(year, minDate.getFullYear()) : year);\r\n                    endYear = (maxDate ? Math.min(endYear, maxDate.getFullYear()) : endYear);\r\n                    inst.yearshtml += \"<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>\";\r\n                    for (; year <= endYear; year++) {\r\n                        inst.yearshtml += \"<option value='\" + year + \"'\" +\r\n                            (year === drawYear ? \" selected='selected'\" : \"\") +\r\n                            \">\" + year + \"</option>\";\r\n                    }\r\n                    inst.yearshtml += \"</select>\";\r\n\r\n                    html += inst.yearshtml;\r\n                    inst.yearshtml = null;\r\n                }\r\n            }\r\n\r\n            html += this._get(inst, \"yearSuffix\");\r\n            if (showMonthAfterYear) {\r\n                html += (secondary || !(changeMonth && changeYear) ? \"&#xa0;\" : \"\") + monthHtml;\r\n            }\r\n            html += \"</div>\"; // Close datepicker_header\r\n            return html;\r\n        },\r\n\r\n        /* Adjust one of the date sub-fields. */\r\n        _adjustInstDate: function (inst, offset, period) {\r\n            var year = inst.drawYear + (period === \"Y\" ? offset : 0),\r\n                month = inst.drawMonth + (period === \"M\" ? offset : 0),\r\n                day = Math.min(inst.selectedDay, this._getDaysInMonth(year, month)) + (period === \"D\" ? offset : 0),\r\n                date = this._restrictMinMax(inst, this._daylightSavingAdjust(new Date(year, month, day)));\r\n\r\n            inst.selectedDay = date.getDate();\r\n            inst.drawMonth = inst.selectedMonth = date.getMonth();\r\n            inst.drawYear = inst.selectedYear = date.getFullYear();\r\n            if (period === \"M\" || period === \"Y\") {\r\n                this._notifyChange(inst);\r\n            }\r\n        },\r\n\r\n        /* Ensure a date is within any min/max bounds. */\r\n        _restrictMinMax: function (inst, date) {\r\n            var minDate = this._getMinMaxDate(inst, \"min\"),\r\n                maxDate = this._getMinMaxDate(inst, \"max\"),\r\n                newDate = (minDate && date < minDate ? minDate : date);\r\n            return (maxDate && newDate > maxDate ? maxDate : newDate);\r\n        },\r\n\r\n        /* Notify change of month/year. */\r\n        _notifyChange: function (inst) {\r\n            var onChange = this._get(inst, \"onChangeMonthYear\");\r\n            if (onChange) {\r\n                onChange.apply((inst.input ? inst.input[0] : null),\r\n                    [inst.selectedYear, inst.selectedMonth + 1, inst]);\r\n            }\r\n        },\r\n\r\n        /* Determine the number of months to show. */\r\n        _getNumberOfMonths: function (inst) {\r\n            var numMonths = this._get(inst, \"numberOfMonths\");\r\n            return (numMonths == null ? [1, 1] : (typeof numMonths === \"number\" ? [1, numMonths] : numMonths));\r\n        },\r\n\r\n        /* Determine the current maximum date - ensure no time components are set. */\r\n        _getMinMaxDate: function (inst, minMax) {\r\n            return this._determineDate(inst, this._get(inst, minMax + \"Date\"), null);\r\n        },\r\n\r\n        /* Find the number of days in a given month. */\r\n        _getDaysInMonth: function (year, month) {\r\n            return 32 - this._daylightSavingAdjust(new Date(year, month, 32)).getDate();\r\n        },\r\n\r\n        /* Find the day of the week of the first of a month. */\r\n        _getFirstDayOfMonth: function (year, month) {\r\n            return new Date(year, month, 1).getDay();\r\n        },\r\n\r\n        /* Determines if we should allow a \"next/prev\" month display change. */\r\n        _canAdjustMonth: function (inst, offset, curYear, curMonth) {\r\n            var numMonths = this._getNumberOfMonths(inst),\r\n                date = this._daylightSavingAdjust(new Date(curYear,\r\n                    curMonth + (offset < 0 ? offset : numMonths[0] * numMonths[1]), 1));\r\n\r\n            if (offset < 0) {\r\n                date.setDate(this._getDaysInMonth(date.getFullYear(), date.getMonth()));\r\n            }\r\n            return this._isInRange(inst, date);\r\n        },\r\n\r\n        /* Is the given date in the accepted range? */\r\n        _isInRange: function (inst, date) {\r\n            var yearSplit, currentYear,\r\n                minDate = this._getMinMaxDate(inst, \"min\"),\r\n                maxDate = this._getMinMaxDate(inst, \"max\"),\r\n                minYear = null,\r\n                maxYear = null,\r\n                years = this._get(inst, \"yearRange\");\r\n            if (years) {\r\n                yearSplit = years.split(\":\");\r\n                currentYear = new Date().getFullYear();\r\n                minYear = parseInt(yearSplit[0], 10);\r\n                maxYear = parseInt(yearSplit[1], 10);\r\n                if (yearSplit[0].match(/[+\\-].*/)) {\r\n                    minYear += currentYear;\r\n                }\r\n                if (yearSplit[1].match(/[+\\-].*/)) {\r\n                    maxYear += currentYear;\r\n                }\r\n            }\r\n\r\n            return ((!minDate || date.getTime() >= minDate.getTime()) &&\r\n                (!maxDate || date.getTime() <= maxDate.getTime()) &&\r\n                (!minYear || date.getFullYear() >= minYear) &&\r\n                (!maxYear || date.getFullYear() <= maxYear));\r\n        },\r\n\r\n        /* Provide the configuration settings for formatting/parsing. */\r\n        _getFormatConfig: function (inst) {\r\n            var shortYearCutoff = this._get(inst, \"shortYearCutoff\");\r\n            shortYearCutoff = (typeof shortYearCutoff !== \"string\" ? shortYearCutoff :\r\n                new Date().getFullYear() % 100 + parseInt(shortYearCutoff, 10));\r\n            return {\r\n                shortYearCutoff: shortYearCutoff,\r\n                dayNamesShort: this._get(inst, \"dayNamesShort\"), dayNames: this._get(inst, \"dayNames\"),\r\n                monthNamesShort: this._get(inst, \"monthNamesShort\"), monthNames: this._get(inst, \"monthNames\")\r\n            };\r\n        },\r\n\r\n        /* Format the given date for display. */\r\n        _formatDate: function (inst, day, month, year) {\r\n            if (!day) {\r\n                inst.currentDay = inst.selectedDay;\r\n                inst.currentMonth = inst.selectedMonth;\r\n                inst.currentYear = inst.selectedYear;\r\n            }\r\n            var date = (day ? (typeof day === \"object\" ? day :\r\n                this._daylightSavingAdjust(new Date(year, month, day))) :\r\n                this._daylightSavingAdjust(new Date(inst.currentYear, inst.currentMonth, inst.currentDay)));\r\n            return this.formatDate(this._get(inst, \"dateFormat\"), date, this._getFormatConfig(inst));\r\n        }\r\n    });\r\n\r\n    /*\r\n     * Bind hover events for datepicker elements.\r\n     * Done via delegate so the binding only occurs once in the lifetime of the parent div.\r\n     * Global instActive, set by _updateDatepicker allows the handlers to find their way back to the active picker.\r\n     */\r\n    function bindHover(dpDiv) {\r\n        var selector = \"button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a\";\r\n        return dpDiv.delegate(selector, \"mouseout\", function () {\r\n            $(this).removeClass(\"ui-state-hover\");\r\n            if (this.className.indexOf(\"ui-datepicker-prev\") !== -1) {\r\n                $(this).removeClass(\"ui-datepicker-prev-hover\");\r\n            }\r\n            if (this.className.indexOf(\"ui-datepicker-next\") !== -1) {\r\n                $(this).removeClass(\"ui-datepicker-next-hover\");\r\n            }\r\n        })\r\n            .delegate(selector, \"mouseover\", function () {\r\n                if (!$.datepicker._isDisabledDatepicker(instActive.inline ? dpDiv.parent()[0] : instActive.input[0])) {\r\n                    $(this).parents(\".ui-datepicker-calendar\").find(\"a\").removeClass(\"ui-state-hover\");\r\n                    $(this).addClass(\"ui-state-hover\");\r\n                    if (this.className.indexOf(\"ui-datepicker-prev\") !== -1) {\r\n                        $(this).addClass(\"ui-datepicker-prev-hover\");\r\n                    }\r\n                    if (this.className.indexOf(\"ui-datepicker-next\") !== -1) {\r\n                        $(this).addClass(\"ui-datepicker-next-hover\");\r\n                    }\r\n                }\r\n            });\r\n    }\r\n\r\n    /* jQuery extend now ignores nulls! */\r\n    function extendRemove(target, props) {\r\n        $.extend(target, props);\r\n        for (var name in props) {\r\n            if (props[name] == null) {\r\n                target[name] = props[name];\r\n            }\r\n        }\r\n        return target;\r\n    }\r\n\r\n    /* Invoke the datepicker functionality.\r\n       @param  options  string - a command, optionally followed by additional parameters or\r\n                        Object - settings for attaching new datepicker functionality\r\n       @return  jQuery object */\r\n    $.fn.datepicker = function (options) {\r\n\r\n        /* Verify an empty collection wasn't passed - Fixes #6976 */\r\n        if (!this.length) {\r\n            return this;\r\n        }\r\n\r\n        /* Initialise the date picker. */\r\n        if (!$.datepicker.initialized) {\r\n            $(document).mousedown($.datepicker._checkExternalClick);\r\n            $.datepicker.initialized = true;\r\n        }\r\n\r\n        /* Append datepicker main container to body if not exist. */\r\n        if ($(\"#\" + $.datepicker._mainDivId).length === 0) {\r\n            $(\"body\").append($.datepicker.dpDiv);\r\n        }\r\n\r\n        var otherArgs = Array.prototype.slice.call(arguments, 1);\r\n        if (typeof options === \"string\" && (options === \"isDisabled\" || options === \"getDate\" || options === \"widget\")) {\r\n            return $.datepicker[\"_\" + options + \"Datepicker\"].apply($.datepicker, [this[0]].concat(otherArgs));\r\n        }\r\n        if (options === \"option\" && arguments.length === 2 && typeof arguments[1] === \"string\") {\r\n            return $.datepicker[\"_\" + options + \"Datepicker\"].apply($.datepicker, [this[0]].concat(otherArgs));\r\n        }\r\n        return this.each(function () {\r\n            typeof options === \"string\" ?\r\n                $.datepicker[\"_\" + options + \"Datepicker\"].apply($.datepicker, [this].concat(otherArgs)) :\r\n                $.datepicker._attachDatepicker(this, options);\r\n        });\r\n    };\r\n\r\n    $.datepicker = new Datepicker(); // singleton instance\r\n    $.datepicker.initialized = false;\r\n    $.datepicker.uuid = new Date().getTime();\r\n    $.datepicker.version = \"1.10.4\";\r\n\r\n});\r\n","jquery/ui-modules/dialog.js":"/*!\r\n * jQuery UI Dialog - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/dialog/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/button',\r\n    'jquery-ui-modules/draggable',\r\n    'jquery-ui-modules/position',\r\n    'jquery-ui-modules/resizable'\r\n], function ($, undefined) {\r\n\r\n    var sizeRelatedOptions = {\r\n            buttons: true,\r\n            height: true,\r\n            maxHeight: true,\r\n            maxWidth: true,\r\n            minHeight: true,\r\n            minWidth: true,\r\n            width: true\r\n        },\r\n        resizableRelatedOptions = {\r\n            maxHeight: true,\r\n            maxWidth: true,\r\n            minHeight: true,\r\n            minWidth: true\r\n        };\r\n\r\n    $.widget(\"ui.dialog\", {\r\n        version: \"1.10.4\",\r\n        options: {\r\n            appendTo: \"body\",\r\n            autoOpen: true,\r\n            buttons: [],\r\n            closeOnEscape: true,\r\n            closeText: \"close\",\r\n            dialogClass: \"\",\r\n            draggable: true,\r\n            hide: null,\r\n            height: \"auto\",\r\n            maxHeight: null,\r\n            maxWidth: null,\r\n            minHeight: 150,\r\n            minWidth: 150,\r\n            modal: false,\r\n            position: {\r\n                my: \"center\",\r\n                at: \"center\",\r\n                of: window,\r\n                collision: \"fit\",\r\n                // Ensure the titlebar is always visible\r\n                using: function (pos) {\r\n                    var topOffset = $(this).css(pos).offset().top;\r\n                    if (topOffset < 0) {\r\n                        $(this).css(\"top\", pos.top - topOffset);\r\n                    }\r\n                }\r\n            },\r\n            resizable: true,\r\n            show: null,\r\n            title: null,\r\n            width: 300,\r\n\r\n            // callbacks\r\n            beforeClose: null,\r\n            close: null,\r\n            drag: null,\r\n            dragStart: null,\r\n            dragStop: null,\r\n            focus: null,\r\n            open: null,\r\n            resize: null,\r\n            resizeStart: null,\r\n            resizeStop: null\r\n        },\r\n\r\n        _create: function () {\r\n            this.originalCss = {\r\n                display: this.element[0].style.display,\r\n                width: this.element[0].style.width,\r\n                minHeight: this.element[0].style.minHeight,\r\n                maxHeight: this.element[0].style.maxHeight,\r\n                height: this.element[0].style.height\r\n            };\r\n            this.originalPosition = {\r\n                parent: this.element.parent(),\r\n                index: this.element.parent().children().index(this.element)\r\n            };\r\n            this.originalTitle = this.element.attr(\"title\");\r\n            this.options.title = this.options.title || this.originalTitle;\r\n\r\n            this._createWrapper();\r\n\r\n            this.element\r\n                .show()\r\n                .removeAttr(\"title\")\r\n                .addClass(\"ui-dialog-content ui-widget-content\")\r\n                .appendTo(this.uiDialog);\r\n\r\n            this._createTitlebar();\r\n            this._createButtonPane();\r\n\r\n            if (this.options.draggable && $.fn.draggable) {\r\n                this._makeDraggable();\r\n            }\r\n            if (this.options.resizable && $.fn.resizable) {\r\n                this._makeResizable();\r\n            }\r\n\r\n            this._isOpen = false;\r\n        },\r\n\r\n        _init: function () {\r\n            if (this.options.autoOpen) {\r\n                this.open();\r\n            }\r\n        },\r\n\r\n        _appendTo: function () {\r\n            var element = this.options.appendTo;\r\n            if (element && (element.jquery || element.nodeType)) {\r\n                return $(element);\r\n            }\r\n            return this.document.find(element || \"body\").eq(0);\r\n        },\r\n\r\n        _destroy: function () {\r\n            var next,\r\n                originalPosition = this.originalPosition;\r\n\r\n            this._destroyOverlay();\r\n\r\n            this.element\r\n                .removeUniqueId()\r\n                .removeClass(\"ui-dialog-content ui-widget-content\")\r\n                .css(this.originalCss)\r\n                // Without detaching first, the following becomes really slow\r\n                .detach();\r\n\r\n            this.uiDialog.stop(true, true).remove();\r\n\r\n            if (this.originalTitle) {\r\n                this.element.attr(\"title\", this.originalTitle);\r\n            }\r\n\r\n            next = originalPosition.parent.children().eq(originalPosition.index);\r\n            // Don't try to place the dialog next to itself (#8613)\r\n            if (next.length && next[0] !== this.element[0]) {\r\n                next.before(this.element);\r\n            } else {\r\n                originalPosition.parent.append(this.element);\r\n            }\r\n        },\r\n\r\n        widget: function () {\r\n            return this.uiDialog;\r\n        },\r\n\r\n        disable: $.noop,\r\n        enable: $.noop,\r\n\r\n        close: function (event) {\r\n            var activeElement,\r\n                that = this;\r\n\r\n            if (!this._isOpen || this._trigger(\"beforeClose\", event) === false) {\r\n                return;\r\n            }\r\n\r\n            this._isOpen = false;\r\n            this._destroyOverlay();\r\n\r\n            if (!this.opener.filter(\":focusable\").focus().length) {\r\n\r\n                // support: IE9\r\n                // IE9 throws an \"Unspecified error\" accessing document.activeElement from an <iframe>\r\n                try {\r\n                    activeElement = this.document[0].activeElement;\r\n\r\n                    // Support: IE9, IE10\r\n                    // If the <body> is blurred, IE will switch windows, see #4520\r\n                    if (activeElement && activeElement.nodeName.toLowerCase() !== \"body\") {\r\n\r\n                        // Hiding a focused element doesn't trigger blur in WebKit\r\n                        // so in case we have nothing to focus on, explicitly blur the active element\r\n                        // https://bugs.webkit.org/show_bug.cgi?id=47182\r\n                        $(activeElement).blur();\r\n                    }\r\n                } catch (error) {\r\n                }\r\n            }\r\n\r\n            this._hide(this.uiDialog, this.options.hide, function () {\r\n                that._trigger(\"close\", event);\r\n            });\r\n        },\r\n\r\n        isOpen: function () {\r\n            return this._isOpen;\r\n        },\r\n\r\n        moveToTop: function () {\r\n            this._moveToTop();\r\n        },\r\n\r\n        _moveToTop: function (event, silent) {\r\n            var moved = !!this.uiDialog.nextAll(\":visible\").insertBefore(this.uiDialog).length;\r\n            if (moved && !silent) {\r\n                this._trigger(\"focus\", event);\r\n            }\r\n            return moved;\r\n        },\r\n\r\n        open: function () {\r\n            var that = this;\r\n            if (this._isOpen) {\r\n                if (this._moveToTop()) {\r\n                    this._focusTabbable();\r\n                }\r\n                return;\r\n            }\r\n\r\n            this._isOpen = true;\r\n            this.opener = $(this.document[0].activeElement);\r\n\r\n            this._size();\r\n            this._position();\r\n            this._createOverlay();\r\n            this._moveToTop(null, true);\r\n            this._show(this.uiDialog, this.options.show, function () {\r\n                that._focusTabbable();\r\n                that._trigger(\"focus\");\r\n            });\r\n\r\n            this._trigger(\"open\");\r\n        },\r\n\r\n        _focusTabbable: function () {\r\n            // Set focus to the first match:\r\n            // 1. First element inside the dialog matching [autofocus]\r\n            // 2. Tabbable element inside the content element\r\n            // 3. Tabbable element inside the buttonpane\r\n            // 4. The close button\r\n            // 5. The dialog itself\r\n            var hasFocus = this.element.find(\"[autofocus]\");\r\n            if (!hasFocus.length) {\r\n                hasFocus = this.element.find(\":tabbable\");\r\n            }\r\n            if (!hasFocus.length) {\r\n                hasFocus = this.uiDialogButtonPane.find(\":tabbable\");\r\n            }\r\n            if (!hasFocus.length) {\r\n                hasFocus = this.uiDialogTitlebarClose.filter(\":tabbable\");\r\n            }\r\n            if (!hasFocus.length) {\r\n                hasFocus = this.uiDialog;\r\n            }\r\n            hasFocus.eq(0).focus();\r\n        },\r\n\r\n        _keepFocus: function (event) {\r\n            function checkFocus() {\r\n                var activeElement = this.document[0].activeElement,\r\n                    isActive = this.uiDialog[0] === activeElement ||\r\n                        $.contains(this.uiDialog[0], activeElement);\r\n                if (!isActive) {\r\n                    this._focusTabbable();\r\n                }\r\n            }\r\n\r\n            event.preventDefault();\r\n            checkFocus.call(this);\r\n            // support: IE\r\n            // IE <= 8 doesn't prevent moving focus even with event.preventDefault()\r\n            // so we check again later\r\n            this._delay(checkFocus);\r\n        },\r\n\r\n        _createWrapper: function () {\r\n            this.uiDialog = $(\"<div>\")\r\n                .addClass(\"ui-dialog ui-widget ui-widget-content ui-corner-all ui-front \" +\r\n                    this.options.dialogClass)\r\n                .hide()\r\n                .attr({\r\n                    // Setting tabIndex makes the div focusable\r\n                    tabIndex: -1,\r\n                    role: \"dialog\"\r\n                })\r\n                .appendTo(this._appendTo());\r\n\r\n            this._on(this.uiDialog, {\r\n                keydown: function (event) {\r\n                    if (this.options.closeOnEscape && !event.isDefaultPrevented() && event.keyCode &&\r\n                        event.keyCode === $.ui.keyCode.ESCAPE) {\r\n                        event.preventDefault();\r\n                        this.close(event);\r\n                        return;\r\n                    }\r\n\r\n                    // prevent tabbing out of dialogs\r\n                    if (event.keyCode !== $.ui.keyCode.TAB) {\r\n                        return;\r\n                    }\r\n                    var tabbables = this.uiDialog.find(\":tabbable\"),\r\n                        first = tabbables.filter(\":first\"),\r\n                        last = tabbables.filter(\":last\");\r\n\r\n                    if ((event.target === last[0] || event.target === this.uiDialog[0]) && !event.shiftKey) {\r\n                        first.focus(1);\r\n                        event.preventDefault();\r\n                    } else if ((event.target === first[0] || event.target === this.uiDialog[0]) && event.shiftKey) {\r\n                        last.focus(1);\r\n                        event.preventDefault();\r\n                    }\r\n                },\r\n                mousedown: function (event) {\r\n                    if (this._moveToTop(event)) {\r\n                        this._focusTabbable();\r\n                    }\r\n                }\r\n            });\r\n\r\n            // We assume that any existing aria-describedby attribute means\r\n            // that the dialog content is marked up properly\r\n            // otherwise we brute force the content as the description\r\n            if (!this.element.find(\"[aria-describedby]\").length) {\r\n                this.uiDialog.attr({\r\n                    \"aria-describedby\": this.element.uniqueId().attr(\"id\")\r\n                });\r\n            }\r\n        },\r\n\r\n        _createTitlebar: function () {\r\n            var uiDialogTitle;\r\n\r\n            this.uiDialogTitlebar = $(\"<div>\")\r\n                .addClass(\"ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix\")\r\n                .prependTo(this.uiDialog);\r\n            this._on(this.uiDialogTitlebar, {\r\n                mousedown: function (event) {\r\n                    // Don't prevent click on close button (#8838)\r\n                    // Focusing a dialog that is partially scrolled out of view\r\n                    // causes the browser to scroll it into view, preventing the click event\r\n                    if (!$(event.target).closest(\".ui-dialog-titlebar-close\")) {\r\n                        // Dialog isn't getting focus when dragging (#8063)\r\n                        this.uiDialog.focus();\r\n                    }\r\n                }\r\n            });\r\n\r\n            // support: IE\r\n            // Use type=\"button\" to prevent enter keypresses in textboxes from closing the\r\n            // dialog in IE (#9312)\r\n            this.uiDialogTitlebarClose = $(\"<button type='button'></button>\")\r\n                .button({\r\n                    label: this.options.closeText,\r\n                    icons: {\r\n                        primary: \"ui-icon-closethick\"\r\n                    },\r\n                    text: false\r\n                })\r\n                .addClass(\"ui-dialog-titlebar-close\")\r\n                .appendTo(this.uiDialogTitlebar);\r\n            this._on(this.uiDialogTitlebarClose, {\r\n                click: function (event) {\r\n                    event.preventDefault();\r\n                    this.close(event);\r\n                }\r\n            });\r\n\r\n            uiDialogTitle = $(\"<span>\")\r\n                .uniqueId()\r\n                .addClass(\"ui-dialog-title\")\r\n                .prependTo(this.uiDialogTitlebar);\r\n            this._title(uiDialogTitle);\r\n\r\n            this.uiDialog.attr({\r\n                \"aria-labelledby\": uiDialogTitle.attr(\"id\")\r\n            });\r\n        },\r\n\r\n        _title: function (title) {\r\n            if (!this.options.title) {\r\n                title.html(\"&#160;\");\r\n            }\r\n            title.text(this.options.title);\r\n        },\r\n\r\n        _createButtonPane: function () {\r\n            this.uiDialogButtonPane = $(\"<div>\")\r\n                .addClass(\"ui-dialog-buttonpane ui-widget-content ui-helper-clearfix\");\r\n\r\n            this.uiButtonSet = $(\"<div>\")\r\n                .addClass(\"ui-dialog-buttonset\")\r\n                .appendTo(this.uiDialogButtonPane);\r\n\r\n            this._createButtons();\r\n        },\r\n\r\n        _createButtons: function () {\r\n            var that = this,\r\n                buttons = this.options.buttons;\r\n\r\n            // if we already have a button pane, remove it\r\n            this.uiDialogButtonPane.remove();\r\n            this.uiButtonSet.empty();\r\n\r\n            if ($.isEmptyObject(buttons) || ($.isArray(buttons) && !buttons.length)) {\r\n                this.uiDialog.removeClass(\"ui-dialog-buttons\");\r\n                return;\r\n            }\r\n\r\n            $.each(buttons, function (name, props) {\r\n                var click, buttonOptions;\r\n                props = $.isFunction(props) ?\r\n                    {click: props, text: name} :\r\n                    props;\r\n                // Default to a non-submitting button\r\n                props = $.extend({type: \"button\"}, props);\r\n                // Change the context for the click callback to be the main element\r\n                click = props.click;\r\n                props.click = function () {\r\n                    click.apply(that.element[0], arguments);\r\n                };\r\n                buttonOptions = {\r\n                    icons: props.icons,\r\n                    text: props.showText\r\n                };\r\n                delete props.icons;\r\n                delete props.showText;\r\n                $(\"<button></button>\", props)\r\n                    .button(buttonOptions)\r\n                    .appendTo(that.uiButtonSet);\r\n            });\r\n            this.uiDialog.addClass(\"ui-dialog-buttons\");\r\n            this.uiDialogButtonPane.appendTo(this.uiDialog);\r\n        },\r\n\r\n        _makeDraggable: function () {\r\n            var that = this,\r\n                options = this.options;\r\n\r\n            function filteredUi(ui) {\r\n                return {\r\n                    position: ui.position,\r\n                    offset: ui.offset\r\n                };\r\n            }\r\n\r\n            this.uiDialog.draggable({\r\n                cancel: \".ui-dialog-content, .ui-dialog-titlebar-close\",\r\n                handle: \".ui-dialog-titlebar\",\r\n                containment: \"document\",\r\n                start: function (event, ui) {\r\n                    $(this).addClass(\"ui-dialog-dragging\");\r\n                    that._blockFrames();\r\n                    that._trigger(\"dragStart\", event, filteredUi(ui));\r\n                },\r\n                drag: function (event, ui) {\r\n                    that._trigger(\"drag\", event, filteredUi(ui));\r\n                },\r\n                stop: function (event, ui) {\r\n                    options.position = [\r\n                        ui.position.left - that.document.scrollLeft(),\r\n                        ui.position.top - that.document.scrollTop()\r\n                    ];\r\n                    $(this).removeClass(\"ui-dialog-dragging\");\r\n                    that._unblockFrames();\r\n                    that._trigger(\"dragStop\", event, filteredUi(ui));\r\n                }\r\n            });\r\n        },\r\n\r\n        _makeResizable: function () {\r\n            var that = this,\r\n                options = this.options,\r\n                handles = options.resizable,\r\n                // .ui-resizable has position: relative defined in the stylesheet\r\n                // but dialogs have to use absolute or fixed positioning\r\n                position = this.uiDialog.css(\"position\"),\r\n                resizeHandles = typeof handles === \"string\" ?\r\n                    handles :\r\n                    \"n,e,s,w,se,sw,ne,nw\";\r\n\r\n            function filteredUi(ui) {\r\n                return {\r\n                    originalPosition: ui.originalPosition,\r\n                    originalSize: ui.originalSize,\r\n                    position: ui.position,\r\n                    size: ui.size\r\n                };\r\n            }\r\n\r\n            this.uiDialog.resizable({\r\n                cancel: \".ui-dialog-content\",\r\n                containment: \"document\",\r\n                alsoResize: this.element,\r\n                maxWidth: options.maxWidth,\r\n                maxHeight: options.maxHeight,\r\n                minWidth: options.minWidth,\r\n                minHeight: this._minHeight(),\r\n                handles: resizeHandles,\r\n                start: function (event, ui) {\r\n                    $(this).addClass(\"ui-dialog-resizing\");\r\n                    that._blockFrames();\r\n                    that._trigger(\"resizeStart\", event, filteredUi(ui));\r\n                },\r\n                resize: function (event, ui) {\r\n                    that._trigger(\"resize\", event, filteredUi(ui));\r\n                },\r\n                stop: function (event, ui) {\r\n                    options.height = $(this).height();\r\n                    options.width = $(this).width();\r\n                    $(this).removeClass(\"ui-dialog-resizing\");\r\n                    that._unblockFrames();\r\n                    that._trigger(\"resizeStop\", event, filteredUi(ui));\r\n                }\r\n            })\r\n                .css(\"position\", position);\r\n        },\r\n\r\n        _minHeight: function () {\r\n            var options = this.options;\r\n\r\n            return options.height === \"auto\" ?\r\n                options.minHeight :\r\n                Math.min(options.minHeight, options.height);\r\n        },\r\n\r\n        _position: function () {\r\n            // Need to show the dialog to get the actual offset in the position plugin\r\n            var isVisible = this.uiDialog.is(\":visible\");\r\n            if (!isVisible) {\r\n                this.uiDialog.show();\r\n            }\r\n            this.uiDialog.position(this.options.position);\r\n            if (!isVisible) {\r\n                this.uiDialog.hide();\r\n            }\r\n        },\r\n\r\n        _setOptions: function (options) {\r\n            var that = this,\r\n                resize = false,\r\n                resizableOptions = {};\r\n\r\n            $.each(options, function (key, value) {\r\n                that._setOption(key, value);\r\n\r\n                if (key in sizeRelatedOptions) {\r\n                    resize = true;\r\n                }\r\n                if (key in resizableRelatedOptions) {\r\n                    resizableOptions[key] = value;\r\n                }\r\n            });\r\n\r\n            if (resize) {\r\n                this._size();\r\n                this._position();\r\n            }\r\n            if (this.uiDialog.is(\":data(ui-resizable)\")) {\r\n                this.uiDialog.resizable(\"option\", resizableOptions);\r\n            }\r\n        },\r\n\r\n        _setOption: function (key, value) {\r\n            var isDraggable, isResizable,\r\n                uiDialog = this.uiDialog;\r\n\r\n            if (key === \"dialogClass\") {\r\n                uiDialog\r\n                    .removeClass(this.options.dialogClass)\r\n                    .addClass(value);\r\n            }\r\n\r\n            if (key === \"disabled\") {\r\n                return;\r\n            }\r\n\r\n            this._super(key, value);\r\n\r\n            if (key === \"appendTo\") {\r\n                this.uiDialog.appendTo(this._appendTo());\r\n            }\r\n\r\n            if (key === \"buttons\") {\r\n                this._createButtons();\r\n            }\r\n\r\n            if (key === \"closeText\") {\r\n                this.uiDialogTitlebarClose.button({\r\n                    // Ensure that we always pass a string\r\n                    label: \"\" + value\r\n                });\r\n            }\r\n\r\n            if (key === \"draggable\") {\r\n                isDraggable = uiDialog.is(\":data(ui-draggable)\");\r\n                if (isDraggable && !value) {\r\n                    uiDialog.draggable(\"destroy\");\r\n                }\r\n\r\n                if (!isDraggable && value) {\r\n                    this._makeDraggable();\r\n                }\r\n            }\r\n\r\n            if (key === \"position\") {\r\n                this._position();\r\n            }\r\n\r\n            if (key === \"resizable\") {\r\n                // currently resizable, becoming non-resizable\r\n                isResizable = uiDialog.is(\":data(ui-resizable)\");\r\n                if (isResizable && !value) {\r\n                    uiDialog.resizable(\"destroy\");\r\n                }\r\n\r\n                // currently resizable, changing handles\r\n                if (isResizable && typeof value === \"string\") {\r\n                    uiDialog.resizable(\"option\", \"handles\", value);\r\n                }\r\n\r\n                // currently non-resizable, becoming resizable\r\n                if (!isResizable && value !== false) {\r\n                    this._makeResizable();\r\n                }\r\n            }\r\n\r\n            if (key === \"title\") {\r\n                this._title(this.uiDialogTitlebar.find(\".ui-dialog-title\"));\r\n            }\r\n        },\r\n\r\n        _size: function () {\r\n            // If the user has resized the dialog, the .ui-dialog and .ui-dialog-content\r\n            // divs will both have width and height set, so we need to reset them\r\n            var nonContentHeight, minContentHeight, maxContentHeight,\r\n                options = this.options;\r\n\r\n            // Reset content sizing\r\n            this.element.show().css({\r\n                width: \"auto\",\r\n                minHeight: 0,\r\n                maxHeight: \"none\",\r\n                height: 0\r\n            });\r\n\r\n            if (options.minWidth > options.width) {\r\n                options.width = options.minWidth;\r\n            }\r\n\r\n            // reset wrapper sizing\r\n            // determine the height of all the non-content elements\r\n            nonContentHeight = this.uiDialog.css({\r\n                height: \"auto\",\r\n                width: options.width\r\n            })\r\n                .outerHeight();\r\n            minContentHeight = Math.max(0, options.minHeight - nonContentHeight);\r\n            maxContentHeight = typeof options.maxHeight === \"number\" ?\r\n                Math.max(0, options.maxHeight - nonContentHeight) :\r\n                \"none\";\r\n\r\n            if (options.height === \"auto\") {\r\n                this.element.css({\r\n                    minHeight: minContentHeight,\r\n                    maxHeight: maxContentHeight,\r\n                    height: \"auto\"\r\n                });\r\n            } else {\r\n                this.element.height(Math.max(0, options.height - nonContentHeight));\r\n            }\r\n\r\n            if (this.uiDialog.is(\":data(ui-resizable)\")) {\r\n                this.uiDialog.resizable(\"option\", \"minHeight\", this._minHeight());\r\n            }\r\n        },\r\n\r\n        _blockFrames: function () {\r\n            this.iframeBlocks = this.document.find(\"iframe\").map(function () {\r\n                var iframe = $(this);\r\n\r\n                return $(\"<div>\")\r\n                    .css({\r\n                        position: \"absolute\",\r\n                        width: iframe.outerWidth(),\r\n                        height: iframe.outerHeight()\r\n                    })\r\n                    .appendTo(iframe.parent())\r\n                    .offset(iframe.offset())[0];\r\n            });\r\n        },\r\n\r\n        _unblockFrames: function () {\r\n            if (this.iframeBlocks) {\r\n                this.iframeBlocks.remove();\r\n                delete this.iframeBlocks;\r\n            }\r\n        },\r\n\r\n        _allowInteraction: function (event) {\r\n            if ($(event.target).closest(\".ui-dialog\").length) {\r\n                return true;\r\n            }\r\n\r\n            // TODO: Remove hack when datepicker implements\r\n            // the .ui-front logic (#8989)\r\n            return !!$(event.target).closest(\".ui-datepicker\").length;\r\n        },\r\n\r\n        _createOverlay: function () {\r\n            if (!this.options.modal) {\r\n                return;\r\n            }\r\n\r\n            var that = this,\r\n                widgetFullName = this.widgetFullName;\r\n            if (!$.ui.dialog.overlayInstances) {\r\n                // Prevent use of anchors and inputs.\r\n                // We use a delay in case the overlay is created from an\r\n                // event that we're going to be cancelling. (#2804)\r\n                this._delay(function () {\r\n                    // Handle .dialog().dialog(\"close\") (#4065)\r\n                    if ($.ui.dialog.overlayInstances) {\r\n                        this.document.bind(\"focusin.dialog\", function (event) {\r\n                            if (!that._allowInteraction(event)) {\r\n                                event.preventDefault();\r\n                                $(\".ui-dialog:visible:last .ui-dialog-content\")\r\n                                    .data(widgetFullName)._focusTabbable();\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n\r\n            this.overlay = $(\"<div>\")\r\n                .addClass(\"ui-widget-overlay ui-front\")\r\n                .appendTo(this._appendTo());\r\n            this._on(this.overlay, {\r\n                mousedown: \"_keepFocus\"\r\n            });\r\n            $.ui.dialog.overlayInstances++;\r\n        },\r\n\r\n        _destroyOverlay: function () {\r\n            if (!this.options.modal) {\r\n                return;\r\n            }\r\n\r\n            if (this.overlay) {\r\n                $.ui.dialog.overlayInstances--;\r\n\r\n                if (!$.ui.dialog.overlayInstances) {\r\n                    this.document.unbind(\"focusin.dialog\");\r\n                }\r\n                this.overlay.remove();\r\n                this.overlay = null;\r\n            }\r\n        }\r\n    });\r\n\r\n    $.ui.dialog.overlayInstances = 0;\r\n\r\n// DEPRECATED\r\n    if ($.uiBackCompat !== false) {\r\n        // position option with array notation\r\n        // just override with old implementation\r\n        $.widget(\"ui.dialog\", $.ui.dialog, {\r\n            _position: function () {\r\n                var position = this.options.position,\r\n                    myAt = [],\r\n                    offset = [0, 0],\r\n                    isVisible;\r\n\r\n                if (position) {\r\n                    if (typeof position === \"string\" || (typeof position === \"object\" && \"0\" in position)) {\r\n                        myAt = position.split ? position.split(\" \") : [position[0], position[1]];\r\n                        if (myAt.length === 1) {\r\n                            myAt[1] = myAt[0];\r\n                        }\r\n\r\n                        $.each([\"left\", \"top\"], function (i, offsetPosition) {\r\n                            if (+myAt[i] === myAt[i]) {\r\n                                offset[i] = myAt[i];\r\n                                myAt[i] = offsetPosition;\r\n                            }\r\n                        });\r\n\r\n                        position = {\r\n                            my: myAt[0] + (offset[0] < 0 ? offset[0] : \"+\" + offset[0]) + \" \" +\r\n                                myAt[1] + (offset[1] < 0 ? offset[1] : \"+\" + offset[1]),\r\n                            at: myAt.join(\" \")\r\n                        };\r\n                    }\r\n\r\n                    position = $.extend({}, $.ui.dialog.prototype.options.position, position);\r\n                } else {\r\n                    position = $.ui.dialog.prototype.options.position;\r\n                }\r\n\r\n                // need to show the dialog to get the actual offset in the position plugin\r\n                isVisible = this.uiDialog.is(\":visible\");\r\n                if (!isVisible) {\r\n                    this.uiDialog.show();\r\n                }\r\n                this.uiDialog.position(position);\r\n                if (!isVisible) {\r\n                    this.uiDialog.hide();\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n});\r\n","jquery/ui-modules/draggable.js":"/*!\r\n * jQuery UI Draggable - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/draggable/\r\n *\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/core',\r\n    'jquery-ui-modules/mouse'\r\n], function ($, undefined) {\r\n\r\n    $.widget(\"ui.draggable\", $.ui.mouse, {\r\n        version: \"1.10.4\",\r\n        widgetEventPrefix: \"drag\",\r\n        options: {\r\n            addClasses: true,\r\n            appendTo: \"parent\",\r\n            axis: false,\r\n            connectToSortable: false,\r\n            containment: false,\r\n            cursor: \"auto\",\r\n            cursorAt: false,\r\n            grid: false,\r\n            handle: false,\r\n            helper: \"original\",\r\n            iframeFix: false,\r\n            opacity: false,\r\n            refreshPositions: false,\r\n            revert: false,\r\n            revertDuration: 500,\r\n            scope: \"default\",\r\n            scroll: true,\r\n            scrollSensitivity: 20,\r\n            scrollSpeed: 20,\r\n            snap: false,\r\n            snapMode: \"both\",\r\n            snapTolerance: 20,\r\n            stack: false,\r\n            zIndex: false,\r\n\r\n            // callbacks\r\n            drag: null,\r\n            start: null,\r\n            stop: null\r\n        },\r\n        _create: function () {\r\n\r\n            if (this.options.helper === \"original\" && !(/^(?:r|a|f)/).test(this.element.css(\"position\"))) {\r\n                this.element[0].style.position = \"relative\";\r\n            }\r\n            if (this.options.addClasses) {\r\n                this.element.addClass(\"ui-draggable\");\r\n            }\r\n            if (this.options.disabled) {\r\n                this.element.addClass(\"ui-draggable-disabled\");\r\n            }\r\n\r\n            this._mouseInit();\r\n\r\n        },\r\n\r\n        _destroy: function () {\r\n            this.element.removeClass(\"ui-draggable ui-draggable-dragging ui-draggable-disabled\");\r\n            this._mouseDestroy();\r\n        },\r\n\r\n        _mouseCapture: function (event) {\r\n\r\n            var o = this.options;\r\n\r\n            // among others, prevent a drag on a resizable-handle\r\n            if (this.helper || o.disabled || $(event.target).closest(\".ui-resizable-handle\").length > 0) {\r\n                return false;\r\n            }\r\n\r\n            //Quit if we're not on a valid handle\r\n            this.handle = this._getHandle(event);\r\n            if (!this.handle) {\r\n                return false;\r\n            }\r\n\r\n            $(o.iframeFix === true ? \"iframe\" : o.iframeFix).each(function () {\r\n                $(\"<div class='ui-draggable-iframeFix' style='background: #fff;'></div>\")\r\n                    .css({\r\n                        width: this.offsetWidth + \"px\", height: this.offsetHeight + \"px\",\r\n                        position: \"absolute\", opacity: \"0.001\", zIndex: 1000\r\n                    })\r\n                    .css($(this).offset())\r\n                    .appendTo(\"body\");\r\n            });\r\n\r\n            return true;\r\n\r\n        },\r\n\r\n        _mouseStart: function (event) {\r\n\r\n            var o = this.options;\r\n\r\n            //Create and append the visible helper\r\n            this.helper = this._createHelper(event);\r\n\r\n            this.helper.addClass(\"ui-draggable-dragging\");\r\n\r\n            //Cache the helper size\r\n            this._cacheHelperProportions();\r\n\r\n            //If ddmanager is used for droppables, set the global draggable\r\n            if ($.ui.ddmanager) {\r\n                $.ui.ddmanager.current = this;\r\n            }\r\n\r\n            /*\r\n             * - Position generation -\r\n             * This block generates everything position related - it's the core of draggables.\r\n             */\r\n\r\n            //Cache the margins of the original element\r\n            this._cacheMargins();\r\n\r\n            //Store the helper's css position\r\n            this.cssPosition = this.helper.css(\"position\");\r\n            this.scrollParent = this.helper.scrollParent();\r\n            this.offsetParent = this.helper.offsetParent();\r\n            this.offsetParentCssPosition = this.offsetParent.css(\"position\");\r\n\r\n            //The element's absolute position on the page minus margins\r\n            this.offset = this.positionAbs = this.element.offset();\r\n            this.offset = {\r\n                top: this.offset.top - this.margins.top,\r\n                left: this.offset.left - this.margins.left\r\n            };\r\n\r\n            //Reset scroll cache\r\n            this.offset.scroll = false;\r\n\r\n            $.extend(this.offset, {\r\n                click: { //Where the click happened, relative to the element\r\n                    left: event.pageX - this.offset.left,\r\n                    top: event.pageY - this.offset.top\r\n                },\r\n                parent: this._getParentOffset(),\r\n                relative: this._getRelativeOffset() //This is a relative to absolute position minus the actual position calculation - only used for relative positioned helper\r\n            });\r\n\r\n            //Generate the original position\r\n            this.originalPosition = this.position = this._generatePosition(event);\r\n            this.originalPageX = event.pageX;\r\n            this.originalPageY = event.pageY;\r\n\r\n            //Adjust the mouse offset relative to the helper if \"cursorAt\" is supplied\r\n            (o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt));\r\n\r\n            //Set a containment if given in the options\r\n            this._setContainment();\r\n\r\n            //Trigger event + callbacks\r\n            if (this._trigger(\"start\", event) === false) {\r\n                this._clear();\r\n                return false;\r\n            }\r\n\r\n            //Recache the helper size\r\n            this._cacheHelperProportions();\r\n\r\n            //Prepare the droppable offsets\r\n            if ($.ui.ddmanager && !o.dropBehaviour) {\r\n                $.ui.ddmanager.prepareOffsets(this, event);\r\n            }\r\n\r\n\r\n            this._mouseDrag(event, true); //Execute the drag once - this causes the helper not to be visible before getting its correct position\r\n\r\n            //If the ddmanager is used for droppables, inform the manager that dragging has started (see #5003)\r\n            if ($.ui.ddmanager) {\r\n                $.ui.ddmanager.dragStart(this, event);\r\n            }\r\n\r\n            return true;\r\n        },\r\n\r\n        _mouseDrag: function (event, noPropagation) {\r\n            // reset any necessary cached properties (see #5009)\r\n            if (this.offsetParentCssPosition === \"fixed\") {\r\n                this.offset.parent = this._getParentOffset();\r\n            }\r\n\r\n            //Compute the helpers position\r\n            this.position = this._generatePosition(event);\r\n            this.positionAbs = this._convertPositionTo(\"absolute\");\r\n\r\n            //Call plugins and callbacks and use the resulting position if something is returned\r\n            if (!noPropagation) {\r\n                var ui = this._uiHash();\r\n                if (this._trigger(\"drag\", event, ui) === false) {\r\n                    this._mouseUp({});\r\n                    return false;\r\n                }\r\n                this.position = ui.position;\r\n            }\r\n\r\n            if (!this.options.axis || this.options.axis !== \"y\") {\r\n                this.helper[0].style.left = this.position.left + \"px\";\r\n            }\r\n            if (!this.options.axis || this.options.axis !== \"x\") {\r\n                this.helper[0].style.top = this.position.top + \"px\";\r\n            }\r\n            if ($.ui.ddmanager) {\r\n                $.ui.ddmanager.drag(this, event);\r\n            }\r\n\r\n            return false;\r\n        },\r\n\r\n        _mouseStop: function (event) {\r\n\r\n            //If we are using droppables, inform the manager about the drop\r\n            var that = this,\r\n                dropped = false;\r\n            if ($.ui.ddmanager && !this.options.dropBehaviour) {\r\n                dropped = $.ui.ddmanager.drop(this, event);\r\n            }\r\n\r\n            //if a drop comes from outside (a sortable)\r\n            if (this.dropped) {\r\n                dropped = this.dropped;\r\n                this.dropped = false;\r\n            }\r\n\r\n            //if the original element is no longer in the DOM don't bother to continue (see #8269)\r\n            if (this.options.helper === \"original\" && !$.contains(this.element[0].ownerDocument, this.element[0])) {\r\n                return false;\r\n            }\r\n\r\n            if ((this.options.revert === \"invalid\" && !dropped) || (this.options.revert === \"valid\" && dropped) || this.options.revert === true || ($.isFunction(this.options.revert) && this.options.revert.call(this.element, dropped))) {\r\n                $(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function () {\r\n                    if (that._trigger(\"stop\", event) !== false) {\r\n                        that._clear();\r\n                    }\r\n                });\r\n            } else {\r\n                if (this._trigger(\"stop\", event) !== false) {\r\n                    this._clear();\r\n                }\r\n            }\r\n\r\n            return false;\r\n        },\r\n\r\n        _mouseUp: function (event) {\r\n            //Remove frame helpers\r\n            $(\"div.ui-draggable-iframeFix\").each(function () {\r\n                this.parentNode.removeChild(this);\r\n            });\r\n\r\n            //If the ddmanager is used for droppables, inform the manager that dragging has stopped (see #5003)\r\n            if ($.ui.ddmanager) {\r\n                $.ui.ddmanager.dragStop(this, event);\r\n            }\r\n\r\n            return $.ui.mouse.prototype._mouseUp.call(this, event);\r\n        },\r\n\r\n        cancel: function () {\r\n\r\n            if (this.helper.is(\".ui-draggable-dragging\")) {\r\n                this._mouseUp({});\r\n            } else {\r\n                this._clear();\r\n            }\r\n\r\n            return this;\r\n\r\n        },\r\n\r\n        _getHandle: function (event) {\r\n            return this.options.handle ?\r\n                !!$(event.target).closest(this.element.find(this.options.handle)).length :\r\n                true;\r\n        },\r\n\r\n        _createHelper: function (event) {\r\n\r\n            var o = this.options,\r\n                helper = $.isFunction(o.helper) ? $(o.helper.apply(this.element[0], [event])) : (o.helper === \"clone\" ? this.element.clone().removeAttr(\"id\") : this.element);\r\n\r\n            if (!helper.parents(\"body\").length) {\r\n                helper.appendTo((o.appendTo === \"parent\" ? this.element[0].parentNode : o.appendTo));\r\n            }\r\n\r\n            if (helper[0] !== this.element[0] && !(/(fixed|absolute)/).test(helper.css(\"position\"))) {\r\n                helper.css(\"position\", \"absolute\");\r\n            }\r\n\r\n            return helper;\r\n\r\n        },\r\n\r\n        _adjustOffsetFromHelper: function (obj) {\r\n            if (typeof obj === \"string\") {\r\n                obj = obj.split(\" \");\r\n            }\r\n            if ($.isArray(obj)) {\r\n                obj = {left: +obj[0], top: +obj[1] || 0};\r\n            }\r\n            if (\"left\" in obj) {\r\n                this.offset.click.left = obj.left + this.margins.left;\r\n            }\r\n            if (\"right\" in obj) {\r\n                this.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;\r\n            }\r\n            if (\"top\" in obj) {\r\n                this.offset.click.top = obj.top + this.margins.top;\r\n            }\r\n            if (\"bottom\" in obj) {\r\n                this.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;\r\n            }\r\n        },\r\n\r\n        _getParentOffset: function () {\r\n\r\n            //Get the offsetParent and cache its position\r\n            var po = this.offsetParent.offset();\r\n\r\n            // This is a special case where we need to modify a offset calculated on start, since the following happened:\r\n            // 1. The position of the helper is absolute, so it's position is calculated based on the next positioned parent\r\n            // 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't the document, which means that\r\n            //    the scroll is included in the initial calculation of the offset of the parent, and never recalculated upon drag\r\n            if (this.cssPosition === \"absolute\" && this.scrollParent[0] !== document && $.contains(this.scrollParent[0], this.offsetParent[0])) {\r\n                po.left += this.scrollParent.scrollLeft();\r\n                po.top += this.scrollParent.scrollTop();\r\n            }\r\n\r\n            //This needs to be actually done for all browsers, since pageX/pageY includes this information\r\n            //Ugly IE fix\r\n            if ((this.offsetParent[0] === document.body) ||\r\n                (this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() === \"html\" && $.ui.ie)) {\r\n                po = {top: 0, left: 0};\r\n            }\r\n\r\n            return {\r\n                top: po.top + (parseInt(this.offsetParent.css(\"borderTopWidth\"), 10) || 0),\r\n                left: po.left + (parseInt(this.offsetParent.css(\"borderLeftWidth\"), 10) || 0)\r\n            };\r\n\r\n        },\r\n\r\n        _getRelativeOffset: function () {\r\n\r\n            if (this.cssPosition === \"relative\") {\r\n                var p = this.element.position();\r\n                return {\r\n                    top: p.top - (parseInt(this.helper.css(\"top\"), 10) || 0) + this.scrollParent.scrollTop(),\r\n                    left: p.left - (parseInt(this.helper.css(\"left\"), 10) || 0) + this.scrollParent.scrollLeft()\r\n                };\r\n            } else {\r\n                return {top: 0, left: 0};\r\n            }\r\n\r\n        },\r\n\r\n        _cacheMargins: function () {\r\n            this.margins = {\r\n                left: (parseInt(this.element.css(\"marginLeft\"), 10) || 0),\r\n                top: (parseInt(this.element.css(\"marginTop\"), 10) || 0),\r\n                right: (parseInt(this.element.css(\"marginRight\"), 10) || 0),\r\n                bottom: (parseInt(this.element.css(\"marginBottom\"), 10) || 0)\r\n            };\r\n        },\r\n\r\n        _cacheHelperProportions: function () {\r\n            this.helperProportions = {\r\n                width: this.helper.outerWidth(),\r\n                height: this.helper.outerHeight()\r\n            };\r\n        },\r\n\r\n        _setContainment: function () {\r\n\r\n            var over, c, ce,\r\n                o = this.options;\r\n\r\n            if (!o.containment) {\r\n                this.containment = null;\r\n                return;\r\n            }\r\n\r\n            if (o.containment === \"window\") {\r\n                this.containment = [\r\n                    $(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left,\r\n                    $(window).scrollTop() - this.offset.relative.top - this.offset.parent.top,\r\n                    $(window).scrollLeft() + $(window).width() - this.helperProportions.width - this.margins.left,\r\n                    $(window).scrollTop() + ($(window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top\r\n                ];\r\n                return;\r\n            }\r\n\r\n            if (o.containment === \"document\") {\r\n                this.containment = [\r\n                    0,\r\n                    0,\r\n                    $(document).width() - this.helperProportions.width - this.margins.left,\r\n                    ($(document).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top\r\n                ];\r\n                return;\r\n            }\r\n\r\n            if (o.containment.constructor === Array) {\r\n                this.containment = o.containment;\r\n                return;\r\n            }\r\n\r\n            if (o.containment === \"parent\") {\r\n                o.containment = this.helper[0].parentNode;\r\n            }\r\n\r\n            c = $(o.containment);\r\n            ce = c[0];\r\n\r\n            if (!ce) {\r\n                return;\r\n            }\r\n\r\n            over = c.css(\"overflow\") !== \"hidden\";\r\n\r\n            this.containment = [\r\n                (parseInt(c.css(\"borderLeftWidth\"), 10) || 0) + (parseInt(c.css(\"paddingLeft\"), 10) || 0),\r\n                (parseInt(c.css(\"borderTopWidth\"), 10) || 0) + (parseInt(c.css(\"paddingTop\"), 10) || 0),\r\n                (over ? Math.max(ce.scrollWidth, ce.offsetWidth) : ce.offsetWidth) - (parseInt(c.css(\"borderRightWidth\"), 10) || 0) - (parseInt(c.css(\"paddingRight\"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right,\r\n                (over ? Math.max(ce.scrollHeight, ce.offsetHeight) : ce.offsetHeight) - (parseInt(c.css(\"borderBottomWidth\"), 10) || 0) - (parseInt(c.css(\"paddingBottom\"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom\r\n            ];\r\n            this.relative_container = c;\r\n        },\r\n\r\n        _convertPositionTo: function (d, pos) {\r\n\r\n            if (!pos) {\r\n                pos = this.position;\r\n            }\r\n\r\n            var mod = d === \"absolute\" ? 1 : -1,\r\n                scroll = this.cssPosition === \"absolute\" && !(this.scrollParent[0] !== document && $.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent;\r\n\r\n            //Cache the scroll\r\n            if (!this.offset.scroll) {\r\n                this.offset.scroll = {top: scroll.scrollTop(), left: scroll.scrollLeft()};\r\n            }\r\n\r\n            return {\r\n                top: (\r\n                    pos.top +\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\r\n                    this.offset.relative.top * mod +\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\r\n                    this.offset.parent.top * mod -\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\r\n                    ((this.cssPosition === \"fixed\" ? -this.scrollParent.scrollTop() : this.offset.scroll.top) * mod)\r\n                ),\r\n                left: (\r\n                    pos.left +\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\r\n                    this.offset.relative.left * mod +\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\r\n                    this.offset.parent.left * mod -\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\r\n                    ((this.cssPosition === \"fixed\" ? -this.scrollParent.scrollLeft() : this.offset.scroll.left) * mod)\r\n                )\r\n            };\r\n\r\n        },\r\n\r\n        _generatePosition: function (event) {\r\n\r\n            var containment, co, top, left,\r\n                o = this.options,\r\n                scroll = this.cssPosition === \"absolute\" && !(this.scrollParent[0] !== document && $.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent,\r\n                pageX = event.pageX,\r\n                pageY = event.pageY;\r\n\r\n            //Cache the scroll\r\n            if (!this.offset.scroll) {\r\n                this.offset.scroll = {top: scroll.scrollTop(), left: scroll.scrollLeft()};\r\n            }\r\n\r\n            /*\r\n             * - Position constraining -\r\n             * Constrain the position to a mix of grid, containment.\r\n             */\r\n\r\n            // If we are not dragging yet, we won't check for options\r\n            if (this.originalPosition) {\r\n                if (this.containment) {\r\n                    if (this.relative_container) {\r\n                        co = this.relative_container.offset();\r\n                        containment = [\r\n                            this.containment[0] + co.left,\r\n                            this.containment[1] + co.top,\r\n                            this.containment[2] + co.left,\r\n                            this.containment[3] + co.top\r\n                        ];\r\n                    } else {\r\n                        containment = this.containment;\r\n                    }\r\n\r\n                    if (event.pageX - this.offset.click.left < containment[0]) {\r\n                        pageX = containment[0] + this.offset.click.left;\r\n                    }\r\n                    if (event.pageY - this.offset.click.top < containment[1]) {\r\n                        pageY = containment[1] + this.offset.click.top;\r\n                    }\r\n                    if (event.pageX - this.offset.click.left > containment[2]) {\r\n                        pageX = containment[2] + this.offset.click.left;\r\n                    }\r\n                    if (event.pageY - this.offset.click.top > containment[3]) {\r\n                        pageY = containment[3] + this.offset.click.top;\r\n                    }\r\n                }\r\n\r\n                if (o.grid) {\r\n                    //Check for grid elements set to 0 to prevent divide by 0 error causing invalid argument errors in IE (see ticket #6950)\r\n                    top = o.grid[1] ? this.originalPageY + Math.round((pageY - this.originalPageY) / o.grid[1]) * o.grid[1] : this.originalPageY;\r\n                    pageY = containment ? ((top - this.offset.click.top >= containment[1] || top - this.offset.click.top > containment[3]) ? top : ((top - this.offset.click.top >= containment[1]) ? top - o.grid[1] : top + o.grid[1])) : top;\r\n\r\n                    left = o.grid[0] ? this.originalPageX + Math.round((pageX - this.originalPageX) / o.grid[0]) * o.grid[0] : this.originalPageX;\r\n                    pageX = containment ? ((left - this.offset.click.left >= containment[0] || left - this.offset.click.left > containment[2]) ? left : ((left - this.offset.click.left >= containment[0]) ? left - o.grid[0] : left + o.grid[0])) : left;\r\n                }\r\n\r\n            }\r\n\r\n            return {\r\n                top: (\r\n                    pageY -\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\r\n                    this.offset.click.top -\t\t\t\t\t\t\t\t\t\t\t\t// Click offset (relative to the element)\r\n                    this.offset.relative.top -\t\t\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\r\n                    this.offset.parent.top +\t\t\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\r\n                    (this.cssPosition === \"fixed\" ? -this.scrollParent.scrollTop() : this.offset.scroll.top)\r\n                ),\r\n                left: (\r\n                    pageX -\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\r\n                    this.offset.click.left -\t\t\t\t\t\t\t\t\t\t\t\t// Click offset (relative to the element)\r\n                    this.offset.relative.left -\t\t\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\r\n                    this.offset.parent.left +\t\t\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\r\n                    (this.cssPosition === \"fixed\" ? -this.scrollParent.scrollLeft() : this.offset.scroll.left)\r\n                )\r\n            };\r\n\r\n        },\r\n\r\n        _clear: function () {\r\n            this.helper.removeClass(\"ui-draggable-dragging\");\r\n            if (this.helper[0] !== this.element[0] && !this.cancelHelperRemoval) {\r\n                this.helper.remove();\r\n            }\r\n            this.helper = null;\r\n            this.cancelHelperRemoval = false;\r\n        },\r\n\r\n        // From now on bulk stuff - mainly helpers\r\n\r\n        _trigger: function (type, event, ui) {\r\n            ui = ui || this._uiHash();\r\n            $.ui.plugin.call(this, type, [event, ui]);\r\n            //The absolute position has to be recalculated after plugins\r\n            if (type === \"drag\") {\r\n                this.positionAbs = this._convertPositionTo(\"absolute\");\r\n            }\r\n            return $.Widget.prototype._trigger.call(this, type, event, ui);\r\n        },\r\n\r\n        plugins: {},\r\n\r\n        _uiHash: function () {\r\n            return {\r\n                helper: this.helper,\r\n                position: this.position,\r\n                originalPosition: this.originalPosition,\r\n                offset: this.positionAbs\r\n            };\r\n        }\r\n\r\n    });\r\n\r\n    $.ui.plugin.add(\"draggable\", \"connectToSortable\", {\r\n        start: function (event, ui) {\r\n\r\n            var inst = $(this).data(\"ui-draggable\"), o = inst.options,\r\n                uiSortable = $.extend({}, ui, {item: inst.element});\r\n            inst.sortables = [];\r\n            $(o.connectToSortable).each(function () {\r\n                var sortable = $.data(this, \"ui-sortable\");\r\n                if (sortable && !sortable.options.disabled) {\r\n                    inst.sortables.push({\r\n                        instance: sortable,\r\n                        shouldRevert: sortable.options.revert\r\n                    });\r\n                    sortable.refreshPositions();\t// Call the sortable's refreshPositions at drag start to refresh the containerCache since the sortable container cache is used in drag and needs to be up to date (this will ensure it's initialised as well as being kept in step with any changes that might have happened on the page).\r\n                    sortable._trigger(\"activate\", event, uiSortable);\r\n                }\r\n            });\r\n\r\n        },\r\n        stop: function (event, ui) {\r\n\r\n            //If we are still over the sortable, we fake the stop event of the sortable, but also remove helper\r\n            var inst = $(this).data(\"ui-draggable\"),\r\n                uiSortable = $.extend({}, ui, {item: inst.element});\r\n\r\n            $.each(inst.sortables, function () {\r\n                if (this.instance.isOver) {\r\n\r\n                    this.instance.isOver = 0;\r\n\r\n                    inst.cancelHelperRemoval = true; //Don't remove the helper in the draggable instance\r\n                    this.instance.cancelHelperRemoval = false; //Remove it in the sortable instance (so sortable plugins like revert still work)\r\n\r\n                    //The sortable revert is supported, and we have to set a temporary dropped variable on the draggable to support revert: \"valid/invalid\"\r\n                    if (this.shouldRevert) {\r\n                        this.instance.options.revert = this.shouldRevert;\r\n                    }\r\n\r\n                    //Trigger the stop of the sortable\r\n                    this.instance._mouseStop(event);\r\n\r\n                    this.instance.options.helper = this.instance.options._helper;\r\n\r\n                    //If the helper has been the original item, restore properties in the sortable\r\n                    if (inst.options.helper === \"original\") {\r\n                        this.instance.currentItem.css({top: \"auto\", left: \"auto\"});\r\n                    }\r\n\r\n                } else {\r\n                    this.instance.cancelHelperRemoval = false; //Remove the helper in the sortable instance\r\n                    this.instance._trigger(\"deactivate\", event, uiSortable);\r\n                }\r\n\r\n            });\r\n\r\n        },\r\n        drag: function (event, ui) {\r\n\r\n            var inst = $(this).data(\"ui-draggable\"), that = this;\r\n\r\n            $.each(inst.sortables, function () {\r\n\r\n                var innermostIntersecting = false,\r\n                    thisSortable = this;\r\n\r\n                //Copy over some variables to allow calling the sortable's native _intersectsWith\r\n                this.instance.positionAbs = inst.positionAbs;\r\n                this.instance.helperProportions = inst.helperProportions;\r\n                this.instance.offset.click = inst.offset.click;\r\n\r\n                if (this.instance._intersectsWith(this.instance.containerCache)) {\r\n                    innermostIntersecting = true;\r\n                    $.each(inst.sortables, function () {\r\n                        this.instance.positionAbs = inst.positionAbs;\r\n                        this.instance.helperProportions = inst.helperProportions;\r\n                        this.instance.offset.click = inst.offset.click;\r\n                        if (this !== thisSortable &&\r\n                            this.instance._intersectsWith(this.instance.containerCache) &&\r\n                            $.contains(thisSortable.instance.element[0], this.instance.element[0])\r\n                        ) {\r\n                            innermostIntersecting = false;\r\n                        }\r\n                        return innermostIntersecting;\r\n                    });\r\n                }\r\n\r\n\r\n                if (innermostIntersecting) {\r\n                    //If it intersects, we use a little isOver variable and set it once, so our move-in stuff gets fired only once\r\n                    if (!this.instance.isOver) {\r\n\r\n                        this.instance.isOver = 1;\r\n                        //Now we fake the start of dragging for the sortable instance,\r\n                        //by cloning the list group item, appending it to the sortable and using it as inst.currentItem\r\n                        //We can then fire the start event of the sortable with our passed browser event, and our own helper (so it doesn't create a new one)\r\n                        this.instance.currentItem = $(that).clone().removeAttr(\"id\").appendTo(this.instance.element).data(\"ui-sortable-item\", true);\r\n                        this.instance.options._helper = this.instance.options.helper; //Store helper option to later restore it\r\n                        this.instance.options.helper = function () {\r\n                            return ui.helper[0];\r\n                        };\r\n\r\n                        event.target = this.instance.currentItem[0];\r\n                        this.instance._mouseCapture(event, true);\r\n                        this.instance._mouseStart(event, true, true);\r\n\r\n                        //Because the browser event is way off the new appended portlet, we modify a couple of variables to reflect the changes\r\n                        this.instance.offset.click.top = inst.offset.click.top;\r\n                        this.instance.offset.click.left = inst.offset.click.left;\r\n                        this.instance.offset.parent.left -= inst.offset.parent.left - this.instance.offset.parent.left;\r\n                        this.instance.offset.parent.top -= inst.offset.parent.top - this.instance.offset.parent.top;\r\n\r\n                        inst._trigger(\"toSortable\", event);\r\n                        inst.dropped = this.instance.element; //draggable revert needs that\r\n                        //hack so receive/update callbacks work (mostly)\r\n                        inst.currentItem = inst.element;\r\n                        this.instance.fromOutside = inst;\r\n\r\n                    }\r\n\r\n                    //Provided we did all the previous steps, we can fire the drag event of the sortable on every draggable drag, when it intersects with the sortable\r\n                    if (this.instance.currentItem) {\r\n                        this.instance._mouseDrag(event);\r\n                    }\r\n\r\n                } else {\r\n\r\n                    //If it doesn't intersect with the sortable, and it intersected before,\r\n                    //we fake the drag stop of the sortable, but make sure it doesn't remove the helper by using cancelHelperRemoval\r\n                    if (this.instance.isOver) {\r\n\r\n                        this.instance.isOver = 0;\r\n                        this.instance.cancelHelperRemoval = true;\r\n\r\n                        //Prevent reverting on this forced stop\r\n                        this.instance.options.revert = false;\r\n\r\n                        // The out event needs to be triggered independently\r\n                        this.instance._trigger(\"out\", event, this.instance._uiHash(this.instance));\r\n\r\n                        this.instance._mouseStop(event, true);\r\n                        this.instance.options.helper = this.instance.options._helper;\r\n\r\n                        //Now we remove our currentItem, the list group clone again, and the placeholder, and animate the helper back to it's original size\r\n                        this.instance.currentItem.remove();\r\n                        if (this.instance.placeholder) {\r\n                            this.instance.placeholder.remove();\r\n                        }\r\n\r\n                        inst._trigger(\"fromSortable\", event);\r\n                        inst.dropped = false; //draggable revert needs that\r\n                    }\r\n\r\n                }\r\n\r\n            });\r\n\r\n        }\r\n    });\r\n\r\n    $.ui.plugin.add(\"draggable\", \"cursor\", {\r\n        start: function () {\r\n            var t = $(\"body\"), o = $(this).data(\"ui-draggable\").options;\r\n            if (t.css(\"cursor\")) {\r\n                o._cursor = t.css(\"cursor\");\r\n            }\r\n            t.css(\"cursor\", o.cursor);\r\n        },\r\n        stop: function () {\r\n            var o = $(this).data(\"ui-draggable\").options;\r\n            if (o._cursor) {\r\n                $(\"body\").css(\"cursor\", o._cursor);\r\n            }\r\n        }\r\n    });\r\n\r\n    $.ui.plugin.add(\"draggable\", \"opacity\", {\r\n        start: function (event, ui) {\r\n            var t = $(ui.helper), o = $(this).data(\"ui-draggable\").options;\r\n            if (t.css(\"opacity\")) {\r\n                o._opacity = t.css(\"opacity\");\r\n            }\r\n            t.css(\"opacity\", o.opacity);\r\n        },\r\n        stop: function (event, ui) {\r\n            var o = $(this).data(\"ui-draggable\").options;\r\n            if (o._opacity) {\r\n                $(ui.helper).css(\"opacity\", o._opacity);\r\n            }\r\n        }\r\n    });\r\n\r\n    $.ui.plugin.add(\"draggable\", \"scroll\", {\r\n        start: function () {\r\n            var i = $(this).data(\"ui-draggable\");\r\n            if (i.scrollParent[0] !== document && i.scrollParent[0].tagName !== \"HTML\") {\r\n                i.overflowOffset = i.scrollParent.offset();\r\n            }\r\n        },\r\n        drag: function (event) {\r\n\r\n            var i = $(this).data(\"ui-draggable\"), o = i.options, scrolled = false;\r\n\r\n            if (i.scrollParent[0] !== document && i.scrollParent[0].tagName !== \"HTML\") {\r\n\r\n                if (!o.axis || o.axis !== \"x\") {\r\n                    if ((i.overflowOffset.top + i.scrollParent[0].offsetHeight) - event.pageY < o.scrollSensitivity) {\r\n                        i.scrollParent[0].scrollTop = scrolled = i.scrollParent[0].scrollTop + o.scrollSpeed;\r\n                    } else if (event.pageY - i.overflowOffset.top < o.scrollSensitivity) {\r\n                        i.scrollParent[0].scrollTop = scrolled = i.scrollParent[0].scrollTop - o.scrollSpeed;\r\n                    }\r\n                }\r\n\r\n                if (!o.axis || o.axis !== \"y\") {\r\n                    if ((i.overflowOffset.left + i.scrollParent[0].offsetWidth) - event.pageX < o.scrollSensitivity) {\r\n                        i.scrollParent[0].scrollLeft = scrolled = i.scrollParent[0].scrollLeft + o.scrollSpeed;\r\n                    } else if (event.pageX - i.overflowOffset.left < o.scrollSensitivity) {\r\n                        i.scrollParent[0].scrollLeft = scrolled = i.scrollParent[0].scrollLeft - o.scrollSpeed;\r\n                    }\r\n                }\r\n\r\n            } else {\r\n\r\n                if (!o.axis || o.axis !== \"x\") {\r\n                    if (event.pageY - $(document).scrollTop() < o.scrollSensitivity) {\r\n                        scrolled = $(document).scrollTop($(document).scrollTop() - o.scrollSpeed);\r\n                    } else if ($(window).height() - (event.pageY - $(document).scrollTop()) < o.scrollSensitivity) {\r\n                        scrolled = $(document).scrollTop($(document).scrollTop() + o.scrollSpeed);\r\n                    }\r\n                }\r\n\r\n                if (!o.axis || o.axis !== \"y\") {\r\n                    if (event.pageX - $(document).scrollLeft() < o.scrollSensitivity) {\r\n                        scrolled = $(document).scrollLeft($(document).scrollLeft() - o.scrollSpeed);\r\n                    } else if ($(window).width() - (event.pageX - $(document).scrollLeft()) < o.scrollSensitivity) {\r\n                        scrolled = $(document).scrollLeft($(document).scrollLeft() + o.scrollSpeed);\r\n                    }\r\n                }\r\n\r\n            }\r\n\r\n            if (scrolled !== false && $.ui.ddmanager && !o.dropBehaviour) {\r\n                $.ui.ddmanager.prepareOffsets(i, event);\r\n            }\r\n\r\n        }\r\n    });\r\n\r\n    $.ui.plugin.add(\"draggable\", \"snap\", {\r\n        start: function () {\r\n\r\n            var i = $(this).data(\"ui-draggable\"),\r\n                o = i.options;\r\n\r\n            i.snapElements = [];\r\n\r\n            $(o.snap.constructor !== String ? (o.snap.items || \":data(ui-draggable)\") : o.snap).each(function () {\r\n                var $t = $(this),\r\n                    $o = $t.offset();\r\n                if (this !== i.element[0]) {\r\n                    i.snapElements.push({\r\n                        item: this,\r\n                        width: $t.outerWidth(), height: $t.outerHeight(),\r\n                        top: $o.top, left: $o.left\r\n                    });\r\n                }\r\n            });\r\n\r\n        },\r\n        drag: function (event, ui) {\r\n\r\n            var ts, bs, ls, rs, l, r, t, b, i, first,\r\n                inst = $(this).data(\"ui-draggable\"),\r\n                o = inst.options,\r\n                d = o.snapTolerance,\r\n                x1 = ui.offset.left, x2 = x1 + inst.helperProportions.width,\r\n                y1 = ui.offset.top, y2 = y1 + inst.helperProportions.height;\r\n\r\n            for (i = inst.snapElements.length - 1; i >= 0; i--) {\r\n\r\n                l = inst.snapElements[i].left;\r\n                r = l + inst.snapElements[i].width;\r\n                t = inst.snapElements[i].top;\r\n                b = t + inst.snapElements[i].height;\r\n\r\n                if (x2 < l - d || x1 > r + d || y2 < t - d || y1 > b + d || !$.contains(inst.snapElements[i].item.ownerDocument, inst.snapElements[i].item)) {\r\n                    if (inst.snapElements[i].snapping) {\r\n                        (inst.options.snap.release && inst.options.snap.release.call(inst.element, event, $.extend(inst._uiHash(), {snapItem: inst.snapElements[i].item})));\r\n                    }\r\n                    inst.snapElements[i].snapping = false;\r\n                    continue;\r\n                }\r\n\r\n                if (o.snapMode !== \"inner\") {\r\n                    ts = Math.abs(t - y2) <= d;\r\n                    bs = Math.abs(b - y1) <= d;\r\n                    ls = Math.abs(l - x2) <= d;\r\n                    rs = Math.abs(r - x1) <= d;\r\n                    if (ts) {\r\n                        ui.position.top = inst._convertPositionTo(\"relative\", {\r\n                            top: t - inst.helperProportions.height,\r\n                            left: 0\r\n                        }).top - inst.margins.top;\r\n                    }\r\n                    if (bs) {\r\n                        ui.position.top = inst._convertPositionTo(\"relative\", {top: b, left: 0}).top - inst.margins.top;\r\n                    }\r\n                    if (ls) {\r\n                        ui.position.left = inst._convertPositionTo(\"relative\", {\r\n                            top: 0,\r\n                            left: l - inst.helperProportions.width\r\n                        }).left - inst.margins.left;\r\n                    }\r\n                    if (rs) {\r\n                        ui.position.left = inst._convertPositionTo(\"relative\", {\r\n                            top: 0,\r\n                            left: r\r\n                        }).left - inst.margins.left;\r\n                    }\r\n                }\r\n\r\n                first = (ts || bs || ls || rs);\r\n\r\n                if (o.snapMode !== \"outer\") {\r\n                    ts = Math.abs(t - y1) <= d;\r\n                    bs = Math.abs(b - y2) <= d;\r\n                    ls = Math.abs(l - x1) <= d;\r\n                    rs = Math.abs(r - x2) <= d;\r\n                    if (ts) {\r\n                        ui.position.top = inst._convertPositionTo(\"relative\", {top: t, left: 0}).top - inst.margins.top;\r\n                    }\r\n                    if (bs) {\r\n                        ui.position.top = inst._convertPositionTo(\"relative\", {\r\n                            top: b - inst.helperProportions.height,\r\n                            left: 0\r\n                        }).top - inst.margins.top;\r\n                    }\r\n                    if (ls) {\r\n                        ui.position.left = inst._convertPositionTo(\"relative\", {\r\n                            top: 0,\r\n                            left: l\r\n                        }).left - inst.margins.left;\r\n                    }\r\n                    if (rs) {\r\n                        ui.position.left = inst._convertPositionTo(\"relative\", {\r\n                            top: 0,\r\n                            left: r - inst.helperProportions.width\r\n                        }).left - inst.margins.left;\r\n                    }\r\n                }\r\n\r\n                if (!inst.snapElements[i].snapping && (ts || bs || ls || rs || first)) {\r\n                    (inst.options.snap.snap && inst.options.snap.snap.call(inst.element, event, $.extend(inst._uiHash(), {snapItem: inst.snapElements[i].item})));\r\n                }\r\n                inst.snapElements[i].snapping = (ts || bs || ls || rs || first);\r\n\r\n            }\r\n\r\n        }\r\n    });\r\n\r\n    $.ui.plugin.add(\"draggable\", \"stack\", {\r\n        start: function () {\r\n            var min,\r\n                o = this.data(\"ui-draggable\").options,\r\n                group = $.makeArray($(o.stack)).sort(function (a, b) {\r\n                    return (parseInt($(a).css(\"zIndex\"), 10) || 0) - (parseInt($(b).css(\"zIndex\"), 10) || 0);\r\n                });\r\n\r\n            if (!group.length) {\r\n                return;\r\n            }\r\n\r\n            min = parseInt($(group[0]).css(\"zIndex\"), 10) || 0;\r\n            $(group).each(function (i) {\r\n                $(this).css(\"zIndex\", min + i);\r\n            });\r\n            this.css(\"zIndex\", (min + group.length));\r\n        }\r\n    });\r\n\r\n    $.ui.plugin.add(\"draggable\", \"zIndex\", {\r\n        start: function (event, ui) {\r\n            var t = $(ui.helper), o = $(this).data(\"ui-draggable\").options;\r\n            if (t.css(\"zIndex\")) {\r\n                o._zIndex = t.css(\"zIndex\");\r\n            }\r\n            t.css(\"zIndex\", o.zIndex);\r\n        },\r\n        stop: function (event, ui) {\r\n            var o = $(this).data(\"ui-draggable\").options;\r\n            if (o._zIndex) {\r\n                $(ui.helper).css(\"zIndex\", o._zIndex);\r\n            }\r\n        }\r\n    });\r\n\r\n});\r\n","jquery/ui-modules/droppable.js":"/*!\r\n * jQuery UI Droppable - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/droppable/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/draggable'\r\n], function ($, undefined) {\r\n\r\n    function isOverAxis(x, reference, size) {\r\n        return (x > reference) && (x < (reference + size));\r\n    }\r\n\r\n    $.widget(\"ui.droppable\", {\r\n        version: \"1.10.4\",\r\n        widgetEventPrefix: \"drop\",\r\n        options: {\r\n            accept: \"*\",\r\n            activeClass: false,\r\n            addClasses: true,\r\n            greedy: false,\r\n            hoverClass: false,\r\n            scope: \"default\",\r\n            tolerance: \"intersect\",\r\n\r\n            // callbacks\r\n            activate: null,\r\n            deactivate: null,\r\n            drop: null,\r\n            out: null,\r\n            over: null\r\n        },\r\n        _create: function () {\r\n\r\n            var proportions,\r\n                o = this.options,\r\n                accept = o.accept;\r\n\r\n            this.isover = false;\r\n            this.isout = true;\r\n\r\n            this.accept = $.isFunction(accept) ? accept : function (d) {\r\n                return d.is(accept);\r\n            };\r\n\r\n            this.proportions = function ( /* valueToWrite */) {\r\n                if (arguments.length) {\r\n                    // Store the droppable's proportions\r\n                    proportions = arguments[0];\r\n                } else {\r\n                    // Retrieve or derive the droppable's proportions\r\n                    return proportions ?\r\n                        proportions :\r\n                        proportions = {\r\n                            width: this.element[0].offsetWidth,\r\n                            height: this.element[0].offsetHeight\r\n                        };\r\n                }\r\n            };\r\n\r\n            // Add the reference and positions to the manager\r\n            $.ui.ddmanager.droppables[o.scope] = $.ui.ddmanager.droppables[o.scope] || [];\r\n            $.ui.ddmanager.droppables[o.scope].push(this);\r\n\r\n            (o.addClasses && this.element.addClass(\"ui-droppable\"));\r\n\r\n        },\r\n\r\n        _destroy: function () {\r\n            var i = 0,\r\n                drop = $.ui.ddmanager.droppables[this.options.scope];\r\n\r\n            for (; i < drop.length; i++) {\r\n                if (drop[i] === this) {\r\n                    drop.splice(i, 1);\r\n                }\r\n            }\r\n\r\n            this.element.removeClass(\"ui-droppable ui-droppable-disabled\");\r\n        },\r\n\r\n        _setOption: function (key, value) {\r\n\r\n            if (key === \"accept\") {\r\n                this.accept = $.isFunction(value) ? value : function (d) {\r\n                    return d.is(value);\r\n                };\r\n            }\r\n            $.Widget.prototype._setOption.apply(this, arguments);\r\n        },\r\n\r\n        _activate: function (event) {\r\n            var draggable = $.ui.ddmanager.current;\r\n            if (this.options.activeClass) {\r\n                this.element.addClass(this.options.activeClass);\r\n            }\r\n            if (draggable) {\r\n                this._trigger(\"activate\", event, this.ui(draggable));\r\n            }\r\n        },\r\n\r\n        _deactivate: function (event) {\r\n            var draggable = $.ui.ddmanager.current;\r\n            if (this.options.activeClass) {\r\n                this.element.removeClass(this.options.activeClass);\r\n            }\r\n            if (draggable) {\r\n                this._trigger(\"deactivate\", event, this.ui(draggable));\r\n            }\r\n        },\r\n\r\n        _over: function (event) {\r\n\r\n            var draggable = $.ui.ddmanager.current;\r\n\r\n            // Bail if draggable and droppable are same element\r\n            if (!draggable || (draggable.currentItem || draggable.element)[0] === this.element[0]) {\r\n                return;\r\n            }\r\n\r\n            if (this.accept.call(this.element[0], (draggable.currentItem || draggable.element))) {\r\n                if (this.options.hoverClass) {\r\n                    this.element.addClass(this.options.hoverClass);\r\n                }\r\n                this._trigger(\"over\", event, this.ui(draggable));\r\n            }\r\n\r\n        },\r\n\r\n        _out: function (event) {\r\n\r\n            var draggable = $.ui.ddmanager.current;\r\n\r\n            // Bail if draggable and droppable are same element\r\n            if (!draggable || (draggable.currentItem || draggable.element)[0] === this.element[0]) {\r\n                return;\r\n            }\r\n\r\n            if (this.accept.call(this.element[0], (draggable.currentItem || draggable.element))) {\r\n                if (this.options.hoverClass) {\r\n                    this.element.removeClass(this.options.hoverClass);\r\n                }\r\n                this._trigger(\"out\", event, this.ui(draggable));\r\n            }\r\n\r\n        },\r\n\r\n        _drop: function (event, custom) {\r\n\r\n            var draggable = custom || $.ui.ddmanager.current,\r\n                childrenIntersection = false;\r\n\r\n            // Bail if draggable and droppable are same element\r\n            if (!draggable || (draggable.currentItem || draggable.element)[0] === this.element[0]) {\r\n                return false;\r\n            }\r\n\r\n            this.element.find(\":data(ui-droppable)\").not(\".ui-draggable-dragging\").each(function () {\r\n                var inst = $.data(this, \"ui-droppable\");\r\n                if (\r\n                    inst.options.greedy &&\r\n                    !inst.options.disabled &&\r\n                    inst.options.scope === draggable.options.scope &&\r\n                    inst.accept.call(inst.element[0], (draggable.currentItem || draggable.element)) &&\r\n                    $.ui.intersect(draggable, $.extend(inst, {offset: inst.element.offset()}), inst.options.tolerance)\r\n                ) {\r\n                    childrenIntersection = true;\r\n                    return false;\r\n                }\r\n            });\r\n            if (childrenIntersection) {\r\n                return false;\r\n            }\r\n\r\n            if (this.accept.call(this.element[0], (draggable.currentItem || draggable.element))) {\r\n                if (this.options.activeClass) {\r\n                    this.element.removeClass(this.options.activeClass);\r\n                }\r\n                if (this.options.hoverClass) {\r\n                    this.element.removeClass(this.options.hoverClass);\r\n                }\r\n                this._trigger(\"drop\", event, this.ui(draggable));\r\n                return this.element;\r\n            }\r\n\r\n            return false;\r\n\r\n        },\r\n\r\n        ui: function (c) {\r\n            return {\r\n                draggable: (c.currentItem || c.element),\r\n                helper: c.helper,\r\n                position: c.position,\r\n                offset: c.positionAbs\r\n            };\r\n        }\r\n\r\n    });\r\n\r\n    $.ui.intersect = function (draggable, droppable, toleranceMode) {\r\n\r\n        if (!droppable.offset) {\r\n            return false;\r\n        }\r\n\r\n        var draggableLeft, draggableTop,\r\n            x1 = (draggable.positionAbs || draggable.position.absolute).left,\r\n            y1 = (draggable.positionAbs || draggable.position.absolute).top,\r\n            x2 = x1 + draggable.helperProportions.width,\r\n            y2 = y1 + draggable.helperProportions.height,\r\n            l = droppable.offset.left,\r\n            t = droppable.offset.top,\r\n            r = l + droppable.proportions().width,\r\n            b = t + droppable.proportions().height;\r\n\r\n        switch (toleranceMode) {\r\n            case \"fit\":\r\n                return (l <= x1 && x2 <= r && t <= y1 && y2 <= b);\r\n            case \"intersect\":\r\n                return (l < x1 + (draggable.helperProportions.width / 2) && // Right Half\r\n                    x2 - (draggable.helperProportions.width / 2) < r && // Left Half\r\n                    t < y1 + (draggable.helperProportions.height / 2) && // Bottom Half\r\n                    y2 - (draggable.helperProportions.height / 2) < b); // Top Half\r\n            case \"pointer\":\r\n                draggableLeft = ((draggable.positionAbs || draggable.position.absolute).left + (draggable.clickOffset || draggable.offset.click).left);\r\n                draggableTop = ((draggable.positionAbs || draggable.position.absolute).top + (draggable.clickOffset || draggable.offset.click).top);\r\n                return isOverAxis(draggableTop, t, droppable.proportions().height) && isOverAxis(draggableLeft, l, droppable.proportions().width);\r\n            case \"touch\":\r\n                return (\r\n                    (y1 >= t && y1 <= b) ||\t// Top edge touching\r\n                    (y2 >= t && y2 <= b) ||\t// Bottom edge touching\r\n                    (y1 < t && y2 > b)\t\t// Surrounded vertically\r\n                ) && (\r\n                    (x1 >= l && x1 <= r) ||\t// Left edge touching\r\n                    (x2 >= l && x2 <= r) ||\t// Right edge touching\r\n                    (x1 < l && x2 > r)\t\t// Surrounded horizontally\r\n                );\r\n            default:\r\n                return false;\r\n        }\r\n\r\n    };\r\n\r\n    /*\r\n        This manager tracks offsets of draggables and droppables\r\n    */\r\n    $.ui.ddmanager = {\r\n        current: null,\r\n        droppables: {\"default\": []},\r\n        prepareOffsets: function (t, event) {\r\n\r\n            var i, j,\r\n                m = $.ui.ddmanager.droppables[t.options.scope] || [],\r\n                type = event ? event.type : null, // workaround for #2317\r\n                list = (t.currentItem || t.element).find(\":data(ui-droppable)\").addBack();\r\n\r\n            droppablesLoop: for (i = 0; i < m.length; i++) {\r\n\r\n                //No disabled and non-accepted\r\n                if (m[i].options.disabled || (t && !m[i].accept.call(m[i].element[0], (t.currentItem || t.element)))) {\r\n                    continue;\r\n                }\r\n\r\n                // Filter out elements in the current dragged item\r\n                for (j = 0; j < list.length; j++) {\r\n                    if (list[j] === m[i].element[0]) {\r\n                        m[i].proportions().height = 0;\r\n                        continue droppablesLoop;\r\n                    }\r\n                }\r\n\r\n                m[i].visible = m[i].element.css(\"display\") !== \"none\";\r\n                if (!m[i].visible) {\r\n                    continue;\r\n                }\r\n\r\n                //Activate the droppable if used directly from draggables\r\n                if (type === \"mousedown\") {\r\n                    m[i]._activate.call(m[i], event);\r\n                }\r\n\r\n                m[i].offset = m[i].element.offset();\r\n                m[i].proportions({width: m[i].element[0].offsetWidth, height: m[i].element[0].offsetHeight});\r\n\r\n            }\r\n\r\n        },\r\n        drop: function (draggable, event) {\r\n\r\n            var dropped = false;\r\n            // Create a copy of the droppables in case the list changes during the drop (#9116)\r\n            $.each(($.ui.ddmanager.droppables[draggable.options.scope] || []).slice(), function () {\r\n\r\n                if (!this.options) {\r\n                    return;\r\n                }\r\n                if (!this.options.disabled && this.visible && $.ui.intersect(draggable, this, this.options.tolerance)) {\r\n                    dropped = this._drop.call(this, event) || dropped;\r\n                }\r\n\r\n                if (!this.options.disabled && this.visible && this.accept.call(this.element[0], (draggable.currentItem || draggable.element))) {\r\n                    this.isout = true;\r\n                    this.isover = false;\r\n                    this._deactivate.call(this, event);\r\n                }\r\n\r\n            });\r\n            return dropped;\r\n\r\n        },\r\n        dragStart: function (draggable, event) {\r\n            //Listen for scrolling so that if the dragging causes scrolling the position of the droppables can be recalculated (see #5003)\r\n            draggable.element.parentsUntil(\"body\").bind(\"scroll.droppable\", function () {\r\n                if (!draggable.options.refreshPositions) {\r\n                    $.ui.ddmanager.prepareOffsets(draggable, event);\r\n                }\r\n            });\r\n        },\r\n        drag: function (draggable, event) {\r\n\r\n            //If you have a highly dynamic page, you might try this option. It renders positions every time you move the mouse.\r\n            if (draggable.options.refreshPositions) {\r\n                $.ui.ddmanager.prepareOffsets(draggable, event);\r\n            }\r\n\r\n            //Run through all droppables and check their positions based on specific tolerance options\r\n            $.each($.ui.ddmanager.droppables[draggable.options.scope] || [], function () {\r\n\r\n                if (this.options.disabled || this.greedyChild || !this.visible) {\r\n                    return;\r\n                }\r\n\r\n                var parentInstance, scope, parent,\r\n                    intersects = $.ui.intersect(draggable, this, this.options.tolerance),\r\n                    c = !intersects && this.isover ? \"isout\" : (intersects && !this.isover ? \"isover\" : null);\r\n                if (!c) {\r\n                    return;\r\n                }\r\n\r\n                if (this.options.greedy) {\r\n                    // find droppable parents with same scope\r\n                    scope = this.options.scope;\r\n                    parent = this.element.parents(\":data(ui-droppable)\").filter(function () {\r\n                        return $.data(this, \"ui-droppable\").options.scope === scope;\r\n                    });\r\n\r\n                    if (parent.length) {\r\n                        parentInstance = $.data(parent[0], \"ui-droppable\");\r\n                        parentInstance.greedyChild = (c === \"isover\");\r\n                    }\r\n                }\r\n\r\n                // we just moved into a greedy child\r\n                if (parentInstance && c === \"isover\") {\r\n                    parentInstance.isover = false;\r\n                    parentInstance.isout = true;\r\n                    parentInstance._out.call(parentInstance, event);\r\n                }\r\n\r\n                this[c] = true;\r\n                this[c === \"isout\" ? \"isover\" : \"isout\"] = false;\r\n                this[c === \"isover\" ? \"_over\" : \"_out\"].call(this, event);\r\n\r\n                // we just moved out of a greedy child\r\n                if (parentInstance && c === \"isout\") {\r\n                    parentInstance.isout = false;\r\n                    parentInstance.isover = true;\r\n                    parentInstance._over.call(parentInstance, event);\r\n                }\r\n            });\r\n\r\n        },\r\n        dragStop: function (draggable, event) {\r\n            draggable.element.parentsUntil(\"body\").unbind(\"scroll.droppable\");\r\n            //Call prepareOffsets one final time since IE does not fire return scroll events when overflow was caused by drag (see #5003)\r\n            if (!draggable.options.refreshPositions) {\r\n                $.ui.ddmanager.prepareOffsets(draggable, event);\r\n            }\r\n        }\r\n    };\r\n\r\n});\r\n","jquery/ui-modules/effect-blind.js":"/*!\r\n * jQuery UI Effects Blind - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/blind-effect/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/effect'\r\n], function ($, undefined) {\r\n\r\n    var rvertical = /up|down|vertical/,\r\n        rpositivemotion = /up|left|vertical|horizontal/;\r\n\r\n    $.effects.effect.blind = function (o, done) {\r\n        // Create element\r\n        var el = $(this),\r\n            props = [\"position\", \"top\", \"bottom\", \"left\", \"right\", \"height\", \"width\"],\r\n            mode = $.effects.setMode(el, o.mode || \"hide\"),\r\n            direction = o.direction || \"up\",\r\n            vertical = rvertical.test(direction),\r\n            ref = vertical ? \"height\" : \"width\",\r\n            ref2 = vertical ? \"top\" : \"left\",\r\n            motion = rpositivemotion.test(direction),\r\n            animation = {},\r\n            show = mode === \"show\",\r\n            wrapper, distance, margin;\r\n\r\n        // if already wrapped, the wrapper's properties are my property. #6245\r\n        if (el.parent().is(\".ui-effects-wrapper\")) {\r\n            $.effects.save(el.parent(), props);\r\n        } else {\r\n            $.effects.save(el, props);\r\n        }\r\n        el.show();\r\n        wrapper = $.effects.createWrapper(el).css({\r\n            overflow: \"hidden\"\r\n        });\r\n\r\n        distance = wrapper[ref]();\r\n        margin = parseFloat(wrapper.css(ref2)) || 0;\r\n\r\n        animation[ref] = show ? distance : 0;\r\n        if (!motion) {\r\n            el\r\n                .css(vertical ? \"bottom\" : \"right\", 0)\r\n                .css(vertical ? \"top\" : \"left\", \"auto\")\r\n                .css({position: \"absolute\"});\r\n\r\n            animation[ref2] = show ? margin : distance + margin;\r\n        }\r\n\r\n        // start at 0 if we are showing\r\n        if (show) {\r\n            wrapper.css(ref, 0);\r\n            if (!motion) {\r\n                wrapper.css(ref2, margin + distance);\r\n            }\r\n        }\r\n\r\n        // Animate\r\n        wrapper.animate(animation, {\r\n            duration: o.duration,\r\n            easing: o.easing,\r\n            queue: false,\r\n            complete: function () {\r\n                if (mode === \"hide\") {\r\n                    el.hide();\r\n                }\r\n                $.effects.restore(el, props);\r\n                $.effects.removeWrapper(el);\r\n                done();\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n});\r\n","jquery/ui-modules/effect-bounce.js":"/*!\r\n * jQuery UI Effects Bounce - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/bounce-effect/\r\n *\r\n * Depends:\r\n *\tjquery.ui.effect.js\r\n */\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/effect'\r\n], function ($, undefined) {\r\n\r\n    $.effects.effect.bounce = function (o, done) {\r\n        var el = $(this),\r\n            props = [\"position\", \"top\", \"bottom\", \"left\", \"right\", \"height\", \"width\"],\r\n\r\n            // defaults:\r\n            mode = $.effects.setMode(el, o.mode || \"effect\"),\r\n            hide = mode === \"hide\",\r\n            show = mode === \"show\",\r\n            direction = o.direction || \"up\",\r\n            distance = o.distance,\r\n            times = o.times || 5,\r\n\r\n            // number of internal animations\r\n            anims = times * 2 + (show || hide ? 1 : 0),\r\n            speed = o.duration / anims,\r\n            easing = o.easing,\r\n\r\n            // utility:\r\n            ref = (direction === \"up\" || direction === \"down\") ? \"top\" : \"left\",\r\n            motion = (direction === \"up\" || direction === \"left\"),\r\n            i,\r\n            upAnim,\r\n            downAnim,\r\n\r\n            // we will need to re-assemble the queue to stack our animations in place\r\n            queue = el.queue(),\r\n            queuelen = queue.length;\r\n\r\n        // Avoid touching opacity to prevent clearType and PNG issues in IE\r\n        if (show || hide) {\r\n            props.push(\"opacity\");\r\n        }\r\n\r\n        $.effects.save(el, props);\r\n        el.show();\r\n        $.effects.createWrapper(el); // Create Wrapper\r\n\r\n        // default distance for the BIGGEST bounce is the outer Distance / 3\r\n        if (!distance) {\r\n            distance = el[ref === \"top\" ? \"outerHeight\" : \"outerWidth\"]() / 3;\r\n        }\r\n\r\n        if (show) {\r\n            downAnim = {opacity: 1};\r\n            downAnim[ref] = 0;\r\n\r\n            // if we are showing, force opacity 0 and set the initial position\r\n            // then do the \"first\" animation\r\n            el.css(\"opacity\", 0)\r\n                .css(ref, motion ? -distance * 2 : distance * 2)\r\n                .animate(downAnim, speed, easing);\r\n        }\r\n\r\n        // start at the smallest distance if we are hiding\r\n        if (hide) {\r\n            distance = distance / Math.pow(2, times - 1);\r\n        }\r\n\r\n        downAnim = {};\r\n        downAnim[ref] = 0;\r\n        // Bounces up/down/left/right then back to 0 -- times * 2 animations happen here\r\n        for (i = 0; i < times; i++) {\r\n            upAnim = {};\r\n            upAnim[ref] = (motion ? \"-=\" : \"+=\") + distance;\r\n\r\n            el.animate(upAnim, speed, easing)\r\n                .animate(downAnim, speed, easing);\r\n\r\n            distance = hide ? distance * 2 : distance / 2;\r\n        }\r\n\r\n        // Last Bounce when Hiding\r\n        if (hide) {\r\n            upAnim = {opacity: 0};\r\n            upAnim[ref] = (motion ? \"-=\" : \"+=\") + distance;\r\n\r\n            el.animate(upAnim, speed, easing);\r\n        }\r\n\r\n        el.queue(function () {\r\n            if (hide) {\r\n                el.hide();\r\n            }\r\n            $.effects.restore(el, props);\r\n            $.effects.removeWrapper(el);\r\n            done();\r\n        });\r\n\r\n        // inject all the animations we just queued to be first in line (after \"inprogress\")\r\n        if (queuelen > 1) {\r\n            queue.splice.apply(queue,\r\n                [1, 0].concat(queue.splice(queuelen, anims + 1)));\r\n        }\r\n        el.dequeue();\r\n\r\n    };\r\n\r\n});\r\n","jquery/ui-modules/effect-clip.js":"/*!\r\n * jQuery UI Effects Clip - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/clip-effect/\r\n */\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/effect'\r\n], function ($, undefined) {\r\n\r\n    $.effects.effect.clip = function (o, done) {\r\n        // Create element\r\n        var el = $(this),\r\n            props = [\"position\", \"top\", \"bottom\", \"left\", \"right\", \"height\", \"width\"],\r\n            mode = $.effects.setMode(el, o.mode || \"hide\"),\r\n            show = mode === \"show\",\r\n            direction = o.direction || \"vertical\",\r\n            vert = direction === \"vertical\",\r\n            size = vert ? \"height\" : \"width\",\r\n            position = vert ? \"top\" : \"left\",\r\n            animation = {},\r\n            wrapper, animate, distance;\r\n\r\n        // Save & Show\r\n        $.effects.save(el, props);\r\n        el.show();\r\n\r\n        // Create Wrapper\r\n        wrapper = $.effects.createWrapper(el).css({\r\n            overflow: \"hidden\"\r\n        });\r\n        animate = (el[0].tagName === \"IMG\") ? wrapper : el;\r\n        distance = animate[size]();\r\n\r\n        // Shift\r\n        if (show) {\r\n            animate.css(size, 0);\r\n            animate.css(position, distance / 2);\r\n        }\r\n\r\n        // Create Animation Object:\r\n        animation[size] = show ? distance : 0;\r\n        animation[position] = show ? 0 : distance / 2;\r\n\r\n        // Animate\r\n        animate.animate(animation, {\r\n            queue: false,\r\n            duration: o.duration,\r\n            easing: o.easing,\r\n            complete: function () {\r\n                if (!show) {\r\n                    el.hide();\r\n                }\r\n                $.effects.restore(el, props);\r\n                $.effects.removeWrapper(el);\r\n                done();\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n});\r\n","jquery/ui-modules/effect-drop.js":"/*!\r\n * jQuery UI Effects Drop - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/drop-effect/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/effect'\r\n], function ($, undefined) {\r\n\r\n    $.effects.effect.drop = function (o, done) {\r\n\r\n        var el = $(this),\r\n            props = [\"position\", \"top\", \"bottom\", \"left\", \"right\", \"opacity\", \"height\", \"width\"],\r\n            mode = $.effects.setMode(el, o.mode || \"hide\"),\r\n            show = mode === \"show\",\r\n            direction = o.direction || \"left\",\r\n            ref = (direction === \"up\" || direction === \"down\") ? \"top\" : \"left\",\r\n            motion = (direction === \"up\" || direction === \"left\") ? \"pos\" : \"neg\",\r\n            animation = {\r\n                opacity: show ? 1 : 0\r\n            },\r\n            distance;\r\n\r\n        // Adjust\r\n        $.effects.save(el, props);\r\n        el.show();\r\n        $.effects.createWrapper(el);\r\n\r\n        distance = o.distance || el[ref === \"top\" ? \"outerHeight\" : \"outerWidth\"](true) / 2;\r\n\r\n        if (show) {\r\n            el\r\n                .css(\"opacity\", 0)\r\n                .css(ref, motion === \"pos\" ? -distance : distance);\r\n        }\r\n\r\n        // Animation\r\n        animation[ref] = (show ?\r\n            (motion === \"pos\" ? \"+=\" : \"-=\") :\r\n            (motion === \"pos\" ? \"-=\" : \"+=\")) +\r\n            distance;\r\n\r\n        // Animate\r\n        el.animate(animation, {\r\n            queue: false,\r\n            duration: o.duration,\r\n            easing: o.easing,\r\n            complete: function () {\r\n                if (mode === \"hide\") {\r\n                    el.hide();\r\n                }\r\n                $.effects.restore(el, props);\r\n                $.effects.removeWrapper(el);\r\n                done();\r\n            }\r\n        });\r\n    };\r\n\r\n});\r\n","jquery/ui-modules/effect-explode.js":"/*!\r\n * jQuery UI Effects Explode - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/explode-effect/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/effect'\r\n], function ($, undefined) {\r\n\r\n    $.effects.effect.explode = function (o, done) {\r\n\r\n        var rows = o.pieces ? Math.round(Math.sqrt(o.pieces)) : 3,\r\n            cells = rows,\r\n            el = $(this),\r\n            mode = $.effects.setMode(el, o.mode || \"hide\"),\r\n            show = mode === \"show\",\r\n\r\n            // show and then visibility:hidden the element before calculating offset\r\n            offset = el.show().css(\"visibility\", \"hidden\").offset(),\r\n\r\n            // width and height of a piece\r\n            width = Math.ceil(el.outerWidth() / cells),\r\n            height = Math.ceil(el.outerHeight() / rows),\r\n            pieces = [],\r\n\r\n            // loop\r\n            i, j, left, top, mx, my;\r\n\r\n        // children animate complete:\r\n        function childComplete() {\r\n            pieces.push(this);\r\n            if (pieces.length === rows * cells) {\r\n                animComplete();\r\n            }\r\n        }\r\n\r\n        // clone the element for each row and cell.\r\n        for (i = 0; i < rows; i++) { // ===>\r\n            top = offset.top + i * height;\r\n            my = i - (rows - 1) / 2;\r\n\r\n            for (j = 0; j < cells; j++) { // |||\r\n                left = offset.left + j * width;\r\n                mx = j - (cells - 1) / 2;\r\n\r\n                // Create a clone of the now hidden main element that will be absolute positioned\r\n                // within a wrapper div off the -left and -top equal to size of our pieces\r\n                el\r\n                    .clone()\r\n                    .appendTo(\"body\")\r\n                    .wrap(\"<div></div>\")\r\n                    .css({\r\n                        position: \"absolute\",\r\n                        visibility: \"visible\",\r\n                        left: -j * width,\r\n                        top: -i * height\r\n                    })\r\n\r\n                    // select the wrapper - make it overflow: hidden and absolute positioned based on\r\n                    // where the original was located +left and +top equal to the size of pieces\r\n                    .parent()\r\n                    .addClass(\"ui-effects-explode\")\r\n                    .css({\r\n                        position: \"absolute\",\r\n                        overflow: \"hidden\",\r\n                        width: width,\r\n                        height: height,\r\n                        left: left + (show ? mx * width : 0),\r\n                        top: top + (show ? my * height : 0),\r\n                        opacity: show ? 0 : 1\r\n                    }).animate({\r\n                    left: left + (show ? 0 : mx * width),\r\n                    top: top + (show ? 0 : my * height),\r\n                    opacity: show ? 1 : 0\r\n                }, o.duration || 500, o.easing, childComplete);\r\n            }\r\n        }\r\n\r\n        function animComplete() {\r\n            el.css({\r\n                visibility: \"visible\"\r\n            });\r\n            $(pieces).remove();\r\n            if (!show) {\r\n                el.hide();\r\n            }\r\n            done();\r\n        }\r\n    };\r\n\r\n});\r\n","jquery/ui-modules/effect-fade.js":"/*!\r\n * jQuery UI Effects Fade - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/fade-effect/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/effect'\r\n], function ($, undefined) {\r\n\r\n    $.effects.effect.fade = function (o, done) {\r\n        var el = $(this),\r\n            mode = $.effects.setMode(el, o.mode || \"toggle\");\r\n\r\n        el.animate({\r\n            opacity: mode\r\n        }, {\r\n            queue: false,\r\n            duration: o.duration,\r\n            easing: o.easing,\r\n            complete: done\r\n        });\r\n    };\r\n\r\n});\r\n","jquery/ui-modules/effect-fold.js":"/*!\r\n * jQuery UI Effects Fold - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/fold-effect/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/effect'\r\n], function ($, undefined) {\r\n\r\n    $.effects.effect.fold = function (o, done) {\r\n\r\n        // Create element\r\n        var el = $(this),\r\n            props = [\"position\", \"top\", \"bottom\", \"left\", \"right\", \"height\", \"width\"],\r\n            mode = $.effects.setMode(el, o.mode || \"hide\"),\r\n            show = mode === \"show\",\r\n            hide = mode === \"hide\",\r\n            size = o.size || 15,\r\n            percent = /([0-9]+)%/.exec(size),\r\n            horizFirst = !!o.horizFirst,\r\n            widthFirst = show !== horizFirst,\r\n            ref = widthFirst ? [\"width\", \"height\"] : [\"height\", \"width\"],\r\n            duration = o.duration / 2,\r\n            wrapper, distance,\r\n            animation1 = {},\r\n            animation2 = {};\r\n\r\n        $.effects.save(el, props);\r\n        el.show();\r\n\r\n        // Create Wrapper\r\n        wrapper = $.effects.createWrapper(el).css({\r\n            overflow: \"hidden\"\r\n        });\r\n        distance = widthFirst ?\r\n            [wrapper.width(), wrapper.height()] :\r\n            [wrapper.height(), wrapper.width()];\r\n\r\n        if (percent) {\r\n            size = parseInt(percent[1], 10) / 100 * distance[hide ? 0 : 1];\r\n        }\r\n        if (show) {\r\n            wrapper.css(horizFirst ? {\r\n                height: 0,\r\n                width: size\r\n            } : {\r\n                height: size,\r\n                width: 0\r\n            });\r\n        }\r\n\r\n        // Animation\r\n        animation1[ref[0]] = show ? distance[0] : size;\r\n        animation2[ref[1]] = show ? distance[1] : 0;\r\n\r\n        // Animate\r\n        wrapper\r\n            .animate(animation1, duration, o.easing)\r\n            .animate(animation2, duration, o.easing, function () {\r\n                if (hide) {\r\n                    el.hide();\r\n                }\r\n                $.effects.restore(el, props);\r\n                $.effects.removeWrapper(el);\r\n                done();\r\n            });\r\n    };\r\n\r\n});\r\n","jquery/ui-modules/effect-highlight.js":"/*!\r\n * jQuery UI Effects Highlight - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/highlight-effect/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/effect'\r\n], function ($, undefined) {\r\n\r\n    $.effects.effect.highlight = function (o, done) {\r\n        var elem = $(this),\r\n            props = [\"backgroundImage\", \"backgroundColor\", \"opacity\"],\r\n            mode = $.effects.setMode(elem, o.mode || \"show\"),\r\n            animation = {\r\n                backgroundColor: elem.css(\"backgroundColor\")\r\n            };\r\n\r\n        if (mode === \"hide\") {\r\n            animation.opacity = 0;\r\n        }\r\n\r\n        $.effects.save(elem, props);\r\n\r\n        elem\r\n            .show()\r\n            .css({\r\n                backgroundImage: \"none\",\r\n                backgroundColor: o.color || \"#ffff99\"\r\n            })\r\n            .animate(animation, {\r\n                queue: false,\r\n                duration: o.duration,\r\n                easing: o.easing,\r\n                complete: function () {\r\n                    if (mode === \"hide\") {\r\n                        elem.hide();\r\n                    }\r\n                    $.effects.restore(elem, props);\r\n                    done();\r\n                }\r\n            });\r\n    };\r\n\r\n});\r\n","jquery/ui-modules/effect-pulsate.js":"/*!\r\n * jQuery UI Effects Pulsate - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/pulsate-effect/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/effect'\r\n], function ($, undefined) {\r\n\r\n    $.effects.effect.pulsate = function (o, done) {\r\n        var elem = $(this),\r\n            mode = $.effects.setMode(elem, o.mode || \"show\"),\r\n            show = mode === \"show\",\r\n            hide = mode === \"hide\",\r\n            showhide = (show || mode === \"hide\"),\r\n\r\n            // showing or hiding leaves of the \"last\" animation\r\n            anims = ((o.times || 5) * 2) + (showhide ? 1 : 0),\r\n            duration = o.duration / anims,\r\n            animateTo = 0,\r\n            queue = elem.queue(),\r\n            queuelen = queue.length,\r\n            i;\r\n\r\n        if (show || !elem.is(\":visible\")) {\r\n            elem.css(\"opacity\", 0).show();\r\n            animateTo = 1;\r\n        }\r\n\r\n        // anims - 1 opacity \"toggles\"\r\n        for (i = 1; i < anims; i++) {\r\n            elem.animate({\r\n                opacity: animateTo\r\n            }, duration, o.easing);\r\n            animateTo = 1 - animateTo;\r\n        }\r\n\r\n        elem.animate({\r\n            opacity: animateTo\r\n        }, duration, o.easing);\r\n\r\n        elem.queue(function () {\r\n            if (hide) {\r\n                elem.hide();\r\n            }\r\n            done();\r\n        });\r\n\r\n        // We just queued up \"anims\" animations, we need to put them next in the queue\r\n        if (queuelen > 1) {\r\n            queue.splice.apply(queue,\r\n                [1, 0].concat(queue.splice(queuelen, anims + 1)));\r\n        }\r\n        elem.dequeue();\r\n    };\r\n\r\n});\r\n","jquery/ui-modules/effect-scale.js":"/*!\r\n * jQuery UI Effects Scale - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/scale-effect/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/effect'\r\n], function ($, undefined) {\r\n\r\n    $.effects.effect.puff = function (o, done) {\r\n        var elem = $(this),\r\n            mode = $.effects.setMode(elem, o.mode || \"hide\"),\r\n            hide = mode === \"hide\",\r\n            percent = parseInt(o.percent, 10) || 150,\r\n            factor = percent / 100,\r\n            original = {\r\n                height: elem.height(),\r\n                width: elem.width(),\r\n                outerHeight: elem.outerHeight(),\r\n                outerWidth: elem.outerWidth()\r\n            };\r\n\r\n        $.extend(o, {\r\n            effect: \"scale\",\r\n            queue: false,\r\n            fade: true,\r\n            mode: mode,\r\n            complete: done,\r\n            percent: hide ? percent : 100,\r\n            from: hide ?\r\n                original :\r\n                {\r\n                    height: original.height * factor,\r\n                    width: original.width * factor,\r\n                    outerHeight: original.outerHeight * factor,\r\n                    outerWidth: original.outerWidth * factor\r\n                }\r\n        });\r\n\r\n        elem.effect(o);\r\n    };\r\n\r\n    $.effects.effect.scale = function (o, done) {\r\n\r\n        // Create element\r\n        var el = $(this),\r\n            options = $.extend(true, {}, o),\r\n            mode = $.effects.setMode(el, o.mode || \"effect\"),\r\n            percent = parseInt(o.percent, 10) ||\r\n                (parseInt(o.percent, 10) === 0 ? 0 : (mode === \"hide\" ? 0 : 100)),\r\n            direction = o.direction || \"both\",\r\n            origin = o.origin,\r\n            original = {\r\n                height: el.height(),\r\n                width: el.width(),\r\n                outerHeight: el.outerHeight(),\r\n                outerWidth: el.outerWidth()\r\n            },\r\n            factor = {\r\n                y: direction !== \"horizontal\" ? (percent / 100) : 1,\r\n                x: direction !== \"vertical\" ? (percent / 100) : 1\r\n            };\r\n\r\n        // We are going to pass this effect to the size effect:\r\n        options.effect = \"size\";\r\n        options.queue = false;\r\n        options.complete = done;\r\n\r\n        // Set default origin and restore for show/hide\r\n        if (mode !== \"effect\") {\r\n            options.origin = origin || [\"middle\", \"center\"];\r\n            options.restore = true;\r\n        }\r\n\r\n        options.from = o.from || (mode === \"show\" ? {\r\n            height: 0,\r\n            width: 0,\r\n            outerHeight: 0,\r\n            outerWidth: 0\r\n        } : original);\r\n        options.to = {\r\n            height: original.height * factor.y,\r\n            width: original.width * factor.x,\r\n            outerHeight: original.outerHeight * factor.y,\r\n            outerWidth: original.outerWidth * factor.x\r\n        };\r\n\r\n        // Fade option to support puff\r\n        if (options.fade) {\r\n            if (mode === \"show\") {\r\n                options.from.opacity = 0;\r\n                options.to.opacity = 1;\r\n            }\r\n            if (mode === \"hide\") {\r\n                options.from.opacity = 1;\r\n                options.to.opacity = 0;\r\n            }\r\n        }\r\n\r\n        // Animate\r\n        el.effect(options);\r\n\r\n    };\r\n\r\n    $.effects.effect.size = function (o, done) {\r\n\r\n        // Create element\r\n        var original, baseline, factor,\r\n            el = $(this),\r\n            props0 = [\"position\", \"top\", \"bottom\", \"left\", \"right\", \"width\", \"height\", \"overflow\", \"opacity\"],\r\n\r\n            // Always restore\r\n            props1 = [\"position\", \"top\", \"bottom\", \"left\", \"right\", \"overflow\", \"opacity\"],\r\n\r\n            // Copy for children\r\n            props2 = [\"width\", \"height\", \"overflow\"],\r\n            cProps = [\"fontSize\"],\r\n            vProps = [\"borderTopWidth\", \"borderBottomWidth\", \"paddingTop\", \"paddingBottom\"],\r\n            hProps = [\"borderLeftWidth\", \"borderRightWidth\", \"paddingLeft\", \"paddingRight\"],\r\n\r\n            // Set options\r\n            mode = $.effects.setMode(el, o.mode || \"effect\"),\r\n            restore = o.restore || mode !== \"effect\",\r\n            scale = o.scale || \"both\",\r\n            origin = o.origin || [\"middle\", \"center\"],\r\n            position = el.css(\"position\"),\r\n            props = restore ? props0 : props1,\r\n            zero = {\r\n                height: 0,\r\n                width: 0,\r\n                outerHeight: 0,\r\n                outerWidth: 0\r\n            };\r\n\r\n        if (mode === \"show\") {\r\n            el.show();\r\n        }\r\n        original = {\r\n            height: el.height(),\r\n            width: el.width(),\r\n            outerHeight: el.outerHeight(),\r\n            outerWidth: el.outerWidth()\r\n        };\r\n\r\n        if (o.mode === \"toggle\" && mode === \"show\") {\r\n            el.from = o.to || zero;\r\n            el.to = o.from || original;\r\n        } else {\r\n            el.from = o.from || (mode === \"show\" ? zero : original);\r\n            el.to = o.to || (mode === \"hide\" ? zero : original);\r\n        }\r\n\r\n        // Set scaling factor\r\n        factor = {\r\n            from: {\r\n                y: el.from.height / original.height,\r\n                x: el.from.width / original.width\r\n            },\r\n            to: {\r\n                y: el.to.height / original.height,\r\n                x: el.to.width / original.width\r\n            }\r\n        };\r\n\r\n        // Scale the css box\r\n        if (scale === \"box\" || scale === \"both\") {\r\n\r\n            // Vertical props scaling\r\n            if (factor.from.y !== factor.to.y) {\r\n                props = props.concat(vProps);\r\n                el.from = $.effects.setTransition(el, vProps, factor.from.y, el.from);\r\n                el.to = $.effects.setTransition(el, vProps, factor.to.y, el.to);\r\n            }\r\n\r\n            // Horizontal props scaling\r\n            if (factor.from.x !== factor.to.x) {\r\n                props = props.concat(hProps);\r\n                el.from = $.effects.setTransition(el, hProps, factor.from.x, el.from);\r\n                el.to = $.effects.setTransition(el, hProps, factor.to.x, el.to);\r\n            }\r\n        }\r\n\r\n        // Scale the content\r\n        if (scale === \"content\" || scale === \"both\") {\r\n\r\n            // Vertical props scaling\r\n            if (factor.from.y !== factor.to.y) {\r\n                props = props.concat(cProps).concat(props2);\r\n                el.from = $.effects.setTransition(el, cProps, factor.from.y, el.from);\r\n                el.to = $.effects.setTransition(el, cProps, factor.to.y, el.to);\r\n            }\r\n        }\r\n\r\n        $.effects.save(el, props);\r\n        el.show();\r\n        $.effects.createWrapper(el);\r\n        el.css(\"overflow\", \"hidden\").css(el.from);\r\n\r\n        // Adjust\r\n        if (origin) { // Calculate baseline shifts\r\n            baseline = $.effects.getBaseline(origin, original);\r\n            el.from.top = (original.outerHeight - el.outerHeight()) * baseline.y;\r\n            el.from.left = (original.outerWidth - el.outerWidth()) * baseline.x;\r\n            el.to.top = (original.outerHeight - el.to.outerHeight) * baseline.y;\r\n            el.to.left = (original.outerWidth - el.to.outerWidth) * baseline.x;\r\n        }\r\n        el.css(el.from); // set top & left\r\n\r\n        // Animate\r\n        if (scale === \"content\" || scale === \"both\") { // Scale the children\r\n\r\n            // Add margins/font-size\r\n            vProps = vProps.concat([\"marginTop\", \"marginBottom\"]).concat(cProps);\r\n            hProps = hProps.concat([\"marginLeft\", \"marginRight\"]);\r\n            props2 = props0.concat(vProps).concat(hProps);\r\n\r\n            el.find(\"*[width]\").each(function () {\r\n                var child = $(this),\r\n                    c_original = {\r\n                        height: child.height(),\r\n                        width: child.width(),\r\n                        outerHeight: child.outerHeight(),\r\n                        outerWidth: child.outerWidth()\r\n                    };\r\n                if (restore) {\r\n                    $.effects.save(child, props2);\r\n                }\r\n\r\n                child.from = {\r\n                    height: c_original.height * factor.from.y,\r\n                    width: c_original.width * factor.from.x,\r\n                    outerHeight: c_original.outerHeight * factor.from.y,\r\n                    outerWidth: c_original.outerWidth * factor.from.x\r\n                };\r\n                child.to = {\r\n                    height: c_original.height * factor.to.y,\r\n                    width: c_original.width * factor.to.x,\r\n                    outerHeight: c_original.height * factor.to.y,\r\n                    outerWidth: c_original.width * factor.to.x\r\n                };\r\n\r\n                // Vertical props scaling\r\n                if (factor.from.y !== factor.to.y) {\r\n                    child.from = $.effects.setTransition(child, vProps, factor.from.y, child.from);\r\n                    child.to = $.effects.setTransition(child, vProps, factor.to.y, child.to);\r\n                }\r\n\r\n                // Horizontal props scaling\r\n                if (factor.from.x !== factor.to.x) {\r\n                    child.from = $.effects.setTransition(child, hProps, factor.from.x, child.from);\r\n                    child.to = $.effects.setTransition(child, hProps, factor.to.x, child.to);\r\n                }\r\n\r\n                // Animate children\r\n                child.css(child.from);\r\n                child.animate(child.to, o.duration, o.easing, function () {\r\n\r\n                    // Restore children\r\n                    if (restore) {\r\n                        $.effects.restore(child, props2);\r\n                    }\r\n                });\r\n            });\r\n        }\r\n\r\n        // Animate\r\n        el.animate(el.to, {\r\n            queue: false,\r\n            duration: o.duration,\r\n            easing: o.easing,\r\n            complete: function () {\r\n                if (el.to.opacity === 0) {\r\n                    el.css(\"opacity\", el.from.opacity);\r\n                }\r\n                if (mode === \"hide\") {\r\n                    el.hide();\r\n                }\r\n                $.effects.restore(el, props);\r\n                if (!restore) {\r\n\r\n                    // we need to calculate our new positioning based on the scaling\r\n                    if (position === \"static\") {\r\n                        el.css({\r\n                            position: \"relative\",\r\n                            top: el.to.top,\r\n                            left: el.to.left\r\n                        });\r\n                    } else {\r\n                        $.each([\"top\", \"left\"], function (idx, pos) {\r\n                            el.css(pos, function (_, str) {\r\n                                var val = parseInt(str, 10),\r\n                                    toRef = idx ? el.to.left : el.to.top;\r\n\r\n                                // if original was \"auto\", recalculate the new value from wrapper\r\n                                if (str === \"auto\") {\r\n                                    return toRef + \"px\";\r\n                                }\r\n\r\n                                return val + toRef + \"px\";\r\n                            });\r\n                        });\r\n                    }\r\n                }\r\n\r\n                $.effects.removeWrapper(el);\r\n                done();\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n});\r\n","jquery/ui-modules/effect-shake.js":"/*!\r\n * jQuery UI Effects Shake - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/shake-effect/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/effect'\r\n], function ($, undefined) {\r\n\r\n    $.effects.effect.shake = function (o, done) {\r\n\r\n        var el = $(this),\r\n            props = [\"position\", \"top\", \"bottom\", \"left\", \"right\", \"height\", \"width\"],\r\n            mode = $.effects.setMode(el, o.mode || \"effect\"),\r\n            direction = o.direction || \"left\",\r\n            distance = o.distance || 20,\r\n            times = o.times || 3,\r\n            anims = times * 2 + 1,\r\n            speed = Math.round(o.duration / anims),\r\n            ref = (direction === \"up\" || direction === \"down\") ? \"top\" : \"left\",\r\n            positiveMotion = (direction === \"up\" || direction === \"left\"),\r\n            animation = {},\r\n            animation1 = {},\r\n            animation2 = {},\r\n            i,\r\n\r\n            // we will need to re-assemble the queue to stack our animations in place\r\n            queue = el.queue(),\r\n            queuelen = queue.length;\r\n\r\n        $.effects.save(el, props);\r\n        el.show();\r\n        $.effects.createWrapper(el);\r\n\r\n        // Animation\r\n        animation[ref] = (positiveMotion ? \"-=\" : \"+=\") + distance;\r\n        animation1[ref] = (positiveMotion ? \"+=\" : \"-=\") + distance * 2;\r\n        animation2[ref] = (positiveMotion ? \"-=\" : \"+=\") + distance * 2;\r\n\r\n        // Animate\r\n        el.animate(animation, speed, o.easing);\r\n\r\n        // Shakes\r\n        for (i = 1; i < times; i++) {\r\n            el.animate(animation1, speed, o.easing).animate(animation2, speed, o.easing);\r\n        }\r\n        el\r\n            .animate(animation1, speed, o.easing)\r\n            .animate(animation, speed / 2, o.easing)\r\n            .queue(function () {\r\n                if (mode === \"hide\") {\r\n                    el.hide();\r\n                }\r\n                $.effects.restore(el, props);\r\n                $.effects.removeWrapper(el);\r\n                done();\r\n            });\r\n\r\n        // inject all the animations we just queued to be first in line (after \"inprogress\")\r\n        if (queuelen > 1) {\r\n            queue.splice.apply(queue,\r\n                [1, 0].concat(queue.splice(queuelen, anims + 1)));\r\n        }\r\n        el.dequeue();\r\n\r\n    };\r\n\r\n});\r\n","jquery/ui-modules/effect-slide.js":"/*!\r\n * jQuery UI Effects Slide - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/slide-effect/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/effect'\r\n], function ($, undefined) {\r\n\r\n    $.effects.effect.slide = function (o, done) {\r\n\r\n        // Create element\r\n        var el = $(this),\r\n            props = [\"position\", \"top\", \"bottom\", \"left\", \"right\", \"width\", \"height\"],\r\n            mode = $.effects.setMode(el, o.mode || \"show\"),\r\n            show = mode === \"show\",\r\n            direction = o.direction || \"left\",\r\n            ref = (direction === \"up\" || direction === \"down\") ? \"top\" : \"left\",\r\n            positiveMotion = (direction === \"up\" || direction === \"left\"),\r\n            distance,\r\n            animation = {};\r\n\r\n        // Adjust\r\n        $.effects.save(el, props);\r\n        el.show();\r\n        distance = o.distance || el[ref === \"top\" ? \"outerHeight\" : \"outerWidth\"](true);\r\n\r\n        $.effects.createWrapper(el).css({\r\n            overflow: \"hidden\"\r\n        });\r\n\r\n        if (show) {\r\n            el.css(ref, positiveMotion ? (isNaN(distance) ? \"-\" + distance : -distance) : distance);\r\n        }\r\n\r\n        // Animation\r\n        animation[ref] = (show ?\r\n            (positiveMotion ? \"+=\" : \"-=\") :\r\n            (positiveMotion ? \"-=\" : \"+=\")) +\r\n            distance;\r\n\r\n        // Animate\r\n        el.animate(animation, {\r\n            queue: false,\r\n            duration: o.duration,\r\n            easing: o.easing,\r\n            complete: function () {\r\n                if (mode === \"hide\") {\r\n                    el.hide();\r\n                }\r\n                $.effects.restore(el, props);\r\n                $.effects.removeWrapper(el);\r\n                done();\r\n            }\r\n        });\r\n    };\r\n\r\n});\r\n","jquery/ui-modules/effect-transfer.js":"/*!\r\n * jQuery UI Effects Transfer - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/transfer-effect/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/effect'\r\n], function ($, undefined) {\r\n\r\n    $.effects.effect.transfer = function (o, done) {\r\n        var elem = $(this),\r\n            target = $(o.to),\r\n            targetFixed = target.css(\"position\") === \"fixed\",\r\n            body = $(\"body\"),\r\n            fixTop = targetFixed ? body.scrollTop() : 0,\r\n            fixLeft = targetFixed ? body.scrollLeft() : 0,\r\n            endPosition = target.offset(),\r\n            animation = {\r\n                top: endPosition.top - fixTop,\r\n                left: endPosition.left - fixLeft,\r\n                height: target.innerHeight(),\r\n                width: target.innerWidth()\r\n            },\r\n            startPosition = elem.offset(),\r\n            transfer = $(\"<div class='ui-effects-transfer'></div>\")\r\n                .appendTo(document.body)\r\n                .addClass(o.className)\r\n                .css({\r\n                    top: startPosition.top - fixTop,\r\n                    left: startPosition.left - fixLeft,\r\n                    height: elem.innerHeight(),\r\n                    width: elem.innerWidth(),\r\n                    position: targetFixed ? \"fixed\" : \"absolute\"\r\n                })\r\n                .animate(animation, o.duration, o.easing, function () {\r\n                    transfer.remove();\r\n                    done();\r\n                });\r\n    };\r\n\r\n});\r\n","jquery/ui-modules/effect.js":"/*!\r\n * jQuery UI Effects - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/category/effects-core/\r\n */\r\n\r\ndefine([\r\n    'jquery'\r\n], function ($, undefined) {\r\n\r\n    var dataSpace = \"ui-effects-\";\r\n\r\n    $.effects = {\r\n        effect: {}\r\n    };\r\n\r\n    /*!\r\n     * jQuery Color Animations v2.1.2\r\n     * https://github.com/jquery/jquery-color\r\n     *\r\n     * Copyright 2013 jQuery Foundation and other contributors\r\n     * Released under the MIT license.\r\n     * http://jquery.org/license\r\n     *\r\n     * Date: Wed Jan 16 08:47:09 2013 -0600\r\n     */\r\n    (function (jQuery, undefined) {\r\n\r\n        var stepHooks = \"backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor\",\r\n\r\n            // plusequals test for += 100 -= 100\r\n            rplusequals = /^([\\-+])=\\s*(\\d+\\.?\\d*)/,\r\n            // a set of RE's that can match strings and generate color tuples.\r\n            stringParsers = [{\r\n                re: /rgba?\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*(?:,\\s*(\\d?(?:\\.\\d+)?)\\s*)?\\)/,\r\n                parse: function (execResult) {\r\n                    return [\r\n                        execResult[1],\r\n                        execResult[2],\r\n                        execResult[3],\r\n                        execResult[4]\r\n                    ];\r\n                }\r\n            }, {\r\n                re: /rgba?\\(\\s*(\\d+(?:\\.\\d+)?)\\%\\s*,\\s*(\\d+(?:\\.\\d+)?)\\%\\s*,\\s*(\\d+(?:\\.\\d+)?)\\%\\s*(?:,\\s*(\\d?(?:\\.\\d+)?)\\s*)?\\)/,\r\n                parse: function (execResult) {\r\n                    return [\r\n                        execResult[1] * 2.55,\r\n                        execResult[2] * 2.55,\r\n                        execResult[3] * 2.55,\r\n                        execResult[4]\r\n                    ];\r\n                }\r\n            }, {\r\n                // this regex ignores A-F because it's compared against an already lowercased string\r\n                re: /#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,\r\n                parse: function (execResult) {\r\n                    return [\r\n                        parseInt(execResult[1], 16),\r\n                        parseInt(execResult[2], 16),\r\n                        parseInt(execResult[3], 16)\r\n                    ];\r\n                }\r\n            }, {\r\n                // this regex ignores A-F because it's compared against an already lowercased string\r\n                re: /#([a-f0-9])([a-f0-9])([a-f0-9])/,\r\n                parse: function (execResult) {\r\n                    return [\r\n                        parseInt(execResult[1] + execResult[1], 16),\r\n                        parseInt(execResult[2] + execResult[2], 16),\r\n                        parseInt(execResult[3] + execResult[3], 16)\r\n                    ];\r\n                }\r\n            }, {\r\n                re: /hsla?\\(\\s*(\\d+(?:\\.\\d+)?)\\s*,\\s*(\\d+(?:\\.\\d+)?)\\%\\s*,\\s*(\\d+(?:\\.\\d+)?)\\%\\s*(?:,\\s*(\\d?(?:\\.\\d+)?)\\s*)?\\)/,\r\n                space: \"hsla\",\r\n                parse: function (execResult) {\r\n                    return [\r\n                        execResult[1],\r\n                        execResult[2] / 100,\r\n                        execResult[3] / 100,\r\n                        execResult[4]\r\n                    ];\r\n                }\r\n            }],\r\n\r\n            // jQuery.Color( )\r\n            color = jQuery.Color = function (color, green, blue, alpha) {\r\n                return new jQuery.Color.fn.parse(color, green, blue, alpha);\r\n            },\r\n            spaces = {\r\n                rgba: {\r\n                    props: {\r\n                        red: {\r\n                            idx: 0,\r\n                            type: \"byte\"\r\n                        },\r\n                        green: {\r\n                            idx: 1,\r\n                            type: \"byte\"\r\n                        },\r\n                        blue: {\r\n                            idx: 2,\r\n                            type: \"byte\"\r\n                        }\r\n                    }\r\n                },\r\n\r\n                hsla: {\r\n                    props: {\r\n                        hue: {\r\n                            idx: 0,\r\n                            type: \"degrees\"\r\n                        },\r\n                        saturation: {\r\n                            idx: 1,\r\n                            type: \"percent\"\r\n                        },\r\n                        lightness: {\r\n                            idx: 2,\r\n                            type: \"percent\"\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            propTypes = {\r\n                \"byte\": {\r\n                    floor: true,\r\n                    max: 255\r\n                },\r\n                \"percent\": {\r\n                    max: 1\r\n                },\r\n                \"degrees\": {\r\n                    mod: 360,\r\n                    floor: true\r\n                }\r\n            },\r\n            support = color.support = {},\r\n\r\n            // element for support tests\r\n            supportElem = jQuery(\"<p>\")[0],\r\n\r\n            // colors = jQuery.Color.names\r\n            colors,\r\n\r\n            // local aliases of functions called often\r\n            each = jQuery.each;\r\n\r\n// determine rgba support immediately\r\n        supportElem.style.cssText = \"background-color:rgba(1,1,1,.5)\";\r\n        support.rgba = supportElem.style.backgroundColor.indexOf(\"rgba\") > -1;\r\n\r\n// define cache name and alpha properties\r\n// for rgba and hsla spaces\r\n        each(spaces, function (spaceName, space) {\r\n            space.cache = \"_\" + spaceName;\r\n            space.props.alpha = {\r\n                idx: 3,\r\n                type: \"percent\",\r\n                def: 1\r\n            };\r\n        });\r\n\r\n        function clamp(value, prop, allowEmpty) {\r\n            var type = propTypes[prop.type] || {};\r\n\r\n            if (value == null) {\r\n                return (allowEmpty || !prop.def) ? null : prop.def;\r\n            }\r\n\r\n            // ~~ is an short way of doing floor for positive numbers\r\n            value = type.floor ? ~~value : parseFloat(value);\r\n\r\n            // IE will pass in empty strings as value for alpha,\r\n            // which will hit this case\r\n            if (isNaN(value)) {\r\n                return prop.def;\r\n            }\r\n\r\n            if (type.mod) {\r\n                // we add mod before modding to make sure that negatives values\r\n                // get converted properly: -10 -> 350\r\n                return (value + type.mod) % type.mod;\r\n            }\r\n\r\n            // for now all property types without mod have min and max\r\n            return 0 > value ? 0 : type.max < value ? type.max : value;\r\n        }\r\n\r\n        function stringParse(string) {\r\n            var inst = color(),\r\n                rgba = inst._rgba = [];\r\n\r\n            string = string.toLowerCase();\r\n\r\n            each(stringParsers, function (i, parser) {\r\n                var parsed,\r\n                    match = parser.re.exec(string),\r\n                    values = match && parser.parse(match),\r\n                    spaceName = parser.space || \"rgba\";\r\n\r\n                if (values) {\r\n                    parsed = inst[spaceName](values);\r\n\r\n                    // if this was an rgba parse the assignment might happen twice\r\n                    // oh well....\r\n                    inst[spaces[spaceName].cache] = parsed[spaces[spaceName].cache];\r\n                    rgba = inst._rgba = parsed._rgba;\r\n\r\n                    // exit each( stringParsers ) here because we matched\r\n                    return false;\r\n                }\r\n            });\r\n\r\n            // Found a stringParser that handled it\r\n            if (rgba.length) {\r\n\r\n                // if this came from a parsed string, force \"transparent\" when alpha is 0\r\n                // chrome, (and maybe others) return \"transparent\" as rgba(0,0,0,0)\r\n                if (rgba.join() === \"0,0,0,0\") {\r\n                    jQuery.extend(rgba, colors.transparent);\r\n                }\r\n                return inst;\r\n            }\r\n\r\n            // named colors\r\n            return colors[string];\r\n        }\r\n\r\n        color.fn = jQuery.extend(color.prototype, {\r\n            parse: function (red, green, blue, alpha) {\r\n                if (red === undefined) {\r\n                    this._rgba = [null, null, null, null];\r\n                    return this;\r\n                }\r\n                if (red.jquery || red.nodeType) {\r\n                    red = jQuery(red).css(green);\r\n                    green = undefined;\r\n                }\r\n\r\n                var inst = this,\r\n                    type = jQuery.type(red),\r\n                    rgba = this._rgba = [];\r\n\r\n                // more than 1 argument specified - assume ( red, green, blue, alpha )\r\n                if (green !== undefined) {\r\n                    red = [red, green, blue, alpha];\r\n                    type = \"array\";\r\n                }\r\n\r\n                if (type === \"string\") {\r\n                    return this.parse(stringParse(red) || colors._default);\r\n                }\r\n\r\n                if (type === \"array\") {\r\n                    each(spaces.rgba.props, function (key, prop) {\r\n                        rgba[prop.idx] = clamp(red[prop.idx], prop);\r\n                    });\r\n                    return this;\r\n                }\r\n\r\n                if (type === \"object\") {\r\n                    if (red instanceof color) {\r\n                        each(spaces, function (spaceName, space) {\r\n                            if (red[space.cache]) {\r\n                                inst[space.cache] = red[space.cache].slice();\r\n                            }\r\n                        });\r\n                    } else {\r\n                        each(spaces, function (spaceName, space) {\r\n                            var cache = space.cache;\r\n                            each(space.props, function (key, prop) {\r\n\r\n                                // if the cache doesn't exist, and we know how to convert\r\n                                if (!inst[cache] && space.to) {\r\n\r\n                                    // if the value was null, we don't need to copy it\r\n                                    // if the key was alpha, we don't need to copy it either\r\n                                    if (key === \"alpha\" || red[key] == null) {\r\n                                        return;\r\n                                    }\r\n                                    inst[cache] = space.to(inst._rgba);\r\n                                }\r\n\r\n                                // this is the only case where we allow nulls for ALL properties.\r\n                                // call clamp with alwaysAllowEmpty\r\n                                inst[cache][prop.idx] = clamp(red[key], prop, true);\r\n                            });\r\n\r\n                            // everything defined but alpha?\r\n                            if (inst[cache] && jQuery.inArray(null, inst[cache].slice(0, 3)) < 0) {\r\n                                // use the default of 1\r\n                                inst[cache][3] = 1;\r\n                                if (space.from) {\r\n                                    inst._rgba = space.from(inst[cache]);\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                    return this;\r\n                }\r\n            },\r\n            is: function (compare) {\r\n                var is = color(compare),\r\n                    same = true,\r\n                    inst = this;\r\n\r\n                each(spaces, function (_, space) {\r\n                    var localCache,\r\n                        isCache = is[space.cache];\r\n                    if (isCache) {\r\n                        localCache = inst[space.cache] || space.to && space.to(inst._rgba) || [];\r\n                        each(space.props, function (_, prop) {\r\n                            if (isCache[prop.idx] != null) {\r\n                                same = (isCache[prop.idx] === localCache[prop.idx]);\r\n                                return same;\r\n                            }\r\n                        });\r\n                    }\r\n                    return same;\r\n                });\r\n                return same;\r\n            },\r\n            _space: function () {\r\n                var used = [],\r\n                    inst = this;\r\n                each(spaces, function (spaceName, space) {\r\n                    if (inst[space.cache]) {\r\n                        used.push(spaceName);\r\n                    }\r\n                });\r\n                return used.pop();\r\n            },\r\n            transition: function (other, distance) {\r\n                var end = color(other),\r\n                    spaceName = end._space(),\r\n                    space = spaces[spaceName],\r\n                    startColor = this.alpha() === 0 ? color(\"transparent\") : this,\r\n                    start = startColor[space.cache] || space.to(startColor._rgba),\r\n                    result = start.slice();\r\n\r\n                end = end[space.cache];\r\n                each(space.props, function (key, prop) {\r\n                    var index = prop.idx,\r\n                        startValue = start[index],\r\n                        endValue = end[index],\r\n                        type = propTypes[prop.type] || {};\r\n\r\n                    // if null, don't override start value\r\n                    if (endValue === null) {\r\n                        return;\r\n                    }\r\n                    // if null - use end\r\n                    if (startValue === null) {\r\n                        result[index] = endValue;\r\n                    } else {\r\n                        if (type.mod) {\r\n                            if (endValue - startValue > type.mod / 2) {\r\n                                startValue += type.mod;\r\n                            } else if (startValue - endValue > type.mod / 2) {\r\n                                startValue -= type.mod;\r\n                            }\r\n                        }\r\n                        result[index] = clamp((endValue - startValue) * distance + startValue, prop);\r\n                    }\r\n                });\r\n                return this[spaceName](result);\r\n            },\r\n            blend: function (opaque) {\r\n                // if we are already opaque - return ourself\r\n                if (this._rgba[3] === 1) {\r\n                    return this;\r\n                }\r\n\r\n                var rgb = this._rgba.slice(),\r\n                    a = rgb.pop(),\r\n                    blend = color(opaque)._rgba;\r\n\r\n                return color(jQuery.map(rgb, function (v, i) {\r\n                    return (1 - a) * blend[i] + a * v;\r\n                }));\r\n            },\r\n            toRgbaString: function () {\r\n                var prefix = \"rgba(\",\r\n                    rgba = jQuery.map(this._rgba, function (v, i) {\r\n                        return v == null ? (i > 2 ? 1 : 0) : v;\r\n                    });\r\n\r\n                if (rgba[3] === 1) {\r\n                    rgba.pop();\r\n                    prefix = \"rgb(\";\r\n                }\r\n\r\n                return prefix + rgba.join() + \")\";\r\n            },\r\n            toHslaString: function () {\r\n                var prefix = \"hsla(\",\r\n                    hsla = jQuery.map(this.hsla(), function (v, i) {\r\n                        if (v == null) {\r\n                            v = i > 2 ? 1 : 0;\r\n                        }\r\n\r\n                        // catch 1 and 2\r\n                        if (i && i < 3) {\r\n                            v = Math.round(v * 100) + \"%\";\r\n                        }\r\n                        return v;\r\n                    });\r\n\r\n                if (hsla[3] === 1) {\r\n                    hsla.pop();\r\n                    prefix = \"hsl(\";\r\n                }\r\n                return prefix + hsla.join() + \")\";\r\n            },\r\n            toHexString: function (includeAlpha) {\r\n                var rgba = this._rgba.slice(),\r\n                    alpha = rgba.pop();\r\n\r\n                if (includeAlpha) {\r\n                    rgba.push(~~(alpha * 255));\r\n                }\r\n\r\n                return \"#\" + jQuery.map(rgba, function (v) {\r\n\r\n                    // default to 0 when nulls exist\r\n                    v = (v || 0).toString(16);\r\n                    return v.length === 1 ? \"0\" + v : v;\r\n                }).join(\"\");\r\n            },\r\n            toString: function () {\r\n                return this._rgba[3] === 0 ? \"transparent\" : this.toRgbaString();\r\n            }\r\n        });\r\n        color.fn.parse.prototype = color.fn;\r\n\r\n// hsla conversions adapted from:\r\n// https://code.google.com/p/maashaack/source/browse/packages/graphics/trunk/src/graphics/colors/HUE2RGB.as?r=5021\r\n\r\n        function hue2rgb(p, q, h) {\r\n            h = (h + 1) % 1;\r\n            if (h * 6 < 1) {\r\n                return p + (q - p) * h * 6;\r\n            }\r\n            if (h * 2 < 1) {\r\n                return q;\r\n            }\r\n            if (h * 3 < 2) {\r\n                return p + (q - p) * ((2 / 3) - h) * 6;\r\n            }\r\n            return p;\r\n        }\r\n\r\n        spaces.hsla.to = function (rgba) {\r\n            if (rgba[0] == null || rgba[1] == null || rgba[2] == null) {\r\n                return [null, null, null, rgba[3]];\r\n            }\r\n            var r = rgba[0] / 255,\r\n                g = rgba[1] / 255,\r\n                b = rgba[2] / 255,\r\n                a = rgba[3],\r\n                max = Math.max(r, g, b),\r\n                min = Math.min(r, g, b),\r\n                diff = max - min,\r\n                add = max + min,\r\n                l = add * 0.5,\r\n                h, s;\r\n\r\n            if (min === max) {\r\n                h = 0;\r\n            } else if (r === max) {\r\n                h = (60 * (g - b) / diff) + 360;\r\n            } else if (g === max) {\r\n                h = (60 * (b - r) / diff) + 120;\r\n            } else {\r\n                h = (60 * (r - g) / diff) + 240;\r\n            }\r\n\r\n            // chroma (diff) == 0 means greyscale which, by definition, saturation = 0%\r\n            // otherwise, saturation is based on the ratio of chroma (diff) to lightness (add)\r\n            if (diff === 0) {\r\n                s = 0;\r\n            } else if (l <= 0.5) {\r\n                s = diff / add;\r\n            } else {\r\n                s = diff / (2 - add);\r\n            }\r\n            return [Math.round(h) % 360, s, l, a == null ? 1 : a];\r\n        };\r\n\r\n        spaces.hsla.from = function (hsla) {\r\n            if (hsla[0] == null || hsla[1] == null || hsla[2] == null) {\r\n                return [null, null, null, hsla[3]];\r\n            }\r\n            var h = hsla[0] / 360,\r\n                s = hsla[1],\r\n                l = hsla[2],\r\n                a = hsla[3],\r\n                q = l <= 0.5 ? l * (1 + s) : l + s - l * s,\r\n                p = 2 * l - q;\r\n\r\n            return [\r\n                Math.round(hue2rgb(p, q, h + (1 / 3)) * 255),\r\n                Math.round(hue2rgb(p, q, h) * 255),\r\n                Math.round(hue2rgb(p, q, h - (1 / 3)) * 255),\r\n                a\r\n            ];\r\n        };\r\n\r\n\r\n        each(spaces, function (spaceName, space) {\r\n            var props = space.props,\r\n                cache = space.cache,\r\n                to = space.to,\r\n                from = space.from;\r\n\r\n            // makes rgba() and hsla()\r\n            color.fn[spaceName] = function (value) {\r\n\r\n                // generate a cache for this space if it doesn't exist\r\n                if (to && !this[cache]) {\r\n                    this[cache] = to(this._rgba);\r\n                }\r\n                if (value === undefined) {\r\n                    return this[cache].slice();\r\n                }\r\n\r\n                var ret,\r\n                    type = jQuery.type(value),\r\n                    arr = (type === \"array\" || type === \"object\") ? value : arguments,\r\n                    local = this[cache].slice();\r\n\r\n                each(props, function (key, prop) {\r\n                    var val = arr[type === \"object\" ? key : prop.idx];\r\n                    if (val == null) {\r\n                        val = local[prop.idx];\r\n                    }\r\n                    local[prop.idx] = clamp(val, prop);\r\n                });\r\n\r\n                if (from) {\r\n                    ret = color(from(local));\r\n                    ret[cache] = local;\r\n                    return ret;\r\n                } else {\r\n                    return color(local);\r\n                }\r\n            };\r\n\r\n            // makes red() green() blue() alpha() hue() saturation() lightness()\r\n            each(props, function (key, prop) {\r\n                // alpha is included in more than one space\r\n                if (color.fn[key]) {\r\n                    return;\r\n                }\r\n                color.fn[key] = function (value) {\r\n                    var vtype = jQuery.type(value),\r\n                        fn = (key === \"alpha\" ? (this._hsla ? \"hsla\" : \"rgba\") : spaceName),\r\n                        local = this[fn](),\r\n                        cur = local[prop.idx],\r\n                        match;\r\n\r\n                    if (vtype === \"undefined\") {\r\n                        return cur;\r\n                    }\r\n\r\n                    if (vtype === \"function\") {\r\n                        value = value.call(this, cur);\r\n                        vtype = jQuery.type(value);\r\n                    }\r\n                    if (value == null && prop.empty) {\r\n                        return this;\r\n                    }\r\n                    if (vtype === \"string\") {\r\n                        match = rplusequals.exec(value);\r\n                        if (match) {\r\n                            value = cur + parseFloat(match[2]) * (match[1] === \"+\" ? 1 : -1);\r\n                        }\r\n                    }\r\n                    local[prop.idx] = value;\r\n                    return this[fn](local);\r\n                };\r\n            });\r\n        });\r\n\r\n// add cssHook and .fx.step function for each named hook.\r\n// accept a space separated string of properties\r\n        color.hook = function (hook) {\r\n            var hooks = hook.split(\" \");\r\n            each(hooks, function (i, hook) {\r\n                jQuery.cssHooks[hook] = {\r\n                    set: function (elem, value) {\r\n                        var parsed, curElem,\r\n                            backgroundColor = \"\";\r\n\r\n                        if (value !== \"transparent\" && (jQuery.type(value) !== \"string\" || (parsed = stringParse(value)))) {\r\n                            value = color(parsed || value);\r\n                            if (!support.rgba && value._rgba[3] !== 1) {\r\n                                curElem = hook === \"backgroundColor\" ? elem.parentNode : elem;\r\n                                while (\r\n                                    (backgroundColor === \"\" || backgroundColor === \"transparent\") &&\r\n                                    curElem && curElem.style\r\n                                    ) {\r\n                                    try {\r\n                                        backgroundColor = jQuery.css(curElem, \"backgroundColor\");\r\n                                        curElem = curElem.parentNode;\r\n                                    } catch (e) {\r\n                                    }\r\n                                }\r\n\r\n                                value = value.blend(backgroundColor && backgroundColor !== \"transparent\" ?\r\n                                    backgroundColor :\r\n                                    \"_default\");\r\n                            }\r\n\r\n                            value = value.toRgbaString();\r\n                        }\r\n                        try {\r\n                            elem.style[hook] = value;\r\n                        } catch (e) {\r\n                            // wrapped to prevent IE from throwing errors on \"invalid\" values like 'auto' or 'inherit'\r\n                        }\r\n                    }\r\n                };\r\n                jQuery.fx.step[hook] = function (fx) {\r\n                    if (!fx.colorInit) {\r\n                        fx.start = color(fx.elem, hook);\r\n                        fx.end = color(fx.end);\r\n                        fx.colorInit = true;\r\n                    }\r\n                    jQuery.cssHooks[hook].set(fx.elem, fx.start.transition(fx.end, fx.pos));\r\n                };\r\n            });\r\n\r\n        };\r\n\r\n        color.hook(stepHooks);\r\n\r\n        jQuery.cssHooks.borderColor = {\r\n            expand: function (value) {\r\n                var expanded = {};\r\n\r\n                each([\"Top\", \"Right\", \"Bottom\", \"Left\"], function (i, part) {\r\n                    expanded[\"border\" + part + \"Color\"] = value;\r\n                });\r\n                return expanded;\r\n            }\r\n        };\r\n\r\n// Basic color names only.\r\n// Usage of any of the other color names requires adding yourself or including\r\n// jquery.color.svg-names.js.\r\n        colors = jQuery.Color.names = {\r\n            // 4.1. Basic color keywords\r\n            aqua: \"#00ffff\",\r\n            black: \"#000000\",\r\n            blue: \"#0000ff\",\r\n            fuchsia: \"#ff00ff\",\r\n            gray: \"#808080\",\r\n            green: \"#008000\",\r\n            lime: \"#00ff00\",\r\n            maroon: \"#800000\",\r\n            navy: \"#000080\",\r\n            olive: \"#808000\",\r\n            purple: \"#800080\",\r\n            red: \"#ff0000\",\r\n            silver: \"#c0c0c0\",\r\n            teal: \"#008080\",\r\n            white: \"#ffffff\",\r\n            yellow: \"#ffff00\",\r\n\r\n            // 4.2.3. \"transparent\" color keyword\r\n            transparent: [null, null, null, 0],\r\n\r\n            _default: \"#ffffff\"\r\n        };\r\n\r\n    })(jQuery);\r\n\r\n\r\n    /******************************************************************************/\r\n    /****************************** CLASS ANIMATIONS ******************************/\r\n    /******************************************************************************/\r\n    (function () {\r\n\r\n        var classAnimationActions = [\"add\", \"remove\", \"toggle\"],\r\n            shorthandStyles = {\r\n                border: 1,\r\n                borderBottom: 1,\r\n                borderColor: 1,\r\n                borderLeft: 1,\r\n                borderRight: 1,\r\n                borderTop: 1,\r\n                borderWidth: 1,\r\n                margin: 1,\r\n                padding: 1\r\n            };\r\n\r\n        $.each([\"borderLeftStyle\", \"borderRightStyle\", \"borderBottomStyle\", \"borderTopStyle\"], function (_, prop) {\r\n            $.fx.step[prop] = function (fx) {\r\n                if (fx.end !== \"none\" && !fx.setAttr || fx.pos === 1 && !fx.setAttr) {\r\n                    jQuery.style(fx.elem, prop, fx.end);\r\n                    fx.setAttr = true;\r\n                }\r\n            };\r\n        });\r\n\r\n        function getElementStyles(elem) {\r\n            var key, len,\r\n                style = elem.ownerDocument.defaultView ?\r\n                    elem.ownerDocument.defaultView.getComputedStyle(elem, null) :\r\n                    elem.currentStyle,\r\n                styles = {};\r\n\r\n            if (style && style.length && style[0] && style[style[0]]) {\r\n                len = style.length;\r\n                while (len--) {\r\n                    key = style[len];\r\n                    if (typeof style[key] === \"string\") {\r\n                        styles[$.camelCase(key)] = style[key];\r\n                    }\r\n                }\r\n                // support: Opera, IE <9\r\n            } else {\r\n                for (key in style) {\r\n                    if (typeof style[key] === \"string\") {\r\n                        styles[key] = style[key];\r\n                    }\r\n                }\r\n            }\r\n\r\n            return styles;\r\n        }\r\n\r\n\r\n        function styleDifference(oldStyle, newStyle) {\r\n            var diff = {},\r\n                name, value;\r\n\r\n            for (name in newStyle) {\r\n                value = newStyle[name];\r\n                if (oldStyle[name] !== value) {\r\n                    if (!shorthandStyles[name]) {\r\n                        if ($.fx.step[name] || !isNaN(parseFloat(value))) {\r\n                            diff[name] = value;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            return diff;\r\n        }\r\n\r\n// support: jQuery <1.8\r\n        if (!$.fn.addBack) {\r\n            $.fn.addBack = function (selector) {\r\n                return this.add(selector == null ?\r\n                    this.prevObject : this.prevObject.filter(selector)\r\n                );\r\n            };\r\n        }\r\n\r\n        $.effects.animateClass = function (value, duration, easing, callback) {\r\n            var o = $.speed(duration, easing, callback);\r\n\r\n            return this.queue(function () {\r\n                var animated = $(this),\r\n                    baseClass = animated.attr(\"class\") || \"\",\r\n                    applyClassChange,\r\n                    allAnimations = o.children ? animated.find(\"*\").addBack() : animated;\r\n\r\n                // map the animated objects to store the original styles.\r\n                allAnimations = allAnimations.map(function () {\r\n                    var el = $(this);\r\n                    return {\r\n                        el: el,\r\n                        start: getElementStyles(this)\r\n                    };\r\n                });\r\n\r\n                // apply class change\r\n                applyClassChange = function () {\r\n                    $.each(classAnimationActions, function (i, action) {\r\n                        if (value[action]) {\r\n                            animated[action + \"Class\"](value[action]);\r\n                        }\r\n                    });\r\n                };\r\n                applyClassChange();\r\n\r\n                // map all animated objects again - calculate new styles and diff\r\n                allAnimations = allAnimations.map(function () {\r\n                    this.end = getElementStyles(this.el[0]);\r\n                    this.diff = styleDifference(this.start, this.end);\r\n                    return this;\r\n                });\r\n\r\n                // apply original class\r\n                animated.attr(\"class\", baseClass);\r\n\r\n                // map all animated objects again - this time collecting a promise\r\n                allAnimations = allAnimations.map(function () {\r\n                    var styleInfo = this,\r\n                        dfd = $.Deferred(),\r\n                        opts = $.extend({}, o, {\r\n                            queue: false,\r\n                            complete: function () {\r\n                                dfd.resolve(styleInfo);\r\n                            }\r\n                        });\r\n\r\n                    this.el.animate(this.diff, opts);\r\n                    return dfd.promise();\r\n                });\r\n\r\n                // once all animations have completed:\r\n                $.when.apply($, allAnimations.get()).done(function () {\r\n\r\n                    // set the final class\r\n                    applyClassChange();\r\n\r\n                    // for each animated element,\r\n                    // clear all css properties that were animated\r\n                    $.each(arguments, function () {\r\n                        var el = this.el;\r\n                        $.each(this.diff, function (key) {\r\n                            el.css(key, \"\");\r\n                        });\r\n                    });\r\n\r\n                    // this is guarnteed to be there if you use jQuery.speed()\r\n                    // it also handles dequeuing the next anim...\r\n                    o.complete.call(animated[0]);\r\n                });\r\n            });\r\n        };\r\n\r\n        $.fn.extend({\r\n            addClass: (function (orig) {\r\n                return function (classNames, speed, easing, callback) {\r\n                    return speed ?\r\n                        $.effects.animateClass.call(this,\r\n                            {add: classNames}, speed, easing, callback) :\r\n                        orig.apply(this, arguments);\r\n                };\r\n            })($.fn.addClass),\r\n\r\n            removeClass: (function (orig) {\r\n                return function (classNames, speed, easing, callback) {\r\n                    return arguments.length > 1 ?\r\n                        $.effects.animateClass.call(this,\r\n                            {remove: classNames}, speed, easing, callback) :\r\n                        orig.apply(this, arguments);\r\n                };\r\n            })($.fn.removeClass),\r\n\r\n            toggleClass: (function (orig) {\r\n                return function (classNames, force, speed, easing, callback) {\r\n                    if (typeof force === \"boolean\" || force === undefined) {\r\n                        if (!speed) {\r\n                            // without speed parameter\r\n                            return orig.apply(this, arguments);\r\n                        } else {\r\n                            return $.effects.animateClass.call(this,\r\n                                (force ? {add: classNames} : {remove: classNames}),\r\n                                speed, easing, callback);\r\n                        }\r\n                    } else {\r\n                        // without force parameter\r\n                        return $.effects.animateClass.call(this,\r\n                            {toggle: classNames}, force, speed, easing);\r\n                    }\r\n                };\r\n            })($.fn.toggleClass),\r\n\r\n            switchClass: function (remove, add, speed, easing, callback) {\r\n                return $.effects.animateClass.call(this, {\r\n                    add: add,\r\n                    remove: remove\r\n                }, speed, easing, callback);\r\n            }\r\n        });\r\n\r\n    })();\r\n\r\n    /******************************************************************************/\r\n    /*********************************** EFFECTS **********************************/\r\n    /******************************************************************************/\r\n\r\n    (function () {\r\n\r\n        $.extend($.effects, {\r\n            version: \"1.10.4\",\r\n\r\n            // Saves a set of properties in a data storage\r\n            save: function (element, set) {\r\n                for (var i = 0; i < set.length; i++) {\r\n                    if (set[i] !== null) {\r\n                        element.data(dataSpace + set[i], element[0].style[set[i]]);\r\n                    }\r\n                }\r\n            },\r\n\r\n            // Restores a set of previously saved properties from a data storage\r\n            restore: function (element, set) {\r\n                var val, i;\r\n                for (i = 0; i < set.length; i++) {\r\n                    if (set[i] !== null) {\r\n                        val = element.data(dataSpace + set[i]);\r\n                        // support: jQuery 1.6.2\r\n                        // http://bugs.jquery.com/ticket/9917\r\n                        // jQuery 1.6.2 incorrectly returns undefined for any falsy value.\r\n                        // We can't differentiate between \"\" and 0 here, so we just assume\r\n                        // empty string since it's likely to be a more common value...\r\n                        if (val === undefined) {\r\n                            val = \"\";\r\n                        }\r\n                        element.css(set[i], val);\r\n                    }\r\n                }\r\n            },\r\n\r\n            setMode: function (el, mode) {\r\n                if (mode === \"toggle\") {\r\n                    mode = el.is(\":hidden\") ? \"show\" : \"hide\";\r\n                }\r\n                return mode;\r\n            },\r\n\r\n            // Translates a [top,left] array into a baseline value\r\n            // this should be a little more flexible in the future to handle a string & hash\r\n            getBaseline: function (origin, original) {\r\n                var y, x;\r\n                switch (origin[0]) {\r\n                    case \"top\":\r\n                        y = 0;\r\n                        break;\r\n                    case \"middle\":\r\n                        y = 0.5;\r\n                        break;\r\n                    case \"bottom\":\r\n                        y = 1;\r\n                        break;\r\n                    default:\r\n                        y = origin[0] / original.height;\r\n                }\r\n                switch (origin[1]) {\r\n                    case \"left\":\r\n                        x = 0;\r\n                        break;\r\n                    case \"center\":\r\n                        x = 0.5;\r\n                        break;\r\n                    case \"right\":\r\n                        x = 1;\r\n                        break;\r\n                    default:\r\n                        x = origin[1] / original.width;\r\n                }\r\n                return {\r\n                    x: x,\r\n                    y: y\r\n                };\r\n            },\r\n\r\n            // Wraps the element around a wrapper that copies position properties\r\n            createWrapper: function (element) {\r\n\r\n                // if the element is already wrapped, return it\r\n                if (element.parent().is(\".ui-effects-wrapper\")) {\r\n                    return element.parent();\r\n                }\r\n\r\n                // wrap the element\r\n                var props = {\r\n                        width: element.outerWidth(true),\r\n                        height: element.outerHeight(true),\r\n                        \"float\": element.css(\"float\")\r\n                    },\r\n                    wrapper = $(\"<div></div>\")\r\n                        .addClass(\"ui-effects-wrapper\")\r\n                        .css({\r\n                            fontSize: \"100%\",\r\n                            background: \"transparent\",\r\n                            border: \"none\",\r\n                            margin: 0,\r\n                            padding: 0\r\n                        }),\r\n                    // Store the size in case width/height are defined in % - Fixes #5245\r\n                    size = {\r\n                        width: element.width(),\r\n                        height: element.height()\r\n                    },\r\n                    active = document.activeElement;\r\n\r\n                // support: Firefox\r\n                // Firefox incorrectly exposes anonymous content\r\n                // https://bugzilla.mozilla.org/show_bug.cgi?id=561664\r\n                try {\r\n                    active.id;\r\n                } catch (e) {\r\n                    active = document.body;\r\n                }\r\n\r\n                element.wrap(wrapper);\r\n\r\n                // Fixes #7595 - Elements lose focus when wrapped.\r\n                if (element[0] === active || $.contains(element[0], active)) {\r\n                    $(active).focus();\r\n                }\r\n\r\n                wrapper = element.parent(); //Hotfix for jQuery 1.4 since some change in wrap() seems to actually lose the reference to the wrapped element\r\n\r\n                // transfer positioning properties to the wrapper\r\n                if (element.css(\"position\") === \"static\") {\r\n                    wrapper.css({position: \"relative\"});\r\n                    element.css({position: \"relative\"});\r\n                } else {\r\n                    $.extend(props, {\r\n                        position: element.css(\"position\"),\r\n                        zIndex: element.css(\"z-index\")\r\n                    });\r\n                    $.each([\"top\", \"left\", \"bottom\", \"right\"], function (i, pos) {\r\n                        props[pos] = element.css(pos);\r\n                        if (isNaN(parseInt(props[pos], 10))) {\r\n                            props[pos] = \"auto\";\r\n                        }\r\n                    });\r\n                    element.css({\r\n                        position: \"relative\",\r\n                        top: 0,\r\n                        left: 0,\r\n                        right: \"auto\",\r\n                        bottom: \"auto\"\r\n                    });\r\n                }\r\n                element.css(size);\r\n\r\n                return wrapper.css(props).show();\r\n            },\r\n\r\n            removeWrapper: function (element) {\r\n                var active = document.activeElement;\r\n\r\n                if (element.parent().is(\".ui-effects-wrapper\")) {\r\n                    element.parent().replaceWith(element);\r\n\r\n                    // Fixes #7595 - Elements lose focus when wrapped.\r\n                    if (element[0] === active || $.contains(element[0], active)) {\r\n                        $(active).focus();\r\n                    }\r\n                }\r\n\r\n\r\n                return element;\r\n            },\r\n\r\n            setTransition: function (element, list, factor, value) {\r\n                value = value || {};\r\n                $.each(list, function (i, x) {\r\n                    var unit = element.cssUnit(x);\r\n                    if (unit[0] > 0) {\r\n                        value[x] = unit[0] * factor + unit[1];\r\n                    }\r\n                });\r\n                return value;\r\n            }\r\n        });\r\n\r\n// return an effect options object for the given parameters:\r\n        function _normalizeArguments(effect, options, speed, callback) {\r\n\r\n            // allow passing all options as the first parameter\r\n            if ($.isPlainObject(effect)) {\r\n                options = effect;\r\n                effect = effect.effect;\r\n            }\r\n\r\n            // convert to an object\r\n            effect = {effect: effect};\r\n\r\n            // catch (effect, null, ...)\r\n            if (options == null) {\r\n                options = {};\r\n            }\r\n\r\n            // catch (effect, callback)\r\n            if ($.isFunction(options)) {\r\n                callback = options;\r\n                speed = null;\r\n                options = {};\r\n            }\r\n\r\n            // catch (effect, speed, ?)\r\n            if (typeof options === \"number\" || $.fx.speeds[options]) {\r\n                callback = speed;\r\n                speed = options;\r\n                options = {};\r\n            }\r\n\r\n            // catch (effect, options, callback)\r\n            if ($.isFunction(speed)) {\r\n                callback = speed;\r\n                speed = null;\r\n            }\r\n\r\n            // add options to effect\r\n            if (options) {\r\n                $.extend(effect, options);\r\n            }\r\n\r\n            speed = speed || options.duration;\r\n            effect.duration = $.fx.off ? 0 :\r\n                typeof speed === \"number\" ? speed :\r\n                    speed in $.fx.speeds ? $.fx.speeds[speed] :\r\n                        $.fx.speeds._default;\r\n\r\n            effect.complete = callback || options.complete;\r\n\r\n            return effect;\r\n        }\r\n\r\n        function standardAnimationOption(option) {\r\n            // Valid standard speeds (nothing, number, named speed)\r\n            if (!option || typeof option === \"number\" || $.fx.speeds[option]) {\r\n                return true;\r\n            }\r\n\r\n            // Invalid strings - treat as \"normal\" speed\r\n            if (typeof option === \"string\" && !$.effects.effect[option]) {\r\n                return true;\r\n            }\r\n\r\n            // Complete callback\r\n            if ($.isFunction(option)) {\r\n                return true;\r\n            }\r\n\r\n            // Options hash (but not naming an effect)\r\n            if (typeof option === \"object\" && !option.effect) {\r\n                return true;\r\n            }\r\n\r\n            // Didn't match any standard API\r\n            return false;\r\n        }\r\n\r\n        $.fn.extend({\r\n            effect: function ( /* effect, options, speed, callback */) {\r\n                var args = _normalizeArguments.apply(this, arguments),\r\n                    mode = args.mode,\r\n                    queue = args.queue,\r\n                    effectMethod = $.effects.effect[args.effect];\r\n\r\n                if ($.fx.off || !effectMethod) {\r\n                    // delegate to the original method (e.g., .show()) if possible\r\n                    if (mode) {\r\n                        return this[mode](args.duration, args.complete);\r\n                    } else {\r\n                        return this.each(function () {\r\n                            if (args.complete) {\r\n                                args.complete.call(this);\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n\r\n                function run(next) {\r\n                    var elem = $(this),\r\n                        complete = args.complete,\r\n                        mode = args.mode;\r\n\r\n                    function done() {\r\n                        if ($.isFunction(complete)) {\r\n                            complete.call(elem[0]);\r\n                        }\r\n                        if ($.isFunction(next)) {\r\n                            next();\r\n                        }\r\n                    }\r\n\r\n                    // If the element already has the correct final state, delegate to\r\n                    // the core methods so the internal tracking of \"olddisplay\" works.\r\n                    if (elem.is(\":hidden\") ? mode === \"hide\" : mode === \"show\") {\r\n                        elem[mode]();\r\n                        done();\r\n                    } else {\r\n                        effectMethod.call(elem[0], args, done);\r\n                    }\r\n                }\r\n\r\n                return queue === false ? this.each(run) : this.queue(queue || \"fx\", run);\r\n            },\r\n\r\n            show: (function (orig) {\r\n                return function (option) {\r\n                    if (standardAnimationOption(option)) {\r\n                        return orig.apply(this, arguments);\r\n                    } else {\r\n                        var args = _normalizeArguments.apply(this, arguments);\r\n                        args.mode = \"show\";\r\n                        return this.effect.call(this, args);\r\n                    }\r\n                };\r\n            })($.fn.show),\r\n\r\n            hide: (function (orig) {\r\n                return function (option) {\r\n                    if (standardAnimationOption(option)) {\r\n                        return orig.apply(this, arguments);\r\n                    } else {\r\n                        var args = _normalizeArguments.apply(this, arguments);\r\n                        args.mode = \"hide\";\r\n                        return this.effect.call(this, args);\r\n                    }\r\n                };\r\n            })($.fn.hide),\r\n\r\n            toggle: (function (orig) {\r\n                return function (option) {\r\n                    if (standardAnimationOption(option) || typeof option === \"boolean\") {\r\n                        return orig.apply(this, arguments);\r\n                    } else {\r\n                        var args = _normalizeArguments.apply(this, arguments);\r\n                        args.mode = \"toggle\";\r\n                        return this.effect.call(this, args);\r\n                    }\r\n                };\r\n            })($.fn.toggle),\r\n\r\n            // helper functions\r\n            cssUnit: function (key) {\r\n                var style = this.css(key),\r\n                    val = [];\r\n\r\n                $.each([\"em\", \"px\", \"%\", \"pt\"], function (i, unit) {\r\n                    if (style.indexOf(unit) > 0) {\r\n                        val = [parseFloat(style), unit];\r\n                    }\r\n                });\r\n                return val;\r\n            }\r\n        });\r\n\r\n    })();\r\n\r\n    /******************************************************************************/\r\n    /*********************************** EASING ***********************************/\r\n    /******************************************************************************/\r\n\r\n    (function () {\r\n\r\n// based on easing equations from Robert Penner (http://www.robertpenner.com/easing)\r\n\r\n        var baseEasings = {};\r\n\r\n        $.each([\"Quad\", \"Cubic\", \"Quart\", \"Quint\", \"Expo\"], function (i, name) {\r\n            baseEasings[name] = function (p) {\r\n                return Math.pow(p, i + 2);\r\n            };\r\n        });\r\n\r\n        $.extend(baseEasings, {\r\n            Sine: function (p) {\r\n                return 1 - Math.cos(p * Math.PI / 2);\r\n            },\r\n            Circ: function (p) {\r\n                return 1 - Math.sqrt(1 - p * p);\r\n            },\r\n            Elastic: function (p) {\r\n                return p === 0 || p === 1 ? p :\r\n                    -Math.pow(2, 8 * (p - 1)) * Math.sin(((p - 1) * 80 - 7.5) * Math.PI / 15);\r\n            },\r\n            Back: function (p) {\r\n                return p * p * (3 * p - 2);\r\n            },\r\n            Bounce: function (p) {\r\n                var pow2,\r\n                    bounce = 4;\r\n\r\n                while (p < ((pow2 = Math.pow(2, --bounce)) - 1) / 11) {\r\n                }\r\n                return 1 / Math.pow(4, 3 - bounce) - 7.5625 * Math.pow((pow2 * 3 - 2) / 22 - p, 2);\r\n            }\r\n        });\r\n\r\n        $.each(baseEasings, function (name, easeIn) {\r\n            $.easing[\"easeIn\" + name] = easeIn;\r\n            $.easing[\"easeOut\" + name] = function (p) {\r\n                return 1 - easeIn(1 - p);\r\n            };\r\n            $.easing[\"easeInOut\" + name] = function (p) {\r\n                return p < 0.5 ?\r\n                    easeIn(p * 2) / 2 :\r\n                    1 - easeIn(p * -2 + 2) / 2;\r\n            };\r\n        });\r\n\r\n    })();\r\n\r\n});\r\n","jquery/ui-modules/menu.js":"/*!\r\n * jQuery UI Menu - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/menu/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/core',\r\n    'jquery-ui-modules/widget',\r\n    'jquery-ui-modules/position'\r\n], function ($, undefined) {\r\n\r\n    $.widget(\"ui.menu\", {\r\n        version: \"1.10.4\",\r\n        defaultElement: \"<ul>\",\r\n        delay: 300,\r\n        options: {\r\n            icons: {\r\n                submenu: \"ui-icon-carat-1-e\"\r\n            },\r\n            menus: \"ul\",\r\n            position: {\r\n                my: \"left top\",\r\n                at: \"right top\"\r\n            },\r\n            role: \"menu\",\r\n\r\n            // callbacks\r\n            blur: null,\r\n            focus: null,\r\n            select: null\r\n        },\r\n\r\n        _create: function () {\r\n            this.activeMenu = this.element;\r\n            // flag used to prevent firing of the click handler\r\n            // as the event bubbles up through nested menus\r\n            this.mouseHandled = false;\r\n            this.element\r\n                .uniqueId()\r\n                .addClass(\"ui-menu ui-widget ui-widget-content ui-corner-all\")\r\n                .toggleClass(\"ui-menu-icons\", !!this.element.find(\".ui-icon\").length)\r\n                .attr({\r\n                    role: this.options.role,\r\n                    tabIndex: 0\r\n                })\r\n                // need to catch all clicks on disabled menu\r\n                // not possible through _on\r\n                .bind(\"click\" + this.eventNamespace, $.proxy(function (event) {\r\n                    if (this.options.disabled) {\r\n                        event.preventDefault();\r\n                    }\r\n                }, this));\r\n\r\n            if (this.options.disabled) {\r\n                this.element\r\n                    .addClass(\"ui-state-disabled\")\r\n                    .attr(\"aria-disabled\", \"true\");\r\n            }\r\n\r\n            this._on({\r\n                // Prevent focus from sticking to links inside menu after clicking\r\n                // them (focus should always stay on UL during navigation).\r\n                \"mousedown .ui-menu-item > a\": function (event) {\r\n                    event.preventDefault();\r\n                },\r\n                \"click .ui-state-disabled > a\": function (event) {\r\n                    event.preventDefault();\r\n                },\r\n                \"click .ui-menu-item:has(a)\": function (event) {\r\n                    var target = $(event.target).closest(\".ui-menu-item\");\r\n                    if (!this.mouseHandled && target.not(\".ui-state-disabled\").length) {\r\n                        this.select(event);\r\n\r\n                        // Only set the mouseHandled flag if the event will bubble, see #9469.\r\n                        if (!event.isPropagationStopped()) {\r\n                            this.mouseHandled = true;\r\n                        }\r\n\r\n                        // Open submenu on click\r\n                        if (target.has(\".ui-menu\").length) {\r\n                            this.expand(event);\r\n                        } else if (!this.element.is(\":focus\") && $(this.document[0].activeElement).closest(\".ui-menu\").length) {\r\n\r\n                            // Redirect focus to the menu\r\n                            this.element.trigger(\"focus\", [true]);\r\n\r\n                            // If the active item is on the top level, let it stay active.\r\n                            // Otherwise, blur the active item since it is no longer visible.\r\n                            if (this.active && this.active.parents(\".ui-menu\").length === 1) {\r\n                                clearTimeout(this.timer);\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                \"mouseenter .ui-menu-item\": function (event) {\r\n                    var target = $(event.currentTarget);\r\n                    // Remove ui-state-active class from siblings of the newly focused menu item\r\n                    // to avoid a jump caused by adjacent elements both having a class with a border\r\n                    target.siblings().children(\".ui-state-active\").removeClass(\"ui-state-active\");\r\n                    this.focus(event, target);\r\n                },\r\n                mouseleave: \"collapseAll\",\r\n                \"mouseleave .ui-menu\": \"collapseAll\",\r\n                focus: function (event, keepActiveItem) {\r\n                    // If there's already an active item, keep it active\r\n                    // If not, activate the first item\r\n                    var item = this.active || this.element.children(\".ui-menu-item\").eq(0);\r\n\r\n                    if (!keepActiveItem) {\r\n                        this.focus(event, item);\r\n                    }\r\n                },\r\n                blur: function (event) {\r\n                    this._delay(function () {\r\n                        if (!$.contains(this.element[0], this.document[0].activeElement)) {\r\n                            this.collapseAll(event);\r\n                        }\r\n                    });\r\n                },\r\n                keydown: \"_keydown\"\r\n            });\r\n\r\n            this.refresh();\r\n\r\n            // Clicks outside of a menu collapse any open menus\r\n            this._on(this.document, {\r\n                click: function (event) {\r\n                    if (!$(event.target).closest(\".ui-menu\").length) {\r\n                        this.collapseAll(event);\r\n                    }\r\n\r\n                    // Reset the mouseHandled flag\r\n                    this.mouseHandled = false;\r\n                }\r\n            });\r\n        },\r\n\r\n        _destroy: function () {\r\n            // Destroy (sub)menus\r\n            this.element\r\n                .removeAttr(\"aria-activedescendant\")\r\n                .find(\".ui-menu\").addBack()\r\n                .removeClass(\"ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons\")\r\n                .removeAttr(\"role\")\r\n                .removeAttr(\"tabIndex\")\r\n                .removeAttr(\"aria-labelledby\")\r\n                .removeAttr(\"aria-expanded\")\r\n                .removeAttr(\"aria-hidden\")\r\n                .removeAttr(\"aria-disabled\")\r\n                .removeUniqueId()\r\n                .show();\r\n\r\n            // Destroy menu items\r\n            this.element.find(\".ui-menu-item\")\r\n                .removeClass(\"ui-menu-item\")\r\n                .removeAttr(\"role\")\r\n                .removeAttr(\"aria-disabled\")\r\n                .children(\"a\")\r\n                .removeUniqueId()\r\n                .removeClass(\"ui-corner-all ui-state-hover\")\r\n                .removeAttr(\"tabIndex\")\r\n                .removeAttr(\"role\")\r\n                .removeAttr(\"aria-haspopup\")\r\n                .children().each(function () {\r\n                var elem = $(this);\r\n                if (elem.data(\"ui-menu-submenu-carat\")) {\r\n                    elem.remove();\r\n                }\r\n            });\r\n\r\n            // Destroy menu dividers\r\n            this.element.find(\".ui-menu-divider\").removeClass(\"ui-menu-divider ui-widget-content\");\r\n        },\r\n\r\n        _keydown: function (event) {\r\n            var match, prev, character, skip, regex,\r\n                preventDefault = true;\r\n\r\n            function escape(value) {\r\n                return value.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g, \"\\\\$&\");\r\n            }\r\n\r\n            switch (event.keyCode) {\r\n                case $.ui.keyCode.PAGE_UP:\r\n                    this.previousPage(event);\r\n                    break;\r\n                case $.ui.keyCode.PAGE_DOWN:\r\n                    this.nextPage(event);\r\n                    break;\r\n                case $.ui.keyCode.HOME:\r\n                    this._move(\"first\", \"first\", event);\r\n                    break;\r\n                case $.ui.keyCode.END:\r\n                    this._move(\"last\", \"last\", event);\r\n                    break;\r\n                case $.ui.keyCode.UP:\r\n                    this.previous(event);\r\n                    break;\r\n                case $.ui.keyCode.DOWN:\r\n                    this.next(event);\r\n                    break;\r\n                case $.ui.keyCode.LEFT:\r\n                    this.collapse(event);\r\n                    break;\r\n                case $.ui.keyCode.RIGHT:\r\n                    if (this.active && !this.active.is(\".ui-state-disabled\")) {\r\n                        this.expand(event);\r\n                    }\r\n                    break;\r\n                case $.ui.keyCode.ENTER:\r\n                case $.ui.keyCode.SPACE:\r\n                    this._activate(event);\r\n                    break;\r\n                case $.ui.keyCode.ESCAPE:\r\n                    this.collapse(event);\r\n                    break;\r\n                default:\r\n                    preventDefault = false;\r\n                    prev = this.previousFilter || \"\";\r\n                    character = String.fromCharCode(event.keyCode);\r\n                    skip = false;\r\n\r\n                    clearTimeout(this.filterTimer);\r\n\r\n                    if (character === prev) {\r\n                        skip = true;\r\n                    } else {\r\n                        character = prev + character;\r\n                    }\r\n\r\n                    regex = new RegExp(\"^\" + escape(character), \"i\");\r\n                    match = this.activeMenu.children(\".ui-menu-item\").filter(function () {\r\n                        return regex.test($(this).children(\"a\").text());\r\n                    });\r\n                    match = skip && match.index(this.active.next()) !== -1 ?\r\n                        this.active.nextAll(\".ui-menu-item\") :\r\n                        match;\r\n\r\n                    // If no matches on the current filter, reset to the last character pressed\r\n                    // to move down the menu to the first item that starts with that character\r\n                    if (!match.length) {\r\n                        character = String.fromCharCode(event.keyCode);\r\n                        regex = new RegExp(\"^\" + escape(character), \"i\");\r\n                        match = this.activeMenu.children(\".ui-menu-item\").filter(function () {\r\n                            return regex.test($(this).children(\"a\").text());\r\n                        });\r\n                    }\r\n\r\n                    if (match.length) {\r\n                        this.focus(event, match);\r\n                        if (match.length > 1) {\r\n                            this.previousFilter = character;\r\n                            this.filterTimer = this._delay(function () {\r\n                                delete this.previousFilter;\r\n                            }, 1000);\r\n                        } else {\r\n                            delete this.previousFilter;\r\n                        }\r\n                    } else {\r\n                        delete this.previousFilter;\r\n                    }\r\n            }\r\n\r\n            if (preventDefault) {\r\n                event.preventDefault();\r\n            }\r\n        },\r\n\r\n        _activate: function (event) {\r\n            if (!this.active.is(\".ui-state-disabled\")) {\r\n                if (this.active.children(\"a[aria-haspopup='true']\").length) {\r\n                    this.expand(event);\r\n                } else {\r\n                    this.select(event);\r\n                }\r\n            }\r\n        },\r\n\r\n        refresh: function () {\r\n            var menus,\r\n                icon = this.options.icons.submenu,\r\n                submenus = this.element.find(this.options.menus);\r\n\r\n            this.element.toggleClass(\"ui-menu-icons\", !!this.element.find(\".ui-icon\").length);\r\n\r\n            // Initialize nested menus\r\n            submenus.filter(\":not(.ui-menu)\")\r\n                .addClass(\"ui-menu ui-widget ui-widget-content ui-corner-all\")\r\n                .hide()\r\n                .attr({\r\n                    role: this.options.role,\r\n                    \"aria-hidden\": \"true\",\r\n                    \"aria-expanded\": \"false\"\r\n                })\r\n                .each(function () {\r\n                    var menu = $(this),\r\n                        item = menu.prev(\"a\"),\r\n                        submenuCarat = $(\"<span>\")\r\n                            .addClass(\"ui-menu-icon ui-icon \" + icon)\r\n                            .data(\"ui-menu-submenu-carat\", true);\r\n\r\n                    item\r\n                        .attr(\"aria-haspopup\", \"true\")\r\n                        .prepend(submenuCarat);\r\n                    menu.attr(\"aria-labelledby\", item.attr(\"id\"));\r\n                });\r\n\r\n            menus = submenus.add(this.element);\r\n\r\n            // Don't refresh list items that are already adapted\r\n            menus.children(\":not(.ui-menu-item):has(a)\")\r\n                .addClass(\"ui-menu-item\")\r\n                .attr(\"role\", \"presentation\")\r\n                .children(\"a\")\r\n                .uniqueId()\r\n                .addClass(\"ui-corner-all\")\r\n                .attr({\r\n                    tabIndex: -1,\r\n                    role: this._itemRole()\r\n                });\r\n\r\n            // Initialize unlinked menu-items containing spaces and/or dashes only as dividers\r\n            menus.children(\":not(.ui-menu-item)\").each(function () {\r\n                var item = $(this);\r\n                // hyphen, em dash, en dash\r\n                if (!/[^\\-\\u2014\\u2013\\s]/.test(item.text())) {\r\n                    item.addClass(\"ui-widget-content ui-menu-divider\");\r\n                }\r\n            });\r\n\r\n            // Add aria-disabled attribute to any disabled menu item\r\n            menus.children(\".ui-state-disabled\").attr(\"aria-disabled\", \"true\");\r\n\r\n            // If the active item has been removed, blur the menu\r\n            if (this.active && !$.contains(this.element[0], this.active[0])) {\r\n                this.blur();\r\n            }\r\n        },\r\n\r\n        _itemRole: function () {\r\n            return {\r\n                menu: \"menuitem\",\r\n                listbox: \"option\"\r\n            }[this.options.role];\r\n        },\r\n\r\n        _setOption: function (key, value) {\r\n            if (key === \"icons\") {\r\n                this.element.find(\".ui-menu-icon\")\r\n                    .removeClass(this.options.icons.submenu)\r\n                    .addClass(value.submenu);\r\n            }\r\n            this._super(key, value);\r\n        },\r\n\r\n        focus: function (event, item) {\r\n            var nested, focused;\r\n            this.blur(event, event && event.type === \"focus\");\r\n\r\n            this._scrollIntoView(item);\r\n\r\n            this.active = item.first();\r\n            focused = this.active.children(\"a\").addClass(\"ui-state-focus\");\r\n            // Only update aria-activedescendant if there's a role\r\n            // otherwise we assume focus is managed elsewhere\r\n            if (this.options.role) {\r\n                this.element.attr(\"aria-activedescendant\", focused.attr(\"id\"));\r\n            }\r\n\r\n            // Highlight active parent menu item, if any\r\n            this.active\r\n                .parent()\r\n                .closest(\".ui-menu-item\")\r\n                .children(\"a:first\")\r\n                .addClass(\"ui-state-active\");\r\n\r\n            if (event && event.type === \"keydown\") {\r\n                this._close();\r\n            } else {\r\n                this.timer = this._delay(function () {\r\n                    this._close();\r\n                }, this.delay);\r\n            }\r\n\r\n            nested = item.children(\".ui-menu\");\r\n            if (nested.length && event && (/^mouse/.test(event.type))) {\r\n                this._startOpening(nested);\r\n            }\r\n            this.activeMenu = item.parent();\r\n\r\n            this._trigger(\"focus\", event, {item: item});\r\n        },\r\n\r\n        _scrollIntoView: function (item) {\r\n            var borderTop, paddingTop, offset, scroll, elementHeight, itemHeight;\r\n            if (this._hasScroll()) {\r\n                borderTop = parseFloat($.css(this.activeMenu[0], \"borderTopWidth\")) || 0;\r\n                paddingTop = parseFloat($.css(this.activeMenu[0], \"paddingTop\")) || 0;\r\n                offset = item.offset().top - this.activeMenu.offset().top - borderTop - paddingTop;\r\n                scroll = this.activeMenu.scrollTop();\r\n                elementHeight = this.activeMenu.height();\r\n                itemHeight = item.height();\r\n\r\n                if (offset < 0) {\r\n                    this.activeMenu.scrollTop(scroll + offset);\r\n                } else if (offset + itemHeight > elementHeight) {\r\n                    this.activeMenu.scrollTop(scroll + offset - elementHeight + itemHeight);\r\n                }\r\n            }\r\n        },\r\n\r\n        blur: function (event, fromFocus) {\r\n            if (!fromFocus) {\r\n                clearTimeout(this.timer);\r\n            }\r\n\r\n            if (!this.active) {\r\n                return;\r\n            }\r\n\r\n            this.active.children(\"a\").removeClass(\"ui-state-focus\");\r\n            this.active = null;\r\n\r\n            this._trigger(\"blur\", event, {item: this.active});\r\n        },\r\n\r\n        _startOpening: function (submenu) {\r\n            clearTimeout(this.timer);\r\n\r\n            // Don't open if already open fixes a Firefox bug that caused a .5 pixel\r\n            // shift in the submenu position when mousing over the carat icon\r\n            if (submenu.attr(\"aria-hidden\") !== \"true\") {\r\n                return;\r\n            }\r\n\r\n            this._open(submenu);\r\n        },\r\n\r\n        _open: function (submenu) {\r\n            var position = $.extend({\r\n                of: this.active\r\n            }, this.options.position);\r\n\r\n            clearTimeout(this.timer);\r\n            this.element.find(\".ui-menu\").not(submenu.parents(\".ui-menu\"))\r\n                .hide()\r\n                .attr(\"aria-hidden\", \"true\");\r\n\r\n            submenu\r\n                .show()\r\n                .removeAttr(\"aria-hidden\")\r\n                .attr(\"aria-expanded\", \"true\")\r\n                .position(position);\r\n        },\r\n\r\n        collapseAll: function (event, all) {\r\n            clearTimeout(this.timer);\r\n            this.timer = this._delay(function () {\r\n                // If we were passed an event, look for the submenu that contains the event\r\n                var currentMenu = all ? this.element :\r\n                    $(event && event.target).closest(this.element.find(\".ui-menu\"));\r\n\r\n                // If we found no valid submenu ancestor, use the main menu to close all sub menus anyway\r\n                if (!currentMenu.length) {\r\n                    currentMenu = this.element;\r\n                }\r\n\r\n                this._close(currentMenu);\r\n\r\n                this.blur(event);\r\n                this.activeMenu = currentMenu;\r\n            }, this.delay);\r\n        },\r\n\r\n        // With no arguments, closes the currently active menu - if nothing is active\r\n        // it closes all menus.  If passed an argument, it will search for menus BELOW\r\n        _close: function (startMenu) {\r\n            if (!startMenu) {\r\n                startMenu = this.active ? this.active.parent() : this.element;\r\n            }\r\n\r\n            startMenu\r\n                .find(\".ui-menu\")\r\n                .hide()\r\n                .attr(\"aria-hidden\", \"true\")\r\n                .attr(\"aria-expanded\", \"false\")\r\n                .end()\r\n                .find(\"a.ui-state-active\")\r\n                .removeClass(\"ui-state-active\");\r\n        },\r\n\r\n        collapse: function (event) {\r\n            var newItem = this.active &&\r\n                this.active.parent().closest(\".ui-menu-item\", this.element);\r\n            if (newItem && newItem.length) {\r\n                this._close();\r\n                this.focus(event, newItem);\r\n            }\r\n        },\r\n\r\n        expand: function (event) {\r\n            var newItem = this.active &&\r\n                this.active\r\n                    .children(\".ui-menu \")\r\n                    .children(\".ui-menu-item\")\r\n                    .first();\r\n\r\n            if (newItem && newItem.length) {\r\n                this._open(newItem.parent());\r\n\r\n                // Delay so Firefox will not hide activedescendant change in expanding submenu from AT\r\n                this._delay(function () {\r\n                    this.focus(event, newItem);\r\n                });\r\n            }\r\n        },\r\n\r\n        next: function (event) {\r\n            this._move(\"next\", \"first\", event);\r\n        },\r\n\r\n        previous: function (event) {\r\n            this._move(\"prev\", \"last\", event);\r\n        },\r\n\r\n        isFirstItem: function () {\r\n            return this.active && !this.active.prevAll(\".ui-menu-item\").length;\r\n        },\r\n\r\n        isLastItem: function () {\r\n            return this.active && !this.active.nextAll(\".ui-menu-item\").length;\r\n        },\r\n\r\n        _move: function (direction, filter, event) {\r\n            var next;\r\n            if (this.active) {\r\n                if (direction === \"first\" || direction === \"last\") {\r\n                    next = this.active\r\n                        [direction === \"first\" ? \"prevAll\" : \"nextAll\"](\".ui-menu-item\")\r\n                        .eq(-1);\r\n                } else {\r\n                    next = this.active\r\n                        [direction + \"All\"](\".ui-menu-item\")\r\n                        .eq(0);\r\n                }\r\n            }\r\n            if (!next || !next.length || !this.active) {\r\n                next = this.activeMenu.children(\".ui-menu-item\")[filter]();\r\n            }\r\n\r\n            this.focus(event, next);\r\n        },\r\n\r\n        nextPage: function (event) {\r\n            var item, base, height;\r\n\r\n            if (!this.active) {\r\n                this.next(event);\r\n                return;\r\n            }\r\n            if (this.isLastItem()) {\r\n                return;\r\n            }\r\n            if (this._hasScroll()) {\r\n                base = this.active.offset().top;\r\n                height = this.element.height();\r\n                this.active.nextAll(\".ui-menu-item\").each(function () {\r\n                    item = $(this);\r\n                    return item.offset().top - base - height < 0;\r\n                });\r\n\r\n                this.focus(event, item);\r\n            } else {\r\n                this.focus(event, this.activeMenu.children(\".ui-menu-item\")\r\n                    [!this.active ? \"first\" : \"last\"]());\r\n            }\r\n        },\r\n\r\n        previousPage: function (event) {\r\n            var item, base, height;\r\n            if (!this.active) {\r\n                this.next(event);\r\n                return;\r\n            }\r\n            if (this.isFirstItem()) {\r\n                return;\r\n            }\r\n            if (this._hasScroll()) {\r\n                base = this.active.offset().top;\r\n                height = this.element.height();\r\n                this.active.prevAll(\".ui-menu-item\").each(function () {\r\n                    item = $(this);\r\n                    return item.offset().top - base + height > 0;\r\n                });\r\n\r\n                this.focus(event, item);\r\n            } else {\r\n                this.focus(event, this.activeMenu.children(\".ui-menu-item\").first());\r\n            }\r\n        },\r\n\r\n        _hasScroll: function () {\r\n            return this.element.outerHeight() < this.element.prop(\"scrollHeight\");\r\n        },\r\n\r\n        select: function (event) {\r\n            // TODO: It should never be possible to not have an active item at this\r\n            // point, but the tests don't trigger mouseenter before click.\r\n            this.active = this.active || $(event.target).closest(\".ui-menu-item\");\r\n            var ui = {item: this.active};\r\n            if (!this.active.has(\".ui-menu\").length) {\r\n                this.collapseAll(event, true);\r\n            }\r\n            this._trigger(\"select\", event, ui);\r\n        }\r\n    });\r\n\r\n});\r\n","jquery/ui-modules/mouse.js":"/*!\r\n * jQuery UI Mouse - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/mouse/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/widget'\r\n], function ($, undefined) {\r\n\r\n    var mouseHandled = false;\r\n    $(document).mouseup(function () {\r\n        mouseHandled = false;\r\n    });\r\n\r\n    $.widget(\"ui.mouse\", {\r\n        version: \"1.10.4\",\r\n        options: {\r\n            cancel: \"input,textarea,button,select,option\",\r\n            distance: 1,\r\n            delay: 0\r\n        },\r\n        _mouseInit: function () {\r\n            var that = this;\r\n\r\n            this.element\r\n                .bind(\"mousedown.\" + this.widgetName, function (event) {\r\n                    return that._mouseDown(event);\r\n                })\r\n                .bind(\"click.\" + this.widgetName, function (event) {\r\n                    if (true === $.data(event.target, that.widgetName + \".preventClickEvent\")) {\r\n                        $.removeData(event.target, that.widgetName + \".preventClickEvent\");\r\n                        event.stopImmediatePropagation();\r\n                        return false;\r\n                    }\r\n                });\r\n\r\n            this.started = false;\r\n        },\r\n\r\n        // TODO: make sure destroying one instance of mouse doesn't mess with\r\n        // other instances of mouse\r\n        _mouseDestroy: function () {\r\n            this.element.unbind(\".\" + this.widgetName);\r\n            if (this._mouseMoveDelegate) {\r\n                $(document)\r\n                    .unbind(\"mousemove.\" + this.widgetName, this._mouseMoveDelegate)\r\n                    .unbind(\"mouseup.\" + this.widgetName, this._mouseUpDelegate);\r\n            }\r\n        },\r\n\r\n        _mouseDown: function (event) {\r\n            // don't let more than one widget handle mouseStart\r\n            if (mouseHandled) {\r\n                return;\r\n            }\r\n\r\n            // we may have missed mouseup (out of window)\r\n            (this._mouseStarted && this._mouseUp(event));\r\n\r\n            this._mouseDownEvent = event;\r\n\r\n            var that = this,\r\n                btnIsLeft = (event.which === 1),\r\n                // event.target.nodeName works around a bug in IE 8 with\r\n                // disabled inputs (#7620)\r\n                elIsCancel = (typeof this.options.cancel === \"string\" && event.target.nodeName ? $(event.target).closest(this.options.cancel).length : false);\r\n            if (!btnIsLeft || elIsCancel || !this._mouseCapture(event)) {\r\n                return true;\r\n            }\r\n\r\n            this.mouseDelayMet = !this.options.delay;\r\n            if (!this.mouseDelayMet) {\r\n                this._mouseDelayTimer = setTimeout(function () {\r\n                    that.mouseDelayMet = true;\r\n                }, this.options.delay);\r\n            }\r\n\r\n            if (this._mouseDistanceMet(event) && this._mouseDelayMet(event)) {\r\n                this._mouseStarted = (this._mouseStart(event) !== false);\r\n                if (!this._mouseStarted) {\r\n                    event.preventDefault();\r\n                    return true;\r\n                }\r\n            }\r\n\r\n            // Click event may never have fired (Gecko & Opera)\r\n            if (true === $.data(event.target, this.widgetName + \".preventClickEvent\")) {\r\n                $.removeData(event.target, this.widgetName + \".preventClickEvent\");\r\n            }\r\n\r\n            // these delegates are required to keep context\r\n            this._mouseMoveDelegate = function (event) {\r\n                return that._mouseMove(event);\r\n            };\r\n            this._mouseUpDelegate = function (event) {\r\n                return that._mouseUp(event);\r\n            };\r\n            $(document)\r\n                .bind(\"mousemove.\" + this.widgetName, this._mouseMoveDelegate)\r\n                .bind(\"mouseup.\" + this.widgetName, this._mouseUpDelegate);\r\n\r\n            event.preventDefault();\r\n\r\n            mouseHandled = true;\r\n            return true;\r\n        },\r\n\r\n        _mouseMove: function (event) {\r\n            // IE mouseup check - mouseup happened when mouse was out of window\r\n            if ($.ui.ie && (!document.documentMode || document.documentMode < 9) && !event.button) {\r\n                return this._mouseUp(event);\r\n            }\r\n\r\n            if (this._mouseStarted) {\r\n                this._mouseDrag(event);\r\n                return event.preventDefault();\r\n            }\r\n\r\n            if (this._mouseDistanceMet(event) && this._mouseDelayMet(event)) {\r\n                this._mouseStarted =\r\n                    (this._mouseStart(this._mouseDownEvent, event) !== false);\r\n                (this._mouseStarted ? this._mouseDrag(event) : this._mouseUp(event));\r\n            }\r\n\r\n            return !this._mouseStarted;\r\n        },\r\n\r\n        _mouseUp: function (event) {\r\n            $(document)\r\n                .unbind(\"mousemove.\" + this.widgetName, this._mouseMoveDelegate)\r\n                .unbind(\"mouseup.\" + this.widgetName, this._mouseUpDelegate);\r\n\r\n            if (this._mouseStarted) {\r\n                this._mouseStarted = false;\r\n\r\n                if (event.target === this._mouseDownEvent.target) {\r\n                    $.data(event.target, this.widgetName + \".preventClickEvent\", true);\r\n                }\r\n\r\n                this._mouseStop(event);\r\n            }\r\n\r\n            return false;\r\n        },\r\n\r\n        _mouseDistanceMet: function (event) {\r\n            return (Math.max(\r\n                    Math.abs(this._mouseDownEvent.pageX - event.pageX),\r\n                    Math.abs(this._mouseDownEvent.pageY - event.pageY)\r\n                ) >= this.options.distance\r\n            );\r\n        },\r\n\r\n        _mouseDelayMet: function (/* event */) {\r\n            return this.mouseDelayMet;\r\n        },\r\n\r\n        // These are placeholder methods, to be overridden by extending plugin\r\n        _mouseStart: function (/* event */) {\r\n        },\r\n        _mouseDrag: function (/* event */) {\r\n        },\r\n        _mouseStop: function (/* event */) {\r\n        },\r\n        _mouseCapture: function (/* event */) {\r\n            return true;\r\n        }\r\n    });\r\n\r\n});\r\n","jquery/ui-modules/position.js":"/*!\r\n * jQuery UI Position - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n */\r\n\r\ndefine([\r\n    'jquery'\r\n], function ($, undefined) {\r\n\r\n    $.ui = $.ui || {};\r\n\r\n    var cachedScrollbarWidth,\r\n        max = Math.max,\r\n        abs = Math.abs,\r\n        round = Math.round,\r\n        rhorizontal = /left|center|right/,\r\n        rvertical = /top|center|bottom/,\r\n        roffset = /[\\+\\-]\\d+(\\.[\\d]+)?%?/,\r\n        rposition = /^\\w+/,\r\n        rpercent = /%$/,\r\n        _position = $.fn.position;\r\n\r\n    function getOffsets(offsets, width, height) {\r\n        return [\r\n            parseFloat(offsets[0]) * (rpercent.test(offsets[0]) ? width / 100 : 1),\r\n            parseFloat(offsets[1]) * (rpercent.test(offsets[1]) ? height / 100 : 1)\r\n        ];\r\n    }\r\n\r\n    function parseCss(element, property) {\r\n        return parseInt($.css(element, property), 10) || 0;\r\n    }\r\n\r\n    function getDimensions(elem) {\r\n        var raw = elem[0];\r\n        if (raw.nodeType === 9) {\r\n            return {\r\n                width: elem.width(),\r\n                height: elem.height(),\r\n                offset: {top: 0, left: 0}\r\n            };\r\n        }\r\n        if ($.isWindow(raw)) {\r\n            return {\r\n                width: elem.width(),\r\n                height: elem.height(),\r\n                offset: {top: elem.scrollTop(), left: elem.scrollLeft()}\r\n            };\r\n        }\r\n        if (raw.preventDefault) {\r\n            return {\r\n                width: 0,\r\n                height: 0,\r\n                offset: {top: raw.pageY, left: raw.pageX}\r\n            };\r\n        }\r\n        return {\r\n            width: elem.outerWidth(),\r\n            height: elem.outerHeight(),\r\n            offset: elem.offset()\r\n        };\r\n    }\r\n\r\n    $.position = {\r\n        scrollbarWidth: function () {\r\n            if (cachedScrollbarWidth !== undefined) {\r\n                return cachedScrollbarWidth;\r\n            }\r\n            var w1, w2,\r\n                div = $(\"<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>\"),\r\n                innerDiv = div.children()[0];\r\n\r\n            $(\"body\").append(div);\r\n            w1 = innerDiv.offsetWidth;\r\n            div.css(\"overflow\", \"scroll\");\r\n\r\n            w2 = innerDiv.offsetWidth;\r\n\r\n            if (w1 === w2) {\r\n                w2 = div[0].clientWidth;\r\n            }\r\n\r\n            div.remove();\r\n\r\n            return (cachedScrollbarWidth = w1 - w2);\r\n        },\r\n        getScrollInfo: function (within) {\r\n            var overflowX = within.isWindow || within.isDocument ? \"\" :\r\n                within.element.css(\"overflow-x\"),\r\n                overflowY = within.isWindow || within.isDocument ? \"\" :\r\n                    within.element.css(\"overflow-y\"),\r\n                hasOverflowX = overflowX === \"scroll\" ||\r\n                    (overflowX === \"auto\" && within.width < within.element[0].scrollWidth),\r\n                hasOverflowY = overflowY === \"scroll\" ||\r\n                    (overflowY === \"auto\" && within.height < within.element[0].scrollHeight);\r\n            return {\r\n                width: hasOverflowY ? $.position.scrollbarWidth() : 0,\r\n                height: hasOverflowX ? $.position.scrollbarWidth() : 0\r\n            };\r\n        },\r\n        getWithinInfo: function (element) {\r\n            var withinElement = $(element || window),\r\n                isWindow = $.isWindow(withinElement[0]),\r\n                isDocument = !!withinElement[0] && withinElement[0].nodeType === 9;\r\n            return {\r\n                element: withinElement,\r\n                isWindow: isWindow,\r\n                isDocument: isDocument,\r\n                offset: withinElement.offset() || {left: 0, top: 0},\r\n                scrollLeft: withinElement.scrollLeft(),\r\n                scrollTop: withinElement.scrollTop(),\r\n                width: isWindow ? withinElement.width() : withinElement.outerWidth(),\r\n                height: isWindow ? withinElement.height() : withinElement.outerHeight()\r\n            };\r\n        }\r\n    };\r\n\r\n    $.fn.position = function (options) {\r\n        if (!options || !options.of) {\r\n            return _position.apply(this, arguments);\r\n        }\r\n\r\n        // make a copy, we don't want to modify arguments\r\n        options = $.extend({}, options);\r\n\r\n        var atOffset, targetWidth, targetHeight, targetOffset, basePosition, dimensions,\r\n            target = $(options.of),\r\n            within = $.position.getWithinInfo(options.within),\r\n            scrollInfo = $.position.getScrollInfo(within),\r\n            collision = (options.collision || \"flip\").split(\" \"),\r\n            offsets = {};\r\n\r\n        dimensions = getDimensions(target);\r\n        if (target[0].preventDefault) {\r\n            // force left top to allow flipping\r\n            options.at = \"left top\";\r\n        }\r\n        targetWidth = dimensions.width;\r\n        targetHeight = dimensions.height;\r\n        targetOffset = dimensions.offset;\r\n        // clone to reuse original targetOffset later\r\n        basePosition = $.extend({}, targetOffset);\r\n\r\n        // force my and at to have valid horizontal and vertical positions\r\n        // if a value is missing or invalid, it will be converted to center\r\n        $.each([\"my\", \"at\"], function () {\r\n            var pos = (options[this] || \"\").split(\" \"),\r\n                horizontalOffset,\r\n                verticalOffset;\r\n\r\n            if (pos.length === 1) {\r\n                pos = rhorizontal.test(pos[0]) ?\r\n                    pos.concat([\"center\"]) :\r\n                    rvertical.test(pos[0]) ?\r\n                        [\"center\"].concat(pos) :\r\n                        [\"center\", \"center\"];\r\n            }\r\n            pos[0] = rhorizontal.test(pos[0]) ? pos[0] : \"center\";\r\n            pos[1] = rvertical.test(pos[1]) ? pos[1] : \"center\";\r\n\r\n            // calculate offsets\r\n            horizontalOffset = roffset.exec(pos[0]);\r\n            verticalOffset = roffset.exec(pos[1]);\r\n            offsets[this] = [\r\n                horizontalOffset ? horizontalOffset[0] : 0,\r\n                verticalOffset ? verticalOffset[0] : 0\r\n            ];\r\n\r\n            // reduce to just the positions without the offsets\r\n            options[this] = [\r\n                rposition.exec(pos[0])[0],\r\n                rposition.exec(pos[1])[0]\r\n            ];\r\n        });\r\n\r\n        // normalize collision option\r\n        if (collision.length === 1) {\r\n            collision[1] = collision[0];\r\n        }\r\n\r\n        if (options.at[0] === \"right\") {\r\n            basePosition.left += targetWidth;\r\n        } else if (options.at[0] === \"center\") {\r\n            basePosition.left += targetWidth / 2;\r\n        }\r\n\r\n        if (options.at[1] === \"bottom\") {\r\n            basePosition.top += targetHeight;\r\n        } else if (options.at[1] === \"center\") {\r\n            basePosition.top += targetHeight / 2;\r\n        }\r\n\r\n        atOffset = getOffsets(offsets.at, targetWidth, targetHeight);\r\n        basePosition.left += atOffset[0];\r\n        basePosition.top += atOffset[1];\r\n\r\n        return this.each(function () {\r\n            var collisionPosition, using,\r\n                elem = $(this),\r\n                elemWidth = elem.outerWidth(),\r\n                elemHeight = elem.outerHeight(),\r\n                marginLeft = parseCss(this, \"marginLeft\"),\r\n                marginTop = parseCss(this, \"marginTop\"),\r\n                collisionWidth = elemWidth + marginLeft + parseCss(this, \"marginRight\") + scrollInfo.width,\r\n                collisionHeight = elemHeight + marginTop + parseCss(this, \"marginBottom\") + scrollInfo.height,\r\n                position = $.extend({}, basePosition),\r\n                myOffset = getOffsets(offsets.my, elem.outerWidth(), elem.outerHeight());\r\n\r\n            if (options.my[0] === \"right\") {\r\n                position.left -= elemWidth;\r\n            } else if (options.my[0] === \"center\") {\r\n                position.left -= elemWidth / 2;\r\n            }\r\n\r\n            if (options.my[1] === \"bottom\") {\r\n                position.top -= elemHeight;\r\n            } else if (options.my[1] === \"center\") {\r\n                position.top -= elemHeight / 2;\r\n            }\r\n\r\n            position.left += myOffset[0];\r\n            position.top += myOffset[1];\r\n\r\n            // if the browser doesn't support fractions, then round for consistent results\r\n            if (!$.support.offsetFractions) {\r\n                position.left = round(position.left);\r\n                position.top = round(position.top);\r\n            }\r\n\r\n            collisionPosition = {\r\n                marginLeft: marginLeft,\r\n                marginTop: marginTop\r\n            };\r\n\r\n            $.each([\"left\", \"top\"], function (i, dir) {\r\n                if ($.ui.position[collision[i]]) {\r\n                    $.ui.position[collision[i]][dir](position, {\r\n                        targetWidth: targetWidth,\r\n                        targetHeight: targetHeight,\r\n                        elemWidth: elemWidth,\r\n                        elemHeight: elemHeight,\r\n                        collisionPosition: collisionPosition,\r\n                        collisionWidth: collisionWidth,\r\n                        collisionHeight: collisionHeight,\r\n                        offset: [atOffset[0] + myOffset[0], atOffset [1] + myOffset[1]],\r\n                        my: options.my,\r\n                        at: options.at,\r\n                        within: within,\r\n                        elem: elem\r\n                    });\r\n                }\r\n            });\r\n\r\n            if (options.using) {\r\n                // adds feedback as second argument to using callback, if present\r\n                using = function (props) {\r\n                    var left = targetOffset.left - position.left,\r\n                        right = left + targetWidth - elemWidth,\r\n                        top = targetOffset.top - position.top,\r\n                        bottom = top + targetHeight - elemHeight,\r\n                        feedback = {\r\n                            target: {\r\n                                element: target,\r\n                                left: targetOffset.left,\r\n                                top: targetOffset.top,\r\n                                width: targetWidth,\r\n                                height: targetHeight\r\n                            },\r\n                            element: {\r\n                                element: elem,\r\n                                left: position.left,\r\n                                top: position.top,\r\n                                width: elemWidth,\r\n                                height: elemHeight\r\n                            },\r\n                            horizontal: right < 0 ? \"left\" : left > 0 ? \"right\" : \"center\",\r\n                            vertical: bottom < 0 ? \"top\" : top > 0 ? \"bottom\" : \"middle\"\r\n                        };\r\n                    if (targetWidth < elemWidth && abs(left + right) < targetWidth) {\r\n                        feedback.horizontal = \"center\";\r\n                    }\r\n                    if (targetHeight < elemHeight && abs(top + bottom) < targetHeight) {\r\n                        feedback.vertical = \"middle\";\r\n                    }\r\n                    if (max(abs(left), abs(right)) > max(abs(top), abs(bottom))) {\r\n                        feedback.important = \"horizontal\";\r\n                    } else {\r\n                        feedback.important = \"vertical\";\r\n                    }\r\n                    options.using.call(this, props, feedback);\r\n                };\r\n            }\r\n\r\n            elem.offset($.extend(position, {using: using}));\r\n        });\r\n    };\r\n\r\n    $.ui.position = {\r\n        fit: {\r\n            left: function (position, data) {\r\n                var within = data.within,\r\n                    withinOffset = within.isWindow ? within.scrollLeft : within.offset.left,\r\n                    outerWidth = within.width,\r\n                    collisionPosLeft = position.left - data.collisionPosition.marginLeft,\r\n                    overLeft = withinOffset - collisionPosLeft,\r\n                    overRight = collisionPosLeft + data.collisionWidth - outerWidth - withinOffset,\r\n                    newOverRight;\r\n\r\n                // element is wider than within\r\n                if (data.collisionWidth > outerWidth) {\r\n                    // element is initially over the left side of within\r\n                    if (overLeft > 0 && overRight <= 0) {\r\n                        newOverRight = position.left + overLeft + data.collisionWidth - outerWidth - withinOffset;\r\n                        position.left += overLeft - newOverRight;\r\n                        // element is initially over right side of within\r\n                    } else if (overRight > 0 && overLeft <= 0) {\r\n                        position.left = withinOffset;\r\n                        // element is initially over both left and right sides of within\r\n                    } else {\r\n                        if (overLeft > overRight) {\r\n                            position.left = withinOffset + outerWidth - data.collisionWidth;\r\n                        } else {\r\n                            position.left = withinOffset;\r\n                        }\r\n                    }\r\n                    // too far left -> align with left edge\r\n                } else if (overLeft > 0) {\r\n                    position.left += overLeft;\r\n                    // too far right -> align with right edge\r\n                } else if (overRight > 0) {\r\n                    position.left -= overRight;\r\n                    // adjust based on position and margin\r\n                } else {\r\n                    position.left = max(position.left - collisionPosLeft, position.left);\r\n                }\r\n            },\r\n            top: function (position, data) {\r\n                var within = data.within,\r\n                    withinOffset = within.isWindow ? within.scrollTop : within.offset.top,\r\n                    outerHeight = data.within.height,\r\n                    collisionPosTop = position.top - data.collisionPosition.marginTop,\r\n                    overTop = withinOffset - collisionPosTop,\r\n                    overBottom = collisionPosTop + data.collisionHeight - outerHeight - withinOffset,\r\n                    newOverBottom;\r\n\r\n                // element is taller than within\r\n                if (data.collisionHeight > outerHeight) {\r\n                    // element is initially over the top of within\r\n                    if (overTop > 0 && overBottom <= 0) {\r\n                        newOverBottom = position.top + overTop + data.collisionHeight - outerHeight - withinOffset;\r\n                        position.top += overTop - newOverBottom;\r\n                        // element is initially over bottom of within\r\n                    } else if (overBottom > 0 && overTop <= 0) {\r\n                        position.top = withinOffset;\r\n                        // element is initially over both top and bottom of within\r\n                    } else {\r\n                        if (overTop > overBottom) {\r\n                            position.top = withinOffset + outerHeight - data.collisionHeight;\r\n                        } else {\r\n                            position.top = withinOffset;\r\n                        }\r\n                    }\r\n                    // too far up -> align with top\r\n                } else if (overTop > 0) {\r\n                    position.top += overTop;\r\n                    // too far down -> align with bottom edge\r\n                } else if (overBottom > 0) {\r\n                    position.top -= overBottom;\r\n                    // adjust based on position and margin\r\n                } else {\r\n                    position.top = max(position.top - collisionPosTop, position.top);\r\n                }\r\n            }\r\n        },\r\n        flip: {\r\n            left: function (position, data) {\r\n                var within = data.within,\r\n                    withinOffset = within.offset.left + within.scrollLeft,\r\n                    outerWidth = within.width,\r\n                    offsetLeft = within.isWindow ? within.scrollLeft : within.offset.left,\r\n                    collisionPosLeft = position.left - data.collisionPosition.marginLeft,\r\n                    overLeft = collisionPosLeft - offsetLeft,\r\n                    overRight = collisionPosLeft + data.collisionWidth - outerWidth - offsetLeft,\r\n                    myOffset = data.my[0] === \"left\" ?\r\n                        -data.elemWidth :\r\n                        data.my[0] === \"right\" ?\r\n                            data.elemWidth :\r\n                            0,\r\n                    atOffset = data.at[0] === \"left\" ?\r\n                        data.targetWidth :\r\n                        data.at[0] === \"right\" ?\r\n                            -data.targetWidth :\r\n                            0,\r\n                    offset = -2 * data.offset[0],\r\n                    newOverRight,\r\n                    newOverLeft;\r\n\r\n                if (overLeft < 0) {\r\n                    newOverRight = position.left + myOffset + atOffset + offset + data.collisionWidth - outerWidth - withinOffset;\r\n                    if (newOverRight < 0 || newOverRight < abs(overLeft)) {\r\n                        position.left += myOffset + atOffset + offset;\r\n                    }\r\n                } else if (overRight > 0) {\r\n                    newOverLeft = position.left - data.collisionPosition.marginLeft + myOffset + atOffset + offset - offsetLeft;\r\n                    if (newOverLeft > 0 || abs(newOverLeft) < overRight) {\r\n                        position.left += myOffset + atOffset + offset;\r\n                    }\r\n                }\r\n            },\r\n            top: function (position, data) {\r\n                var within = data.within,\r\n                    withinOffset = within.offset.top + within.scrollTop,\r\n                    outerHeight = within.height,\r\n                    offsetTop = within.isWindow ? within.scrollTop : within.offset.top,\r\n                    collisionPosTop = position.top - data.collisionPosition.marginTop,\r\n                    overTop = collisionPosTop - offsetTop,\r\n                    overBottom = collisionPosTop + data.collisionHeight - outerHeight - offsetTop,\r\n                    top = data.my[1] === \"top\",\r\n                    myOffset = top ?\r\n                        -data.elemHeight :\r\n                        data.my[1] === \"bottom\" ?\r\n                            data.elemHeight :\r\n                            0,\r\n                    atOffset = data.at[1] === \"top\" ?\r\n                        data.targetHeight :\r\n                        data.at[1] === \"bottom\" ?\r\n                            -data.targetHeight :\r\n                            0,\r\n                    offset = -2 * data.offset[1],\r\n                    newOverTop,\r\n                    newOverBottom;\r\n                if (overTop < 0) {\r\n                    newOverBottom = position.top + myOffset + atOffset + offset + data.collisionHeight - outerHeight - withinOffset;\r\n                    if ((position.top + myOffset + atOffset + offset) > overTop && (newOverBottom < 0 || newOverBottom < abs(overTop))) {\r\n                        position.top += myOffset + atOffset + offset;\r\n                    }\r\n                } else if (overBottom > 0) {\r\n                    newOverTop = position.top - data.collisionPosition.marginTop + myOffset + atOffset + offset - offsetTop;\r\n                    if ((position.top + myOffset + atOffset + offset) > overBottom && (newOverTop > 0 || abs(newOverTop) < overBottom)) {\r\n                        position.top += myOffset + atOffset + offset;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        flipfit: {\r\n            left: function () {\r\n                $.ui.position.flip.left.apply(this, arguments);\r\n                $.ui.position.fit.left.apply(this, arguments);\r\n            },\r\n            top: function () {\r\n                $.ui.position.flip.top.apply(this, arguments);\r\n                $.ui.position.fit.top.apply(this, arguments);\r\n            }\r\n        }\r\n    };\r\n\r\n// fraction support test\r\n    (function () {\r\n        var testElement, testElementParent, testElementStyle, offsetLeft, i,\r\n            body = document.getElementsByTagName(\"body\")[0],\r\n            div = document.createElement(\"div\");\r\n\r\n        //Create a \"fake body\" for testing based on method used in jQuery.support\r\n        testElement = document.createElement(body ? \"div\" : \"body\");\r\n        testElementStyle = {\r\n            visibility: \"hidden\",\r\n            width: 0,\r\n            height: 0,\r\n            border: 0,\r\n            margin: 0,\r\n            background: \"none\"\r\n        };\r\n        if (body) {\r\n            $.extend(testElementStyle, {\r\n                position: \"absolute\",\r\n                left: \"-1000px\",\r\n                top: \"-1000px\"\r\n            });\r\n        }\r\n        for (i in testElementStyle) {\r\n            testElement.style[i] = testElementStyle[i];\r\n        }\r\n        testElement.appendChild(div);\r\n        testElementParent = body || document.documentElement;\r\n        testElementParent.insertBefore(testElement, testElementParent.firstChild);\r\n\r\n        div.style.cssText = \"position: absolute; left: 10.7432222px;\";\r\n\r\n        offsetLeft = $(div).offset().left;\r\n        $.support.offsetFractions = offsetLeft > 10 && offsetLeft < 11;\r\n\r\n        testElement.innerHTML = \"\";\r\n        testElementParent.removeChild(testElement);\r\n    })();\r\n\r\n});\r\n","jquery/ui-modules/progressbar.js":"/*!\r\n * jQuery UI Progressbar - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/progressbar/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/core',\r\n    'jquery-ui-modules/widget'\r\n], function ($, undefined) {\r\n\r\n    $.widget(\"ui.progressbar\", {\r\n        version: \"1.10.4\",\r\n        options: {\r\n            max: 100,\r\n            value: 0,\r\n\r\n            change: null,\r\n            complete: null\r\n        },\r\n\r\n        min: 0,\r\n\r\n        _create: function () {\r\n            // Constrain initial value\r\n            this.oldValue = this.options.value = this._constrainedValue();\r\n\r\n            this.element\r\n                .addClass(\"ui-progressbar ui-widget ui-widget-content ui-corner-all\")\r\n                .attr({\r\n                    // Only set static values, aria-valuenow and aria-valuemax are\r\n                    // set inside _refreshValue()\r\n                    role: \"progressbar\",\r\n                    \"aria-valuemin\": this.min\r\n                });\r\n\r\n            this.valueDiv = $(\"<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>\")\r\n                .appendTo(this.element);\r\n\r\n            this._refreshValue();\r\n        },\r\n\r\n        _destroy: function () {\r\n            this.element\r\n                .removeClass(\"ui-progressbar ui-widget ui-widget-content ui-corner-all\")\r\n                .removeAttr(\"role\")\r\n                .removeAttr(\"aria-valuemin\")\r\n                .removeAttr(\"aria-valuemax\")\r\n                .removeAttr(\"aria-valuenow\");\r\n\r\n            this.valueDiv.remove();\r\n        },\r\n\r\n        value: function (newValue) {\r\n            if (newValue === undefined) {\r\n                return this.options.value;\r\n            }\r\n\r\n            this.options.value = this._constrainedValue(newValue);\r\n            this._refreshValue();\r\n        },\r\n\r\n        _constrainedValue: function (newValue) {\r\n            if (newValue === undefined) {\r\n                newValue = this.options.value;\r\n            }\r\n\r\n            this.indeterminate = newValue === false;\r\n\r\n            // sanitize value\r\n            if (typeof newValue !== \"number\") {\r\n                newValue = 0;\r\n            }\r\n\r\n            return this.indeterminate ? false :\r\n                Math.min(this.options.max, Math.max(this.min, newValue));\r\n        },\r\n\r\n        _setOptions: function (options) {\r\n            // Ensure \"value\" option is set after other values (like max)\r\n            var value = options.value;\r\n            delete options.value;\r\n\r\n            this._super(options);\r\n\r\n            this.options.value = this._constrainedValue(value);\r\n            this._refreshValue();\r\n        },\r\n\r\n        _setOption: function (key, value) {\r\n            if (key === \"max\") {\r\n                // Don't allow a max less than min\r\n                value = Math.max(this.min, value);\r\n            }\r\n\r\n            this._super(key, value);\r\n        },\r\n\r\n        _percentage: function () {\r\n            return this.indeterminate ? 100 : 100 * (this.options.value - this.min) / (this.options.max - this.min);\r\n        },\r\n\r\n        _refreshValue: function () {\r\n            var value = this.options.value,\r\n                percentage = this._percentage();\r\n\r\n            this.valueDiv\r\n                .toggle(this.indeterminate || value > this.min)\r\n                .toggleClass(\"ui-corner-right\", value === this.options.max)\r\n                .width(percentage.toFixed(0) + \"%\");\r\n\r\n            this.element.toggleClass(\"ui-progressbar-indeterminate\", this.indeterminate);\r\n\r\n            if (this.indeterminate) {\r\n                this.element.removeAttr(\"aria-valuenow\");\r\n                if (!this.overlayDiv) {\r\n                    this.overlayDiv = $(\"<div class='ui-progressbar-overlay'></div>\").appendTo(this.valueDiv);\r\n                }\r\n            } else {\r\n                this.element.attr({\r\n                    \"aria-valuemax\": this.options.max,\r\n                    \"aria-valuenow\": value\r\n                });\r\n                if (this.overlayDiv) {\r\n                    this.overlayDiv.remove();\r\n                    this.overlayDiv = null;\r\n                }\r\n            }\r\n\r\n            if (this.oldValue !== value) {\r\n                this.oldValue = value;\r\n                this._trigger(\"change\");\r\n            }\r\n            if (value === this.options.max) {\r\n                this._trigger(\"complete\");\r\n            }\r\n        }\r\n    });\r\n\r\n});\r\n","jquery/ui-modules/resizable.js":"/*!\r\n * jQuery UI Resizable - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/resizable/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/core',\r\n    'jquery-ui-modules/mouse'\r\n], function ($, undefined) {\r\n\r\n    function num(v) {\r\n        return parseInt(v, 10) || 0;\r\n    }\r\n\r\n    function isNumber(value) {\r\n        return !isNaN(parseInt(value, 10));\r\n    }\r\n\r\n    $.widget(\"ui.resizable\", $.ui.mouse, {\r\n        version: \"1.10.4\",\r\n        widgetEventPrefix: \"resize\",\r\n        options: {\r\n            alsoResize: false,\r\n            animate: false,\r\n            animateDuration: \"slow\",\r\n            animateEasing: \"swing\",\r\n            aspectRatio: false,\r\n            autoHide: false,\r\n            containment: false,\r\n            ghost: false,\r\n            grid: false,\r\n            handles: \"e,s,se\",\r\n            helper: false,\r\n            maxHeight: null,\r\n            maxWidth: null,\r\n            minHeight: 10,\r\n            minWidth: 10,\r\n            // See #7960\r\n            zIndex: 90,\r\n\r\n            // callbacks\r\n            resize: null,\r\n            start: null,\r\n            stop: null\r\n        },\r\n        _create: function () {\r\n\r\n            var n, i, handle, axis, hname,\r\n                that = this,\r\n                o = this.options;\r\n            this.element.addClass(\"ui-resizable\");\r\n\r\n            $.extend(this, {\r\n                _aspectRatio: !!(o.aspectRatio),\r\n                aspectRatio: o.aspectRatio,\r\n                originalElement: this.element,\r\n                _proportionallyResizeElements: [],\r\n                _helper: o.helper || o.ghost || o.animate ? o.helper || \"ui-resizable-helper\" : null\r\n            });\r\n\r\n            //Wrap the element if it cannot hold child nodes\r\n            if (this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)) {\r\n\r\n                //Create a wrapper element and set the wrapper to the new current internal element\r\n                this.element.wrap(\r\n                    $(\"<div class='ui-wrapper' style='overflow: hidden;'></div>\").css({\r\n                        position: this.element.css(\"position\"),\r\n                        width: this.element.outerWidth(),\r\n                        height: this.element.outerHeight(),\r\n                        top: this.element.css(\"top\"),\r\n                        left: this.element.css(\"left\")\r\n                    })\r\n                );\r\n\r\n                //Overwrite the original this.element\r\n                this.element = this.element.parent().data(\r\n                    \"ui-resizable\", this.element.data(\"ui-resizable\")\r\n                );\r\n\r\n                this.elementIsWrapper = true;\r\n\r\n                //Move margins to the wrapper\r\n                this.element.css({\r\n                    marginLeft: this.originalElement.css(\"marginLeft\"),\r\n                    marginTop: this.originalElement.css(\"marginTop\"),\r\n                    marginRight: this.originalElement.css(\"marginRight\"),\r\n                    marginBottom: this.originalElement.css(\"marginBottom\")\r\n                });\r\n                this.originalElement.css({marginLeft: 0, marginTop: 0, marginRight: 0, marginBottom: 0});\r\n\r\n                //Prevent Safari textarea resize\r\n                this.originalResizeStyle = this.originalElement.css(\"resize\");\r\n                this.originalElement.css(\"resize\", \"none\");\r\n\r\n                //Push the actual element to our proportionallyResize internal array\r\n                this._proportionallyResizeElements.push(this.originalElement.css({\r\n                    position: \"static\",\r\n                    zoom: 1,\r\n                    display: \"block\"\r\n                }));\r\n\r\n                // avoid IE jump (hard set the margin)\r\n                this.originalElement.css({margin: this.originalElement.css(\"margin\")});\r\n\r\n                // fix handlers offset\r\n                this._proportionallyResize();\r\n\r\n            }\r\n\r\n            this.handles = o.handles || (!$(\".ui-resizable-handle\", this.element).length ? \"e,s,se\" : {\r\n                n: \".ui-resizable-n\",\r\n                e: \".ui-resizable-e\",\r\n                s: \".ui-resizable-s\",\r\n                w: \".ui-resizable-w\",\r\n                se: \".ui-resizable-se\",\r\n                sw: \".ui-resizable-sw\",\r\n                ne: \".ui-resizable-ne\",\r\n                nw: \".ui-resizable-nw\"\r\n            });\r\n            if (this.handles.constructor === String) {\r\n\r\n                if (this.handles === \"all\") {\r\n                    this.handles = \"n,e,s,w,se,sw,ne,nw\";\r\n                }\r\n\r\n                n = this.handles.split(\",\");\r\n                this.handles = {};\r\n\r\n                for (i = 0; i < n.length; i++) {\r\n\r\n                    handle = $.trim(n[i]);\r\n                    hname = \"ui-resizable-\" + handle;\r\n                    axis = $(\"<div class='ui-resizable-handle \" + hname + \"'></div>\");\r\n\r\n                    // Apply zIndex to all handles - see #7960\r\n                    axis.css({zIndex: o.zIndex});\r\n\r\n                    //TODO : What's going on here?\r\n                    if (\"se\" === handle) {\r\n                        axis.addClass(\"ui-icon ui-icon-gripsmall-diagonal-se\");\r\n                    }\r\n\r\n                    //Insert into internal handles object and append to element\r\n                    this.handles[handle] = \".ui-resizable-\" + handle;\r\n                    this.element.append(axis);\r\n                }\r\n\r\n            }\r\n\r\n            this._renderAxis = function (target) {\r\n\r\n                var i, axis, padPos, padWrapper;\r\n\r\n                target = target || this.element;\r\n\r\n                for (i in this.handles) {\r\n\r\n                    if (this.handles[i].constructor === String) {\r\n                        this.handles[i] = $(this.handles[i], this.element).show();\r\n                    }\r\n\r\n                    //Apply pad to wrapper element, needed to fix axis position (textarea, inputs, scrolls)\r\n                    if (this.elementIsWrapper && this.originalElement[0].nodeName.match(/textarea|input|select|button/i)) {\r\n\r\n                        axis = $(this.handles[i], this.element);\r\n\r\n                        //Checking the correct pad and border\r\n                        padWrapper = /sw|ne|nw|se|n|s/.test(i) ? axis.outerHeight() : axis.outerWidth();\r\n\r\n                        //The padding type i have to apply...\r\n                        padPos = [\"padding\",\r\n                            /ne|nw|n/.test(i) ? \"Top\" :\r\n                                /se|sw|s/.test(i) ? \"Bottom\" :\r\n                                    /^e$/.test(i) ? \"Right\" : \"Left\"].join(\"\");\r\n\r\n                        target.css(padPos, padWrapper);\r\n\r\n                        this._proportionallyResize();\r\n\r\n                    }\r\n\r\n                    //TODO: What's that good for? There's not anything to be executed left\r\n                    if (!$(this.handles[i]).length) {\r\n                        continue;\r\n                    }\r\n                }\r\n            };\r\n\r\n            //TODO: make renderAxis a prototype function\r\n            this._renderAxis(this.element);\r\n\r\n            this._handles = $(\".ui-resizable-handle\", this.element)\r\n                .disableSelection();\r\n\r\n            //Matching axis name\r\n            this._handles.mouseover(function () {\r\n                if (!that.resizing) {\r\n                    if (this.className) {\r\n                        axis = this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);\r\n                    }\r\n                    //Axis, default = se\r\n                    that.axis = axis && axis[1] ? axis[1] : \"se\";\r\n                }\r\n            });\r\n\r\n            //If we want to auto hide the elements\r\n            if (o.autoHide) {\r\n                this._handles.hide();\r\n                $(this.element)\r\n                    .addClass(\"ui-resizable-autohide\")\r\n                    .mouseenter(function () {\r\n                        if (o.disabled) {\r\n                            return;\r\n                        }\r\n                        $(this).removeClass(\"ui-resizable-autohide\");\r\n                        that._handles.show();\r\n                    })\r\n                    .mouseleave(function () {\r\n                        if (o.disabled) {\r\n                            return;\r\n                        }\r\n                        if (!that.resizing) {\r\n                            $(this).addClass(\"ui-resizable-autohide\");\r\n                            that._handles.hide();\r\n                        }\r\n                    });\r\n            }\r\n\r\n            //Initialize the mouse interaction\r\n            this._mouseInit();\r\n\r\n        },\r\n\r\n        _destroy: function () {\r\n\r\n            this._mouseDestroy();\r\n\r\n            var wrapper,\r\n                _destroy = function (exp) {\r\n                    $(exp).removeClass(\"ui-resizable ui-resizable-disabled ui-resizable-resizing\")\r\n                        .removeData(\"resizable\").removeData(\"ui-resizable\").unbind(\".resizable\").find(\".ui-resizable-handle\").remove();\r\n                };\r\n\r\n            //TODO: Unwrap at same DOM position\r\n            if (this.elementIsWrapper) {\r\n                _destroy(this.element);\r\n                wrapper = this.element;\r\n                this.originalElement.css({\r\n                    position: wrapper.css(\"position\"),\r\n                    width: wrapper.outerWidth(),\r\n                    height: wrapper.outerHeight(),\r\n                    top: wrapper.css(\"top\"),\r\n                    left: wrapper.css(\"left\")\r\n                }).insertAfter(wrapper);\r\n                wrapper.remove();\r\n            }\r\n\r\n            this.originalElement.css(\"resize\", this.originalResizeStyle);\r\n            _destroy(this.originalElement);\r\n\r\n            return this;\r\n        },\r\n\r\n        _mouseCapture: function (event) {\r\n            var i, handle,\r\n                capture = false;\r\n\r\n            for (i in this.handles) {\r\n                handle = $(this.handles[i])[0];\r\n                if (handle === event.target || $.contains(handle, event.target)) {\r\n                    capture = true;\r\n                }\r\n            }\r\n\r\n            return !this.options.disabled && capture;\r\n        },\r\n\r\n        _mouseStart: function (event) {\r\n\r\n            var curleft, curtop, cursor,\r\n                o = this.options,\r\n                iniPos = this.element.position(),\r\n                el = this.element;\r\n\r\n            this.resizing = true;\r\n\r\n            // bugfix for http://dev.jquery.com/ticket/1749\r\n            if ((/absolute/).test(el.css(\"position\"))) {\r\n                el.css({position: \"absolute\", top: el.css(\"top\"), left: el.css(\"left\")});\r\n            } else if (el.is(\".ui-draggable\")) {\r\n                el.css({position: \"absolute\", top: iniPos.top, left: iniPos.left});\r\n            }\r\n\r\n            this._renderProxy();\r\n\r\n            curleft = num(this.helper.css(\"left\"));\r\n            curtop = num(this.helper.css(\"top\"));\r\n\r\n            if (o.containment) {\r\n                curleft += $(o.containment).scrollLeft() || 0;\r\n                curtop += $(o.containment).scrollTop() || 0;\r\n            }\r\n\r\n            //Store needed variables\r\n            this.offset = this.helper.offset();\r\n            this.position = {left: curleft, top: curtop};\r\n            this.size = this._helper ? {width: this.helper.width(), height: this.helper.height()} : {\r\n                width: el.width(),\r\n                height: el.height()\r\n            };\r\n            this.originalSize = this._helper ? {width: el.outerWidth(), height: el.outerHeight()} : {\r\n                width: el.width(),\r\n                height: el.height()\r\n            };\r\n            this.originalPosition = {left: curleft, top: curtop};\r\n            this.sizeDiff = {width: el.outerWidth() - el.width(), height: el.outerHeight() - el.height()};\r\n            this.originalMousePosition = {left: event.pageX, top: event.pageY};\r\n\r\n            //Aspect Ratio\r\n            this.aspectRatio = (typeof o.aspectRatio === \"number\") ? o.aspectRatio : ((this.originalSize.width / this.originalSize.height) || 1);\r\n\r\n            cursor = $(\".ui-resizable-\" + this.axis).css(\"cursor\");\r\n            $(\"body\").css(\"cursor\", cursor === \"auto\" ? this.axis + \"-resize\" : cursor);\r\n\r\n            el.addClass(\"ui-resizable-resizing\");\r\n            this._propagate(\"start\", event);\r\n            return true;\r\n        },\r\n\r\n        _mouseDrag: function (event) {\r\n\r\n            //Increase performance, avoid regex\r\n            var data,\r\n                el = this.helper, props = {},\r\n                smp = this.originalMousePosition,\r\n                a = this.axis,\r\n                prevTop = this.position.top,\r\n                prevLeft = this.position.left,\r\n                prevWidth = this.size.width,\r\n                prevHeight = this.size.height,\r\n                dx = (event.pageX - smp.left) || 0,\r\n                dy = (event.pageY - smp.top) || 0,\r\n                trigger = this._change[a];\r\n\r\n            if (!trigger) {\r\n                return false;\r\n            }\r\n\r\n            // Calculate the attrs that will be change\r\n            data = trigger.apply(this, [event, dx, dy]);\r\n\r\n            // Put this in the mouseDrag handler since the user can start pressing shift while resizing\r\n            this._updateVirtualBoundaries(event.shiftKey);\r\n            if (this._aspectRatio || event.shiftKey) {\r\n                data = this._updateRatio(data, event);\r\n            }\r\n\r\n            data = this._respectSize(data, event);\r\n\r\n            this._updateCache(data);\r\n\r\n            // plugins callbacks need to be called first\r\n            this._propagate(\"resize\", event);\r\n\r\n            if (this.position.top !== prevTop) {\r\n                props.top = this.position.top + \"px\";\r\n            }\r\n            if (this.position.left !== prevLeft) {\r\n                props.left = this.position.left + \"px\";\r\n            }\r\n            if (this.size.width !== prevWidth) {\r\n                props.width = this.size.width + \"px\";\r\n            }\r\n            if (this.size.height !== prevHeight) {\r\n                props.height = this.size.height + \"px\";\r\n            }\r\n            el.css(props);\r\n\r\n            if (!this._helper && this._proportionallyResizeElements.length) {\r\n                this._proportionallyResize();\r\n            }\r\n\r\n            // Call the user callback if the element was resized\r\n            if (!$.isEmptyObject(props)) {\r\n                this._trigger(\"resize\", event, this.ui());\r\n            }\r\n\r\n            return false;\r\n        },\r\n\r\n        _mouseStop: function (event) {\r\n\r\n            this.resizing = false;\r\n            var pr, ista, soffseth, soffsetw, s, left, top,\r\n                o = this.options, that = this;\r\n\r\n            if (this._helper) {\r\n\r\n                pr = this._proportionallyResizeElements;\r\n                ista = pr.length && (/textarea/i).test(pr[0].nodeName);\r\n                soffseth = ista && $.ui.hasScroll(pr[0], \"left\") /* TODO - jump height */ ? 0 : that.sizeDiff.height;\r\n                soffsetw = ista ? 0 : that.sizeDiff.width;\r\n\r\n                s = {width: (that.helper.width() - soffsetw), height: (that.helper.height() - soffseth)};\r\n                left = (parseInt(that.element.css(\"left\"), 10) + (that.position.left - that.originalPosition.left)) || null;\r\n                top = (parseInt(that.element.css(\"top\"), 10) + (that.position.top - that.originalPosition.top)) || null;\r\n\r\n                if (!o.animate) {\r\n                    this.element.css($.extend(s, {top: top, left: left}));\r\n                }\r\n\r\n                that.helper.height(that.size.height);\r\n                that.helper.width(that.size.width);\r\n\r\n                if (this._helper && !o.animate) {\r\n                    this._proportionallyResize();\r\n                }\r\n            }\r\n\r\n            $(\"body\").css(\"cursor\", \"auto\");\r\n\r\n            this.element.removeClass(\"ui-resizable-resizing\");\r\n\r\n            this._propagate(\"stop\", event);\r\n\r\n            if (this._helper) {\r\n                this.helper.remove();\r\n            }\r\n\r\n            return false;\r\n\r\n        },\r\n\r\n        _updateVirtualBoundaries: function (forceAspectRatio) {\r\n            var pMinWidth, pMaxWidth, pMinHeight, pMaxHeight, b,\r\n                o = this.options;\r\n\r\n            b = {\r\n                minWidth: isNumber(o.minWidth) ? o.minWidth : 0,\r\n                maxWidth: isNumber(o.maxWidth) ? o.maxWidth : Infinity,\r\n                minHeight: isNumber(o.minHeight) ? o.minHeight : 0,\r\n                maxHeight: isNumber(o.maxHeight) ? o.maxHeight : Infinity\r\n            };\r\n\r\n            if (this._aspectRatio || forceAspectRatio) {\r\n                // We want to create an enclosing box whose aspect ration is the requested one\r\n                // First, compute the \"projected\" size for each dimension based on the aspect ratio and other dimension\r\n                pMinWidth = b.minHeight * this.aspectRatio;\r\n                pMinHeight = b.minWidth / this.aspectRatio;\r\n                pMaxWidth = b.maxHeight * this.aspectRatio;\r\n                pMaxHeight = b.maxWidth / this.aspectRatio;\r\n\r\n                if (pMinWidth > b.minWidth) {\r\n                    b.minWidth = pMinWidth;\r\n                }\r\n                if (pMinHeight > b.minHeight) {\r\n                    b.minHeight = pMinHeight;\r\n                }\r\n                if (pMaxWidth < b.maxWidth) {\r\n                    b.maxWidth = pMaxWidth;\r\n                }\r\n                if (pMaxHeight < b.maxHeight) {\r\n                    b.maxHeight = pMaxHeight;\r\n                }\r\n            }\r\n            this._vBoundaries = b;\r\n        },\r\n\r\n        _updateCache: function (data) {\r\n            this.offset = this.helper.offset();\r\n            if (isNumber(data.left)) {\r\n                this.position.left = data.left;\r\n            }\r\n            if (isNumber(data.top)) {\r\n                this.position.top = data.top;\r\n            }\r\n            if (isNumber(data.height)) {\r\n                this.size.height = data.height;\r\n            }\r\n            if (isNumber(data.width)) {\r\n                this.size.width = data.width;\r\n            }\r\n        },\r\n\r\n        _updateRatio: function (data) {\r\n\r\n            var cpos = this.position,\r\n                csize = this.size,\r\n                a = this.axis;\r\n\r\n            if (isNumber(data.height)) {\r\n                data.width = (data.height * this.aspectRatio);\r\n            } else if (isNumber(data.width)) {\r\n                data.height = (data.width / this.aspectRatio);\r\n            }\r\n\r\n            if (a === \"sw\") {\r\n                data.left = cpos.left + (csize.width - data.width);\r\n                data.top = null;\r\n            }\r\n            if (a === \"nw\") {\r\n                data.top = cpos.top + (csize.height - data.height);\r\n                data.left = cpos.left + (csize.width - data.width);\r\n            }\r\n\r\n            return data;\r\n        },\r\n\r\n        _respectSize: function (data) {\r\n\r\n            var o = this._vBoundaries,\r\n                a = this.axis,\r\n                ismaxw = isNumber(data.width) && o.maxWidth && (o.maxWidth < data.width),\r\n                ismaxh = isNumber(data.height) && o.maxHeight && (o.maxHeight < data.height),\r\n                isminw = isNumber(data.width) && o.minWidth && (o.minWidth > data.width),\r\n                isminh = isNumber(data.height) && o.minHeight && (o.minHeight > data.height),\r\n                dw = this.originalPosition.left + this.originalSize.width,\r\n                dh = this.position.top + this.size.height,\r\n                cw = /sw|nw|w/.test(a), ch = /nw|ne|n/.test(a);\r\n            if (isminw) {\r\n                data.width = o.minWidth;\r\n            }\r\n            if (isminh) {\r\n                data.height = o.minHeight;\r\n            }\r\n            if (ismaxw) {\r\n                data.width = o.maxWidth;\r\n            }\r\n            if (ismaxh) {\r\n                data.height = o.maxHeight;\r\n            }\r\n\r\n            if (isminw && cw) {\r\n                data.left = dw - o.minWidth;\r\n            }\r\n            if (ismaxw && cw) {\r\n                data.left = dw - o.maxWidth;\r\n            }\r\n            if (isminh && ch) {\r\n                data.top = dh - o.minHeight;\r\n            }\r\n            if (ismaxh && ch) {\r\n                data.top = dh - o.maxHeight;\r\n            }\r\n\r\n            // fixing jump error on top/left - bug #2330\r\n            if (!data.width && !data.height && !data.left && data.top) {\r\n                data.top = null;\r\n            } else if (!data.width && !data.height && !data.top && data.left) {\r\n                data.left = null;\r\n            }\r\n\r\n            return data;\r\n        },\r\n\r\n        _proportionallyResize: function () {\r\n\r\n            if (!this._proportionallyResizeElements.length) {\r\n                return;\r\n            }\r\n\r\n            var i, j, borders, paddings, prel,\r\n                element = this.helper || this.element;\r\n\r\n            for (i = 0; i < this._proportionallyResizeElements.length; i++) {\r\n\r\n                prel = this._proportionallyResizeElements[i];\r\n\r\n                if (!this.borderDif) {\r\n                    this.borderDif = [];\r\n                    borders = [prel.css(\"borderTopWidth\"), prel.css(\"borderRightWidth\"), prel.css(\"borderBottomWidth\"), prel.css(\"borderLeftWidth\")];\r\n                    paddings = [prel.css(\"paddingTop\"), prel.css(\"paddingRight\"), prel.css(\"paddingBottom\"), prel.css(\"paddingLeft\")];\r\n\r\n                    for (j = 0; j < borders.length; j++) {\r\n                        this.borderDif[j] = (parseInt(borders[j], 10) || 0) + (parseInt(paddings[j], 10) || 0);\r\n                    }\r\n                }\r\n\r\n                prel.css({\r\n                    height: (element.height() - this.borderDif[0] - this.borderDif[2]) || 0,\r\n                    width: (element.width() - this.borderDif[1] - this.borderDif[3]) || 0\r\n                });\r\n\r\n            }\r\n\r\n        },\r\n\r\n        _renderProxy: function () {\r\n\r\n            var el = this.element, o = this.options;\r\n            this.elementOffset = el.offset();\r\n\r\n            if (this._helper) {\r\n\r\n                this.helper = this.helper || $(\"<div style='overflow:hidden;'></div>\");\r\n\r\n                this.helper.addClass(this._helper).css({\r\n                    width: this.element.outerWidth() - 1,\r\n                    height: this.element.outerHeight() - 1,\r\n                    position: \"absolute\",\r\n                    left: this.elementOffset.left + \"px\",\r\n                    top: this.elementOffset.top + \"px\",\r\n                    zIndex: ++o.zIndex //TODO: Don't modify option\r\n                });\r\n\r\n                this.helper\r\n                    .appendTo(\"body\")\r\n                    .disableSelection();\r\n\r\n            } else {\r\n                this.helper = this.element;\r\n            }\r\n\r\n        },\r\n\r\n        _change: {\r\n            e: function (event, dx) {\r\n                return {width: this.originalSize.width + dx};\r\n            },\r\n            w: function (event, dx) {\r\n                var cs = this.originalSize, sp = this.originalPosition;\r\n                return {left: sp.left + dx, width: cs.width - dx};\r\n            },\r\n            n: function (event, dx, dy) {\r\n                var cs = this.originalSize, sp = this.originalPosition;\r\n                return {top: sp.top + dy, height: cs.height - dy};\r\n            },\r\n            s: function (event, dx, dy) {\r\n                return {height: this.originalSize.height + dy};\r\n            },\r\n            se: function (event, dx, dy) {\r\n                return $.extend(this._change.s.apply(this, arguments), this._change.e.apply(this, [event, dx, dy]));\r\n            },\r\n            sw: function (event, dx, dy) {\r\n                return $.extend(this._change.s.apply(this, arguments), this._change.w.apply(this, [event, dx, dy]));\r\n            },\r\n            ne: function (event, dx, dy) {\r\n                return $.extend(this._change.n.apply(this, arguments), this._change.e.apply(this, [event, dx, dy]));\r\n            },\r\n            nw: function (event, dx, dy) {\r\n                return $.extend(this._change.n.apply(this, arguments), this._change.w.apply(this, [event, dx, dy]));\r\n            }\r\n        },\r\n\r\n        _propagate: function (n, event) {\r\n            $.ui.plugin.call(this, n, [event, this.ui()]);\r\n            (n !== \"resize\" && this._trigger(n, event, this.ui()));\r\n        },\r\n\r\n        plugins: {},\r\n\r\n        ui: function () {\r\n            return {\r\n                originalElement: this.originalElement,\r\n                element: this.element,\r\n                helper: this.helper,\r\n                position: this.position,\r\n                size: this.size,\r\n                originalSize: this.originalSize,\r\n                originalPosition: this.originalPosition\r\n            };\r\n        }\r\n\r\n    });\r\n\r\n    /*\r\n     * Resizable Extensions\r\n     */\r\n\r\n    $.ui.plugin.add(\"resizable\", \"animate\", {\r\n\r\n        stop: function (event) {\r\n            var that = $(this).data(\"ui-resizable\"),\r\n                o = that.options,\r\n                pr = that._proportionallyResizeElements,\r\n                ista = pr.length && (/textarea/i).test(pr[0].nodeName),\r\n                soffseth = ista && $.ui.hasScroll(pr[0], \"left\") /* TODO - jump height */ ? 0 : that.sizeDiff.height,\r\n                soffsetw = ista ? 0 : that.sizeDiff.width,\r\n                style = {width: (that.size.width - soffsetw), height: (that.size.height - soffseth)},\r\n                left = (parseInt(that.element.css(\"left\"), 10) + (that.position.left - that.originalPosition.left)) || null,\r\n                top = (parseInt(that.element.css(\"top\"), 10) + (that.position.top - that.originalPosition.top)) || null;\r\n\r\n            that.element.animate(\r\n                $.extend(style, top && left ? {top: top, left: left} : {}), {\r\n                    duration: o.animateDuration,\r\n                    easing: o.animateEasing,\r\n                    step: function () {\r\n\r\n                        var data = {\r\n                            width: parseInt(that.element.css(\"width\"), 10),\r\n                            height: parseInt(that.element.css(\"height\"), 10),\r\n                            top: parseInt(that.element.css(\"top\"), 10),\r\n                            left: parseInt(that.element.css(\"left\"), 10)\r\n                        };\r\n\r\n                        if (pr && pr.length) {\r\n                            $(pr[0]).css({width: data.width, height: data.height});\r\n                        }\r\n\r\n                        // propagating resize, and updating values for each animation step\r\n                        that._updateCache(data);\r\n                        that._propagate(\"resize\", event);\r\n\r\n                    }\r\n                }\r\n            );\r\n        }\r\n\r\n    });\r\n\r\n    $.ui.plugin.add(\"resizable\", \"containment\", {\r\n\r\n        start: function () {\r\n            var element, p, co, ch, cw, width, height,\r\n                that = $(this).data(\"ui-resizable\"),\r\n                o = that.options,\r\n                el = that.element,\r\n                oc = o.containment,\r\n                ce = (oc instanceof $) ? oc.get(0) : (/parent/.test(oc)) ? el.parent().get(0) : oc;\r\n\r\n            if (!ce) {\r\n                return;\r\n            }\r\n\r\n            that.containerElement = $(ce);\r\n\r\n            if (/document/.test(oc) || oc === document) {\r\n                that.containerOffset = {left: 0, top: 0};\r\n                that.containerPosition = {left: 0, top: 0};\r\n\r\n                that.parentData = {\r\n                    element: $(document), left: 0, top: 0,\r\n                    width: $(document).width(), height: $(document).height() || document.body.parentNode.scrollHeight\r\n                };\r\n            }\r\n\r\n            // i'm a node, so compute top, left, right, bottom\r\n            else {\r\n                element = $(ce);\r\n                p = [];\r\n                $([\"Top\", \"Right\", \"Left\", \"Bottom\"]).each(function (i, name) {\r\n                    p[i] = num(element.css(\"padding\" + name));\r\n                });\r\n\r\n                that.containerOffset = element.offset();\r\n                that.containerPosition = element.position();\r\n                that.containerSize = {height: (element.innerHeight() - p[3]), width: (element.innerWidth() - p[1])};\r\n\r\n                co = that.containerOffset;\r\n                ch = that.containerSize.height;\r\n                cw = that.containerSize.width;\r\n                width = ($.ui.hasScroll(ce, \"left\") ? ce.scrollWidth : cw);\r\n                height = ($.ui.hasScroll(ce) ? ce.scrollHeight : ch);\r\n\r\n                that.parentData = {\r\n                    element: ce, left: co.left, top: co.top, width: width, height: height\r\n                };\r\n            }\r\n        },\r\n\r\n        resize: function (event) {\r\n            var woset, hoset, isParent, isOffsetRelative,\r\n                that = $(this).data(\"ui-resizable\"),\r\n                o = that.options,\r\n                co = that.containerOffset, cp = that.position,\r\n                pRatio = that._aspectRatio || event.shiftKey,\r\n                cop = {top: 0, left: 0}, ce = that.containerElement;\r\n\r\n            if (ce[0] !== document && (/static/).test(ce.css(\"position\"))) {\r\n                cop = co;\r\n            }\r\n\r\n            if (cp.left < (that._helper ? co.left : 0)) {\r\n                that.size.width = that.size.width + (that._helper ? (that.position.left - co.left) : (that.position.left - cop.left));\r\n                if (pRatio) {\r\n                    that.size.height = that.size.width / that.aspectRatio;\r\n                }\r\n                that.position.left = o.helper ? co.left : 0;\r\n            }\r\n\r\n            if (cp.top < (that._helper ? co.top : 0)) {\r\n                that.size.height = that.size.height + (that._helper ? (that.position.top - co.top) : that.position.top);\r\n                if (pRatio) {\r\n                    that.size.width = that.size.height * that.aspectRatio;\r\n                }\r\n                that.position.top = that._helper ? co.top : 0;\r\n            }\r\n\r\n            that.offset.left = that.parentData.left + that.position.left;\r\n            that.offset.top = that.parentData.top + that.position.top;\r\n\r\n            woset = Math.abs((that._helper ? that.offset.left - cop.left : (that.offset.left - cop.left)) + that.sizeDiff.width);\r\n            hoset = Math.abs((that._helper ? that.offset.top - cop.top : (that.offset.top - co.top)) + that.sizeDiff.height);\r\n\r\n            isParent = that.containerElement.get(0) === that.element.parent().get(0);\r\n            isOffsetRelative = /relative|absolute/.test(that.containerElement.css(\"position\"));\r\n\r\n            if (isParent && isOffsetRelative) {\r\n                woset -= Math.abs(that.parentData.left);\r\n            }\r\n\r\n            if (woset + that.size.width >= that.parentData.width) {\r\n                that.size.width = that.parentData.width - woset;\r\n                if (pRatio) {\r\n                    that.size.height = that.size.width / that.aspectRatio;\r\n                }\r\n            }\r\n\r\n            if (hoset + that.size.height >= that.parentData.height) {\r\n                that.size.height = that.parentData.height - hoset;\r\n                if (pRatio) {\r\n                    that.size.width = that.size.height * that.aspectRatio;\r\n                }\r\n            }\r\n        },\r\n\r\n        stop: function () {\r\n            var that = $(this).data(\"ui-resizable\"),\r\n                o = that.options,\r\n                co = that.containerOffset,\r\n                cop = that.containerPosition,\r\n                ce = that.containerElement,\r\n                helper = $(that.helper),\r\n                ho = helper.offset(),\r\n                w = helper.outerWidth() - that.sizeDiff.width,\r\n                h = helper.outerHeight() - that.sizeDiff.height;\r\n\r\n            if (that._helper && !o.animate && (/relative/).test(ce.css(\"position\"))) {\r\n                $(this).css({left: ho.left - cop.left - co.left, width: w, height: h});\r\n            }\r\n\r\n            if (that._helper && !o.animate && (/static/).test(ce.css(\"position\"))) {\r\n                $(this).css({left: ho.left - cop.left - co.left, width: w, height: h});\r\n            }\r\n\r\n        }\r\n    });\r\n\r\n    $.ui.plugin.add(\"resizable\", \"alsoResize\", {\r\n\r\n        start: function () {\r\n            var that = $(this).data(\"ui-resizable\"),\r\n                o = that.options,\r\n                _store = function (exp) {\r\n                    $(exp).each(function () {\r\n                        var el = $(this);\r\n                        el.data(\"ui-resizable-alsoresize\", {\r\n                            width: parseInt(el.width(), 10), height: parseInt(el.height(), 10),\r\n                            left: parseInt(el.css(\"left\"), 10), top: parseInt(el.css(\"top\"), 10)\r\n                        });\r\n                    });\r\n                };\r\n\r\n            if (typeof (o.alsoResize) === \"object\" && !o.alsoResize.parentNode) {\r\n                if (o.alsoResize.length) {\r\n                    o.alsoResize = o.alsoResize[0];\r\n                    _store(o.alsoResize);\r\n                } else {\r\n                    $.each(o.alsoResize, function (exp) {\r\n                        _store(exp);\r\n                    });\r\n                }\r\n            } else {\r\n                _store(o.alsoResize);\r\n            }\r\n        },\r\n\r\n        resize: function (event, ui) {\r\n            var that = $(this).data(\"ui-resizable\"),\r\n                o = that.options,\r\n                os = that.originalSize,\r\n                op = that.originalPosition,\r\n                delta = {\r\n                    height: (that.size.height - os.height) || 0, width: (that.size.width - os.width) || 0,\r\n                    top: (that.position.top - op.top) || 0, left: (that.position.left - op.left) || 0\r\n                },\r\n\r\n                _alsoResize = function (exp, c) {\r\n                    $(exp).each(function () {\r\n                        var el = $(this), start = $(this).data(\"ui-resizable-alsoresize\"), style = {},\r\n                            css = c && c.length ? c : el.parents(ui.originalElement[0]).length ? [\"width\", \"height\"] : [\"width\", \"height\", \"top\", \"left\"];\r\n\r\n                        $.each(css, function (i, prop) {\r\n                            var sum = (start[prop] || 0) + (delta[prop] || 0);\r\n                            if (sum && sum >= 0) {\r\n                                style[prop] = sum || null;\r\n                            }\r\n                        });\r\n\r\n                        el.css(style);\r\n                    });\r\n                };\r\n\r\n            if (typeof (o.alsoResize) === \"object\" && !o.alsoResize.nodeType) {\r\n                $.each(o.alsoResize, function (exp, c) {\r\n                    _alsoResize(exp, c);\r\n                });\r\n            } else {\r\n                _alsoResize(o.alsoResize);\r\n            }\r\n        },\r\n\r\n        stop: function () {\r\n            $(this).removeData(\"resizable-alsoresize\");\r\n        }\r\n    });\r\n\r\n    $.ui.plugin.add(\"resizable\", \"ghost\", {\r\n\r\n        start: function () {\r\n\r\n            var that = $(this).data(\"ui-resizable\"), o = that.options, cs = that.size;\r\n\r\n            that.ghost = that.originalElement.clone();\r\n            that.ghost\r\n                .css({\r\n                    opacity: 0.25,\r\n                    display: \"block\",\r\n                    position: \"relative\",\r\n                    height: cs.height,\r\n                    width: cs.width,\r\n                    margin: 0,\r\n                    left: 0,\r\n                    top: 0\r\n                })\r\n                .addClass(\"ui-resizable-ghost\")\r\n                .addClass(typeof o.ghost === \"string\" ? o.ghost : \"\");\r\n\r\n            that.ghost.appendTo(that.helper);\r\n\r\n        },\r\n\r\n        resize: function () {\r\n            var that = $(this).data(\"ui-resizable\");\r\n            if (that.ghost) {\r\n                that.ghost.css({position: \"relative\", height: that.size.height, width: that.size.width});\r\n            }\r\n        },\r\n\r\n        stop: function () {\r\n            var that = $(this).data(\"ui-resizable\");\r\n            if (that.ghost && that.helper) {\r\n                that.helper.get(0).removeChild(that.ghost.get(0));\r\n            }\r\n        }\r\n\r\n    });\r\n\r\n    $.ui.plugin.add(\"resizable\", \"grid\", {\r\n\r\n        resize: function () {\r\n            var that = $(this).data(\"ui-resizable\"),\r\n                o = that.options,\r\n                cs = that.size,\r\n                os = that.originalSize,\r\n                op = that.originalPosition,\r\n                a = that.axis,\r\n                grid = typeof o.grid === \"number\" ? [o.grid, o.grid] : o.grid,\r\n                gridX = (grid[0] || 1),\r\n                gridY = (grid[1] || 1),\r\n                ox = Math.round((cs.width - os.width) / gridX) * gridX,\r\n                oy = Math.round((cs.height - os.height) / gridY) * gridY,\r\n                newWidth = os.width + ox,\r\n                newHeight = os.height + oy,\r\n                isMaxWidth = o.maxWidth && (o.maxWidth < newWidth),\r\n                isMaxHeight = o.maxHeight && (o.maxHeight < newHeight),\r\n                isMinWidth = o.minWidth && (o.minWidth > newWidth),\r\n                isMinHeight = o.minHeight && (o.minHeight > newHeight);\r\n\r\n            o.grid = grid;\r\n\r\n            if (isMinWidth) {\r\n                newWidth = newWidth + gridX;\r\n            }\r\n            if (isMinHeight) {\r\n                newHeight = newHeight + gridY;\r\n            }\r\n            if (isMaxWidth) {\r\n                newWidth = newWidth - gridX;\r\n            }\r\n            if (isMaxHeight) {\r\n                newHeight = newHeight - gridY;\r\n            }\r\n\r\n            if (/^(se|s|e)$/.test(a)) {\r\n                that.size.width = newWidth;\r\n                that.size.height = newHeight;\r\n            } else if (/^(ne)$/.test(a)) {\r\n                that.size.width = newWidth;\r\n                that.size.height = newHeight;\r\n                that.position.top = op.top - oy;\r\n            } else if (/^(sw)$/.test(a)) {\r\n                that.size.width = newWidth;\r\n                that.size.height = newHeight;\r\n                that.position.left = op.left - ox;\r\n            } else {\r\n                if (newHeight - gridY > 0) {\r\n                    that.size.height = newHeight;\r\n                    that.position.top = op.top - oy;\r\n                } else {\r\n                    that.size.height = gridY;\r\n                    that.position.top = op.top + os.height - gridY;\r\n                }\r\n                if (newWidth - gridX > 0) {\r\n                    that.size.width = newWidth;\r\n                    that.position.left = op.left - ox;\r\n                } else {\r\n                    that.size.width = gridX;\r\n                    that.position.left = op.left + os.width - gridX;\r\n                }\r\n            }\r\n        }\r\n\r\n    });\r\n\r\n});\r\n","jquery/ui-modules/selectable.js":"/*!\r\n * jQuery UI Selectable - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/selectable/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/core',\r\n    'jquery-ui-modules/mouse'\r\n], function ($, undefined) {\r\n\r\n    $.widget(\"ui.selectable\", $.ui.mouse, {\r\n        version: \"1.10.4\",\r\n        options: {\r\n            appendTo: \"body\",\r\n            autoRefresh: true,\r\n            distance: 0,\r\n            filter: \"*\",\r\n            tolerance: \"touch\",\r\n\r\n            // callbacks\r\n            selected: null,\r\n            selecting: null,\r\n            start: null,\r\n            stop: null,\r\n            unselected: null,\r\n            unselecting: null\r\n        },\r\n        _create: function () {\r\n            var selectees,\r\n                that = this;\r\n\r\n            this.element.addClass(\"ui-selectable\");\r\n\r\n            this.dragged = false;\r\n\r\n            // cache selectee children based on filter\r\n            this.refresh = function () {\r\n                selectees = $(that.options.filter, that.element[0]);\r\n                selectees.addClass(\"ui-selectee\");\r\n                selectees.each(function () {\r\n                    var $this = $(this),\r\n                        pos = $this.offset();\r\n                    $.data(this, \"selectable-item\", {\r\n                        element: this,\r\n                        $element: $this,\r\n                        left: pos.left,\r\n                        top: pos.top,\r\n                        right: pos.left + $this.outerWidth(),\r\n                        bottom: pos.top + $this.outerHeight(),\r\n                        startselected: false,\r\n                        selected: $this.hasClass(\"ui-selected\"),\r\n                        selecting: $this.hasClass(\"ui-selecting\"),\r\n                        unselecting: $this.hasClass(\"ui-unselecting\")\r\n                    });\r\n                });\r\n            };\r\n            this.refresh();\r\n\r\n            this.selectees = selectees.addClass(\"ui-selectee\");\r\n\r\n            this._mouseInit();\r\n\r\n            this.helper = $(\"<div class='ui-selectable-helper'></div>\");\r\n        },\r\n\r\n        _destroy: function () {\r\n            this.selectees\r\n                .removeClass(\"ui-selectee\")\r\n                .removeData(\"selectable-item\");\r\n            this.element\r\n                .removeClass(\"ui-selectable ui-selectable-disabled\");\r\n            this._mouseDestroy();\r\n        },\r\n\r\n        _mouseStart: function (event) {\r\n            var that = this,\r\n                options = this.options;\r\n\r\n            this.opos = [event.pageX, event.pageY];\r\n\r\n            if (this.options.disabled) {\r\n                return;\r\n            }\r\n\r\n            this.selectees = $(options.filter, this.element[0]);\r\n\r\n            this._trigger(\"start\", event);\r\n\r\n            $(options.appendTo).append(this.helper);\r\n            // position helper (lasso)\r\n            this.helper.css({\r\n                \"left\": event.pageX,\r\n                \"top\": event.pageY,\r\n                \"width\": 0,\r\n                \"height\": 0\r\n            });\r\n\r\n            if (options.autoRefresh) {\r\n                this.refresh();\r\n            }\r\n\r\n            this.selectees.filter(\".ui-selected\").each(function () {\r\n                var selectee = $.data(this, \"selectable-item\");\r\n                selectee.startselected = true;\r\n                if (!event.metaKey && !event.ctrlKey) {\r\n                    selectee.$element.removeClass(\"ui-selected\");\r\n                    selectee.selected = false;\r\n                    selectee.$element.addClass(\"ui-unselecting\");\r\n                    selectee.unselecting = true;\r\n                    // selectable UNSELECTING callback\r\n                    that._trigger(\"unselecting\", event, {\r\n                        unselecting: selectee.element\r\n                    });\r\n                }\r\n            });\r\n\r\n            $(event.target).parents().addBack().each(function () {\r\n                var doSelect,\r\n                    selectee = $.data(this, \"selectable-item\");\r\n                if (selectee) {\r\n                    doSelect = (!event.metaKey && !event.ctrlKey) || !selectee.$element.hasClass(\"ui-selected\");\r\n                    selectee.$element\r\n                        .removeClass(doSelect ? \"ui-unselecting\" : \"ui-selected\")\r\n                        .addClass(doSelect ? \"ui-selecting\" : \"ui-unselecting\");\r\n                    selectee.unselecting = !doSelect;\r\n                    selectee.selecting = doSelect;\r\n                    selectee.selected = doSelect;\r\n                    // selectable (UN)SELECTING callback\r\n                    if (doSelect) {\r\n                        that._trigger(\"selecting\", event, {\r\n                            selecting: selectee.element\r\n                        });\r\n                    } else {\r\n                        that._trigger(\"unselecting\", event, {\r\n                            unselecting: selectee.element\r\n                        });\r\n                    }\r\n                    return false;\r\n                }\r\n            });\r\n\r\n        },\r\n\r\n        _mouseDrag: function (event) {\r\n\r\n            this.dragged = true;\r\n\r\n            if (this.options.disabled) {\r\n                return;\r\n            }\r\n\r\n            var tmp,\r\n                that = this,\r\n                options = this.options,\r\n                x1 = this.opos[0],\r\n                y1 = this.opos[1],\r\n                x2 = event.pageX,\r\n                y2 = event.pageY;\r\n\r\n            if (x1 > x2) {\r\n                tmp = x2;\r\n                x2 = x1;\r\n                x1 = tmp;\r\n            }\r\n            if (y1 > y2) {\r\n                tmp = y2;\r\n                y2 = y1;\r\n                y1 = tmp;\r\n            }\r\n            this.helper.css({left: x1, top: y1, width: x2 - x1, height: y2 - y1});\r\n\r\n            this.selectees.each(function () {\r\n                var selectee = $.data(this, \"selectable-item\"),\r\n                    hit = false;\r\n\r\n                //prevent helper from being selected if appendTo: selectable\r\n                if (!selectee || selectee.element === that.element[0]) {\r\n                    return;\r\n                }\r\n\r\n                if (options.tolerance === \"touch\") {\r\n                    hit = (!(selectee.left > x2 || selectee.right < x1 || selectee.top > y2 || selectee.bottom < y1));\r\n                } else if (options.tolerance === \"fit\") {\r\n                    hit = (selectee.left > x1 && selectee.right < x2 && selectee.top > y1 && selectee.bottom < y2);\r\n                }\r\n\r\n                if (hit) {\r\n                    // SELECT\r\n                    if (selectee.selected) {\r\n                        selectee.$element.removeClass(\"ui-selected\");\r\n                        selectee.selected = false;\r\n                    }\r\n                    if (selectee.unselecting) {\r\n                        selectee.$element.removeClass(\"ui-unselecting\");\r\n                        selectee.unselecting = false;\r\n                    }\r\n                    if (!selectee.selecting) {\r\n                        selectee.$element.addClass(\"ui-selecting\");\r\n                        selectee.selecting = true;\r\n                        // selectable SELECTING callback\r\n                        that._trigger(\"selecting\", event, {\r\n                            selecting: selectee.element\r\n                        });\r\n                    }\r\n                } else {\r\n                    // UNSELECT\r\n                    if (selectee.selecting) {\r\n                        if ((event.metaKey || event.ctrlKey) && selectee.startselected) {\r\n                            selectee.$element.removeClass(\"ui-selecting\");\r\n                            selectee.selecting = false;\r\n                            selectee.$element.addClass(\"ui-selected\");\r\n                            selectee.selected = true;\r\n                        } else {\r\n                            selectee.$element.removeClass(\"ui-selecting\");\r\n                            selectee.selecting = false;\r\n                            if (selectee.startselected) {\r\n                                selectee.$element.addClass(\"ui-unselecting\");\r\n                                selectee.unselecting = true;\r\n                            }\r\n                            // selectable UNSELECTING callback\r\n                            that._trigger(\"unselecting\", event, {\r\n                                unselecting: selectee.element\r\n                            });\r\n                        }\r\n                    }\r\n                    if (selectee.selected) {\r\n                        if (!event.metaKey && !event.ctrlKey && !selectee.startselected) {\r\n                            selectee.$element.removeClass(\"ui-selected\");\r\n                            selectee.selected = false;\r\n\r\n                            selectee.$element.addClass(\"ui-unselecting\");\r\n                            selectee.unselecting = true;\r\n                            // selectable UNSELECTING callback\r\n                            that._trigger(\"unselecting\", event, {\r\n                                unselecting: selectee.element\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            return false;\r\n        },\r\n\r\n        _mouseStop: function (event) {\r\n            var that = this;\r\n\r\n            this.dragged = false;\r\n\r\n            $(\".ui-unselecting\", this.element[0]).each(function () {\r\n                var selectee = $.data(this, \"selectable-item\");\r\n                selectee.$element.removeClass(\"ui-unselecting\");\r\n                selectee.unselecting = false;\r\n                selectee.startselected = false;\r\n                that._trigger(\"unselected\", event, {\r\n                    unselected: selectee.element\r\n                });\r\n            });\r\n            $(\".ui-selecting\", this.element[0]).each(function () {\r\n                var selectee = $.data(this, \"selectable-item\");\r\n                selectee.$element.removeClass(\"ui-selecting\").addClass(\"ui-selected\");\r\n                selectee.selecting = false;\r\n                selectee.selected = true;\r\n                selectee.startselected = true;\r\n                that._trigger(\"selected\", event, {\r\n                    selected: selectee.element\r\n                });\r\n            });\r\n            this._trigger(\"stop\", event);\r\n\r\n            this.helper.remove();\r\n\r\n            return false;\r\n        }\r\n\r\n    });\r\n\r\n});\r\n","jquery/ui-modules/slider.js":"/*!\r\n * jQuery UI Slider - v1.10.4\r\n * http://jqueryui.com\r\n *\r\n * Copyright 2014 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n *\r\n * http://api.jqueryui.com/slider/\r\n */\r\n\r\ndefine([\r\n    'jquery',\r\n    'jquery-ui-modules/core',\r\n    'jquery-ui-modules/mouse'\r\n], function ($, undefined) {\r\n\r\n// number of pages in a slider\r\n// (how many times can you page up/down to go through the whole range)\r\n    var numPages = 5;\r\n\r\n    $.widget(\"ui.slider\", $.ui.mouse, {\r\n        version: \"1.10.4\",\r\n        widgetEventPrefix: \"slide\",\r\n\r\n        options: {\r\n            animate: false,\r\n            distance: 0,\r\n            max: 100,\r\n            min: 0,\r\n            orientation: \"horizontal\",\r\n            range: false,\r\n            step: 1,\r\n            value: 0,\r\n            values: null,\r\n\r\n            // callbacks\r\n            change: null,\r\n            slide: null,\r\n            start: null,\r\n            stop: null\r\n        },\r\n\r\n        _create: function () {\r\n            this._keySliding = false;\r\n            this._mouseSliding = false;\r\n            this._animateOff = true;\r\n            this._handleIndex = null;\r\n            this._detectOrientation();\r\n            this._mouseInit();\r\n\r\n            this.element\r\n                .addClass(\"ui-slider\" +\r\n                    \" ui-slider-\" + this.orientation +\r\n                    \" ui-widget\" +\r\n                    \" ui-widget-content\" +\r\n                    \" ui-corner-all\");\r\n\r\n            this._refresh();\r\n            this._setOption(\"disabled\", this.options.disabled);\r\n\r\n            this._animateOff = false;\r\n        },\r\n\r\n        _refresh: function () {\r\n            this._createRange();\r\n            this._createHandles();\r\n            this._setupEvents();\r\n            this._refreshValue();\r\n        },\r\n\r\n        _createHandles: function () {\r\n            var i, handleCount,\r\n                options = this.options,\r\n                existingHandles = this.element.find(\".ui-slider-handle\").addClass(\"ui-state-default ui-corner-all\"),\r\n                handle = \"<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>\",\r\n                handles = [];\r\n\r\n            handleCount = (options.values && options.values.length) || 1;\r\n\r\n            if (existingHandles.length > handleCount) {\r\n                existingHandles.slice(handleCount).remove();\r\n                existingHandles = existingHandles.slice(0, handleCount);\r\n            }\r\n\r\n            for (i = existingHandles.length; i < handleCount; i++) {\r\n                handles.push(handle);\r\n            }\r\n\r\n            this.handles = existingHandles.add($(handles.join(\"\")).appendTo(this.element));\r\n\r\n            this.handle = this.handles.eq(0);\r\n\r\n            this.handles.each(function (i) {\r\n                $(this).data(\"ui-slider-handle-index\", i);\r\n            });\r\n        },\r\n\r\n        _createRange: function () {\r\n            var options = this.options,\r\n                classes = \"\";\r\n\r\n            if (options.range) {\r\n                if (options.range === true) {\r\n                    if (!options.values) {\r\n                        options.values = [this._valueMin(), this._valueMin()];\r\n                    } else if (options.values.length && options.values.length !== 2) {\r\n                        options.values = [options.values[0], options.values[0]];\r\n                    } else if ($.isArray(options.values)) {\r\n                        options.values = options.values.slice(0);\r\n                    }\r\n                }\r\n\r\n                if (!this.range || !this.range.length) {\r\n                    this.range = $(\"<div></div>\")\r\n                        .appendTo(this.element);\r\n\r\n                    classes = \"ui-slider-range\" +\r\n                        // note: this isn't the most fittingly semantic framework class for this element,\r\n                        // but worked best visually with a variety of themes\r\n                        \" ui-widget-header ui-corner-all\";\r\n                } else {\r\n                    this.range.removeClass(\"ui-slider-range-min ui-slider-range-max\")\r\n                    // Handle range switching from true to min/max\r\n                        .css({\r\n                            \"left\": \"\",\r\n                            \"bottom\": \"\"\r\n                        });\r\n                }\r\n\r\n                this.range.addClass(classes +\r\n                    ((options.range === \"min\" || options.range === \"max\") ? \" ui-slider-range-\" + options.range : \"\"));\r\n            } else {\r\n                if (this.range) {\r\n                    this.range.remove();\r\n                }\r\n                this.range = null;\r\n            }\r\n        },\r\n\r\n        _setupEvents: function () {\r\n            var elements = this.handles.add(this.range).filter(\"a\");\r\n            this._off(elements);\r\n            this._on(elements, this._handleEvents);\r\n            this._hoverable(elements);\r\n            this._focusable(elements);\r\n        },\r\n\r\n        _destroy: function () {\r\n            this.handles.remove();\r\n            if (this.range) {\r\n                this.range.remove();\r\n            }\r\n\r\n            this.element\r\n                .removeClass(\"ui-slider\" +\r\n                    \" ui-slider-horizontal\" +\r\n                    \" ui-slider-vertical\" +\r\n                    \" ui-widget\" +\r\n                    \" ui-widget-content\" +\r\n                    \" ui-corner-all\");\r\n\r\n            this._mouseDestroy();\r\n        },\r\n\r\n        _mouseCapture: function (event) {\r\n            var position, normValue, distance, closestHandle, index, allowed, offset, mouseOverHandle,\r\n                that = this,\r\n                o = this.options;\r\n\r\n            if (o.disabled) {\r\n                return false;\r\n            }\r\n\r\n            this.elementSize = {\r\n                width: this.element.outerWidth(),\r\n                height: this.element.outerHeight()\r\n            };\r\n            this.elementOffset = this.element.offset();\r\n\r\n            position = {x: event.pageX, y: event.pageY};\r\n            normValue = this._normValueFromMouse(position);\r\n            distance = this._valueMax() - this._valueMin() + 1;\r\n            this.handles.each(function (i) {\r\n                var thisDistance = Math.abs(normValue - that.values(i));\r\n                if ((distance > thisDistance) ||\r\n                    (distance === thisDistance &&\r\n                        (i === that._lastChangedValue || that.values(i) === o.min))) {\r\n                    distance = thisDistance;\r\n                    closestHandle = $(this);\r\n                    index = i;\r\n                }\r\n            });\r\n\r\n            allowed = this._start(event, index);\r\n            if (allowed === false) {\r\n                return false;\r\n            }\r\n            this._mouseSliding = true;\r\n\r\n            this._handleIndex = index;\r\n\r\n            closestHandle\r\n                .addClass(\"ui-state-active\")\r\n                .focus();\r\n\r\n            offset = closestHandle.offset();\r\n            mouseOverHandle = !$(event.target).parents().addBack().is(\".ui-slider-handle\");\r\n            this._clickOffset = mouseOverHandle ? {left: 0, top: 0} : {\r\n                left: event.pageX - offset.left - (closestHandle.width() / 2),\r\n                top: event.pageY - offset.top -\r\n                    (closestHandle.height() / 2) -\r\n                    (parseInt(closestHandle.css(\"borderTopWidth\"), 10) || 0) -\r\n                    (parseInt(closestHandle.css(\"borderBottomWidth\"), 10) || 0) +\r\n                    (parseInt(closestHandle.css(\"marginTop\"), 10) || 0)\r\n            };\r\n\r\n            if (!this.handles.hasClass(\"ui-state-hover\")) {\r\n                this._slide(event, index, normValue);\r\n            }\r\n            this._animateOff = true;\r\n            return true;\r\n        },\r\n\r\n        _mouseStart: function () {\r\n            return true;\r\n        },\r\n\r\n        _mouseDrag: function (event) {\r\n            var position = {x: event.pageX, y: event.pageY},\r\n                normValue = this._normValueFromMouse(position);\r\n\r\n            this._slide(event, this._handleIndex, normValue);\r\n\r\n            return false;\r\n        },\r\n\r\n        _mouseStop: function (event) {\r\n            this.handles.removeClass(\"ui-state-active\");\r\n            this._mouseSliding = false;\r\n\r\n            this._stop(event, this._handleIndex);\r\n            this._change(event, this._handleIndex);\r\n\r\n            this._handleIndex = null;\r\n            this._clickOffset = null;\r\n            this._animateOff = false;\r\n\r\n            return false;\r\n        },\r\n\r\n        _detectOrientation: function () {\r\n            this.orientation = (this.options.orientation === \"vertical\") ? \"vertical\" : \"horizontal\";\r\n        },\r\n\r\n        _normValueFromMouse: function (position) {\r\n            var pixelTotal,\r\n                pixelMouse,\r\n                percentMouse,\r\n                valueTotal,\r\n                valueMouse;\r\n\r\n            if (this.orientation === \"horizontal\") {\r\n                pixelTotal = this.elementSize.width;\r\n                pixelMouse = position.x - this.elementOffset.left - (this._clickOffset ? this._clickOffset.left : 0);\r\n            } else {\r\n                pixelTotal = this.elementSize.height;\r\n                pixelMouse = position.y - this.elementOffset.top - (this._clickOffset ? this._clickOffset.top : 0);\r\n            }\r\n\r\n            percentMouse = (pixelMouse / pixelTotal);\r\n            if (percentMouse > 1) {\r\n                percentMouse = 1;\r\n            }\r\n            if (percentMouse < 0) {\r\n                percentMouse = 0;\r\n            }\r\n            if (this.orientation === \"vertical\") {\r\n                percentMouse = 1 - percentMouse;\r\n            }\r\n\r\n            valueTotal = this._valueMax() - this._valueMin();\r\n            valueMouse = this._valueMin() + percentMouse * valueTotal;\r\n\r\n            return this._trimAlignValue(valueMouse);\r\n        },\r\n\r\n        _start: function (event, index) {\r\n            var uiHash = {\r\n                handle: this.handles[index],\r\n                value: this.value()\r\n            };\r\n            if (this.options.values && this.options.values.length) {\r\n                uiHash.value = this.values(index);\r\n                uiHash.values = this.values();\r\n            }\r\n            return this._trigger(\"start\", event, uiHash);\r\n        },\r\n\r\n        _slide: function (event, index, newVal) {\r\n            var otherVal,\r\n                newValues,\r\n                allowed;\r\n\r\n            if (this.options.values && this.options.values.length) {\r\n                otherVal = this.values(index ? 0 : 1);\r\n\r\n                if ((this.options.values.length === 2 && this.options.range === true) &&\r\n                    ((index === 0 && newVal > otherVal) || (index === 1 && newVal < otherVal))\r\n                ) {\r\n                    newVal = otherVal;\r\n                }\r\n\r\n                if (newVal !== this.values(index)) {\r\n                    newValues = this.values();\r\n                    newValues[index] = newVal;\r\n                    // A slide can be canceled by returning false from the slide callback\r\n                    allowed = this._trigger(\"slide\", event, {\r\n                        handle: this.handles[index],\r\n                        value: newVal,\r\n                        values: newValues\r\n                    });\r\n                    otherVal = this.values(index ? 0 : 1);\r\n                    if (allowed !== false) {\r\n                        this.values(index, newVal);\r\n                    }\r\n                }\r\n            } else {\r\n                if (newVal !== this.value()) {\r\n                    // A slide can be canceled by returning false from the slide callback\r\n                    allowed = this._trigger(\"slide\", event, {\r\n                        handle: this.handles[index],\r\n                        value: newVal\r\n                    });\r\n                    if (allowed !== false) {\r\n                        this.value(newVal);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        _stop: function (event, index) {\r\n            var uiHash = {\r\n                handle: this.handles[index],\r\n                value: this.value()\r\n            };\r\n            if (this.options.values && this.options.values.length) {\r\n                uiHash.value = this.values(index);\r\n                uiHash.values = this.values();\r\n            }\r\n\r\n            this._trigger(\"stop\", event, uiHash);\r\n        },\r\n\r\n        _change: function (event, index) {\r\n            if (!this._keySliding && !this._mouseSliding) {\r\n                var uiHash = {\r\n                    handle: this.handles[index],\r\n                    value: this.value()\r\n                };\r\n                if (this.options.values && this.options.values.length) {\r\n                    uiHash.value = this.values(index);\r\n                    uiHash.values = this.values();\r\n                }\r\n\r\n                //store the last changed value index for reference when handles overlap\r\n                this._lastChangedValue = index;\r\n\r\n                this._trigger(\"change\", event, uiHash);\r\n            }\r\n        },\r\n\r\n        value: function (newValue) {\r\n            if (arguments.length) {\r\n                this.options.value = this._trimAlignValue(newValue);\r\n                this._refreshValue();\r\n                this._change(null, 0);\r\n                return;\r\n            }\r\n\r\n            return this._value();\r\n        },\r\n\r\n        values: function (index, newValue) {\r\n            var vals,\r\n                newValues,\r\n                i;\r\n\r\n            if (arguments.length > 1) {\r\n                this.options.values[index] = this._trimAlignValue(newValue);\r\n                this._refreshValue();\r\n                this._change(null, index);\r\n                return;\r\n            }\r\n\r\n            if (arguments.length) {\r\n                if ($.isArray(arguments[0])) {\r\n                    vals = this.options.values;\r\n                    newValues = arguments[0];\r\n                    for (i = 0; i < vals.length; i += 1) {\r\n                        vals[i] = this._trimAlignValue(newValues[i]);\r\n                        this._change(null, i);\r\n                    }\r\n                    this._refreshValue();\r\n                } else {\r\n                    if (this.options.values && this.options.values.length) {\r\n                        return this._values(index);\r\n                    } else {\r\n                        return this.value();\r\n                    }\r\n                }\r\n            } else {\r\n                return this._values();\r\n            }\r\n        },\r\n\r\n        _setOption: function (key, value) {\r\n            var i,\r\n                valsLength = 0;\r\n\r\n            if (key === \"range\" && this.options.range === true) {\r\n                if (value === \"min\") {\r\n                    this.options.value = this._values(0);\r\n                    this.options.values = null;\r\n                } else if (value === \"max\") {\r\n                    this.options.value = this._values(this.options.values.length - 1);\r\n                    this.options.values = null;\r\n                }\r\n            }\r\n\r\n            if ($.isArray(this.options.values)) {\r\n                valsLength = this.options.values.length;\r\n            }\r\n\r\n            $.Widget.prototype._setOption.apply(this, arguments);\r\n\r\n            switch (key) {\r\n                case \"orientation\":\r\n                    this._detectOrientation();\r\n                    this.element\r\n                        .removeClass(\"ui-slider-horizontal ui-slider-vertical\")\r\n                        .addClass(\"ui-slider-\" + this.orientation);\r\n                    this._refreshValue();\r\n                    break;\r\n                case \"value\":\r\n                    this._animateOff = true;\r\n                    this._refreshValue();\r\n                    this._change(null, 0);\r\n                    this._animateOff = false;\r\n                    break;\r\n                case \"values\":\r\n                    this._animateOff = true;\r\n                    this._refreshValue();\r\n                    for (i = 0; i < valsLength; i += 1) {\r\n                        this._change(null, i);\r\n                    }\r\n                    this._animateOff = false;\r\n                    break;\r\n                case \"min\":\r\n                case \"max\":\r\n                    this._animateOff = true;\r\n                    this._refreshValue();\r\n                    this._animateOff = false;\r\n                    break;\r\n                case \"range\":\r\n                    this._animateOff = true;\r\n                    this._refresh();\r\n                    this._animateOff = false;\r\n                    break;\r\n            }\r\n        },\r\n\r\n        //internal value getter\r\n        // _value() returns value trimmed by min and max, aligned by step\r\n        _value: function () {\r\n            var val = this.options.value;\r\n            val = this._trimAlignValue(val);\r\n\r\n            return val;\r\n        },\r\n\r\n        //internal values getter\r\n        // _values() returns array of values trimmed by min and max, aligned by step\r\n        // _values( index ) returns single value trimmed by min and max, aligned by step\r\n        _values: function (index) {\r\n            var val,\r\n                vals,\r\n                i;\r\n\r\n            if (arguments.length) {\r\n                val = this.options.values[index];\r\n                val = this._trimAlignValue(val);\r\n\r\n                return val;\r\n            } else if (this.options.values && this.options.values.length) {\r\n                // .slice() creates a copy of the array\r\n                // this copy gets trimmed by min and max and then returned\r\n                vals = this.options.values.slice();\r\n                for (i = 0; i < vals.length; i += 1) {\r\n                    vals[i] = this._trimAlignValue(vals[i]);\r\n                }\r\n\r\n                return vals;\r\n            } else {\r\n                return [];\r\n            }\r\n        },\r\n\r\n        // returns the step-aligned value that val is closest to, between (inclusive) min and max\r\n        _trimAlignValue: function (val) {\r\n            if (val <= this._valueMin()) {\r\n                return this._valueMin();\r\n            }\r\n            if (val >= this._valueMax()) {\r\n                return this._valueMax();\r\n            }\r\n            var step = (this.options.step > 0) ? this.options.step : 1,\r\n                valModStep = (val - this._valueMin()) % step,\r\n                alignValue = val - valModStep;\r\n\r\n            if (Math.abs(valModStep) * 2 >= step) {\r\n                alignValue += (valModStep > 0) ? step : (-step);\r\n            }\r\n\r\n            // Since JavaScript has problems with large floats, round\r\n            // the final value to 5 digits after the decimal point (see #4124)\r\n            return parseFloat(alignValue.toFixed(5));\r\n        },\r\n\r\n        _valueMin: function () {\r\n            return this.options.min;\r\n        },\r\n\r\n        _valueMax: function () {\r\n            return this.options.max;\r\n        },\r\n\r\n        _refreshValue: function () {\r\n            var lastValPercent, valPercent, value, valueMin, valueMax,\r\n                oRange = this.options.range,\r\n                o = this.options,\r\n                that = this,\r\n                animate = (!this._animateOff) ? o.animate : false,\r\n                _set = {};\r\n\r\n            if (this.options.values && this.options.values.length) {\r\n                this.handles.each(function (i) {\r\n                    valPercent = (that.values(i) - that._valueMin()) / (that._valueMax() - that._valueMin()) * 100;\r\n                    _set[that.orientation === \"horizontal\" ? \"left\" : \"bottom\"] = valPercent + \"%\";\r\n                    $(this).stop(1, 1)[animate ? \"animate\" : \"css\"](_set, o.animate);\r\n                    if (that.options.range === true) {\r\n                        if (that.orientation === \"horizontal\") {\r\n                            if (i === 0) {\r\n                                that.range.stop(1, 1)[animate ? \"animate\" : \"css\"]({left: valPercent + \"%\"}, o.animate);\r\n                            }\r\n                            if (i === 1) {\r\n                                that.range[animate ? \"animate\" : \"css\"]({width: (valPercent - lastValPercent) + \"%\"}, {\r\n                                    queue: false,\r\n                                    duration: o.animate\r\n                                });\r\n                            }\r\n                        } else {\r\n                            if (i === 0) {\r\n                                that.range.stop(1, 1)[animate ? \"animate\" : \"css\"]({bottom: (valPercent) + \"%\"}, o.animate);\r\n                            }\r\n                            if (i === 1) {\r\n                                that.range[animate ? \"animate\" : \"css\"]({height: (valPercent - lastValPercent) + \"%\"}, {\r\n                                    queue: false,\r\n                                    duration: o.animate\r\n                                });\r\n                            }\r\n                        }\r\n                    }\r\n                    lastValPercent = valPercent;\r\n                });\r\n            } else {\r\n                value = this.value();\r\n                valueMin = this._valueMin();\r\n                valueMax = this._valueMax();\r\n                valPercent = (valueMax !== valueMin) ?\r\n                    (value - valueMin) / (valueMax - valueMin) * 100 :\r\n                    0;\r\n                _set[this.orientation === \"horizontal\" ? \"left\" : \"bottom\"] = valPercent + \"%\";\r\n                this.handle.stop(1, 1)[animate ? \"animate\" : \"css\"](_set, o.animate);\r\n\r\n                if (oRange === \"min\" && this.orientation === \"horizontal\") {\r\n                    this.range.stop(1, 1)[animate ? \"animate\" : \"css\"]({width: valPercent + \"%\"}, o.animate);\r\n                }\r\n                if (oRange === \"max\" && this.orientation === \"horizontal\") {\r\n                    this.range[animate ? \"animate\" : \"css\"]({width: (100 - valPercent) + \"%\"}, {\r\n                        queue: false,\r\n                        duration: o.animate\r\n                    });\r\n                }\r\n                if (oRange === \"min\" && this.orientation === \"vertical\") {\r\n                    this.range.stop(1, 1)[animate ? \"animate\" : \"css\"]({height: valPercent + \"%\"}, o.animate);\r\n                }\r\n                if (oRange === \"max\" && this.orientation === \"vertical\") {\r\n                    this.range[animate ? \"animate\" : \"css\"]({height: (100 - valPercent) + \"%\"}, {\r\n                        queue: false,\r\n                        duration: o.animate\r\n                    });\r\n                }\r\n            }\r\n        },\r\n\r\n        _handleEvents: {\r\n            keydown: function (event) {\r\n                var allowed, curVal, newVal, step,\r\n                    index = $(event.target).data(\"ui-slider-handle-index\");\r\n\r\n                switch (event.keyCode) {\r\n                    case $.ui.keyCode.HOME:\r\n                    case $.ui.keyCode.END:\r\n                    case $.ui.keyCode.PAGE_UP:\r\n                    case $.ui.keyCode.PAGE_DOWN:\r\n                    case $.ui.keyCode.UP:\r\n                    case $.ui.keyCode.RIGHT:\r\n                    case $.ui.keyCode.DOWN:\r\n                    case $.ui.keyCode.LEFT:\r\n                        event.preventDefault();\r\n                        if (!this._keySliding) {\r\n                            this._keySliding = true;\r\n                            $(event.target).addClass(\"ui-state-active\");\r\n                            allowed = this._start(event, index);\r\n                            if (allowed === false) {\r\n                                return;\r\n                            }\r\n                        }\r\n                        break;\r\n                }\r\n\r\n                step = this.options.step;\r\n                if (this.options.values && this.options.values.length) {\r\n                    curVal = newVal = this.values(index);\r\n                } else {\r\n                    curVal = newVal = this.value();\r\n                }\r\n\r\n                switch (event.keyCode) {\r\n                    case $.ui.keyCode.HOME:\r\n                        newVal = this._valueMin();\r\n                        break;\r\n                    case $.ui.keyCode.END:\r\n                        newVal = this._valueMax();\r\n                        break;\r\n                    case $.ui.keyCode.PAGE_UP:\r\n                        newVal = this._trimAlignValue(curVal + ((this._valueMax() - this._valueMin()) / numPages));\r\n                        break;\r\n                    case $.ui.keyCode.PAGE_DOWN:\r\n                        newVal = this._trimAlignValue(curVal - ((this._valueMax() - this._valueMin()) / numPages));\r\n                        break;\r\n                    case $.ui.keyCode.UP:\r\n                    case $.ui.keyCode.RIGHT:\r\n                        if (curVal === this._valueMax()) {\r\n                            return;\r\n                        }\r\n                        newVal = this._trimAlignValue(curVal + step);\r\n                        break;\r\n                    case $.ui.keyCode.DOWN:\r\n                    case $.ui.keyCode.LEFT:\r\n                        if (curVal === this._valueMin()) {\r\n                            return;\r\n                        }\r\n                        newVal = this._trimAlignValue(curVal - step);\r\n                        break;\r\n                }\r\n\r\n                this._slide(event, index, newVal);\r\n            },\r\n            click: function (event) {\r\n                event.preventDefault();\r\n            },\r\n            keyup: function (event) {\r\n                var index = $(event.target).data(\"ui-slider-handle-index\");\r\n\r\n                if (this._keySliding) {\r\n                    this._keySliding = false;\r\n                    this._stop(event, index);\r\n                    this._change(event, index);\r\n                    $(event.target).removeClass(\"ui-state-active\");\r\n                }\r\n            }\r\n        }\r\n\r\n    });\r\n\r\n});\r\n"}
}});
